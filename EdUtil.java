package us.nm.state.hsd.aspen.business.rules.ed;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Set;

import us.nm.state.hsd.aspen.business.entities.alert.AlEmployeeAlertCargo;
import us.nm.state.hsd.aspen.business.entities.alert.AlEmployeeAlertCollection;
import us.nm.state.hsd.aspen.business.entities.benefit.BiSerIndvIssuanceCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseAddressesCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseAddressesCollection;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseMiscInfoCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseProfileCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseProgramCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCaseProgramIndvCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcCasesCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcIndvHhStatusCargo;
import us.nm.state.hsd.aspen.business.entities.cases.DcIndvHhStatusCollection;
import us.nm.state.hsd.aspen.business.entities.correspondence.COCorrespondence;
import us.nm.state.hsd.aspen.business.entities.correspondence.CoRequestHistoryCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdCaseRecertDatesCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdColaChangesCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEdgOverrideCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEdgOverrideCollection;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEdgOverrideDetailsCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEdgOverrideDetailsCollection;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEdgPenaltyDetailsCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEligFsBudgetCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEligNoticeReasonsCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEligSerServiceAuthCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEligibilityCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdEligibilityCollection;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvApplIncBudgetCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvCdcServiceAuthCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvCountersCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvDateSpecificCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvDssServiceAuthCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvEligibilityCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvLtcPendingReasonCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvNoticeReasonsCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvPenToBeImposedCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvRscBudgetCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvServiceDtlsCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvTanfBudgetCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdLtcEligDatesCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdOnlineTriggerCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdOnlineTriggerCollection;
import us.nm.state.hsd.aspen.business.entities.eligibility.EdVerificationChecklistCargo;
import us.nm.state.hsd.aspen.business.entities.eligibility.HeRestoreBenefitsCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcDisabilityCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcDisableDeterminationCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcIndividualAlienCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcIndvCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcIndvCollection;
import us.nm.state.hsd.aspen.business.entities.individual.DcIntervieweeCargo;
import us.nm.state.hsd.aspen.business.entities.individual.DcPregnanciesCargo;
import us.nm.state.hsd.aspen.business.entities.individualfinancial.DcEmploymentCargo;
import us.nm.state.hsd.aspen.business.entities.individualnonfinancial.DcIndvEmpServExemptionCargo;
import us.nm.state.hsd.aspen.business.entities.individualnonfinancial.DcIndvIpvSanctionsCargo;
import us.nm.state.hsd.aspen.business.entities.interfaces.InTriggerTableCargo;
import us.nm.state.hsd.aspen.business.entities.mci.CvEdMciEdgIndividualCargo;
import us.nm.state.hsd.aspen.business.rules.al.AlAlertManager;
import us.nm.state.hsd.aspen.business.rules.al.AlConstants;
import us.nm.state.hsd.aspen.business.rules.al.IAlerts;
import us.nm.state.hsd.aspen.business.rules.bv.BVComputeCDCDiscrepancyBO;
import us.nm.state.hsd.aspen.business.rules.bv.BvComputeDiscrepancy;
import us.nm.state.hsd.aspen.business.rules.bv.BvDeletePendingClaims;
import us.nm.state.hsd.aspen.business.rules.bv.BvRecoupmentReturnVO;
import us.nm.state.hsd.aspen.business.rules.bv.BvRecoupmentVO;
import us.nm.state.hsd.aspen.business.rules.bv.RecoveryException;
import us.nm.state.hsd.aspen.business.rules.co.CoServiceFactory;
import us.nm.state.hsd.aspen.business.rules.co.ICoBatch;
import us.nm.state.hsd.aspen.business.rules.co.ICoOnline;
import us.nm.state.hsd.aspen.business.rules.di.DIConstants;
import us.nm.state.hsd.aspen.business.rules.di.DIUtil;
import us.nm.state.hsd.aspen.business.rules.di.DiAttributes;
import us.nm.state.hsd.aspen.business.rules.di.DiFindByBO;
import us.nm.state.hsd.aspen.business.rules.di.DiFsCertification;
import us.nm.state.hsd.aspen.business.rules.di.EDBCConstants;
import us.nm.state.hsd.aspen.business.rules.di.EDBCLogger;
import us.nm.state.hsd.aspen.business.rules.di.override.DIOverrideBO;
import us.nm.state.hsd.aspen.business.rules.di.override.IOverride;
import us.nm.state.hsd.aspen.business.rules.dm.DMElectronicDocumentWSGroupVO;
import us.nm.state.hsd.aspen.business.rules.dm.util.DMConstants;
import us.nm.state.hsd.aspen.business.rules.dm.util.DMFactory;
import us.nm.state.hsd.aspen.business.rules.ed.corticon.CorticonFinManager;
import us.nm.state.hsd.aspen.business.rules.ed.corticon.CorticonNFNManager;
import us.nm.state.hsd.aspen.business.rules.ed.corticon.CorticonResourceManager;
import us.nm.state.hsd.aspen.business.rules.ed.corticon.CorticonVCLManager;
import us.nm.state.hsd.aspen.business.rules.eg.EDGConstants;
import us.nm.state.hsd.aspen.business.rules.eg.EgDriverFactory;
import us.nm.state.hsd.aspen.business.rules.eg.IEgManager;
import us.nm.state.hsd.aspen.business.rules.in.INTriggerBO;
import us.nm.state.hsd.aspen.business.rules.sv.CDCManager;
import us.nm.state.hsd.aspen.business.rules.sv.CdcDataHandler;
import us.nm.state.hsd.aspen.business.rules.sv.DSSDataHandler;
import us.nm.state.hsd.aspen.business.rules.sv.DSSManager;
import us.nm.state.hsd.aspen.business.rules.sv.IServiceDetailWriter;
import us.nm.state.hsd.aspen.business.rules.sv.SERManager;
import us.nm.state.hsd.aspen.business.rules.sv.SerDataHandler;
import us.nm.state.hsd.aspen.business.rules.sv.ServiceDetailWriter;
import us.nm.state.hsd.framework.business.services.rulesengine.debugger.RulesException;
import us.nm.state.hsd.framework.business.services.rulesengine.helperclasses.GenericConstants;
import us.nm.state.hsd.framework.factories.FwServiceFactory;
import us.nm.state.hsd.framework.management.logging.ILog;
import us.nm.state.hsd.framework.management.util.FwConstants;
import us.nm.state.hsd.framework.management.util.FwProperty;
import us.nm.state.hsd.framework.management.util.FwPropertyLoader;
import us.nm.state.hsd.framework.management.util.FwTimer;
import us.nm.state.hsd.fw.batch.Controller.TIERSBatchController;
import us.nm.state.hsd.fw.business.exceptions.ApplicationException;
import us.nm.state.hsd.fw.business.exceptions.FrameworkException;
import us.nm.state.hsd.fw.business.exceptions.TIERSRunTimeException;
import us.nm.state.hsd.fw.business.exceptions.TIERSValidationException;
import us.nm.state.hsd.fw.business.helperclasses.TIERSConstants;
import us.nm.state.hsd.fw.management.logger.Debug;
import us.nm.state.hsd.fw.management.referencetables.RefTableData;
import us.nm.state.hsd.fw.management.referencetables.ReferenceTableManager;
import us.nm.state.hsd.fw.management.util.StringUtils;
import us.nm.state.hsd.fw.security.ISecurityFunctions;
import us.nm.state.hsd.fw.security.User;
import us.nm.state.hsd.fw.services.PageActionsParser;

/**
 * <code>EdUtil</code> contains utility methods and edbc driver flow logic
 * used by the EDBC process after before and after returning from the
 * RulesEngine.
 *
 * Creation date: (12/27/2001 11:00:00 AM)
 *
 * @author Deloitte
 * @see DateComparisons
 * @see IEdEligCodes
 * @version %Revision%
 */ 

/**
 * @author kucherlapatis
 *
 * TODO To change the template for this generated type comment go to
 * Window - Preferences - Java - Code Style - Code Templates
 */
public class EdUtil implements IEdUtil {
	/**
	 * Private Constructor.
	 */
	private EdUtil() {
		hmEMERGENCY_MA_TOA = populateHMTPCodes();
	}

	/**
	 * Field StTime.
	 */
	long StTime;

	/**
	 * Method getInstance.
	 *
	 * @return IEdUtil
	 */
	public static IEdUtil getInstance() {
		EdUtil edUtil = new EdUtil();
		return edUtil;
	}

	/**
	 * Field logger.
	 */
	private static ILog logger = EDBCLogger.getLogger();

	/**
	 * Field hmELNoticeReason.
	 */
	private HashMap hmELNoticeReason = null;

	/**
	 * Field hmEMERGENCY_MA_TOA.
	 */
	private HashMap hmEMERGENCY_MA_TOA = null;

	/**
	 * Field hmCMA_TPCodes.
	 */
	private static HashMap hmCMA_TPCodes = null;

	/**
	 * Field hmCoPayTpCodes.
	 */
	private static HashMap hmCoPayTpCodes = null;

	private static String MU_RUN_MODE = "runMode";

	private static String CASE_NUM = "CASE_NUM";

	private static final String TRIGGER_CODE_LIST = "TRIGGER_CODES";

	private EligDetail eligDetailPrevCD = null;

	private int numberOfMonths = 0;// Log Chages
	
	//private long edonLineTrgSeqNum  = 0;// Log Chages//BRGUS00217436-upadhyayulag-FindBugs

	/**
	 * Field sdf.
	 */
	private static SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss:SSS");
	//Added by Sai on 12/9/2004
	//private static EdDcUtil edDcUtil = new EdDcUtil();
	// Added by Sairama on 09/31/2007 For Defect #BRGUS00059767
	/**
	 * Determines the Benefit Status Code for the current EdEligiblity record.
	 *
	 * @param aEdEligibilityCargo
	 *            contains the current EdEligibilityCargo being processed
	 * @param aEdEligibilityCargoConfirmed
	 *            contains the authorized/cancelled EdEligibility records
	 * @param aEgDataHandler
	 *            contains the EgDataHandler for the current record
	 * @param lastEDBCRun
	 *            variable to identify if the criteria to be used is last EDBC
	 * @throws EDBCException
	 */
	//BRGUS00104064 – kesavanr – Passing boolean variable which has the value of last edbc run check
    //to determine benefit status.
	
	//ASPEN00036737 - TANF Support Services - Added by Sai Suresh
	private Map requestMap = new HashMap();
	
	public void detBenefitStatus(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo[] aEdEligibilityCargoConfirmed,
			EgDataHandler aEgDataHandler,boolean lastEDBCRun) throws EDBCException {

		String sCgStatusCd = null;
		String sActivityType = null;
		boolean bAuthFound = false;

		//BRGUS00109150 – kesavanr – Variables which stores the unconfirmed data for medicaid program
		//moved detMedicaidBenefitStatus method.
		double dBenefitAmtUnConfirmed = 0;
		double dBenefitAmtConfirmed = 0;
		double deductibleConfirmed = 0;
		double ftwPremiumConfirmed = 0;
		double remDeductibleConfirmed = 0;//BRGUS00158978-upadhyayulag-Variable to hold the remaining deductible amt
		double tmapPremiumConfirmed = 0;
		double patientPayConfirmed = 0;
		EdEligibilityCargo edEligibilityAuthCargo = null;

		try {
			sCgStatusCd = aEdEligibilityCargo.getCgStatusCd();
			sActivityType = aEdEligibilityCargo.getActivityType();
			if (sCgStatusCd == null) {
				sCgStatusCd = "";
			}
			if (sActivityType == null) {
				sActivityType = "";
			}
			//common logic
			int iLength = 0;
			if (aEdEligibilityCargoConfirmed != null) {
				iLength = aEdEligibilityCargoConfirmed.length;
			}
			EdEligibilityCargo lastAuthCargo = null;
			Timestamp tsMthEndEffBegDt = DateComparisons
					.getLastDayOfDate(aEdEligibilityCargo.getRecBeginDt());
			boolean bEDMLastAuthFound = false;
			for (int i = 0; i < iLength; i++) {

				if ((aEdEligibilityCargoConfirmed[i].getCgStatusCd()
						.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED))
						&& aEdEligibilityCargoConfirmed[i].getEdgNum() == aEdEligibilityCargo
								.getEdgNum()) {
					if ((aEdEligibilityCargoConfirmed[i].getRecBeginDt()
							.before(tsMthEndEffBegDt) || aEdEligibilityCargoConfirmed[i]
							.getRecBeginDt().equals(tsMthEndEffBegDt))
							&& (((aEdEligibilityCargoConfirmed[i].getRecEndDt() == null) || (aEdEligibilityCargoConfirmed[i]
									.getRecEndDt()
									.after(aEdEligibilityCargo.getRecBeginDt()) || aEdEligibilityCargoConfirmed[i]
									.getRecEndDt()
									.equals(aEdEligibilityCargo.getRecBeginDt()))))) {

						dBenefitAmtConfirmed = aEdEligibilityCargoConfirmed[i]
								.getBenefitAmt();
						deductibleConfirmed = aEdEligibilityCargoConfirmed[i]
								.getBenefitAmt();

						//BRGUS00071439 added null check
						if (aEgDataHandler.getEligDetailLastAuth() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligMeBudgetCargo() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligMeBudgetCargo().length > 0) {
							ftwPremiumConfirmed = aEgDataHandler
									.getEligDetailLastAuth()
									.getEdEligMeBudgetCargo()[0]
									.getFtwMonthlyPremiumAmt();
							//BEGIN-BRGUS00158978-upadhyayulag-Retrieve the remaining deductible amount
							//from last authorized record
							remDeductibleConfirmed = aEgDataHandler
									.getEligDetailLastAuth()
									.getEdEligMeBudgetCargo()[0]
									.getRemDeductibleAmt();
							//END-BRGUS00158978
						}
						//BRGUS00071439 added nulll check
						if (aEgDataHandler.getEligDetailLastAuth() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligTanfBudgetCargo() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligTanfBudgetCargo().length > 0) {
							tmapPremiumConfirmed = aEgDataHandler
									.getEligDetailLastAuth()
									.getEdEligTanfBudgetCargo()[0]
									.getPremiumAmt();
						}

						patientPayConfirmed = aEdEligibilityCargoConfirmed[i]
								.getCopayAmt();
						/*
						 * if(aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() !=
						 * null &&
						 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length >
						 * 0) { patientPayConfirmed =
						 * aEgDataHandler.getEligDetailLastAuth()
						 * .getEdEligibilityCargo()[0].getCopayAmt(); }
						 */
						bEDMLastAuthFound = true;
						lastAuthCargo = aEdEligibilityCargoConfirmed[i];
						break;
					}
				}
			}
			//common logic

			//Benefit Status for Cash/Rep/FAP/SSP
			//ASPEN00046267 - Benefit Status for TRFS/GAUC/ENWP/WASU - nsandru 
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(
					"TP01")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("TP71")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("RAPC")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("SDAC")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("REPC")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("TP09")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("SSPC")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("GAUC")	
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("TRFS")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("ENWP")
					|| aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase("WASU")) {

				//DENY Logic
				if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (sCgStatusCd
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
					return;
				}
				//DENY Logic
				//CERTIFY Lofic for FAP
				else if ((sActivityType
						.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE) || aEgDataHandler
						.getEdIndvInfo().getIsEligBegDtSetForCert() == true)
						|| (sActivityType
								.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW) && (aEdEligibilityCargo
								.getProgramCd()
								.equals(IEdEligCodes.PROGRAM_CD_FS)))) {
					if (sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
						detBenefitStatusFromLastAuth(aEgDataHandler);
					}
					if (aEdEligibilityCargo.getBenefitStatus() == null
							|| aEdEligibilityCargo.getBenefitStatus()
									.equals("")) {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
					}
					//CERTIFY Lofic for FAP
					//INCREASE, DECREASE, SUSTAIN Logic for ALL
				} else if ((!sActivityType
						.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))) {
					/*
					 * if (aEgDataHandler.getEligDetailLastAuth() != null &&
					 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() !=
					 * null &&
					 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length >
					 * 0 &&
					 * (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED))) {
					 * dBenefitAmtUnConfirmed =
					 * aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getBenefitAmt();
					 * dBenefitAmtConfirmed =
					 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getBenefitAmt();
					 * //bAuthFound = true; }
					 */
					dBenefitAmtUnConfirmed = aEdEligibilityCargo
							.getBenefitAmt();
					if (bEDMLastAuthFound == true) {
						if (dBenefitAmtUnConfirmed < dBenefitAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
						} else if (dBenefitAmtUnConfirmed == dBenefitAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						} else if (dBenefitAmtUnConfirmed > dBenefitAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
						}
					}
				}
				//INCREASE, DECREASE, SUSTAIN Logic for ALL
				//INCREASE, DECREASE, SUSTAIN Logic for FAP
				//BRGUS00089089
				/*
				 * if
				 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)) {
				 * if (bEDMLastAuthFound == false) { Timestamp tsPayBegDt =
				 * DateComparisons.getDate(IEdEligCodes.LOW_DATE); for (int i =
				 * 0; i < iLength; i++) { if
				 * (aEdEligibilityCargoConfirmed[i].getEdgNum() ==
				 * aEdEligibilityCargo.getEdgNum()) { if
				 * ((aEdEligibilityCargo.getRequestDt().equals(aEdEligibilityCargoConfirmed[i].getRequestDt()))) {
				 * if
				 * (aEdEligibilityCargoConfirmed[i].getPaymentBegDt().after(tsPayBegDt)) {
				 * if (dBenefitAmtUnConfirmed >
				 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
				 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE); }
				 * else if (dBenefitAmtUnConfirmed <
				 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
				 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE); }
				 * else if (dBenefitAmtUnConfirmed ==
				 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
				 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN); } } } } } } }
				 */
				//INCREASE, DECREASE, SUSTAIN Logic for FAP
			} else if (aEdEligibilityCargo.getProgramCd()
					.equalsIgnoreCase("MA")
					|| aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("ME")
					|| aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("MC")) {

				if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (sCgStatusCd
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
				}
				//CERTIFY Lofic for TP43, TP44
				else if ((sActivityType
						.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE) || aEgDataHandler
						.getEdIndvInfo().getIsEligBegDtSetForCert() == true)
						|| (sActivityType
								.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW) && (aEdEligibilityCargo
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_43) || aEdEligibilityCargo
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_44)))) {
					if (sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
						detBenefitStatusFromLastAuth(aEgDataHandler);
					}
					/* Begin BRGUS00109150 – kesavanr
					 * Calliing the method to determine benefit status for medicaid program.
					 */
					if(aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2") && bEDMLastAuthFound) {
						//BEGIN-BRGUS00158978-upadhyayulag-Use remaining deductible amount instead of
						//benefit amount from the last authorized record if it is '0'
						//BEGIN-BRGUS00181506-upadhyayulag-Compare remaining deductibles if it is 0 for 'A' or 'P' records
						//BEGIN-BRGUS00181506-upadhyayulag-Pass last authorized cargo to detMedicaidBenefitStatus
						if(remDeductibleConfirmed <= 0 || aEdEligibilityCargo.getSpendDownAmt() <= 0){
							detMedicaidBenefitStatus(aEdEligibilityCargo,lastAuthCargo,aEgDataHandler,
									remDeductibleConfirmed,ftwPremiumConfirmed,tmapPremiumConfirmed,
									patientPayConfirmed);
						}else{
							detMedicaidBenefitStatus(aEdEligibilityCargo,lastAuthCargo,aEgDataHandler,
									deductibleConfirmed,ftwPremiumConfirmed,tmapPremiumConfirmed,patientPayConfirmed);
						}
						//END-BRGUS00158978
					}
					//End BRGUS00109150
					//BEGIN-BRGUS00215208-upadhyayulag-Check if the mode is Redetermination 
					//& adverse action is not allowed
					if(sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)	
							&& (aEdEligibilityCargo.getAdverseActionAllowedSw()==IEdEligCodes.NO)){
						detMedicaidBenefitStatus(aEdEligibilityCargo,lastAuthCargo,aEgDataHandler,
								deductibleConfirmed,ftwPremiumConfirmed,tmapPremiumConfirmed,patientPayConfirmed);
					}else if (aEdEligibilityCargo.getBenefitStatus() == null
							|| aEdEligibilityCargo.getBenefitStatus()
									.equals("")) {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
					}
					//END-BRGUS00215208
					//CERTIFY Lofic for TP43, TP44
				} else if ((!sActivityType
						.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))) {

					if (bEDMLastAuthFound == true) {
						//BRGUS00109150 – kesavanr – Calling method to determine benefitstatus for medicaid program.
						detMedicaidBenefitStatus(aEdEligibilityCargo,lastAuthCargo,aEgDataHandler,
								deductibleConfirmed,ftwPremiumConfirmed,tmapPremiumConfirmed,patientPayConfirmed);
					} //end of bEDMLastAuthFound
					//END-BRGUS00181506
				} //End of not intake
				//INCREASE, DECREASE, SUSTAIN Logic for ALL
			} else if (aEdEligibilityCargo.getProgramCd()
					.equalsIgnoreCase("CD")) {

				if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (sCgStatusCd
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
				} else {
					/*
					 * if (aEgDataHandler.getEligDetailLastAuth() != null &&
					 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() !=
					 * null &&
					 * aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length >
					 * 0 &&
					 * (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED))) {
					 * bAuthFound = true; }
					 */
					// Added By Kesavan For defect #BRGUS00074227
					/*
					 * Begin BRGUS00102716 – kesavanr Placing null check while
					 * retrieving authorized records from aEgDatahandler.
					 */
					/* Begin BRGUS00104064 – kesavanr
					 * Retrieve authorized and cancel records if last edbc run rule to be used to determine benefit status.
					 */
					EligDetail eligDetailAuth = null;
					EligDetail eligDetailCdcLastAuth = null;
					if(lastEDBCRun) {
						if (aEgDataHandler.getEligDetail() != null
								&& aEgDataHandler.getEligDetail().length > 2) {
							if (aEgDataHandler.getEligDetail()[2] != null) {
								eligDetailAuth = aEgDataHandler.getEligDetail()[2];
								eligDetailCdcLastAuth = getEligDetailCdcLastAuth(
										aEgDataHandler.getEligDetailUnAuthCurrEDM(),
										eligDetailAuth);
							}
						}
					}
					else {
						if (aEgDataHandler.getEligDetail() != null
								&& aEgDataHandler.getEligDetail().length > 1) {
							if (aEgDataHandler.getEligDetail()[1] != null) {
								eligDetailAuth = aEgDataHandler.getEligDetail()[1];
								eligDetailCdcLastAuth = getEligDetailCdcLastAuth(
										aEgDataHandler.getEligDetailUnAuthCurrEDM(),
										eligDetailAuth);
							}
						}
					}
					//End BRGUS00104064
					//End BRGUS00102716

					if (eligDetailCdcLastAuth != null
							&& eligDetailCdcLastAuth.getEdEligibilityCargo() != null
							&& eligDetailCdcLastAuth.getEdEligibilityCargo().length > 0
							&& eligDetailCdcLastAuth.getEdEligibilityCargo()[0]
									.getCgStatusCd().equalsIgnoreCase("AP")) {
						bAuthFound = true;
					}
					//BRGUS00104064 – kesavanr – Set the benefit status to 'CE' if last auth is not found.
					if (!bAuthFound) {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
					} else {
						if (aEgDataHandler.getEligDetailLastAuth() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligibilityCargo() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligibilityCargo().length > 0) {
							edEligibilityAuthCargo = aEgDataHandler
									.getEligDetailLastAuth()
									.getEdEligibilityCargo()[0];
						}
						String indvBenefitStatus = detIndvBenefitStatus(
								aEdEligibilityCargo, edEligibilityAuthCargo,
								aEgDataHandler);
						if (indvBenefitStatus != null
								&& indvBenefitStatus
										.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
							return;
						} else if (indvBenefitStatus != null
								&& indvBenefitStatus
										.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							return;
						}

						EdIndvCdcServiceAuthCargo[] edIndvCdcServiceAuthUnConfirmed = aEgDataHandler
								.getEligDetailUnAuthCurrEDM()
								.getEdIndvCdcServiceAuth();
						EdIndvCdcServiceAuthCargo[] edIndvCdcServiceAuthConfirmed = null;
						if (eligDetailCdcLastAuth != null) {
							edIndvCdcServiceAuthConfirmed = eligDetailCdcLastAuth
									.getEdIndvCdcServiceAuth();
						}
						if (edIndvCdcServiceAuthConfirmed == null) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							return;
						}
						int iCDCLength = 0;
						int jCDCLength = 0;
						boolean matchFound;
						if (edIndvCdcServiceAuthUnConfirmed != null) {
							iCDCLength = edIndvCdcServiceAuthUnConfirmed.length;
						}
						if (edIndvCdcServiceAuthConfirmed != null) {
							jCDCLength = edIndvCdcServiceAuthConfirmed.length;
						}
						boolean benefitStatusDetermined = false;
						ArrayList serviceBenefitStatusList = new ArrayList();
						for (int i = 0; i < iCDCLength; i++) {
							matchFound = false;
							for (int j = 0; j < jCDCLength; j++) {
								if (edIndvCdcServiceAuthUnConfirmed[i]
										.getEdgNum() == edIndvCdcServiceAuthConfirmed[j]
										.getEdgNum()
										&&
										//// Added By Kesavan For defect
										// #BRGUS00074227
										DateComparisons
												.dateGTEQDateInTimestamp(
														edIndvCdcServiceAuthUnConfirmed[i]
																.getPayPeriodBegDt(),
														edIndvCdcServiceAuthConfirmed[j]
																.getPayPeriodBegDt())) {

									if ((edIndvCdcServiceAuthConfirmed[j]
											.getPayPeriodEndDt() == null)
											|| (edIndvCdcServiceAuthConfirmed[j]
													.getPayPeriodEndDt() != null
													&& edIndvCdcServiceAuthUnConfirmed[i]
															.getPayPeriodEndDt() != null && DateComparisons
													.dateLTEQDateInTimestamp(
															edIndvCdcServiceAuthUnConfirmed[i]
																	.getPayPeriodEndDt(),
															edIndvCdcServiceAuthConfirmed[j]
																	.getPayPeriodEndDt()))) {

										if (edIndvCdcServiceAuthConfirmed[j]
												.getChildIndvId() == edIndvCdcServiceAuthUnConfirmed[i]
												.getChildIndvId()
												//Begin BRGUS00108837 – kesavanr – Check PspId while comparing auth and unauth records of EdIndvCdcServiceAuth
												&& edIndvCdcServiceAuthConfirmed[j].getPspId() ==
												   edIndvCdcServiceAuthUnConfirmed[i].getPspId()
												&& edIndvCdcServiceAuthConfirmed[j]
														.getNeedBlock() == edIndvCdcServiceAuthUnConfirmed[i]
														.getNeedBlock()
												/* Begin BRGUS00101000 – kesavanr
												 * Check serviceId or need reason in determining
												 * the last auth record.
												 */
												&& ((edIndvCdcServiceAuthConfirmed[j]
														.getNeedRsnCd() != null
												&& edIndvCdcServiceAuthUnConfirmed[i]
														.getNeedRsnCd() != null
												&& edIndvCdcServiceAuthConfirmed[j]
														.getNeedRsnCd()
														.equalsIgnoreCase(
																edIndvCdcServiceAuthUnConfirmed[i]
																		.getNeedRsnCd())) ||
												   edIndvCdcServiceAuthConfirmed[j].getServiceId() == edIndvCdcServiceAuthUnConfirmed[i].getServiceId())) {
											    //End BRGUS00101000
											matchFound = true;
											if (edIndvCdcServiceAuthUnConfirmed[i]
													.getDeptPayPercentage() < edIndvCdcServiceAuthConfirmed[j]
													.getDeptPayPercentage()
													|| edIndvCdcServiceAuthUnConfirmed[i]
															.getAuthHours() < edIndvCdcServiceAuthConfirmed[j]
															.getAuthHours()) {
												//aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
												//benefitStatusDetermined=true;
												//break;
												/*
												 * Defect ID : BRGUS00100127
												 * Added By : kesavanr Date :
												 * 03/05/2008 Change : Setting
												 * services level benefit status
												 *
												 */
												serviceBenefitStatusList
														.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
											}
											/*
											 * else
											 * if(edIndvCdcServiceAuthUnConfirmed[i].getDeptPayPercentage() >
											 * edIndvCdcServiceAuthConfirmed[j].getDeptPayPercentage() &&
											 * edIndvCdcServiceAuthUnConfirmed[i].getAuthHours() >
											 * edIndvCdcServiceAuthConfirmed[j].getAuthHours()) {
											 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
											 * break; }
											 */
											else if (edIndvCdcServiceAuthUnConfirmed[i]
													.getDeptPayPercentage() == edIndvCdcServiceAuthConfirmed[j]
													.getDeptPayPercentage()
													&& edIndvCdcServiceAuthUnConfirmed[i]
															.getAuthHours() == edIndvCdcServiceAuthConfirmed[j]
															.getAuthHours()) {
												//aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
												//benefitStatusDetermined=true;
												//break;
												/*
												 * Defect ID : BRGUS00100127
												 * Added By : kesavanr Date :
												 * 03/05/2008 Change : Setting
												 * services level benefit status
												 *
												 */
												serviceBenefitStatusList
														.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
											} else if (edIndvCdcServiceAuthUnConfirmed[i]
													.getDeptPayPercentage() > edIndvCdcServiceAuthConfirmed[j]
													.getDeptPayPercentage()
													|| edIndvCdcServiceAuthUnConfirmed[i]
															.getAuthHours() > edIndvCdcServiceAuthConfirmed[j]
															.getAuthHours()) {
												//aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
												//benefitStatusDetermined=true;
												//break;
												/*
												 * Defect ID : BRGUS00100127
												 * Added By : kesavanr Date :
												 * 03/05/2008 Change : Setting
												 * services level benefit status
												 *
												 */
												serviceBenefitStatusList
														.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
											}
										}
									}
								}

							}
							/*
							 * if(benefitStatusDetermined) { break; }
							 */
							if (!matchFound) {
								//aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
								//break;
								/*
								 * Defect ID : BRGUS00100127 Added By : kesavanr
								 * Date : 03/05/2008 Change : Setting services
								 * level benefit status
								 *
								 */
								//Begin BRGUS00100127
								if (edIndvCdcServiceAuthUnConfirmed[i]
										.getAuthHours() > 0
										|| edIndvCdcServiceAuthUnConfirmed[i]
												.getDeptPayPercentage() > 0) {
									serviceBenefitStatusList
											.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
								} else {
									serviceBenefitStatusList
											.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
								}
								//End BRGUS00100127
							}
						}
						/*
						 * Defect ID : BRGUS00100127 Added By : kesavanr Date :
						 * 03/05/2008 Change : Determing group benefit status
						 * from services benefit statuses.
						 *
						 */
						//Start
						//Determine group benefit status
						String cdcGroupBenefitStatus = detCdcGroupBenefitStatus(serviceBenefitStatusList);
						aEdEligibilityCargo
								.setBenefitStatus(cdcGroupBenefitStatus);
						//End
					}
				}
			}

			else if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("DS")) {

				if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (sCgStatusCd
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
				} else {
					if (aEgDataHandler.getEligDetailLastAuth() != null
							&& aEgDataHandler.getEligDetailLastAuth()
									.getEdEligibilityCargo() != null
							&& aEgDataHandler.getEligDetailLastAuth()
									.getEdEligibilityCargo().length > 0
							&& (aEgDataHandler.getEligDetailLastAuth()
									.getEdEligibilityCargo()[0].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_APPROVED))) {

						bAuthFound = true;
					}
					if (sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)
							&& !bAuthFound) {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
					} else {
						EdIndvDssServiceAuthCargo[] edIndvDssServiceAuthUnConfirmed = aEgDataHandler
								.getEligDetailUnAuthCurrEDM()
								.getEdIndvDssServiceAuthCargo();
						EdIndvDssServiceAuthCargo[] edIndvDssServiceAuthConfirmed = null;
						if (aEgDataHandler.getEligDetailLastAuth() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdIndvDssServiceAuthCargo() != null) {
							edIndvDssServiceAuthConfirmed = aEgDataHandler
									.getEligDetailLastAuth()
									.getEdIndvDssServiceAuthCargo();
						}
						if (edIndvDssServiceAuthUnConfirmed != null
								&& edIndvDssServiceAuthConfirmed == null) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							return;
						}
						int iDSSLength = 0;
						int jDSSLength = 0;
						if (edIndvDssServiceAuthUnConfirmed != null) {
							iDSSLength = edIndvDssServiceAuthUnConfirmed.length;
						}
						if (edIndvDssServiceAuthConfirmed != null) {
							jDSSLength = edIndvDssServiceAuthConfirmed.length;
						}

						double servicePaymentAmtUnConfirmed = 0;
						double servicePaymentAmtConfirmed = 0;
						for (int i = 0; i < iDSSLength; i++) {
							servicePaymentAmtUnConfirmed = servicePaymentAmtUnConfirmed
									+ edIndvDssServiceAuthUnConfirmed[i]
											.getServicePaymentAmt();
						}
						for (int j = 0; j < jDSSLength; j++) {
							servicePaymentAmtConfirmed = servicePaymentAmtConfirmed
									+ edIndvDssServiceAuthConfirmed[j]
											.getServicePaymentAmt();
						}

						if (servicePaymentAmtUnConfirmed < servicePaymentAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
						} else if (servicePaymentAmtUnConfirmed > servicePaymentAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
						} else if (servicePaymentAmtUnConfirmed == servicePaymentAmtConfirmed) {
							aEdEligibilityCargo
									.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						}
					}
				}
			}

			else if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("SE")) {

				if (aEdEligibilityCargo.getPaymentEndDt() == null
						&& aEdEligibilityCargo.getCgStatusCd()
								.equalsIgnoreCase("TN")) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
					return;
				}
				if (aEdEligibilityCargo.getCgEligRsltCd()
						.equalsIgnoreCase("FL")) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
				} else if (aEdEligibilityCargo.getCgEligRsltCd()
						.equalsIgnoreCase("PS")
						|| aEdEligibilityCargo.getCgEligRsltCd()
								.equalsIgnoreCase("PE")) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
				}
				/*
				 * EdEligSerServiceAuthCargo[] edEligSerServiceAuthCargo =
				 * aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligSerServiceAuth();
				 * int iSERLength = 0; if(edEligSerServiceAuthCargo != null) {
				 * iSERLength = edEligSerServiceAuthCargo.length; } boolean
				 * allServiceDenied = false; for(int i=0; i <iSERLength; i++) {
				 * if(edEligSerServiceAuthCargo[i].getServiceStatusCd() != null &&
				 * edEligSerServiceAuthCargo[i].getServiceStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_DENIED) ||
				 * edEligSerServiceAuthCargo[i].getServiceStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED)) {
				 * allServiceDenied = true; } else
				 * if(edEligSerServiceAuthCargo[i].getServiceStatusCd() != null &&
				 * edEligSerServiceAuthCargo[i].getServiceStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)) {
				 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
				 * allServiceDenied = false; break; } else { allServiceDenied =
				 * false; } } if(allServiceDenied) {
				 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY); }
				 */}

			else if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("IO")
					|| aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("MO")
					|| aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("PS")) {

				if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (sCgStatusCd
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
				} else if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
				}
			}

			// Default value
			//Common logic
			if (aEdEligibilityCargo.getBenefitStatus() == null) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
			}
			//Common logic

		} catch (EDBCException ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw ex;
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detBenefitStatus", ex);
		}

	}

	//	 Modified by Sairama on 11/01/2007 for Defect #BRGUS00078806
	// Added by Sairama on 09/31/2007 For Defect #BRGUS00059767
	/**
	 * Determines the Group MA Coverage Status.
	 *
	 * @param aEdEligibilityCargo
	 *            current EdEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            authorized EdEligibilityCargo
	 * @param aEgDataHandler
	 *            contains EgDataHandler
	 * @return contains the benefit status for the coverage code
	 * @throws EDBCException
	 */
	
	public String setBeneStsForCoverageCd(
			EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityAuthCargo,
			EgDataHandler aEgDataHandler) throws EDBCException {

		char coverageCdConfirmed = IEdEligCodes.CHAR_BLANK_VALUE;
		char coverageCdUnConfirmed = IEdEligCodes.CHAR_BLANK_VALUE;
		long authIndvEdgTraceId = 0;
		long unAuthIndvEdgTraceId = 0;
		String grpCoverageStsCd = null;
		ArrayList indvCoverageCd = new ArrayList();
		String partStatusCdUnAuth = null;
		String partStatusCdAuth = null;
		boolean indvFound = false;
		boolean edCgStsCodeCheckAuth = false;
		boolean edCgStsCodeCheckUnAuth = false;
		int unAuthlength = 0;
		char grpIndAuth = IEdEligCodes.CHAR_BLANK_VALUE;
		char grpIndUnAuth = IEdEligCodes.CHAR_BLANK_VALUE;
		unAuthlength = aEgDataHandler.getEligDetailUnAuthCurrEDM()
				.getEdIndvEligibilityCargo().length;
		int authlength = 0;
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			authlength = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo().length;
		}
		EdIndvEligibilityCargo[] authRecords = null;
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			authRecords = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo();

		}
		EdIndvEligibilityCargo[] unAuthRecords = aEgDataHandler
				.getEligDetailUnAuthCurrEDM().getEdIndvEligibilityCargo();

		try {

			if (unAuthlength < authlength) {
				for (int i = 0; i < authlength; i++) {
					indvFound = false;
					partStatusCdAuth = authRecords[i].getPartStatusCd();
					grpIndAuth = authRecords[i].getGroupInd();
					for (int j = 0; j < unAuthlength; j++) {
						partStatusCdUnAuth = unAuthRecords[j].getPartStatusCd();
						grpIndUnAuth = unAuthRecords[j].getGroupInd();
						if (authRecords[i].getIndvId() == unAuthRecords[j]
								.getIndvId()) {
							indvFound = true;
							authIndvEdgTraceId = authRecords[i].getEdgTraceId();
							unAuthIndvEdgTraceId = unAuthRecords[j]
									.getEdgTraceId();
							/*
							 * ? - In order to check an individual's eligibility ,
							 * we check his group level CgStatusCd. We do this
							 * for both authorized and unauthorized records.
							 */
							edCgStsCodeCheckAuth = getCgStsCd(
									authIndvEdgTraceId, aEdEligibilityAuthCargo);
							edCgStsCodeCheckUnAuth = getCgStsCd(
									unAuthIndvEdgTraceId, aEdEligibilityCargo);
							if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								// ? - If we find a individual match, we will
								// now check for his MaCoverageCd
								coverageCdConfirmed = authRecords[i]
										.getMaCoverageCd();
								coverageCdUnConfirmed = unAuthRecords[j]
										.getMaCoverageCd();
								indvCoverageCd.add(getIndvBenefitStatus(
										coverageCdConfirmed,
										coverageCdUnConfirmed,
										aEdEligibilityCargo));
							} else if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							}

						}

					}

					if (!indvFound) {

						if (edCgStsCodeCheckAuth
								&& ((partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)) {
							indvCoverageCd
									.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
						} else if (edCgStsCodeCheckAuth
								&& !((partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)) {
							indvCoverageCd
									.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						}
					}

				}
			} else {
				for (int i = 0; i < unAuthlength; i++) {
					indvFound = false;
					partStatusCdUnAuth = unAuthRecords[i].getPartStatusCd();
					grpIndUnAuth = unAuthRecords[i].getGroupInd();
					for (int j = 0; j < authlength; j++) {

						partStatusCdAuth = authRecords[j].getPartStatusCd();
						grpIndAuth = authRecords[j].getGroupInd();
						if (unAuthRecords[i].getIndvId() == authRecords[j]
								.getIndvId()) {
							indvFound = true;
							authIndvEdgTraceId = authRecords[j].getEdgTraceId();
							unAuthIndvEdgTraceId = unAuthRecords[i]
									.getEdgTraceId();
							edCgStsCodeCheckAuth = getCgStsCd(
									authIndvEdgTraceId, aEdEligibilityAuthCargo);
							edCgStsCodeCheckUnAuth = getCgStsCd(
									unAuthIndvEdgTraceId, aEdEligibilityCargo);
							if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								// ? - If we find a individual match, we will
								// now check for his MaCoverageCd
								coverageCdConfirmed = authRecords[j]
										.getMaCoverageCd();
								coverageCdUnConfirmed = unAuthRecords[i]
										.getMaCoverageCd();
								indvCoverageCd.add(getIndvBenefitStatus(
										coverageCdConfirmed,
										coverageCdUnConfirmed,
										aEdEligibilityCargo));
							} else if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvCoverageCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							}
						}

					}
					if (!indvFound) {
						if (edCgStsCodeCheckUnAuth
								&& ((partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)) {
							indvCoverageCd
									.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
						} else if (edCgStsCodeCheckUnAuth
								&& !((partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)) {
							indvCoverageCd
									.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						}
					}

				}

			}
			/*
			 * ? We take all the benefit status into an ArrayList and follow the
			 * below conditions. If any one is decrease, the group level benefit
			 * status is decrease. If any one is increase, the group level
			 * benefit status id increase. If all are sustain, the group level
			 * benefit status is sustain.
			 */
			boolean indvCoverageCdFlag = false;
			String[] indvCoverageCdArr;
			indvCoverageCdArr = (String[]) indvCoverageCd
					.toArray(new String[indvCoverageCd.size()]);
			if (grpCoverageStsCd == null) {
				for (int i = 0; i < indvCoverageCdArr.length; i++) {
					//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_DECREASE) {  // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
					  if (IEdEligCodes.BENEFIT_STATUS_DECREASE.equalsIgnoreCase(indvCoverageCdArr[i])) { 
						grpCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
						indvCoverageCdFlag = true;
						break;
					}
				}
				if (indvCoverageCdFlag == false) {
					for (int i = 0; i < indvCoverageCdArr.length; i++) {
						//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_INCREASE) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
						  if (IEdEligCodes.BENEFIT_STATUS_INCREASE.equalsIgnoreCase(indvCoverageCdArr[i])) {
							grpCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
							indvCoverageCdFlag = true;
							break;
						}
					}
				}
				if (indvCoverageCdFlag == false) {
					boolean isSustain = false;
					for (int i = 0; i < indvCoverageCdArr.length; i++) {
						//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_SUSTAIN) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
						  if (IEdEligCodes.BENEFIT_STATUS_SUSTAIN.equalsIgnoreCase(indvCoverageCdArr[i])) {
							isSustain = true;
						} else {
							isSustain = false;
							break;
						}
					}
					if (isSustain) {
						grpCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					}
				}
			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"setBeneStsforCoverageCd", ex);
		}
		return grpCoverageStsCd;
	}

	/*
	 * public void detBenefitStatus(EdEligibilityCargo aEdEligibilityCargo,
	 * EdEligibilityCargo[] aEdEligibilityCargoConfirmed, EgDataHandler
	 * aEgDataHandler) throws EDBCException{ String sCgStatusCd = null; String
	 * sActivityType = null;
	 *
	 * try { sCgStatusCd = aEdEligibilityCargo.getCgStatusCd(); sActivityType =
	 * aEdEligibilityCargo.getActivityType(); if (sCgStatusCd == null) {
	 * sCgStatusCd = ""; } if (sActivityType == null) { sActivityType = ""; }
	 * //Sai (10/7/2004): Following two if conditions modified for CCB: 188770 -
	 * for all CoPay TP's in ME and CC , //we set Benefit Status Increase or
	 * Decrease, based on CoPay amount decrease or Increase //if
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME) &&
	 * (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_69) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_86))) {
	 * //if
	 * (IEdEligCodes.COPAY_TP_CODES.toString().indexOf(aEdEligibilityCargo.getTypeOfAssistanceCd()) !=
	 * -1) { if
	 * (((aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME))||
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CC))) &&
	 * (getMeCcCoPayTpCodes().containsKey(aEdEligibilityCargo.getTypeOfAssistanceCd()))){
	 * if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED) ||
	 * (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY); }
	 * else { int iLength = 0; if (aEdEligibilityCargoConfirmed != null) {
	 * iLength = aEdEligibilityCargoConfirmed.length; } for (int i = 0; i <
	 * iLength; i++) { // Modified If condition to check for CgStatusCd -
	 * Approvd for Defect # :00214820 , Dt: 2/21/2005 if
	 * ((aEdEligibilityCargoConfirmed[i].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)) &&
	 * aEdEligibilityCargoConfirmed[i].getEdgNum() ==
	 * aEdEligibilityCargo.getEdgNum()) { if
	 * ((aEdEligibilityCargoConfirmed[i].getRecBeginDt().before(aEdEligibilityCargo.getPaymentBegDt()) ||
	 * aEdEligibilityCargoConfirmed[i].getRecBeginDt().equals(aEdEligibilityCargo.getPaymentBegDt())) &&
	 * (((aEdEligibilityCargoConfirmed[i].getRecEndDt() == null) ||
	 * (aEdEligibilityCargoConfirmed[i].getRecEndDt().after(aEdEligibilityCargo.getPaymentBegDt()) ||
	 * aEdEligibilityCargoConfirmed[i].getRecEndDt().equals(aEdEligibilityCargo.getPaymentBegDt()))))) {
	 * if (aEdEligibilityCargo.getCopayAmt() >
	 * aEdEligibilityCargoConfirmed[i].getCopayAmt()) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE); }
	 * else if (aEdEligibilityCargo.getCopayAmt() <
	 * aEdEligibilityCargoConfirmed[i].getCopayAmt()) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE); }
	 * //Sustain condition added for Defect #00205023 else if
	 * (aEdEligibilityCargo.getCopayAmt() ==
	 * aEdEligibilityCargoConfirmed[i].getCopayAmt()) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN); } } }
	 * }// end of for } } else { String[] sOPSEeedTpCodes =
	 * IEdEligCodes.OPS_EEED_TP_CODES; HashMap hmTemp = new HashMap(); int
	 * iStringLength = sOPSEeedTpCodes.length; for (int i = 0; i <
	 * iStringLength; i++) { hmTemp.put(sOPSEeedTpCodes[i], sOPSEeedTpCodes[i]); }
	 * if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_DENIED) ||
	 * (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
	 * //Commented 07/30/03 } else if
	 * (/*sCgStatusCd.equals(IEdEligCodes.STATUS_CD_APPROVED) &&
	 * /sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) { //Added
	 * condition to certify if PR and program is FS for Prod Benefit Status to
	 * Reprocess change using code change 113645 //Modifed for CMA Changes
	 * //Added the or condition for EligBegDt Set For Cert conditon for defect
	 * 183363 to identify if it is not intake and it is certified again. /* }
	 * else if ((sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE) ||
	 * aEgDataHandler.getEdIndvInfo().getIsEligBegDtSetForCert() == true) ||
	 * (sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW) &&
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_43) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_44) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_47) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_48) ||
	 * hmTemp.containsKey(aEdEligibilityCargo.getTypeOfAssistanceCd())))) {
	 * //Added if condition for defect 195388 if
	 * (sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
	 * detBenefitStatusFromLastAuth(aEgDataHandler); } if
	 * (aEdEligibilityCargo.getBenefitStatus() == null ||
	 * aEdEligibilityCargo.getBenefitStatus().equals("")) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY); }
	 * //Added condition to certify if eligibilitybegdt null and tp56,tp32 -
	 * Defect 152797 } else if (aEdEligibilityCargo.getEligibilityBegDt() ==
	 * null &&
	 * (aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_56) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_32))) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY); }
	 * else if ((!sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))) {
	 * double dBenefitAmtUnConfirmed = 0; dBenefitAmtUnConfirmed =
	 * aEdEligibilityCargo.getBenefitAmt(); int iLength = 0; if
	 * (aEdEligibilityCargoConfirmed != null) { iLength =
	 * aEdEligibilityCargoConfirmed.length; } //Added for defect 195388
	 * Timestamp tsMthEndEffBegDt =
	 * DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getRecBeginDt());
	 * boolean bEDMLastAuthFound = false ; for (int i = 0; i < iLength; i++) {
	 * if (aEdEligibilityCargoConfirmed[i].getEdgNum() ==
	 * aEdEligibilityCargo.getEdgNum()) { //Modified for defect 195388 if
	 * ((aEdEligibilityCargoConfirmed[i].getRecBeginDt().before(tsMthEndEffBegDt) ||
	 * aEdEligibilityCargoConfirmed[i].getRecBeginDt().equals(tsMthEndEffBegDt)) &&
	 * (((aEdEligibilityCargoConfirmed[i].getRecEndDt() == null) ||
	 * (aEdEligibilityCargoConfirmed[i].getRecEndDt().after(aEdEligibilityCargo.getRecBeginDt()) ||
	 * aEdEligibilityCargoConfirmed[i].getRecEndDt().equals(aEdEligibilityCargo.getRecBeginDt()))))) {
	 * if (dBenefitAmtUnConfirmed <
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
	 * if(!((aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_56)||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2PM) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2SM) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2UM)||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2CM))
	 * ||(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_32)))){
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE); }
	 * else {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE); } }
	 * else if (dBenefitAmtUnConfirmed ==
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) { if
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CC) ||
	 * aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_MC)) {
	 * if
	 * (aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED) &&
	 * !aEdEligibilityCargo.getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY); }
	 * else {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN); } }
	 * else {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN); } }
	 * else if (dBenefitAmtUnConfirmed >
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
	 * if(!((aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_56) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2PM) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2SM) ||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2UM)||
	 * aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.G2CM))
	 * ||(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_32)))){
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE); }
	 * else {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE); } }
	 * bEDMLastAuthFound = true; break; } } } /* CCB# 00158424
	 */
	/*
	 * if
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)){
	 * if (bEDMLastAuthFound == false) { Timestamp tsPayBegDt =
	 * DateComparisons.getDate(IEdEligCodes.LOW_DATE);
	 *
	 * for (int i = 0; i < iLength; i++) { if
	 * (aEdEligibilityCargoConfirmed[i].getEdgNum() ==
	 * aEdEligibilityCargo.getEdgNum()) { if
	 * ((aEdEligibilityCargo.getRequestDt().equals(aEdEligibilityCargoConfirmed[i].getRequestDt()))) {
	 * if (aEdEligibilityCargoConfirmed[i].getPaymentBegDt().after(tsPayBegDt)) {
	 * if (dBenefitAmtUnConfirmed >
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) { //Defect Tiers00201416
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE); }
	 * else if (dBenefitAmtUnConfirmed <
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) { //Defect Tiers00201416
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE); }
	 * else if (dBenefitAmtUnConfirmed ==
	 * aEdEligibilityCargoConfirmed[i].getBenefitAmt()) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN); } } } } }
	 *  } } /* The above logic is being tried for FS alone, if it works fine, it
	 * will would be applied for all programs
	 */
	/*
	 * } /*else if (sCgStatusCd.equals(IEdEligCodes.STATUS_CD_PENDING)) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_PENDING); }
	 */
	/*
	 * }// end of else // Default value /* if
	 * (aEdEligibilityCargo.getBenefitStatus() == null) {
	 * aEdEligibilityCargo.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY); }
	 *
	 * }catch (EDBCException ex) {
	 * EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,ex);
	 * throw ex ; } catch (Exception ex) {
	 * EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,ex);
	 * throw new EDBCException(EDBCException.MAJOR ,"EdUtil",
	 * "detBenefitStatus", ex); } }
	 */
	/**
	 * Determines the CgEligRsltCd for the current EdEligiblityCargo.
	 * 
	 * @param aEdEligibilityCargo
	 *            contains the current EdEligibilityCargo being processed
	 * @param aEdIndvEligibilityCargo
	 *            contains the EdIndvEligibility records of the curretnt cargo.
	 * @param aDcCaseProgramCargo
	 *            contains the DcCaseProgram record of the current eligibility
	 *            cargo
	 * @param aPrevEdEligibilityCargo
	 *            contains the previous month EdEligibilityCargo
	 * @param aPrevPrevEdEligibilityCargo
	 *            contains EdEligibilityCargo 2 months prior to the current
	 *            record
	 * @param aEdEligNoticeReasonsCargo
	 *            contains the EdEligNoticeReasonsCargo of the current record
	 * @param aEgDataHandler
	 *            contains the EgDataHandler for the current record
	 * @param aArrEligDetailAllProc
	 *            contains the array of EligDetail structure
	 * @throws EDBCException
	 */
	
	public void detCgEligRsltCd(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			DcCaseProgramCargo aDcCaseProgramCargo,
			EdEligibilityCargo aPrevEdEligibilityCargo,
			EdEligibilityCargo aPrevPrevEdEligibilityCargo,
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo,
			EgDataHandler aEgDataHandler, EligDetail[] aArrEligDetailAllProc)
			throws EDBCException {
		String sNFEligRsltCd = "";
		String sRscEligRsltCd = "";
		String sFinEligRsltCd = "";
		String stfsEligRsltCd = "";

		try {
			/*
			 * Defect ID : BRGUS00097768 Added By : kesavanr Date : 02/15/2007
			 * Change : Set nfeligrsltcd to 'FL' if cgsize is '0' for DSS
			 * Program
			 *
			 */
			if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
					IEdEligCodes.PROGRAM_CD_DS)) {
				if (aEdEligibilityCargo.getCgSize() == 0) {
					aEdEligibilityCargo
							.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
				} else {
					aEdEligibilityCargo
							.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
				}
				for (int i = 0; i < aEdIndvEligibilityCargo.length; i++) {
					if (aEdEligibilityCargo.getEdgTraceId() == aEdIndvEligibilityCargo[i]
							.getEdgTraceId()) {
						if (aEdEligibilityCargo.getCgSize() == 0) {
							aEdIndvEligibilityCargo[i]
									.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						} else {
							aEdIndvEligibilityCargo[i]
									.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						}

					}
				}
			}

			sNFEligRsltCd = aEdEligibilityCargo.getNfEligRsltCd();
			sRscEligRsltCd = aEdEligibilityCargo.getRscEligRsltCd();
			sFinEligRsltCd = aEdEligibilityCargo.getFinEligRsltCd();
			stfsEligRsltCd = aEdEligibilityCargo.getStfsEligRsltCd();

			if (sNFEligRsltCd == null) {
				aEdEligibilityCargo
						.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_NA);
			}
			if (sRscEligRsltCd == null) {
				aEdEligibilityCargo
						.setRscEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_NA);
			}
			if (sFinEligRsltCd == null) {
				aEdEligibilityCargo
						.setFinEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_NA);
			}
			if (stfsEligRsltCd == null) {
				aEdEligibilityCargo
						.setStfsEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_NA);
			}

			
			// chalasanic ASPEN00034559
			// Modified this logic to fail EDG Status when verification status
			// fails, regardless of nonfin,fin and Rsc status
			if ((aEdEligibilityCargo.getVerificationStatusCd() != null && aEdEligibilityCargo
					.getVerificationStatusCd().equals(
							IEdEligCodes.VERIFICATION_STATUS_CD_FAIL))) {
				aEdEligibilityCargo
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			}

			// chalasanic ASPEN00034363
			// Modified this logic to Pend EDG Status when nonfin/ fin/ Rsc
			// fails and verification status is pending
			else if ((((sNFEligRsltCd != null) && (sNFEligRsltCd
					.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)))
					|| ((sRscEligRsltCd != null) && (sRscEligRsltCd
							.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) || ((sFinEligRsltCd != null) && (sFinEligRsltCd
					.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))))
					&& ((aEdEligibilityCargo.getVerificationStatusCd() != null && aEdEligibilityCargo
							.getVerificationStatusCd().equals(
									IEdEligCodes.VERIFICATION_STATUS_CD_FAIL))
							|| (aEdEligibilityCargo.getVerificationStatusCd() != null && aEdEligibilityCargo
									.getVerificationStatusCd()
									.equals(IEdEligCodes.VERIFICATION_STATUS_CD_PASS)) || (aEdEligibilityCargo
							.getVerificationStatusCd() != null && aEdEligibilityCargo
							.getVerificationStatusCd().equals(
									IEdEligCodes.VERIFICATION_STATUS_CD_NA)))) {
				aEdEligibilityCargo
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			} else {
				
				//added for VCL
				/*BRGUS00219808 - CR-23266 Pend for trust. Added rsc pending check*/	
				if ((aEdEligibilityCargo.getVerificationStatusCd() != null && aEdEligibilityCargo
						.getVerificationStatusCd().equals(
								IEdEligCodes.VERIFICATION_STATUS_CD_PENDING))
						|| (stfsEligRsltCd != null && stfsEligRsltCd
								.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))
						|| (sNFEligRsltCd != null && sNFEligRsltCd
								.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))
						|| (sRscEligRsltCd != null && sRscEligRsltCd
								.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
					aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
					/* Begin BRGUS00109633 – kesavanr
					 * Set pending verification attribute to 'Y' if verification is pending.
					 */
					if(aEdEligibilityCargo.getVerificationStatusCd() != null && aEdEligibilityCargo
						.getVerificationStatusCd().equals(
								IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {
						aEdEligibilityCargo.setPendingVerificationSw('Y');
					}
					//End BRGUS00109633
				} else {
					if (((sNFEligRsltCd != null) && (sNFEligRsltCd
							.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)))
							|| ((sRscEligRsltCd != null) && (sRscEligRsltCd
									.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)))
							|| ((sFinEligRsltCd != null) && (sFinEligRsltCd
									.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)))) {
						aEdEligibilityCargo
								.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
					}
				}
			}

			boolean bFound = false;
			String vcltypeCd = null;
//BRGUS00238526 rampurkara enter this block if FS is DN due to vcl  			
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_PENDING) 
					|| (aEdEligibilityCargo.getVerificationStatusCd() != null 
							&& aEdEligibilityCargo.getVerificationStatusCd().equalsIgnoreCase(
									IEdEligCodes.ELIG_RSLT_CD_FAIL)
							&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
									IEdEligCodes.PROGRAM_CD_FS))) {
				if (aEgDataHandler.getAlEdVerificationChecklistModApp() != null) {
					//Retrival of Interviewr Indv Id added for Defect # 221370
					DcIntervieweeCargo dcInterviewee = aEgDataHandler
							.getDcIntervieweeCargo();
					long lIntervieweeIndvId = 0;
					if (dcInterviewee != null) {
						lIntervieweeIndvId = dcInterviewee.getIndvId();
					}

					Iterator itTemp = aEgDataHandler
							.getAlEdVerificationChecklistModApp().iterator();
					EdVerificationChecklistCargo cargo = null;
					while (itTemp.hasNext()) {
						cargo = (EdVerificationChecklistCargo) itTemp.next();
						if (cargo.getVoidSw() != IEdEligCodes.VOID_SW_YES
								&& cargo.getValidSourceRcvDt() == null) {
							// Defect 129696 if caseprofile is pending then set
							// it to true;
							if (aEdEligibilityCargo.getEdgNum() == cargo
									.getEdgNum()) {
								vcltypeCd = cargo.getVclTypeCd();
// Only deleteBySupervisor = P records to be considered								
								if ((cargo.getVclTypeCd().equals(
										IEdEligCodes.VCL_ID_CD)
										|| cargo.getVclTypeCd().equals(
												IEdEligCodes.VCL_ID_CD_V109)
										|| cargo.getVclTypeCd().equals(
												IEdEligCodes.VCL_ID_CD_V127)
										|| cargo.getVclTypeCd().equals(
												IEdEligCodes.VCL_ID_CD_V128)
										|| (cargo.getVclDetailRef()
												.startsWith(IEdEligCodes.CASE_PROFILE))
												||(cargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_40) &&  //BRGUS00207154 GANTAC 11/3/2009
														cargo.getVclTypeCd().equalsIgnoreCase("V003")))
														&& cargo.getDeleteBySupervisorInd() == 'P'){
									bFound = true;
									break;
								} else if (cargo.getVclTypeCd().equals(
										IEdEligCodes.VCL_ID_CD_V006)
										&& (lIntervieweeIndvId == cargo
												.getIndvId())) {
									//This else if condition is added for
									// defect # 221370
									bFound = true;
									break;
								}
							}
						}
					}
					/* BRGUS00158517 - EXPEDITED Fap should pened due to educational requirement.  
					 * This is not a vcl pend. This is Other Pending reason by NF*/
					if(aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS)
							&& aEdEligibilityCargo.getFsExpeditedSw() != IEdEligCodes.CHAR_INIT_SPACE
								&& aEdEligibilityCargo.getFsExpeditedSw() == IEdEligCodes.FS_EXPEDITED_SW_YES
									&& "PE".equalsIgnoreCase(aEdEligibilityCargo.getNfEligRsltCd()) ){
						bFound = true;
					}
				}
				if (bFound == false) {
					//Modified for defect 81855
					if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FS)) {
						/**
						 * Begin BrgId:BRGUS00145633
						 * UserId: GANTAC
						 * Date: 04/08/2009
						 * Comenting requested month check with pay period begin date month
						 */
						if ((aEdEligibilityCargo.getFsExpeditedSw() == IEdEligCodes.FS_EXPEDITED_SW_YES /*&& (DateComparisons
								.getMM(aEdEligibilityCargo.getPaymentBegDt()) == DateComparisons
								.getMM(aDcCaseProgramCargo.getRequestDt()))*/)//End BRGUS00145633
								|| (aEdEligibilityCargo.getCombinedPaymentSw() == IEdEligCodes.YES)) {
							//if ((aEdEligibilityCargo.getFsExpeditedSw() ==
							// IEdEligCodes.FS_EXPEDITED_SW_YES &&
							// (DateComparisons.getMM(aEdEligibilityCargo.getPaymentBegDt())
							// ==
							// DateComparisons.getMM(aDcCaseProgramCargo.getRequestDt()))))
							// {
							aEdEligibilityCargo
									.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
// when changing the cgEligRsltCd also change the verificationStatusCd							
							if(aEdEligibilityCargo.getVerificationStatusCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))
							{
								aEdEligibilityCargo.setVerificationStatusCd((IEdEligCodes.ELIG_RSLT_CD_PASS));	
							}
						} else {
							if(aEdEligibilityCargo.getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))
							{
								aEdEligibilityCargo
								.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);	
							}
// end BRGUS00238526
						}
					} else {
						//Modified for CCB 74999
						//BRGUS00117839- Bhuvane - Adding TP45 - new born not to pend for verification
						
						// ASPEN00036288- parma starts - added to pend the low income Prgnancy ver
						/*if ((aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_40))||(aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_45))) {
							if (aEdEligibilityCargo.getPriorMedicalCd().equals(
									IEdEligCodes.PRIOR_MED_CD_0)) {
								aEdEligibilityCargo
										.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
							}
						}*/
						if ((aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_45))) {
					if (aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_0)) {
						aEdEligibilityCargo
								.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
					}
				}
				// ASPEN00036288 - parma ends - added to pend the low income Prgnancy ver
						
						//Modified for BRGUS00101210
						//<BRGUS00265174><kucherlapatis><04/14/2011>
						//<Java Fix To Not Reset CgEligRsltCd When NFEligRsltCd Is 'PE'>
						if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_01)) {
							boolean childTP01 = false;
							if (aEdIndvEligibilityCargo != null
									&& aEdIndvEligibilityCargo.length > 0) {
								for (int k = 0; k < aEdIndvEligibilityCargo.length; k++) {
									if (aEdIndvEligibilityCargo[k]
											.getPartStatusCd().equals("EC")) {
										childTP01 = true;
										break;
									}
								}
							}
							if (!(aEdEligibilityCargo.getNfEligRsltCd()
									.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PENDING))
									&& childTP01
									&& (vcltypeCd != null && vcltypeCd
											.equals("V016"))) {
								// chalasanic - ASPEN00037110
								// Modified this to pend for pregnancy verification
								/*aEdEligibilityCargo
										.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);*/
							}
						}
					}
				}
			}

			//Modified for defect 99144,99147
			//Modified for defect 125632
			//Condition modified for Defect : 223108 on 5/25/2005
			//if
			// (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)
			// ||
			// aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)
			// ||
			// aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF))
			// {
			if (!(aEdEligibilityCargo.getPriorMedicalCd().equals(
					IEdEligCodes.PRIOR_MED_CD_1)
					|| aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_2) || aEdEligibilityCargo
					.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_3))) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					if (aEdEligibilityCargo.getEligibilityBegDt() == null) {
						if (aEdEligibilityCargo.getProgramCd().equals(
								IEdEligCodes.PROGRAM_CD_FS)) {
							if (detValidityForProgMth(aArrEligDetailAllProc,
									aEdEligibilityCargo) == false) {
								aEdEligibilityCargo
										.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
								String sFailureReasonCode = null;
								sFailureReasonCode = aEdEligNoticeReasonsCargo
										.getFailureReasonCode();
								if (sFailureReasonCode == null) {
									sFailureReasonCode = "";
								}
								aEdEligNoticeReasonsCargo
										.setFailureReasonCode(sFailureReasonCode
												+ IEdEligCodes.FAILURE_REASON_CODE_EL5079);
								detBenefitAmt(aEdEligibilityCargo);
							}
						} else if (aEdEligibilityCargo.getProgramCd().equals(
								IEdEligCodes.PROGRAM_CD_FMA)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_TANF)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_ME)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_MC)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_CC)) {
							//This else if is aaded for the change required for
							// the defect # 223108 on 5/25/2005
							if (DateComparisons.getMM(aEdEligibilityCargo
									.getPaymentBegDt()) == DateComparisons
									.getMM(DateComparisons.addMonths(
											aEdEligibilityCargo.getEdbcRunDt(),
											2))) {
								int iLength = aArrEligDetailAllProc.length;
								boolean bPrevPass = false;
								for (int j = 0; j < iLength; j++) {
									if (aArrEligDetailAllProc[j] != null) {
										if (aArrEligDetailAllProc[j]
												.getEdEligibilityCargo()[0]
												.getEdgNum() == aEdEligibilityCargo
												.getEdgNum()) {
											if (IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(aArrEligDetailAllProc[j]
													.getEdEligibilityCargo()[0]
													.getCgEligRsltCd())) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
												bPrevPass = true;
												break;
											}
										}
									}
								}// End of for

								if (bPrevPass != true) {
									aEdEligibilityCargo
											.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
									String sFailureReasonCode = null;
									sFailureReasonCode = aEdEligNoticeReasonsCargo
											.getFailureReasonCode();
									if (sFailureReasonCode == null) {
										sFailureReasonCode = "";
									}
									aEdEligNoticeReasonsCargo
											.setFailureReasonCode(sFailureReasonCode
													+ IEdEligCodes.FAILURE_REASON_CODE_EL5204);
									detBenefitAmt(aEdEligibilityCargo);
								}
							}
						}
					} else {
						//Modified for defect 175630, added the or condition
						//Added the lastauth check for defect 188660
						if (aEdEligibilityCargo.getProgramCd().equals(
								IEdEligCodes.PROGRAM_CD_FS)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_FMA)
								|| aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_TANF)) {
							if (aEgDataHandler.getEligDetailLastAuth() == null
									|| aEgDataHandler.getEligDetailLastAuth()
											.getEdEligibilityCargo().length == 0) {
								if (aPrevEdEligibilityCargo != null
										&& aPrevEdEligibilityCargo
												.getCgStatusCd() != null
										&& aPrevEdEligibilityCargo
												.getCgStatusCd()
												.equals(
														IEdEligCodes.STATUS_CD_TERMINATED)) {
									aEdEligibilityCargo
											.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
									String sFailureReasonCode = null;
									sFailureReasonCode = aEdEligNoticeReasonsCargo
											.getFailureReasonCode();
									if (sFailureReasonCode == null) {
										sFailureReasonCode = "";
									}
									aEdEligNoticeReasonsCargo
											.setFailureReasonCode(sFailureReasonCode
													+ IEdEligCodes.FAILURE_REASON_CODE_EL5079);
									detBenefitAmt(aEdEligibilityCargo);
									//					aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
								}
							}
						}//End of FS Check
					}
				}
			}
			//}
			//modified for defect 136187
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if ((aEdEligibilityCargo.getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_FS))
						|| (aEdEligibilityCargo.getProgramCd()
								.equals(IEdEligCodes.PROGRAM_CD_TANF))) {
					detBenefitAmt(aEdEligibilityCargo);
				}
			}

			// Added for defect 232995
			/*
			 * if
			 * (aEdEligibilityCargo.getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
			 * if
			 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
			 * //Column Forfeit Deleted //if
			 * (aEdEligibilityCargo.getForfeitMthDt() != null) {
			 * //aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
			 * //} } }
			 */
			//Setting CgEligRsltCd based on results from EdIndvCdcServiceAuth
			//Defect BRGUS00025606 - Start
			int iLength = aArrEligDetailAllProc.length;
			boolean bPrevFSPass = false;
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)) {
				for (int j = 0; j < iLength; j++) {
					if (aArrEligDetailAllProc[j] != null
							&& aPrevEdEligibilityCargo.getEdgNum() != 0) {
						if ((aArrEligDetailAllProc[j].getEdEligibilityCargo()[0]
								.getEdgNum() == aEdEligibilityCargo.getEdgNum())
								&& (aArrEligDetailAllProc[j]
										.getEdEligibilityCargo()[0]
										.getFsExpeditedSw() == IEdEligCodes.YES)) {
							if (((aEdEligibilityCargo.getNfEligRsltCd()
									.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)
									&& ((aEdEligibilityCargo.getRscEligRsltCd()
											.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)
									&& ((aEdEligibilityCargo.getFinEligRsltCd()
											.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)) {
								//modified for BRGUS00048581
								if ((aArrEligDetailAllProc[j]
										.getEdEligibilityCargo()[0]
										.getVerificationStatusCd() != null && aArrEligDetailAllProc[j]
										.getEdEligibilityCargo()[0]
										.getVerificationStatusCd()
										.equals(
												IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
									aEdEligibilityCargo
											.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
									aEdEligibilityCargo
											.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
								}
							}

						}// EDG Number Check was required BRGUS00060251
						else if (aArrEligDetailAllProc[j]
								.getEdEligibilityCargo()[0].getEdgNum() == aEdEligibilityCargo
								.getEdgNum()
								&& ((aEdEligibilityCargo.getNfEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)
								&& ((aEdEligibilityCargo.getRscEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)
								&& ((aEdEligibilityCargo.getFinEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) == false)
								//modified for BRGUS00048581
								&& (aArrEligDetailAllProc[j]
										.getEdEligibilityCargo()[0]
										.getVerificationStatusCd() != null && aArrEligDetailAllProc[j]
										.getEdEligibilityCargo()[0]
										.getVerificationStatusCd()
										.equals(
												IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
							aEdEligibilityCargo
									.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
							aEdEligibilityCargo
									.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);

						}
					}
				}
			}
			/* Begin BRGUS00104599 – kesavanr
			 * Carry forward previous month verification status cd if failed to the current month and
			 * set current month group eligibiity result to fail.
			 */
			 /**
			  * Begin BrgId:BRGUS00155807
			  * UserId: GANTAC
			  * Date: 04/15/2009
			  * Checking the Cat Elig Sw for MA and setting the Verification status code to PS
			  */
			 //BEGIN-BRGUS00194799-upadhyayulag-If previous month VCL is failed & is carried forward to
			 //current month, notice reason for current month should be set
			 boolean setNoticeReasonForVrfFailureCarryForward = false;
			 if(aPrevEdEligibilityCargo != null && aPrevEdEligibilityCargo.getEdgNum() != 0) {
				if(aPrevEdEligibilityCargo.getVerificationStatusCd() != null &&
						aPrevEdEligibilityCargo.getVerificationStatusCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if(aEdEligibilityCargo.getProgramCd() != null && aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("MA")
							&& aEdEligibilityCargo.getCatEligSw() == 'Y' && aEdEligibilityCargo.getCgSize() > 0){
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
					}else{
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						setNoticeReasonForVrfFailureCarryForward = true;
					}
			    }
			}else if(aPrevEdEligibilityCargo != null && aPrevEdEligibilityCargo.getEdgNum() == 0){
				EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
						aEgDataHandler.getEdEligibilityCargoVrecords(),aEdEligibilityCargo);
				if(edEligibilityCargoV != null && edEligibilityCargoV.getVerificationStatusCd() != null &&
				   edEligibilityCargoV.getVerificationStatusCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if(aEdEligibilityCargo.getProgramCd() != null && aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("MA")
							&& aEdEligibilityCargo.getCatEligSw() == 'Y' && aEdEligibilityCargo.getCgSize() > 0){
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
					}else{
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						setNoticeReasonForVrfFailureCarryForward = true;
					}
				}
			}
			if(setNoticeReasonForVrfFailureCarryForward){
				String sFailureReasonCode = null;
				sFailureReasonCode = aEdEligNoticeReasonsCargo
						.getFailureReasonCode();
				if (sFailureReasonCode == null) {
					sFailureReasonCode = "";
					aEdEligNoticeReasonsCargo.setFailureReasonCode(sFailureReasonCode + "DI4003");
				}else{
					if (aEdEligNoticeReasonsCargo.getFailureReasonCode().indexOf("DI4003") == -1) {
						sFailureReasonCode = sFailureReasonCode.concat("DI4003");
						aEdEligNoticeReasonsCargo.setFailureReasonCode(sFailureReasonCode);
					}
				}
			}
			//END-BRGUS00194799
			//End BRGUS00104599
			//End

		} catch (EDBCException ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw ex;
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detCgEligRsltCd", ex);
		}
	}

	/**
	 * Determines the CgStatusCd.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public void detCgStatusCd(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo,
			EgDataHandler aEgDataHandler) throws EDBCException {
		String sEligRsltCd = null;
		String sActivityType = null;
		try {
			sEligRsltCd = aEdEligibilityCargo.getCgEligRsltCd();
			sActivityType = aEdEligibilityCargo.getActivityType();
			if (sEligRsltCd == null) {
				sEligRsltCd = "";
			}
			if (sActivityType == null) {
				sActivityType = "";
			}
			if (sEligRsltCd.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if ((sActivityType.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))
						|| (aEdEligibilityCargo.getEligibilityBegDt() == null)
						//				 || (aEgDataHandler.getEligDetailLastAuth() == null)
						//				 ||
						// (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED)
						|| (aEdEligibilityCargo.getPriorMedicalCd().equals(
								IEdEligCodes.PRIOR_MED_CD_1)
								|| aEdEligibilityCargo.getPriorMedicalCd()
										.equals(IEdEligCodes.PRIOR_MED_CD_2) || aEdEligibilityCargo
								.getPriorMedicalCd().equals(
										IEdEligCodes.PRIOR_MED_CD_3))) {
					// beniwala - ASPEN00015918 - fix findbugs issue
					if(aEdEligibilityCargoPrevMth != null) {
						if (aEdEligibilityCargoPrevMth.getCgStatusCd() == null) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
						} else if ((aEdEligibilityCargoPrevMth.getCgStatusCd())
								.equals(IEdEligCodes.STATUS_CD_DENIED)) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
						} else if ((aEdEligibilityCargoPrevMth.getCgStatusCd())
								.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						} else if ((aEdEligibilityCargoPrevMth.getCgStatusCd())
								.equals(IEdEligCodes.STATUS_CD_TERMINATED)) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						}
					}
					

					//					Seting cgstatus cd to terminated for SER record if it is
					// a open end date record
					if (aEdEligibilityCargo.getPaymentEndDt() == null
							&& aEdEligibilityCargo.getProgramCd()
									.equalsIgnoreCase("SE")) {
						if (aEdEligibilityCargoPrevMth != null
								&& aEdEligibilityCargoPrevMth.getCgStatusCd() != null
								&& aEdEligibilityCargoPrevMth.getCgStatusCd()
										.equalsIgnoreCase("PE")) {
							aEdEligibilityCargo.setCgStatusCd("PE");
						}/**
						   * Begin BrgId: BRGUS00114318
						   * UserId: Gantac
						   * Date : 06/30/2008
						   * If the SER previous month record cg status code is denied we are setting to 'SER' openended record
						   * for that same request also be denied.	Same thing we are doing for DSS also.
						   */
						 else 	if (aEdEligibilityCargoPrevMth != null

								&& aEdEligibilityCargoPrevMth.getCgStatusCd() != null
								&& aEdEligibilityCargoPrevMth.getCgStatusCd()
										.equalsIgnoreCase("DN")) {
							aEdEligibilityCargo.setCgStatusCd("DN");
						} else{
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						}
					}
				} else {
					//Defect No: 114366, 114368, 114724, 114739, 114151,
					// 114565, 114937 - modified by sathish
					//BRGUS00112829 – kesavanr – For AP FL situation, if (the adverse action switch is YES )
					//OR (adverse action switch is NO and Adequate notice required as YES), then it should be closed.
					if ((aEdEligibilityCargo.getPaymentEndDt() == null)
							&& ((aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.YES) ||
								 (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO &&
								  aEdEligibilityCargo.getAdequateNoticeReqSw() == IEdEligCodes.YES &&
								  //BRGUS00108412 – kesavanr – Adding condition if payment begin date is greater than the edbc run date.
								  aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt())))) {
						//BRGUS00089510
						if (aEdEligibilityCargoPrevMth.getCgStatusCd() != null
								&& aEdEligibilityCargoPrevMth.getCgStatusCd()
										.equalsIgnoreCase(
												IEdEligCodes.STATUS_CD_DENIED)) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
						} else {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						}
					} else if (aEdEligibilityCargoPrevMth.getCgStatusCd() != null
							&& aEdEligibilityCargoPrevMth.getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_TERMINATED)) {
						//Added for defect 122773
						/*
						 * if
						 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CC)) {
						 * aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED); }
						 * else {
						 */
						/* Begin BRGUS00147702 – kesavanr
						 * If previous month is terminated then terminate the current month
						 * if adverse action is allowed else set the cgstatuscd as in the last
						 * auth segment.
						 */
						if(aEdEligibilityCargo.getAdverseActionAllowedSw() == 'Y') {
							aEdEligibilityCargo
								.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						}
						else {
							if(aEgDataHandler.getEligDetailLastAuth() != null
									&& aEgDataHandler.getEligDetailLastAuth()
											.getEdEligibilityCargo()[0]
											.getCgStatusCd() != null) {
							aEdEligibilityCargo
							.setCgStatusCd(aEgDataHandler
									.getEligDetailLastAuth()
									.getEdEligibilityCargo()[0]
									.getCgStatusCd());
							}
						}
						//End BRGUS00147702
						//	   					}
					} /*
					   * else { // commented for defect 155722 , Defect 155722
					   * overrules defect 106645 (EDG is setting the
					   * adverseaction) if
					   * (aEdEligNoticeReasonsCargo.getFailureReasonCode().indexOf(IEdEligCodes.FAILURE_REASON_CODE_EL0044) !=
					   * -1 ||
					   * aEdEligNoticeReasonsCargo.getFailureReasonCode().indexOf(IEdEligCodes.FAILURE_REASON_CODE_DI4012) !=
					   * -1) {
					   * aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
					   * //Added for defect 106645
					   * aEdEligibilityCargo.setAdverseActionAllowedSw(IEdEligCodes.YES); }
					   */else {
						//Added for defect 107793

					   	//BRGUS00112829 – kesavanr – For AP FL situation, if (the adverse action switch is YES )
						//OR (adverse action switch is NO and Adequate notice required as YES), then it should be closed.
						if ((aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.YES) ||
						   (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO &&
						   	aEdEligibilityCargo.getAdequateNoticeReqSw() == IEdEligCodes.YES &&
							//BRGUS00108412 – kesavanr – Adding condition if payment begin date is greater than the edbc run date.
							aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt()))) {
							if (aEdEligibilityCargoPrevMth.getCgStatusCd() != null
									&& aEdEligibilityCargoPrevMth
											.getCgStatusCd()
											.equalsIgnoreCase(
													IEdEligCodes.STATUS_CD_DENIED)) {
								aEdEligibilityCargo
										.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
							} else {
								aEdEligibilityCargo
										.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
							}
						} else {
							if (aEgDataHandler.getEligDetailLastAuth() != null
									&& aEgDataHandler.getEligDetailLastAuth()
											.getEdEligibilityCargo()[0]
											.getCgStatusCd() != null) {
								//Added for defect 122773
								if (aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_CC)
										&& aEdEligNoticeReasonsCargo
												.getFailureReasonCode()
												.indexOf(
														IEdEligCodes.FAILURE_REASON_CODE_EL0051) != -1) {
									aEdEligibilityCargo
											.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
									aEdEligibilityCargo
											.setAdverseActionAllowedSw(IEdEligCodes.YES);
								} else {
									aEdEligibilityCargo
											.setCgStatusCd(aEgDataHandler
													.getEligDetailLastAuth()
													.getEdEligibilityCargo()[0]
													.getCgStatusCd());
								}
							} else {
								aEdEligibilityCargo
										.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
							}
						}
					}
					//	} commented for defect 155722
				}
			} else if (sEligRsltCd.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
				aEdEligibilityCargo
						.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
			} else if (sEligRsltCd.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				aEdEligibilityCargo
						.setCgStatusCd(IEdEligCodes.STATUS_CD_PENDING);
			}
			//If condition added and modified below condition as else if for
			// CCB 129329(PFP) and Def # 241607 on 9/14/2005
			/*
			 * if
			 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF) &&
			 * aEdEligibilityCargo.getVerificationStatusCd().equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {
			 * ////Column Forfeit Deleted
			 * //aEdEligibilityCargo.getForfeitMthDt() != null) { //Don't do any
			 * thing, deliberatly skiped setting CgStatusCd pending }
			 */

			//Change made to pend based on prev mth only if it Prior Medical
			// code is 0 on 02/27/2003 by Chandilvel
			//Modified 'if' condition to 'else if' of aboce condition for Def #
			// 241607 on 9/14/2005
			// beniwala - ASPEN00015918 - fix findbugs issue
			if (aEdEligibilityCargoPrevMth != null &&
					aEdEligibilityCargoPrevMth.getPriorMedicalCd() != null
					&& aEdEligibilityCargoPrevMth.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_0)
					&& aEdEligibilityCargoPrevMth.getEdgNum() == aEdEligibilityCargo
							.getEdgNum()) {
				/* Begin BRGUS00109633 – kesavanr
				 * Check pending verification attribute to carry forward pending verification.
				 */
				if (aEdEligibilityCargoPrevMth.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_PENDING)
						&& aEdEligibilityCargoPrevMth.getPendingVerificationSw() == 'Y'
						&& (!aEdEligibilityCargo.getCgEligRsltCd().equals("FL"))) {
					//BRGUS00144746
					if(aEdEligibilityCargo.getProgramCd() != null && aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("MA")
							&& aEdEligibilityCargo.getCatEligSw() == 'Y'){
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
					}else{
					aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_PENDING);
					aEdEligibilityCargo.setPendingVerificationSw('Y');
					}
				}
				//End BRGUS00109633
			}

			//Set cgstatuscd to pending if the previous month voided record is
			// in pending status
			if (!aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_PENDING) &&
				//BRGUS00109458 – kesavanr – Carry forward verification pending from 'V' record
				//if the current month is not failed.
				!aEdEligibilityCargo.getCgEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
						aEgDataHandler.getEdEligibilityCargoVrecords(),
						aEdEligibilityCargo);
				//BRGUS00144746
				if (edEligibilityCargoV != null	&& edEligibilityCargoV.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_PENDING)) {
					if(aEdEligibilityCargo.getProgramCd() != null && aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("MA")
							&& aEdEligibilityCargo.getCatEligSw() == 'Y'){
						aEdEligibilityCargo.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
					} else {
					    aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_PENDING);
					}
				}
			}
			//			Seting cgstatus cd to terminated for DSS record if it is a open
			// end date record
			if (aEdEligibilityCargo.getPaymentEndDt() == null
					&& aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("DS")) {
				if (aEdEligibilityCargoPrevMth != null
						&& aEdEligibilityCargoPrevMth.getCgStatusCd() != null
						&& aEdEligibilityCargoPrevMth.getCgStatusCd()
								.equalsIgnoreCase("PE")) {
					aEdEligibilityCargo.setCgStatusCd("PE");
				} else if (aEdEligibilityCargoPrevMth != null
						&& aEdEligibilityCargoPrevMth.getCgStatusCd() != null
						&& aEdEligibilityCargoPrevMth.getCgStatusCd()
								.equalsIgnoreCase("DN")) {
					aEdEligibilityCargo.setCgStatusCd("DN");//End BRGUS00114318
				} else {
					aEdEligibilityCargo
							.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
				}
			}
			/* Begin BRGUS00101130 – kesavanr
			 * Setting eligibility status to denied if eligibility result is failed for G2 TOAs
			 */
			if(aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2") &&
			   aEdEligibilityCargo.getCgEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
				//BRGUS00167644-upadhyayulag-If the last authorized record's spend down amount is '0',
				//then do not set the status code to denied/terminated if payment begin month is less than
				//or equal to EDBC run month for G2 EDGs & certified group size is 0
				//BEGIN-BRGUS00227331-upadhyayulag-Check for the equality of edg trace id & ref edg trace id
				//to identify if individual is moved to higher medicaid group like 'LIF'(if these are not 
				//equal, that means mid month transfer to another group)
				if(aEdEligibilityCargo.getReferenceEdgTraceId() == aEdEligibilityCargo.getEdgTraceId()
// BRGUS00253828 rampurkara We can have G2 failure for access assets also but cgSize will not be zero
//			     thus commenting the cgsize check. Now retro closure of G2 is not possible when deductible is met						
//					&& aEdEligibilityCargo.getCgSize() == 0
// end BRGUS00253828					
					&& DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),
						DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getEdbcRunDt()))){
					if(aEgDataHandler.getEligDetailLastAuth() != null 
							&& aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null 
							&& (aEdEligibilityCargo.getEdgNum() == 
								aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getEdgNum())
							&& aEgDataHandler.getEligDetailLastAuth().
							getEdEligibilityCargo()[0].getSpendDownAmt() == 0){
						aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
					}
				}
				//END-BRGUS00227331
				//END-BRGUS00167644
			}
			//End BRGUS00101130
			//Added for defect 70311
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_DENIED)
					|| aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				detBenefitAmt(aEdEligibilityCargo);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detCgStatusCd", ex);
		}
	}

	/**
	 * Sets the CurrentEligInd to P only after all the modules are run or
	 * disposition calls it.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detCurrentEligInd(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		aEdEligibilityCargo
				.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_IND_PROCESSED);
	}

	/**
	 * Determines the EdEligibility Begin Date.
	 *
	 * @param aEdEligibilityCargo
	 *            contains the EdEligibilityCargo of the current month
	 * @param aEdEligibilityCargoPrevMonth
	 *            contains the EdEligibilityCargo of the previous month
	 * @param aArrEdIndvEligibilityCargo
	 *            contains the EdIndvEligibilityCargos of the current record
	 * @param aEgDataHandler
	 *            contains the EgDataHandler
	 * @param aNFDataHandler
	 *            constains the NFDataHandler
	 * @param aBResetSw
	 *            contains the reset switch
	 * @param eligDetailPrevMonth
	 *            contains the EligDetail structure
	 * @return boolean returns the updated reset switch
	 * @throws EDBCException
	 */
	
	public boolean detEdEligBegDt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMonth,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EgDataHandler aEgDataHandler, NFDataHandler aNFDataHandler,
			boolean aBResetSw, EligDetail eligDetailPrevMonth)
			throws EDBCException {
		try {

			if (aEdEligibilityCargo.getEligibilityBegDt() == null) {
				if (aEdEligibilityCargo.getCgStatusCd() != null
						&& aEdEligibilityCargo.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_APPROVED)) {
					//HashMap hmTemp = populateHMTPCodes();
					HashMap hmTemp = hmEMERGENCY_MA_TOA;
					if (hmTemp.containsKey(aEdEligibilityCargo
							.getTypeOfAssistanceCd())) {
						Timestamp tsHighDt = new Timestamp(Long.MAX_VALUE);
						Timestamp tsLowestEmerMedBegDt = tsHighDt;
						int iLength = aArrEdIndvEligibilityCargo.length;
						//						HashMap hmIndvAlien =
						// NFUtil.detDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
						// aNFDataHandler);
						//HashMap hmAlienEmerMed =
						// EdIndvUtil.detDcAlienEmergencyMedInfoMonthlyHM(aEgDataHandler);
						//						DcIndividualAlienCargo dcIndividualAlienCargo = null;
						//DcAlienEmergencyMedCargo dcAlienEmergencyMedCargo =
						// null;
						for (int i = 0; i < iLength; i++) {
							if (aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
								/*
								 * CQ 1277: Table Deprecated if
								 * (hmAlienEmerMed.containsKey(new
								 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))) {
								 * dcAlienEmergencyMedCargo =
								 * (DcAlienEmergencyMedCargo)hmAlienEmerMed.get(new
								 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()));
								 * if
								 * (dcAlienEmergencyMedCargo.getEmergecyBeginDt() !=
								 * null &&
								 * dcAlienEmergencyMedCargo.getEmergecyBeginDt().before(tsLowestEmerMedBegDt)) {
								 * tsLowestEmerMedBegDt =
								 * dcAlienEmergencyMedCargo.getEmergecyBeginDt(); } }
								 */
							}
						}
						if (!tsLowestEmerMedBegDt.equals(tsHighDt)) {
							if (tsLowestEmerMedBegDt.before(aEdEligibilityCargo
									.getPaymentBegDt())) {
								aEdEligibilityCargo
										.setEligibilityBegDt(aEdEligibilityCargo
												.getPaymentBegDt());
								//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
								if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
									aEdEligibilityCargo
											.setDispositionEligBegDt(aEdEligibilityCargo
													.getEdbcRunDt());
								}
								//END-BRGUS00159285
							} else {
								aEdEligibilityCargo
										.setEligibilityBegDt(tsLowestEmerMedBegDt);
								//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
								if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
									aEdEligibilityCargo
											.setDispositionEligBegDt(aEdEligibilityCargo
													.getEdbcRunDt());
								}
								//END-BRGUS00159285
							}
							aBResetSw = true;
							//Added EligBegDt Set For Cert conditon for defect
							// 183363 to identify if it is not intake and it is
							// certified again.
							aEgDataHandler.getEdIndvInfo()
									.setIsEligBegDtSetForCert(true);
							return aBResetSw;
						}
					}
				}
				//Stg3 8/5/03 if
				// ((aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA))
				// &&
				// (aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_1)
				// ||
				// aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_2)
				// ||
				// aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_3)
				// ||
				// aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_56)))
				// {
				/* Begin BRGUS00109150 – kesavanr
				 * Perform the below logic only if the type of assistance is not G2 TOA
				 */
				if(!aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")) {
					if ((aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_1)
							|| aEdEligibilityCargo.getPriorMedicalCd().equals(
									IEdEligCodes.PRIOR_MED_CD_2)
							|| aEdEligibilityCargo.getPriorMedicalCd().equals(
									IEdEligCodes.PRIOR_MED_CD_3) || aEdEligibilityCargo
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_56))) {
						if (aEdEligibilityCargo.getCgStatusCd() != null
								&& aEdEligibilityCargo.getCgStatusCd().equals(
										IEdEligCodes.STATUS_CD_APPROVED)) {

							aEdEligibilityCargo
									.setEligibilityBegDt(aEdEligibilityCargo
											.getPaymentBegDt());
							//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
							if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
								aEdEligibilityCargo
										.setDispositionEligBegDt(aEdEligibilityCargo
												.getEdbcRunDt());
							}
							//END-BRGUS00159285
							aBResetSw = true;
							//Added EligBegDt Set For Cert conditon for defect
							// 183363 to identify if it is not intake and it is
							// certified again.
							aEgDataHandler.getEdIndvInfo()
									.setIsEligBegDtSetForCert(true);
						}
					} else {
						// beniwala - ASPEN00015918 - fix findbugs issue
						if (aEdEligibilityCargoPrevMonth != null &&
								aEdEligibilityCargoPrevMonth.getEligibilityBegDt() == null) {
							if (aEdEligibilityCargo.getCgStatusCd() != null
									&& aEdEligibilityCargo.getCgStatusCd().equals(
											IEdEligCodes.STATUS_CD_APPROVED)) {
								Timestamp eligibilityBeginDate = null;
								if (aEdEligibilityCargo.getProgramCd()
										.equalsIgnoreCase("CD")) {
									eligibilityBeginDate = detCDeligibilityBegingDate(aEgDataHandler);
									aEdEligibilityCargo
											.setEligibilityBegDt(eligibilityBeginDate);
								} else {
									aEdEligibilityCargo
											.setEligibilityBegDt(aEdEligibilityCargo
													.getPaymentBegDt());
								}
								//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
								if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
									aEdEligibilityCargo
											.setDispositionEligBegDt(aEdEligibilityCargo
													.getEdbcRunDt());
								}
								//END-BRGUS00159285
								aBResetSw = true;
								//Added EligBegDt Set For Cert conditon for defect
								// 183363 to identify if it is not intake and it is
								// certified again.
								aEgDataHandler.getEdIndvInfo()
										.setIsEligBegDtSetForCert(true);
							}
						} else {
							// beniwala - ASPEN00015918 - fix findbugs issue
							if (aEdEligibilityCargoPrevMonth != null && 
									(aEdEligibilityCargoPrevMonth.getPriorMedicalCd()
									.equals(IEdEligCodes.PRIOR_MED_CD_1)
									|| aEdEligibilityCargoPrevMonth
											.getPriorMedicalCd().equals(
													IEdEligCodes.PRIOR_MED_CD_2)
									|| aEdEligibilityCargoPrevMonth
											.getPriorMedicalCd().equals(
													IEdEligCodes.PRIOR_MED_CD_3))) {
								aEdEligibilityCargo
										.setEligibilityBegDt(aEdEligibilityCargo
												.getPaymentBegDt());
								//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
								if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
									aEdEligibilityCargo
											.setDispositionEligBegDt(aEdEligibilityCargo
													.getEdbcRunDt());
								}
								//END-BRGUS00159285
								aBResetSw = true;
								//Added EligBegDt Set For Cert conditon for defect
								// 183363 to identify if it is not intake and it is
								// certified again.
								aEgDataHandler.getEdIndvInfo()
										.setIsEligBegDtSetForCert(true);
							} else {
								//Modified for issue with FS dropping for PR
								Timestamp tsPrevMthBegDt = detPrevMthBegDt(
										aEdEligibilityCargoPrevMonth,
										aEdEligibilityCargo);
								//							aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargoPrevMonth.getEligibilityBegDt());
								aEdEligibilityCargo
										.setEligibilityBegDt(tsPrevMthBegDt);	
								/**
								 * Start BRGUS00185613 -singhh
								 * If previous month benefit is denied or terminated 
								 * then check if current month is not denied or terminated
								 * then set the eligibility begin date as the payment begin
								 * date.
								 */
								if (aEdEligibilityCargoPrevMonth!=null && 
									(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(aEdEligibilityCargoPrevMonth.getCgStatusCd())||
									 IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(aEdEligibilityCargoPrevMonth.getCgStatusCd()))
									)
								{
									if (!(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd()) ||
										  IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd()))){
										aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt());
									}
								}
								//End BRGUS00185613

								//BRGUS00129025 - Bhuvane - To set this only first time
								/*aEdEligibilityCargo
										.setDispositionEligBegDt(aEdEligibilityCargo
												.getEdbcRunDt());*/
								//Added EligBegDt Set For Cert conditon for defect
								// 183363 to identify if it is not intake and it is
								// certified again.
								aEgDataHandler.getEdIndvInfo()
										.setIsEligBegDtSetForCert(true);
							}
						}
					}
				}
				//End BRGUS00109150
				//				Setting Eligibility Begin Date for STFS Records
				if (aEdEligibilityCargo.getCgStatusCd() != null
						&& aEdEligibilityCargo.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_APPROVED)
						&& aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_71)) {
					aEdEligibilityCargo.setEligibilityBegDt(DateComparisons
							.getFirstDayOfDate(aEdEligibilityCargo
									.getRequestDt()));
				}

			}// end of outer most if
			else {
				//Added EligBegDt Set For Cert conditon for defect 183363 to
				// identify if it is not intake and it is certified again.
				aEgDataHandler.getEdIndvInfo().setIsEligBegDtSetForCert(false);
				// else is added as part of CCB: 00127585
				if ((aEdEligibilityCargoPrevMonth.getEligibilityBegDt() != null)
						&& (aEdEligibilityCargoPrevMonth.getEligibilityEndDt() == null)) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargoPrevMonth
									.getEligibilityBegDt());
					//BRGUS00129025 - Bhuvane - To set this only first time
					/*aEdEligibilityCargo
							.setDispositionEligBegDt(aEdEligibilityCargo
									.getEdbcRunDt());*/
				}
				/* Begin BRGUS00105359 – kesavanr
				 * Setting eligibility begin date if previous month eligibility is terminated.
				 */
				/*else if ((aEdEligibilityCargoPrevMonth.getEligibilityBegDt() != null)
						&& (aEdEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
							&& (aEdEligibilityCargo.getCgStatusCd().equals(
									IEdEligCodes.STATUS_CD_APPROVED))) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargo
									.getPaymentBegDt());
					aEdEligibilityCargo
							.setDispositionEligBegDt(aEdEligibilityCargo
									.getEdbcRunDt());
				}*/
				//End BRGUS00105359

				/*
				 * 	Defect ID : BRGUS00103791
				 *  Added By  : alamm2
				 *  Date      : 04/16/2008
				 *  Change    : Commented aboveb condition .
				 * 				Setting eligibility begin date if previous month eligibility is terminated
				 * 				and current month is approved
				 *
				 */
				/*Start - BRGUS00103791*/
				else if ((aEdEligibilityCargoPrevMonth.getEligibilityBegDt() != null)
						&& (aEdEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
							&& (aEdEligibilityCargo.getCgStatusCd().equals(
									IEdEligCodes.STATUS_CD_APPROVED))) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargo
									.getPaymentBegDt());
					//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
					if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
						aEdEligibilityCargo
								.setDispositionEligBegDt(aEdEligibilityCargo
										.getEdbcRunDt());
					}
					//END-BRGUS00159285
				}

				/* Begin BRGUS00130169 – kesavnr
				 * Set new eligibility begin date if previous month eligibility begin date and
				 * previous month eligibility end date are null.
				 */
				else if ((aEdEligibilityCargoPrevMonth.getEligibilityBegDt() == null)
						&& (aEdEligibilityCargoPrevMonth.getEligibilityEndDt() == null)
							&& (aEdEligibilityCargo.getCgStatusCd().equals(
									IEdEligCodes.STATUS_CD_APPROVED))) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargo
									.getPaymentBegDt());
					//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
					if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
						aEdEligibilityCargo
								.setDispositionEligBegDt(aEdEligibilityCargo
										.getEdbcRunDt());
					}
					//END-BRGUS00159285
				}
				//End BRGUS00130169

				/*End - BRGUS00103791*/

			}
			//			Setting eligibility begin date for SER cases
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_APPROVED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
						.getPaymentBegDt());
			}
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				// ID : KesireddyV --BRGUS00131080-- set edg carry forward eligibility beg date if previous month eligibility
				// beg date is null for SER closure month.
				if (aEdEligibilityCargoPrevMonth != null
						&& aEdEligibilityCargoPrevMonth.getEligibilityBegDt() != null) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargoPrevMonth
									.getEligibilityBegDt());
				}
			}
			//<BRGUS00149688><kucherlapatis><05/28/2009><Java Fix To Build DSS For One Day>
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_DS)) {
				aEdEligibilityCargo
							.setEligibilityBegDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));
			}

			//Eligibility begin date for Spend down TOAs
			/*
			 * Begin BRGUS00101897 – kesavanr Setting eligibility begin date for
			 * spend down TOAs.
			 */
			//<BRGUS00259964><kucherlapatis><03/09/2011>
			//<Do not reset the eligibility begin date for G2 if it is already set by EDG>
			//<Reverting back the changes as interface is going to modify their logic while
			// reading individual's eligibility to look at cv_ed_mci_edg_individual table>
			if (aEdEligibilityCargo.getTypeOfAssistanceCd() != null
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith(
							"G2")) {
				aEdEligibilityCargo.setEligibilityBegDt(null);
			}
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_APPROVED)) {
				if (aEdEligibilityCargo.getSpendDownMetDt() != null) {
					aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
							.getSpendDownMetDt());
					//BRGUS00109150 – kesavanr – Set the variable to true if eligibility begin date is set.
					aEgDataHandler.getEdIndvInfo().setIsEligBegDtSetForCert(true);
				} else if (aEdEligibilityCargo.getSpendDownAmt() == 0) {
					aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
							.getPaymentBegDt());
					//BRGUS00109150 – kesavanr – Set the variable to true if eligibility begin date is set.
					aEgDataHandler.getEdIndvInfo().setIsEligBegDtSetForCert(true);
				} else if (aEdEligibilityCargo.getSpendDownAmt() > 0) {
					aEdEligibilityCargo.setEligibilityBegDt(null);
				}


			}
			//End BRGUS00101897

			/* Begin BRGUS00105359 – kesavanr
			 * Carry forward eligibility begin date if there is a V record for that edg.
			 */
			// beniwala - ASPEN00015918 - fix findbugs issue
			if(aEdEligibilityCargoPrevMonth != null &&
					aEdEligibilityCargoPrevMonth.getEligibilityBegDt() == null) {
				EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
						aEgDataHandler.getEdEligibilityCargoVrecords(),aEdEligibilityCargo);
				//BRGUS00117515 – kesavanr – carry forward eligibility begin date from prevous month
				//'V' record if eligibility begin date is not null.
				if(edEligibilityCargoV != null && edEligibilityCargoV.getEligibilityBegDt() != null) {
					aEdEligibilityCargo.setEligibilityBegDt(edEligibilityCargoV.getEligibilityBegDt());
				}
			}
			//End BRGUS00105359
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_DENIED)) {
				aEdEligibilityCargo.setEligibilityBegDt(null);
			}

			EdEligNoticeReasonsCargo[] edEligNoticeReasonsCargo = null;
			if (eligDetailPrevMonth != null) {
				edEligNoticeReasonsCargo = eligDetailPrevMonth
						.getEdEligNoticeReasonsCargo();
			}
			String failureReasonCd = null;
			if (edEligNoticeReasonsCargo != null
					&& edEligNoticeReasonsCargo.length > 0) {
				failureReasonCd = edEligNoticeReasonsCargo[0]
						.getFailureReasonCode();
			}
			if (aEdEligibilityCargoPrevMonth != null
					&& aEdEligibilityCargoPrevMonth.getCgStatusCd() != null
					&& aEdEligibilityCargoPrevMonth.getCgStatusCd()
							.equalsIgnoreCase(IEdEligCodes.STATUS_CD_DENIED)
					&& failureReasonCd != null
					&& failureReasonCd.indexOf("EL3032") != -1) {
				aEdEligibilityCargo.setEligibilityBegDt(DateComparisons
						.getFirstDayOfDate(aEdEligibilityCargoPrevMonth
								.getPaymentBegDt()));
			}
			return aBResetSw;
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEdEligBegDt", ex);
		}
	}

	/**
	 * Determines the EdEligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargoPrevMonth
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aNFDataHandler
	 *            NFDataHandler
	 * @throws EDBCException
	 */
	public void detEdEligEndDt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMonth,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EgDataHandler aEgDataHandler, NFDataHandler aNFDataHandler)
			throws EDBCException {
		try {

			if (aEdEligibilityCargo.getEligibilityEndDt() == null) {
				if (aEdEligibilityCargo.getCgStatusCd() != null
						&& aEdEligibilityCargo.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_APPROVED)) {
					//HashMap hmTemp = populateHMTPCodes();
					HashMap hmTemp = hmEMERGENCY_MA_TOA;
					if (hmTemp.containsKey(aEdEligibilityCargo
							.getTypeOfAssistanceCd())) {
						Timestamp tsLowDt = DateComparisons
								.getDate(IEdEligCodes.LOW_DATE);
						Timestamp tsHighestEmerMedEndDt = tsLowDt;
						int iLength = aArrEdIndvEligibilityCargo.length;
						//						HashMap hmIndvAlien =
						// NFUtil.detDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
						// aNFDataHandler);
						//HashMap hmAlienEmerMed =
						// EdIndvUtil.detDcAlienEmergencyMedInfoMonthlyHM(aEgDataHandler);
						//						DcIndividualAlienCargo dcIndividualAlienCargo = null;
						//DcAlienEmergencyMedCargo dcAlienEmergencyMedCargo =
						// null;
						for (int i = 0; i < iLength; i++) {
							if (aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
								/*
								 * CQ 1277: Table Deprecated if
								 * (hmAlienEmerMed.containsKey(new
								 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))) {
								 * dcAlienEmergencyMedCargo =
								 * (DcAlienEmergencyMedCargo)hmAlienEmerMed.get(new
								 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()));
								 * if
								 * (dcAlienEmergencyMedCargo.getEmergecyEndDt() !=
								 * null) { if
								 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(tsHighestEmerMedEndDt)) {
								 * //Modified for CCB 70149 if
								 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(aEdEligibilityCargo.getPaymentEndDt())) {
								 * tsHighestEmerMedEndDt =
								 * aEdEligibilityCargo.getPaymentEndDt(); } else {
								 * tsHighestEmerMedEndDt =
								 * dcAlienEmergencyMedCargo.getEmergecyEndDt(); } } }
								 * else { tsHighestEmerMedEndDt =
								 * DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt()); } }
								 */
							}
						}
						if (!tsHighestEmerMedEndDt.equals(tsLowDt)) {
							if (tsHighestEmerMedEndDt.after(DateComparisons
									.getLastDayOfDate(aEdEligibilityCargo
											.getPaymentBegDt()))) {
								aEdEligibilityCargo
										.setEligibilityEndDt(DateComparisons
												.getLastDayOfDate(aEdEligibilityCargo
														.getPaymentBegDt()));
							} else {
								aEdEligibilityCargo
										.setEligibilityEndDt(tsHighestEmerMedEndDt);
							}
							return;
						}
					}
				}
			}
			//Stg3 8/5/03 if
			// ((aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA))
			// &&
			// (aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_1)
			// ||
			// aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_2)
			// ||
			// aEdEligibilityCargo.getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_3)
			// ||
			// aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_56)))
			// {
			if ((aEdEligibilityCargo.getPriorMedicalCd().equals(
					IEdEligCodes.PRIOR_MED_CD_1)
					|| aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_2)
					|| aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_3) || aEdEligibilityCargo
					.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_56))) {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					aEdEligibilityCargo.setEligibilityEndDt(aEdEligibilityCargo
							.getPaymentEndDt());
				}
			} else {
				if ((aEdEligibilityCargo.getCgStatusCd()
						.equals(IEdEligCodes.STATUS_CD_TERMINATED))
						&& (aEdEligibilityCargo.getEligibilityEndDt() == null)) {
					if (aEdEligibilityCargoPrevMonth.getEligibilityEndDt() != null) {
						aEdEligibilityCargo
								.setEligibilityEndDt(aEdEligibilityCargoPrevMonth
										.getEligibilityEndDt());
					} else {
						/*
						 * Begin BRGUS00098367 – kesavanr Setting eligibility
						 * end date for CDC(payment begin date - 1 day) if
						 * terminated.
						 */
						if (aEdEligibilityCargo.getProgramCd()
								.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)) {
							aEdEligibilityCargo
									.setEligibilityEndDt(DateComparisons
											.subDays(aEdEligibilityCargo
													.getPaymentBegDt(), 1));
						} else {
							aEdEligibilityCargo
									.setEligibilityEndDt(DateComparisons
											.getLastDayOfPreviousMonth(aEdEligibilityCargo
													.getPaymentBegDt()));
						}
						//End BRGUS00098367
					}
				} else if (aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_APPROVED)) {
					//Modified for defect 143149
					if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.OTGP)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_69)) {
						aEdEligibilityCargo
								.setEligibilityEndDt(aEdEligibilityCargo
										.getPaymentEndDt());
					}
				}
			}
			//			Setting eligibility end date for SER cases
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_APPROVED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				aEdEligibilityCargo.setEligibilityEndDt(aEdEligibilityCargo
						.getPaymentEndDt());
			}
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				//ID : KesireddyV --BRGUS00131080-- set  eligibility end date is payment beg date - 1 sub days if previous month eligibility
				// end date is null for SER closure month.
				if (aEdEligibilityCargoPrevMonth != null) {
					if(aEdEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
					{
						aEdEligibilityCargo
						.setEligibilityEndDt(aEdEligibilityCargoPrevMonth
								.getEligibilityEndDt());
					}
					else
					{
						aEdEligibilityCargo
						.setEligibilityEndDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));

					}

				}
			}
			//<BRGUS00149688><kucherlapatis><05/28/2009><Java Fix To Build DSS For One Day>
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_DS)) {
				aEdEligibilityCargo
							.setEligibilityEndDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));
			}
			//Eligibility end date for spend down TOAs
			/*
			 * Begin BRGUS00101130 – kesavanr Setting eligibility end date for
			 * spend down TOAs if terminated.
			 */
			if (aEdEligibilityCargo.getTypeOfAssistanceCd() != null
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith(
							"G2")) {
				aEdEligibilityCargo.setEligibilityEndDt(null);
			}
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_APPROVED)) {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					aEdEligibilityCargo.setEligibilityEndDt(aEdEligibilityCargo
							.getPaymentEndDt());
				}
			}
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					aEdEligibilityCargo.setEligibilityEndDt(DateComparisons
							.getLastDayOfPreviousMonth(aEdEligibilityCargo
									.getPaymentBegDt()));
				}
			}
			//End BRGUS00101130
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_DENIED)) {
				aEdEligibilityCargo.setEligibilityEndDt(null);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEdEligEndDt", ex);
		}
	}

	/**
	 * Method detEdgReprocessSw, determines the Edg Reprocess Switch.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param eligDetailAllEDM
	 *            EligDetail[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public void detEdgReprocessSw(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EligDetail[] eligDetailAllEDM, EgDataHandler aEgDataHandler)
			throws EDBCException {
		int iLength = 0;
		boolean disabilityPending = isDisabilityPending(aEdEligibilityCargo,
				aEgDataHandler);
		try {
			if (aEdEligibilityCargo.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_YES) {
				//determine EdgReprocessSwitch
				boolean bIsTanfEdgReprocessSwYes = false;
				boolean bIsTanfEdgHearingPending = false;//BRGUS00148880-upadhyayulag-Variable for pending hearing
				iLength = eligDetailAllEDM.length;
				for (int j = 0; j < iLength; j++) {
					if (eligDetailAllEDM[j] != null) {
						if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
								.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_TANF)) {
							if (DateComparisons.getMM(eligDetailAllEDM[j]
									.getEdEligibilityCargo()[0]
									.getPaymentBegDt()) == DateComparisons
									.getMM(aEdEligibilityCargo
											.getPaymentBegDt())) {
								if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
										.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_YES) {
									bIsTanfEdgReprocessSwYes = true;
									//BEGIN-BRGUS00148880-upadhyayulag-Check if hearing is pending for this TF EDG
									if(isHearingPending(eligDetailAllEDM[j].getEdEligibilityCargo()[0],
											aEgDataHandler)){
										bIsTanfEdgHearingPending = true;
									}
									//END-BRGUS00148880
									break;
								}
							}
						}
					}
				}

				boolean bIsTanfEligRsltCdFail = false;
				iLength = eligDetailAllEDM.length;
				for (int j = 0; j < iLength; j++) {
					if (eligDetailAllEDM[j] != null) {
						if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
								.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_TANF)) {
							if (DateComparisons.getMM(eligDetailAllEDM[j]
									.getEdEligibilityCargo()[0]
									.getPaymentBegDt()) == DateComparisons
									.getMM(aEdEligibilityCargo
											.getPaymentBegDt())) {
								if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
										.getCgEligRsltCd() == IEdEligCodes.ELIG_RSLT_CD_FAIL) {
									bIsTanfEligRsltCdFail = true;
									break;
								}
							}
						}
					}
				}

				if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FS)) {
					//BEGIN-BRGUS00148880-If hearing is pending for TF EDG, then also, process setting
					//the EDG reprocess switch.
					if (bIsTanfEdgReprocessSwYes != true || bIsTanfEdgHearingPending == true) {
						detFSTANFEdgReprocessSw(aEdEligibilityCargo);
					}
					//END-BRGUS00148880
				} else if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_TANF)) {
					if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_60)) {
						//Following if condition is commented as we don't need
						// to call 'resetOTGPReprocessSw' method.
						// for CCB 142267 on 4/8/2005
						detFSTANFEdgReprocessSw(aEdEligibilityCargo);
						/*
						 * if (bIsTanfEligRsltCdFail != true) {
						 * detFSTANFEdgReprocessSw(aEdEligibilityCargo); } else {
						 * detFSTANFEdgReprocessSw(aEdEligibilityCargo); if
						 * (aEdEligibilityCargo.getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						 * resetOTGPReprocessSw(eligDetailAllEDM,
						 * aEdEligibilityCargo); } }
						 */
						// Added for defect 122347
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_71)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_72)) {
						// Added for defect 221368
						boolean bFoundOtherTFEdg = false;
						EligDetail eliglastauth = aEgDataHandler
								.getEligDetailLastAuth();
						if (eliglastauth != null) {
							if (aEdEligibilityCargo.getEdgNum() == eliglastauth
									.getEdEligibilityCargo()[0].getEdgNum()) {
								if (eliglastauth.getEdEligibilityCargo()[0]
										.getProgramCd().equals(
												IEdEligCodes.PROGRAM_CD_TANF)) {
									bFoundOtherTFEdg = true;
								}
							}
						}
						if (!bFoundOtherTFEdg) {
							aEdEligibilityCargo
									.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
						}
					} else {
						detFSTANFEdgReprocessSw(aEdEligibilityCargo);
					}
				} else if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FMA)) {
					if (aEdEligibilityCargo.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_YES) {
						//Added for defect 193914
						if (!detAnotherTP08Exists(aEgDataHandler)) {
							if (!aEdEligibilityCargo.getCgEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
								//						if
								// (!(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED))
								// &&
								// !(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_TERMINATED)))
								// {
								//							if
								// (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_08)
								// &&
								// !(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_PENDING)))
								// {
								if (aEdEligibilityCargo.getCgEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
									//Modifed for CCB 70149
									if ((aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_56) || aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_32))
											&& (aEgDataHandler
													.getEligDetailLastAuth() != null)) {
										if (aEgDataHandler
												.getEligDetailLastAuth()
												.getEdEligibilityCargo()[0]
												.getBenefitAmt() == aEdEligibilityCargo
												.getBenefitAmt()) {
											if (aEgDataHandler
													.getEligDetailLastAuth()
													.getEdEligibilityCargo()[0]
													.getCgSize() == aEdEligibilityCargo
													.getCgSize()) {
											} else {
												aEdEligibilityCargo
														.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
											}
										} else {
											aEdEligibilityCargo
													.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
										}
									} /*
									   * else
									   * if(aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_43) ||
									   * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_44) ||
									   * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_47) ||
									   * aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_48)) {
									   * if
									   * (aEdEligibilityCargo.getEstimatedEligEndDt() !=
									   * null &&
									   * aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEstimatedEligEndDt())){
									   * //Don't do anything - ReprocessSE is
									   * already set to 'Y' } }
									   */else {
										iLength = 0;
										iLength = aArrEdIndvEligibilityCargo.length;
										boolean bIndvFl = false;
										for (int i = 0; i < iLength; i++) {
											if (aArrEdIndvEligibilityCargo[i]
													.getGroupInd() != IEdEligCodes.GROUP_IND_C) {
												// Added if EA or EC check for
												// defect 186199
												if (aArrEdIndvEligibilityCargo[i]
														.getEdgPartStatusCd()
														.equals(
																IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT)
														|| aArrEdIndvEligibilityCargo[i]
																.getEdgPartStatusCd()
																.equals(
																		IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD)) {
													if (!aArrEdIndvEligibilityCargo[i]
															.getEdgPartStatusCd()
															.equals(
																	aArrEdIndvEligibilityCargo[i]
																			.getPartStatusCd())) {
														bIndvFl = true;
														break;
													}
												}
											}
										}
										// The above commented code is moved
										// down here and it can be removed once
										// stablished
										// Logic changed during CCB :00150756
										// development (CMA)
										// Moved this correspondingly in prd for
										// defect 186199
										if ((aEdEligibilityCargo
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_43)
												|| aEdEligibilityCargo
														.getTypeOfAssistanceCd()
														.equals(
																IEdEligCodes.TP_44)
												|| aEdEligibilityCargo
														.getTypeOfAssistanceCd()
														.equals(
																IEdEligCodes.TP_47) || aEdEligibilityCargo
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_48))
												&& (aEdEligibilityCargo
														.getEstimatedEligEndDt() != null && aEdEligibilityCargo
														.getPaymentBegDt()
														.after(
																aEdEligibilityCargo
																		.getEstimatedEligEndDt()))) {
											//Don't do anything - ReprocessSE
											// is already set to 'Y'
										} else if (bIndvFl == false) {
											aEdEligibilityCargo
													.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
										}
									}
								} else {//Added TMA for defect 239770.
									if (aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_08)
											|| EDGConstants.TMA_TOA_LIST
													.contains(aEdEligibilityCargo
															.getTypeOfAssistanceCd())
											|| (aEdEligibilityCargo
													.getProgramCd()
													.equalsIgnoreCase(
															EDGConstants.ME) && disabilityPending)) {
									} else {
										aEdEligibilityCargo
												.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
									}

								}
							}

						}

					}

				} else {
					if (aEdEligibilityCargo.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_YES) {
						if (!aEdEligibilityCargo.getCgEligRsltCd().equals(
								IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
							//						if
							// (!(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED))
							// &&
							// !(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_TERMINATED)))
							// {
							//							if
							// (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_08)
							// &&
							// !(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_PENDING)))
							// {
							if (aEdEligibilityCargo.getCgEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_PASS)) {
								iLength = 0;
								iLength = aArrEdIndvEligibilityCargo.length;
								boolean bIndvFl = false;
								for (int i = 0; i < iLength; i++) {
									if (aArrEdIndvEligibilityCargo[i]
											.getGroupInd() != IEdEligCodes.GROUP_IND_C) {
										// Added if EA or EC check for defect
										// 186199
										if (aArrEdIndvEligibilityCargo[i]
												.getEdgPartStatusCd()
												.equals(
														IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT)
												|| aArrEdIndvEligibilityCargo[i]
														.getEdgPartStatusCd()
														.equals(
																IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD)) {
											if (!aArrEdIndvEligibilityCargo[i]
													.getEdgPartStatusCd()
													.equals(
															aArrEdIndvEligibilityCargo[i]
																	.getPartStatusCd())) {
												bIndvFl = true;
												break;
											}
										}
									}
								}
								if (bIndvFl == false) {
									aEdEligibilityCargo
											.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
								}
							} else {
								// Assuming this is for PENDed EDGs. Adding CC
								// waiver check for defect 240060
								if (aEdEligibilityCargo.getTypeOfAssistanceCd()
										.equals(IEdEligCodes.TP_08)
										|| (aEdEligibilityCargo.getProgramCd()
												.equalsIgnoreCase(
														EDGConstants.ME) && disabilityPending)
								//||
								// EDGConstants.CC_WAIVER_TOA_LIST.contains(aEdEligibilityCargo.getTypeOfAssistanceCd())
								) {
								} else {
									aEdEligibilityCargo
											.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
								}

							}
						}

					}

				}
			} else {
				//<BRGUS00203642><kucherlapatis><02/25/2010><Java and DT Fix To Build Medicaid Past EEED>
				if (aEdEligibilityCargo.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_NO) {
					if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FS)/*
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_43)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_44)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_47)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_48)*/) {
						if (aEdEligibilityCargo.getEstimatedEligEndDt() != null
								&& aEdEligibilityCargo.getPaymentBegDt().after(
										aEdEligibilityCargo
												.getEstimatedEligEndDt())
								&& aEdEligibilityCargo.getCgEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
							aEdEligibilityCargo
									.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
						}
					}

					//Defect 140001
					//Added and condition for defect 163838
					/*<BRGUS00144795><kucherlapatis><02/11/2009><Java Fix To Build STFS From Request Date.
					   STFS is being built from application date but it should be built from request date.
					   But as the edg reprocess sw for 'FS' is set based on 'TF' edg reprocess sw which is
					   being set to 'Y' always for STFS in the below code. Commenting this code based on
					   discussion with Abdul and Adithya(Probably TIERS code)>*/
					/*if ((aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_71) || aEdEligibilityCargo
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_72))
							&& !aEdEligibilityCargo.getCgEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						EligDetail eliglastauth = aEgDataHandler
								.getEligDetailLastAuth();
						if (eliglastauth != null) {
							if (aEdEligibilityCargo.getEdgNum() == eliglastauth
									.getEdEligibilityCargo()[0].getEdgNum()) {
								if (eliglastauth.getEdEligibilityCargo()[0]
										.getProgramCd().equals(
												IEdEligCodes.PROGRAM_CD_TANF)) {
									aEdEligibilityCargo
											.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
								}
							}
						}

						//Any processed record in the current run with same edg
						// and different TPCode
						EligDetail[] arrEligUAProcCurEdm = aEgDataHandler
								.getEligDetailUAProcTfFmaCurrEDMEdges();
						if (arrEligUAProcCurEdm != null) {
							int arrProclength = arrEligUAProcCurEdm.length;
							for (int i = 0; i < arrProclength; i++) {
								if (arrEligUAProcCurEdm[i]
										.getEdEligibilityCargo()[0]
										.getProgramCd().equals(
												IEdEligCodes.PROGRAM_CD_TANF)) {
									if (arrEligUAProcCurEdm[i]
											.getEdEligibilityCargo()[0]
											.getEdgNum() == aEdEligibilityCargo
											.getEdgNum()) {
										if (!(arrEligUAProcCurEdm[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_71) || arrEligUAProcCurEdm[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_72))) {
											aEdEligibilityCargo
													.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
										}
									}
								}
							}

						}
					}*/
				}
			}
			//Modifed for defect 81855 & 88515
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)) {
				if (aEdEligibilityCargo.getCombinedPaymentSw() == IEdEligCodes.YES
						&& aEdEligibilityCargo.getRecEndDt() == null) {
					int iEstYear = DateComparisons.getYYYY(aEdEligibilityCargo
							.getEstimatedEligEndDt());
					int iEstMth = DateComparisons.getMM(aEdEligibilityCargo
							.getEstimatedEligEndDt());
					int iEDMYear = DateComparisons.getYYYY(aEdEligibilityCargo
							.getPaymentBegDt());
					int iEDMMth = DateComparisons.getMM(aEdEligibilityCargo
							.getPaymentBegDt());
					if (iEstYear > iEDMYear
							|| (iEstYear == iEDMYear && iEstMth > iEDMMth)) {
						aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
					}
				}
			}
			//Setting reprocess sw to 'Y' for EFIP case
			if (aEgDataHandler.getEligDetailLastAuth() != null) {
				EdEligibilityCargo[] arrEdEligibilityCargo = aEgDataHandler
						.getEligDetailLastAuth().getEdEligibilityCargo();
				for (int i = 0; i < arrEdEligibilityCargo.length; i++) {
					if (arrEdEligibilityCargo[i].getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_01)
							&& arrEdEligibilityCargo[i].getCurrentEligInd() == 'A'
							&& arrEdEligibilityCargo[i].getCgStatusCd().equals(
									"AP")
							&& arrEdEligibilityCargo[i].getPaymentEndDt() == null
							&& arrEdEligibilityCargo[i].getEfipEligSw() == 'Y') {
						if (arrEdEligibilityCargo[i].getEfipToFipSw() == 'Y'
								&& arrEdEligibilityCargo[i].getPaymentEndDt() == null
								&& arrEdEligibilityCargo[i]
										.getAdverseActionAllowedSw() == 'N') {
							aEdEligibilityCargo
									.setEdgReprocessSw(IEdEligCodes.YES);
						}
					}
				}
			}

			//Added for Tanf Pay For Performance

			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_TANF)) {
				/*
				 * Sai : 5/16/2005 : CCB : 158628 Following code to set
				 * EdgReprocess Switch for PFP is commented and re written as
				 * seperate function 'detEdgReprocessSwForPFP' Commented code
				 * can exist for one more build i.e build52 and can be removed
				 * latter.
				 */

				detEdgReprocessSwForPFP(aEdEligibilityCargo,
						aArrEdIndvEligibilityCargo, eligDetailAllEDM,
						aEgDataHandler);
				/*
				 * if(!aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)){
				 * if
				 * (aEdEligibilityCargo.getPaymentBegDt().equals(aEdEligibilityCargo.getForfeitMthDt()) &&
				 * aEdEligibilityCargo.getPaymentEndDt() == null) { if
				 * ((aEdEligibilityCargo.getNonCoopMth2Dt() != null) &&
				 * (aEdEligibilityCargo.getNonCoopMth1Dt() != null)) { if
				 * (aEdEligibilityCargo.getEdbcRunDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
				 * 1))) ||
				 * aEdEligibilityCargo.getEdbcRunDt().after(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
				 * 1)))) {
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } } }
				 * //Added for defect 174446 if
				 * (aEdEligibilityCargo.getNonCoopMth1Dt() != null &&
				 * aEdEligibilityCargo.getNonCoopMth2Dt() == null) { if
				 * (aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligNoticeReasonsCargo()[0].getFailureReasonCode().indexOf(IEdEligCodes.FAILURE_REASON_CODE_EL1205) !=
				 * -1) {
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } }
				 * //Added for Defect 181975:
				 * if((aEdEligibilityCargo.getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS))&&
				 * (aEdEligibilityCargo.getPaymentEndDt() == null) &&
				 * (aEdEligibilityCargo.getForfeitMthDt() == null) &&
				 * (aEgDataHandler.getEligDetailLastAuth() != null) &&
				 * (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getForfeitMthDt() !=
				 * null)){
				 * if(aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getPaymentBegDt().equals(aEdEligibilityCargo.getPaymentBegDt())){
				 * //Following two lines commented and AdverseActionSw based
				 * condition addded for the // Defect : 216054 0n 2/25/2005
				 * //Timestamp tsBiCutOffDate =
				 * getBiCutOffDate(aEdEligibilityCargo); //if
				 * (aEdEligibilityCargo.getEdbcRunDt().after(tsBiCutOffDate)){
				 * if (aEdEligibilityCargo.getAdverseActionAllowedSw() ==
				 * IEdEligCodes.NO ){
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } } }
				 *  } else { //modified for Tanf PFP - sathish (11/07/2003)
				 * if(aEdEligibilityCargo.getForfeitMthDt() != null ){ int
				 * iForfeitYear =
				 * DateComparisons.getYYYY(aEdEligibilityCargo.getForfeitMthDt());
				 * int iForfeitMth =
				 * DateComparisons.getMM(aEdEligibilityCargo.getForfeitMthDt());
				 * int iEDMYear =
				 * DateComparisons.getYYYY(aEdEligibilityCargo.getPaymentBegDt());
				 * int iEDMMth =
				 * DateComparisons.getMM(aEdEligibilityCargo.getPaymentBegDt());
				 * if (iEDMYear > iForfeitYear || (iEDMYear == iForfeitYear &&
				 * iEDMMth >= iForfeitMth)) { //Prod Patch Tiers00212131 (Defect
				 * Tiers00211122) //Defect Tiers00205349
				 * if(aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)){
				 * //Defect 172265 //if there is any forfeit month and a group
				 * denial EDBC is looping
				 * if(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)) {
				 * if(aEdEligibilityCargo.getNonCoopMth2Dt() == null) {
				 * //Follwoing if condition not required as per discussion with
				 * Pani on 4/19/2005 CCB: 129329 //if
				 * (aEdEligibilityCargo.getEdbcRunDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
				 * 1)))) { if((aEdEligibilityCargo.getPaymentEndDt() == null) &&
				 * (DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo.getRequestDt(),aEdEligibilityCargo.getPaymentBegDt()))){
				 * //intentionally left blank for clarity }else{
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); }
				 * //} } } }else //Defect 172265 //if there is any forfeit month
				 * and a group denial EDBC is looping
				 * if(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)) {
				 * if ((aEdEligibilityCargo.getNonCoopMth1Dt() != null) &&
				 * (aEdEligibilityCargo.getNonCoopMth2Dt() == null)) { if
				 * (aEdEligibilityCargo.getEdbcRunDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
				 * 1)))) {
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } } }
				 * else
				 * if(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_TERMINATED)) {
				 * //Added for CCB: 158628 if
				 * (aEdEligibilityCargo.getForfeitMthCount() > 1) {
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } } } } }
				 * //Added For CCB: 00157781 (PayForPerformance) if
				 * (aEdEligibilityCargo.getBuildNextMonthSw() ==
				 * IEdEligCodes.YES){
				 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES); }
				 */}
			//			Setting EDG Reprocess Switch to "N" if it is for CDC or SER cases
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_SER)
					|| aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_CDC)) {
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.NO);
			}
			//<BRGUS00254621><12/02/2010><kucherlapatis>
			//<Java Fix To Set EdgReprocessSw To 'NO' For Overriden FS Records>
			if(aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS)) {
				if(aEdEligibilityCargo.getEdgOverrideSw() != '\u0000' && 
						(aEdEligibilityCargo.getEdgOverrideSw() == 'Y' && aEdEligibilityCargo.getEdgReprocessSw() == 'Y')) {
					aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.NO);
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			ex.printStackTrace();
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEdgReprocessSw", ex);
		}
	}

	/**
	 * Method detEdgReprocessSwForPFP, determines the Edg Reprocess Switch For
	 * PFP .
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param eligDetailAllEDM
	 *            EligDetail[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 */
	public void detEdgReprocessSwForPFP(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EligDetail[] eligDetailAllEDM, EgDataHandler aEgDataHandler) {
		int iForfeitYear = 0;
		int iForfeitMth = 0;
		int iEDMYear = 0;
		int iEDMMth = 0;

		/*
		 * Column ForfeitMthDt deleted if(aEdEligibilityCargo.getForfeitMthDt() !=
		 * null) { iForfeitYear =
		 * DateComparisons.getYYYY(aEdEligibilityCargo.getForfeitMthDt());
		 * iForfeitMth =
		 * DateComparisons.getMM(aEdEligibilityCargo.getForfeitMthDt()); }
		 */
		if (aEdEligibilityCargo.getPaymentBegDt() != null) {
			iEDMYear = DateComparisons.getYYYY(aEdEligibilityCargo
					.getPaymentBegDt());
			iEDMMth = DateComparisons.getMM(aEdEligibilityCargo
					.getPaymentBegDt());
		}

		/*
		 * When EDM is Forfeit mth & run date is on or before potential end date
		 * of NC2 & if NC2 is identified, then next mth need to be created to
		 * identify Forfeit mth 2
		 */
		if ((iEDMYear == iForfeitYear && iEDMMth == iForfeitMth)
				&& aEdEligibilityCargo.getPaymentEndDt() == null) {
			//if ((aEdEligibilityCargo.getNonCoopMth2Dt() != null) &&
			// (aEdEligibilityCargo.getNonCoopMth1Dt() != null)) {
			//Column NonCoopMth1Dt deleted
			//if
			// (aEdEligibilityCargo.getEdbcRunDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
			// 1)))) {
			//if
			// ((aEdEligibilityCargo.getPaymentBegDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
			// 1)))) &&
			//  (aEdEligibilityCargo.getForfeitMthCount() != 2)) {
			aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
			//}
			//}
		}
		/*
		 * When EDM is greater than Forfeit mth, then that record need to be
		 * dropped If Forfeit month count is 2 ( i.e ex: May is FF1 & June is
		 * FF2 then the months above June need to be dropped for the same
		 * initial file date) OR if run date is on or before potential end date
		 * of NC2 & NC2 is not identified & CgStatus is not Terminated.
		 */

		/*
		 * Column NonCoopMth1Dt deleted if (iEDMYear > iForfeitYear || (iEDMYear ==
		 * iForfeitYear && iEDMMth > iForfeitMth)) {
		 * if((aEdEligibilityCargo.getForfeitMthCount() == 2) &&
		 * (aEdEligibilityCargo.getPaymentBegDt().after(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
		 * 2))))){ aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
		 * }else
		 * if(aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED) &&
		 * aEdEligibilityCargo.getNonCoopMth1Dt() != null) { if
		 * ((aEdEligibilityCargo.getEdbcRunDt().before(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
		 * 1)))) ||
		 * (aEdEligibilityCargo.getEdbcRunDt().equals(DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getNonCoopMth1Dt(),
		 * 1))))) { aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } } }
		 */
		/*
		 * When Payment End dt is null & Adverse action is set to No & Forfeit
		 * mth is null & Last auth open Elig record with same initial file date
		 * has Forfeit mth not null, then set reprocess to Y to build next month
		 */
		//defect#BRGUS00052093 -- looping edg and edbc run
		/*
		 * this code is commented for edg and edbc looping..this check is for
		 * Forfeit mth but it is obsolete ex:case#123006085 has TF with 06/07
		 * authorized and unauthorized open ended record , so edgreprocesssw is
		 * being set to Y .which resulted continuous looping of edg and edbc
		 * process
		 */
		/*
		 * if((aEdEligibilityCargo.getPaymentEndDt() == null) && //Column
		 * ForfeitMthDt Deleted //(aEdEligibilityCargo.getForfeitMthDt() ==
		 * null) && (aEgDataHandler.getEligDetailLastAuth() != null)) {
		 * //(aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getForfeitMthDt() !=
		 * null)){ if (aEdEligibilityCargo.getAdverseActionAllowedSw() ==
		 * IEdEligCodes.NO ){
		 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES); } }
		 */

		//Added for defect 174446
		if (aEdEligibilityCargo.getCgStatusCd().equals(
				IEdEligCodes.STATUS_CD_TERMINATED)) {
			//Column ForfeitMthDat and NonCoopMth1&2 deleted
			//aEdEligibilityCargo.getForfeitMthDt() != null &&
			//aEdEligibilityCargo.getNonCoopMth1Dt() != null &&
			//aEdEligibilityCargo.getNonCoopMth2Dt() == null) {
			if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdEligNoticeReasonsCargo()[0].getFailureReasonCode()
					.indexOf(IEdEligCodes.FAILURE_REASON_CODE_EL1205) != -1) {
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
			}
		}

		//Added For CCB: 00157781 (PayForPerformance)
		if (aEdEligibilityCargo.getBuildNextMonthSw() == IEdEligCodes.YES) {
			aEdEligibilityCargo
					.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
		}

	}

	/**
	 * Resets the EdgReprocessSw to Yes if it is OTGP.
	 *
	 * @param eligDetailAllEDM
	 *            EligDetail[]
	 * @param aEdEligibilityCargoCurrEDM
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void resetOTGPReprocessSw(EligDetail[] eligDetailAllEDM,
			EdEligibilityCargo aEdEligibilityCargoCurrEDM) throws EDBCException {
		int iLength = eligDetailAllEDM.length;
		for (int j = 0; j < iLength; j++) {
			if (eligDetailAllEDM[j] != null) {
				if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
						.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
					if (DateComparisons.getMM(eligDetailAllEDM[j]
							.getEdEligibilityCargo()[0].getPaymentBegDt()) == DateComparisons
							.getMM(aEdEligibilityCargoCurrEDM.getPaymentBegDt())) {
						if (eligDetailAllEDM[j].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_60)) {
							if (!eligDetailAllEDM[j].getEdEligibilityCargo()[0]
									.getCgEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
								eligDetailAllEDM[j].getEdEligibilityCargo()[0]
										.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
							}
						}
					}
				}
			}
		}
	}

	/**
	 * Deteremines the EdgReprocessSw for FS or TANF.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detFSTANFEdgReprocessSw(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		if (aEdEligibilityCargo.getEstimatedEligEndDt() != null
				&& aEdEligibilityCargo.getPaymentBegDt().after(
						aEdEligibilityCargo.getEstimatedEligEndDt())) {
			aEdEligibilityCargo
					.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
		}
		//If condition added for Defect # 00241753 on 9/15/2005
		if (aEdEligibilityCargo.getBenefitStatus().equals(
				IEdEligCodes.BENEFIT_STATUS_DENY)
				&& aEdEligibilityCargo.getEdgCombineSw() == 'Y'
				&& aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
			aEdEligibilityCargo
					.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
		} else if (aEdEligibilityCargo.getBenefitStatus().equals(
				IEdEligCodes.BENEFIT_STATUS_CERTIFY)
				|| aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_TERMINATED)) {
			aEdEligibilityCargo
					.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
		} else {
			if (aEdEligibilityCargo.getBenefitStatus().equals(
					IEdEligCodes.BENEFIT_STATUS_DENY)
					&& aEdEligibilityCargo.getActivityType().equals(
							IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
			} else {
				//Def# Looping
				if (//aEdEligibilityCargo.getBenefitStatus().equals(IEdEligCodes.BENEFIT_STATUS_SUSTAIN)
					// &&
				aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_APPROVED)
						&& aEdEligibilityCargo.getCgEligRsltCd().equals(
								IEdEligCodes.ELIG_RSLT_CD_FAIL)
						&& aEdEligibilityCargo
								.getVerificationStatusCd()
								.equals(
										IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {
					aEdEligibilityCargo
							.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
				}

				//Defect 127485
				else if (aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_SUSTAIN)
						&& aEdEligibilityCargo.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_APPROVED)
						&& aEdEligibilityCargo.getCgEligRsltCd().equals(
								IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					// do nothing
				} else {
					//Added for issue with FS dropping for PR
					//Added one more if condition for Sustain by Chandil based
					// on advice from Pani on 03/05/2003
					//				if
					// (aEdEligibilityCargo.getBenefitStatus().equals(IEdEligCodes.BENEFIT_STATUS_SUSTAIN)
					// && aEdEligibilityCargo.getRecEndDt() != null) {
					//				} else {
					//Commented for defect 123478
					//					if (aEdEligibilityCargo.getSupplementAdviceSw() ==
					// IEdEligCodes.NO &&
					// aEdEligibilityCargo.getRecoupmentAdviceSw() ==
					// IEdEligCodes.NO) {
					//					} else {
					//for defect Tiers00238992 (Oct 4 , 05)
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_INCREASE)
							&& aEdEligibilityCargo
									.getVerificationStatusCd()
									.equals(
											IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)
							&& aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO) {
						aEdEligibilityCargo
								.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
					}
					/* Added else if for Def # 241607 */
					else if ((aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DECREASE) || aEdEligibilityCargo
							.getBenefitStatus().equals(
									IEdEligCodes.BENEFIT_STATUS_DENY))
							&& aEdEligibilityCargo
									.getVerificationStatusCd()
									.equals(
											IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)
							&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
						aEdEligibilityCargo
								.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
					} else if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_INCREASE)
							&& aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO) {
					} else {
						if ((aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_DECREASE) || aEdEligibilityCargo
								.getBenefitStatus().equals(
										IEdEligCodes.BENEFIT_STATUS_DENY))
								&& (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO)) {
						} else {
							aEdEligibilityCargo
									.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_NO);
						}

					}
					//					}
				}
				//				}
			}
		}
		//Added for defect Tiers00214709 : on 2/22/2005
		//Modified if condition to include BiCutOffDate (On or Before for
		// Defect # 214488 on 6/21/2005
		/* Begin BRGUS00084723 – kesavanr
		 * Code commented as this tiers code is no longer needed.
		 */
	/*	if (aEdEligibilityCargo.getEdgReprocessSw() == IEdEligCodes.EDG_REPROCESS_SW_NO) {
			if ((DateComparisons.getYYYY(aEdEligibilityCargo.getPaymentBegDt()) == DateComparisons
					.getYYYY(aEdEligibilityCargo.getEdbcRunDt()))
					&& (DateComparisons.getMM(aEdEligibilityCargo
							.getPaymentBegDt()) > DateComparisons
							.getMM(aEdEligibilityCargo.getEdbcRunDt()))) {
				Timestamp tsBiCutOffDate = getBiCutOffDate(aEdEligibilityCargo);
				if (DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo
						.getEdbcRunDt(), tsBiCutOffDate)
						&& (aEdEligibilityCargo.getAdverseActionAllowedSw() != IEdEligCodes.YES)
						&& (aEdEligibilityCargo.getAdequateNoticeReqSw() == IEdEligCodes.YES)) {
					aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES);
				}

			}
		}*/
		//End BRGUS00084723
		
		//ASPEN00036737 - TANF Support Services - Added by Sai Suresh
		boolean bFailMode = false;
		if (requestMap.get(DIConstants.EDG_FAILURE_MODE) != null) {
			bFailMode = ((Boolean) requestMap.get(DIConstants.EDG_FAILURE_MODE)).booleanValue();
		}
		
		if(!bFailMode && IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())){	
			if(null != aEdEligibilityCargo.getSplToaCd() && EDGConstants.SPL_TOA_CD_SUPP_SERV.equalsIgnoreCase(aEdEligibilityCargo.getSplToaCd())){
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
			}
			// ASPEN00043554 - Education Works Fix - Added by Sai Suresh
			if(null != aEdEligibilityCargo.getSplToaCd() && EDGConstants.SPL_TOA_CD_ED_WRKS.equalsIgnoreCase(aEdEligibilityCargo.getSplToaCd())){
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
			}
			if(null != aEdEligibilityCargo.getSplToaCd() && EDGConstants.SPL_TOA_CD_WAGE_SUBSIDY.equalsIgnoreCase(aEdEligibilityCargo.getSplToaCd())){
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
			}
		}
		
		//ASPEN00065332 - sandrun - Hardhisp not approving
		if(!bFailMode && IEdEligCodes.TP_SSSA.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())){	
			if(null != aEdEligibilityCargo.getSplToaCd() && IEdEligCodes.SPL_TOA_CD_HARDSHIP.equalsIgnoreCase(aEdEligibilityCargo.getSplToaCd())){
				aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
		}
			
		}
			
		
	}

	/**
	 * Resets the Special Review Dt and Cd.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpecialReviewDtCd(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMth) throws EDBCException {
		//Modified for defect 90831
		if (aEdEligibilityCargo.getSpReviewDt() == null) {
			if (aEdEligibilityCargoPrevMth != null) {
				if (aEdEligibilityCargoPrevMth.getSpReviewDt() != null) {
					if (DateComparisons.dateGTEQDateInTimestamp(
							aEdEligibilityCargoPrevMth.getSpReviewDt(),
							aEdEligibilityCargo.getPaymentBegDt())) {
						if (DateComparisons.dateLTEQDateInTimestamp(
								aEdEligibilityCargoPrevMth.getSpReviewDt(),
								aEdEligibilityCargo.getEdbcRunDt())) {
							aEdEligibilityCargo.setSpReviewDt(null);
							aEdEligibilityCargo.setSpReviewCd(null);
						} else {
							aEdEligibilityCargo
									.setSpReviewDt(aEdEligibilityCargoPrevMth
											.getSpReviewDt());
							aEdEligibilityCargo
									.setSpReviewCd(aEdEligibilityCargoPrevMth
											.getSpReviewCd());
						}
					}
				}
			}
		} else {
			if (DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo
					.getSpReviewDt(), aEdEligibilityCargo.getEdbcRunDt())) {
				aEdEligibilityCargo.setSpReviewDt(null);
				aEdEligibilityCargo.setSpReviewCd(null);
			}
		}
	}

	/**
	 * The end process that determines the dates, rstls & statuses of the
	 * current processed EligDetail Structure.
	 *
	 * @param aHmParams
	 *            contains the hashmap of parameters
	 * @param eligDetailPrevMonth
	 *            contains EligDetail structure of previous month
	 * @param arrEligDetailOutput
	 *            contains EligDetail structure of the output
	 * @return EligDetail
	 *            contains EligDetail structure of previous month
	 * @throws EDBCException
	 * @throws TIERSValidationException
	 * @throws RulesException
	 * @throws ApplicationException
	 * @throws RecoveryException
	 * @throws Exception
	 * 
	 */
	//BRGUS00113495 – kesavanr – Adding ApplicationException,RecoveryException in the method signature.
	
	public EligDetail determineEdDetails(HashMap aHmParams,
			EligDetail eligDetailPrevMonth, EligDetail[] arrEligDetailOutput)
			throws EDBCException, TIERSValidationException, RulesException, 
			ApplicationException, RecoveryException, Exception {
		//		try {
		EligDetail eligDetailCurrEDM = (EligDetail) aHmParams
				.get(IEdEligCodes.ELIG_DETAIL_PROCCESSED);
		EligDetail[] eligDetailAllEDM = (EligDetail[]) aHmParams
				.get(IEdEligCodes.ELID_DETAIL_ALL_PROCCESSED);
		EdEligibilityCargo edEligibilityCargoPrevMthFirstEDM = (EdEligibilityCargo) aHmParams
				.get(IEdEligCodes.ED_ELIG_PREV_MTH_FIRST_EDM);
		EdEligibilityCargo edEligibilityCargoPrevMthOtherEDM = (EdEligibilityCargo) aHmParams
				.get(IEdEligCodes.ED_ELIG_PREV_MTH_OTHER_EDM);
		EdEligibilityCargo edEligibilityCargoPrevPrevMthFirstEDM = (EdEligibilityCargo) aHmParams
				.get(IEdEligCodes.ED_ELIG_PREV_PREV_MTH_FIRST_EDM);
		EdEligibilityCargo edEligibilityCargoPrevPrevMthOtherEDM = (EdEligibilityCargo) aHmParams
				.get(IEdEligCodes.ED_ELIG_PREV_PREV_MTH_OTHER_EDM);
		boolean bFirstMthFlag = ((Boolean) aHmParams
				.get(IEdEligCodes.FIRST_MONTH_FLAG)).booleanValue();
		
		Connection conn = (Connection) aHmParams.get("CONNECTION");
		String userId = (String)aHmParams.get("USER_ID");
		HashMap overrideFields = new HashMap();
		//hmParams.put("userInfo",userInfo);
		//BEGIN-BRGUS00205536-upadhyayulag-Retrieve other parameters for BV update
		User userInfo = null;
		if(aHmParams.get("userInfo") != null){
			userInfo = (User)aHmParams.get("userInfo");
		}
		boolean isOnlineEbdcProcess = false;
		boolean isAuthorizedRecSpecialist = false;
		if(aHmParams.get("isOnlineEbdcProcess") != null){
			isOnlineEbdcProcess = ((Boolean)aHmParams.get("isOnlineEbdcProcess")).booleanValue();
		}
		if(aHmParams.get("isAuthorizedRecSpecialist") != null){
			isAuthorizedRecSpecialist = ((Boolean)aHmParams.get("isAuthorizedRecSpecialist")).booleanValue(); 
		}
		//END-BRGUS00205536
		if(aHmParams.get("overrideFields") != null){
			overrideFields = (HashMap)aHmParams.get("overrideFields");
		}
		EdEdgOverrideDetailsCollection edgOverrideDetailsCollection = null;
		if(aHmParams.get("edgOverrideDetailsCollection") != null){
			edgOverrideDetailsCollection = 
				(EdEdgOverrideDetailsCollection)aHmParams.get("edgOverrideDetailsCollection");
		}
		//BEGIN-BRGUS00233165-upadhyayulag-Override TOA before setting the value of any field
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_MC)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)){
			overrideField("Type Of Assistance",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		//END-BRGUS00233165
		boolean bResetSw = false;
		EdIndvEligibilityCargo edIndvEligibilityCargo[] = eligDetailCurrEDM
				.getEdIndvEligibilityCargo();
		// Moved most function ivoked based on 'bFirstMthFlag' as per QA Defect
		// 00195765
		//Added for Def# 00229744, on 10/18/2005
		EdCommonUtil.setCountOfCGIndvs(eligDetailCurrEDM
				.getEdEligibilityCargo()[0], eligDetailCurrEDM
				.getEdIndvEligibilityCargo());
		//STFS Code moved here from below BRGUS00081616
		EdIndvLtcPendingReasonCargo[] edIndvLtcPendingReasonCargo = eligDetailCurrEDM
				.getEdIndvLtcPendingReasonCargo();
		int otherPendLength = 0;
		int indvLength = 0;
		long indvid = 0;
		if (edIndvLtcPendingReasonCargo != null) {
			otherPendLength = edIndvLtcPendingReasonCargo.length;
		}
		if (edIndvEligibilityCargo != null) {
			indvLength = edIndvEligibilityCargo.length;
		}
		//modified for BRGUS00048581
		if ((eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
				.equalsIgnoreCase("TF"))
				&& (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getStfsPotentialEligSw() == 'Y' || eligDetailCurrEDM
						.getEdEligibilityCargo()[0].getEfipEligSw() == 'Y')
				&& (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getNfEligRsltCd() != null && eligDetailCurrEDM
						.getEdEligibilityCargo()[0].getNfEligRsltCd()
						.equalsIgnoreCase("PE"))) {
			for (int i = 0; i < otherPendLength; i++) {
				if (eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i]
						.getPendingReasonCd() != null
						&& eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i]
								.getPendingReasonCd().equalsIgnoreCase("1027")) {
					indvid = eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i]
							.getIndvId();
					for (int j = 0; j < indvLength; j++) {
						if (indvid == eligDetailCurrEDM
								.getEdIndvEligibilityCargo()[j].getIndvId()) {
							eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
									.setNfEligRsltCd("PS");
							eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
									.setEligRsltCd("PS");
						}
					}
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setNfEligRsltCd("PS");
					eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i]
							.setDeleteSw('Y');
				}
			}
		}//END
		if (bFirstMthFlag == true) {
			//determine CgEligRsltCd
			//Modified for defect 99144,99147 added new parameter
			detCgEligRsltCd(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(DcCaseProgramCargo) aHmParams
							.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO),
					edEligibilityCargoPrevMthFirstEDM,
					edEligibilityCargoPrevPrevMthFirstEDM,
					(eligDetailCurrEDM.getEdEligNoticeReasonsCargo())[0],
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(EligDetail[]) aHmParams
							.get(IEdEligCodes.ELID_DETAIL_ALL_PROCCESSED));

			//				Determination of CgEligRsltCd for Services
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_CDC)) {
				detCgEligRsltCdForCdcServices(eligDetailCurrEDM);
			} else if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER)) {
				detCgEligRsltCdForSerServices(eligDetailCurrEDM,
						edEligibilityCargoPrevMthFirstEDM);
			}
			//DSS Defect #BRGUS00066726
			else if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_DS)) {
				detCgEligRsltCdForDssServices(eligDetailCurrEDM);
			}

			//Added for defect 92824
			//Added driver logic to recompute dates if PR and if eligrsltcd is
			// failed and no previous pr record found
			//Commented for defect 239605 because this method was used before
			// the certbegdt was introduced for the DN scenario in PR.
			//				detDatesForPRFail(eligDetailCurrEDM.getEdEligibilityCargo()[0],
			// eligDetailCurrEDM.getEdIndvEligibilityCargo(),
			// edEligibilityCargoPrevMthFirstEDM,
			// (EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
			// ((EligDetail[])aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[0].getEdCaseRecertDatesCargo());
			//determine CombinedPaymentSw
			detCombinedPaymentSw(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthFirstEDM, (EligDetail) aHmParams
							.get(IEdEligCodes.ELIG_DETAIL_PREV_MTH),
					(DcCaseProgramCargo) aHmParams
							.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO));
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_FS)) {
				resetFSExpSw(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER));
			}
			//determine CgStatusCd
			if(overrideFields.get("EDG Status") != null){
				String newEdgStatus = (String)overrideFields.get("EDG Status");
				eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgStatusCd(newEdgStatus);
				if(newEdgStatus.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)){
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
					(IEdEligCodes.ELIG_RSLT_CD_PASS);
				}
//BRGUS00265230 rampurkara setting eligRsltCd to pend when cgStatusCd is pending				
				if(IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(newEdgStatus))
				{
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
								(IEdEligCodes.STATUS_CD_PENDING);
				}
// end BRGUS00265230				
				eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
			}else{
				detCgStatusCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						edEligibilityCargoPrevMthFirstEDM, (eligDetailCurrEDM
								.getEdEligNoticeReasonsCargo())[0],
						(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			}
			//Setting normal hours to 55 if FIP individual is eligible for CDC
			/*
			 * Defect ID : BRGUS00088528 Added By : kesavanr Date : 03/05/2008
			 * Change : Setting normal participation hours to 55 if FIP
			 * individual eligible for CDC
			 *
			 */
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)
					&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getCgStatusCd().equalsIgnoreCase(
									IEdEligCodes.STATUS_CD_APPROVED)) {
				EdDriverHelper.detFIPIndvEligibleCDC(eligDetailCurrEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						arrEligDetailOutput);
			}

			//Modified for defect 86792
			bResetSw = detEdEligBegDt(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthFirstEDM,
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER),
					bResetSw, eligDetailPrevMonth);
			//determine EdEligibility.EligibilityEndDt
			detEdEligEndDt(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthFirstEDM,
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER));
		} else {
			detCgEligRsltCd(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(DcCaseProgramCargo) aHmParams
							.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO),
					edEligibilityCargoPrevMthOtherEDM,
					edEligibilityCargoPrevPrevMthOtherEDM,
					(eligDetailCurrEDM.getEdEligNoticeReasonsCargo())[0],
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(EligDetail[]) aHmParams
							.get(IEdEligCodes.ELID_DETAIL_ALL_PROCCESSED));

			//				Determination of CgEligRsltCd for Services
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_CDC)) {
				detCgEligRsltCdForCdcServices(eligDetailCurrEDM);
			} else if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER)) {
				detCgEligRsltCdForSerServices(eligDetailCurrEDM,
						edEligibilityCargoPrevMthOtherEDM);
			}
			//DSS Defect #BRGUS00066726
			else if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_DS)) {
				detCgEligRsltCdForDssServices(eligDetailCurrEDM);
			}

			//Commented for defect 239605 because this method was used before
			// the certbegdt was introduced for the DN scenario in PR.
			//				detDatesForPRFail(eligDetailCurrEDM.getEdEligibilityCargo()[0],
			// eligDetailCurrEDM.getEdIndvEligibilityCargo(),
			// edEligibilityCargoPrevMthOtherEDM,
			// (EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
			// ((EligDetail[])aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[0].getEdCaseRecertDatesCargo());
			detCombinedPaymentSw(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthOtherEDM, (EligDetail) aHmParams
							.get(IEdEligCodes.ELIG_DETAIL_PREV_MTH),
					(DcCaseProgramCargo) aHmParams
							.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO));
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_FS)) {
				resetFSExpSw(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER));
			}
			if(overrideFields.get("EDG Status") != null){
				//ASPEN00068805 - kumard - Additional changes LIHEAP override by worker approving LIHEAP ongoing 
				if(!(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
						eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null)){
				String newEdgStatus = (String)overrideFields.get("EDG Status");
				eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgStatusCd(newEdgStatus);
				if(newEdgStatus.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)){
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
					(IEdEligCodes.ELIG_RSLT_CD_PASS);
				}
//BRGUS00265230	 rampurkara setting eligRsltCd to pend when cgStatusCd is pending				
				if(IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(newEdgStatus))
				{
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
								(IEdEligCodes.STATUS_CD_PENDING);
				}
// end BRGUS00265230 				
				}
				// ASPEN00060947 - Parma - added a check - LIHEAP should not be overridden for ongoing month
				else if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
														eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null){
				detCgStatusCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						edEligibilityCargoPrevMthOtherEDM, (eligDetailCurrEDM
								.getEdEligNoticeReasonsCargo())[0],
						(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
				}
			}else{
				detCgStatusCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						edEligibilityCargoPrevMthOtherEDM, (eligDetailCurrEDM
								.getEdEligNoticeReasonsCargo())[0],
						(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			}
			//Setting normal hours to 55 if FIP individual is eligible for CDC
			/*
			 * Defect ID : BRGUS00088528 Added By : kesavanr Date : 03/05/2008
			 * Change : Setting normal participation hours to 55 if FIP
			 * individual eligible for CDC
			 *
			 */
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)
					&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getCgStatusCd().equalsIgnoreCase(
									IEdEligCodes.STATUS_CD_APPROVED)) {
				EdDriverHelper.detFIPIndvEligibleCDC(eligDetailCurrEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						arrEligDetailOutput);
			}

			bResetSw = detEdEligBegDt(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthOtherEDM,
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER),
					bResetSw, eligDetailPrevMonth);
			detEdEligEndDt(
					eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthOtherEDM,
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),
					(NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER));
		}
		//BEGIN-BRGUS00161268-upadhyayulag-Override Benefit Amount
		if(overrideFields.get("Benefit Amount") != null){
			overrideField("Benefit Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		//END-BRGUS00161268
		//BEGIN-BRGUS00168047-upadhyayulag-MiChild Task/Reminder triggering healthy kids TOAs
		/**
		 * Begin BrgId:BRGUS00215118
		 * UserId: GANTAC
		 * Date: 01/30/2010
		 * MIChild Changes 
		 */
		if(aHmParams.get(DiAttributes.MI_CHILD_DEPLOY_SW) == null || (aHmParams.get(DiAttributes.MI_CHILD_DEPLOY_SW) != null && 
				!((String)aHmParams.get(DiAttributes.MI_CHILD_DEPLOY_SW)).equalsIgnoreCase("TRUE"))){
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED) 
				&& (eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.HKEM)
						|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_40)
						|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_43)
						|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_44))){
			triggerMiChildTaskReminder(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),userId,conn);
		}
		}
		//END-BRGUS00168047
		//BEGIN-BRGUS00146278-upadhyayulag-Changes for CR23169
		//Set Estimated eligibility end date for CDC & SDAC as well for Afghan/Iraqi alien types
		//determine EstimatedEligbilityEndDt
		//<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase("TP86")
				// beniwala - ASPEN00015918 - check on progCd TF now
				|| IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getProgramCd())
				/* beniwala - ASPEN00015918 - check on progCd TF now
				 * || eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.RAPC)*/
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.SSIT)
				/* beniwala - ASPEN00015918 - check on progCd TF now
				 * || eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.TP_01)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.TP_SDA)*//*
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.CDCS)*/){
			EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = null;
			if (eligDetailPrevMonth != null
					&& eligDetailPrevMonth.getEdEligNoticeReasonsCargo() != null
					&& eligDetailPrevMonth.getEdEligNoticeReasonsCargo().length > 0) {
				edEligNoticeReasonsCargo = eligDetailPrevMonth
						.getEdEligNoticeReasonsCargo()[0];
			}
			if (bFirstMthFlag == true) {
				detEstEligEndDt(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						((EligDetail) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_PROCCESSED))
								.getEdIndvEligibilityCargo(),
						edEligibilityCargoPrevMthFirstEDM,
						((EligDetail[]) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[0]
								.getEdCaseRecertDatesCargo(),
						(DcCaseProgramCargo) aHmParams
								.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO),
						(((EligDetail) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_PROCCESSED))
								.getEdEligFsBudgetCargo()),
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER),
						edEligNoticeReasonsCargo);
			} else {
				detEstEligEndDt(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						((EligDetail) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_PROCCESSED))
								.getEdIndvEligibilityCargo(),
						edEligibilityCargoPrevMthOtherEDM,
						((EligDetail[]) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[0]
								.getEdCaseRecertDatesCargo(),
						(DcCaseProgramCargo) aHmParams
								.get(IEdEligCodes.DC_CASE_PROGRAM_CARGO),
						(((EligDetail) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_PROCCESSED))
								.getEdEligFsBudgetCargo()),
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER),
						edEligNoticeReasonsCargo);
			}
		}
		//END-BRGUS00146278
		//Follwoing if is added by Sai on 4/18/2005 for CCB 199383
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)) {
			EdCommonUtil.setFSShortCertSw(eligDetailCurrEDM
					.getEdEligibilityCargo()[0]);
		}
		// Def BRGUS00049907
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEstimatedEligEndDt() == null) {
			DcCaseMiscInfoCargo dcCaseMiscInfoCargo = null;
			NFDataHandler nfDataHandler = (NFDataHandler) aHmParams
					.get(IEdEligCodes.NF_DATA_HANDLER);
			if (nfDataHandler.getIndivNonFinInfo().getDcCaseMiscInfoCargo() != null
					&& nfDataHandler.getIndivNonFinInfo()
							.getDcCaseMiscInfoCargo().length > 0) {
				dcCaseMiscInfoCargo = nfDataHandler.getIndivNonFinInfo()
						.getDcCaseMiscInfoCargo()[0];
				if (dcCaseMiscInfoCargo != null
						&& dcCaseMiscInfoCargo.getUnstableCircSw() == 'Y') {
					Timestamp unstableEligEndDt = null;
					if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getEligibilityBegDt() != null) {
						unstableEligEndDt = DateComparisons
								.getLastDayOfDate(DateComparisons.addMonths(
										eligDetailCurrEDM
												.getEdEligibilityCargo()[0]
												.getEligibilityBegDt(), 3));
					}
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setEstimatedEligEndDt(unstableEligEndDt);
				}
			}
		}
		//Added for defect 110323
		//Modified for defect 121815
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getEligibilityEndDt() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEligibilityBegDt() != null) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getEligibilityEndDt().before(
							eligDetailCurrEDM.getEdEligibilityCargo()[0]
									.getEligibilityBegDt())) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEligibilityBegDt(null);
				//BRGUS00129025 - Bhuvane - To set this only first time
				/*eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setDispositionEligBegDt(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getEdbcRunDt());*/
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEligibilityEndDt(null);
				if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_TERMINATED)) {
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
				}
				//ASPEN00057426 -  Parma - added check for TMA - Application error  when running eligibility -- TMA should have estimated elig end date for even terminated cases
				// commented to fix the ASPEN00057426 in diff way.
				/*if (!IEdEligCodes.TP_07.equalsIgnoreCase(eligDetailCurrEDM
						.getEdEligibilityCargo()[0].getTypeOfAssistanceCd())) { */
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setEstimatedEligEndDt(null);
				//}
			}
		}
		/*
		 * Begin BRGUS00101130 – kesavanr Setting cgstatus cd to 'DN' if
		 * cgstatuscd is 'TN',eligibility begin date is null and eligibility end
		 * date is null.
		 */
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
				.getTypeOfAssistanceCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().startsWith("G2")
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEligibilityBegDt() == null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEligibilityEndDt() == null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
						.equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED)) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
		}
		//End BRGUS00101130

		//Added for defect 122773
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_CC)) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
					.equals(IEdEligCodes.STATUS_CD_DENIED)) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEligibilityBegDt(null);
				//BRGUS00129025 - Bhuvane - To set this only first time
				/*eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setDispositionEligBegDt(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getEdbcRunDt());*/
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEligibilityEndDt(null);
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEstimatedEligEndDt(null);
			}
		}

		//BRGUS00109150 – kesavanr – Method to process scope and coverage during end process.
		//Process scope and coverage. BRGUS00083937
		processScopeAndCoverage(eligDetailCurrEDM, (EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),arrEligDetailOutput);

		//BEGIN-BRGUS00161268-upadhyayulag-Override group & individual level override fields
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_MC)){
			overrideField("Remaining Deductible Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("TMAP Premium Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("FTW Premium Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Patient Pay Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			//overrideField("Client Contribution Amount",edgOverrideDetailsCollection,eligDetailCurrEDM,
					//(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Deductible Met Date",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Scope",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Coverage",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)){
			overrideField("Funding Source",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("EFIP Indicator",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_DS)){
			overrideField("Group Funding Source",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		//END-BRGUS00161268
		
		//determine BenefitStatus
		// added if loop for CR LAst EDBC Run BRGUS00071439
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
				.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_TANF)
                //BRGUS00104064 – kesavanr – Applying last edbc run rule for CDC.
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)) {

			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd()
					.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				detBenefitStatus(
						(eligDetailCurrEDM.getEdEligibilityCargo())[0],	
						((EligDetail[]) aHmParams
								.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1]
								.getEdEligibilityCargo(),
            //BRGUS00104064 – kesavanr – Passing boolean variable which has the value of last edbc run check
		    //to determine benefit status.
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),false);
			} else {
				//BEGIN-BRGUS00187473-upadhyayulag-On a given day, if driver comes up with OP-Referral for a 'FAP' EDG,
				//then since the CG_STATUS_CD is 'AP', last EDBC run would come into effect. In this case, the benefit 
				//status is computed using the Authorized & Cancelled records for that EDG prior to that day with 
				//estimated eligibility end date being equal to the current record. For a 'TF' EDG, estimated eligibility 
				//end date check is not used. If no valid record found from the Auth & Cancelled records, then last 
				//authorized record from the same day would be used.
				int mLength = 0;
				int aLength = 0;
				EdEligibilityCargo[] aEdEligibilityCargoAuthCancel=null;
				EdEligibilityCargo[] aEdEligibilityCargoAuth=null;
				EdEligibilityCargo lastEdbcRunAuthCargo = null;
				EdEligibilityCargo unAuthCurrentCargo = eligDetailCurrEDM.getEdEligibilityCargo()[0];
				Timestamp tsMthEndEffBegDt = DateComparisons.getLastDayOfDate(unAuthCurrentCargo.getRecBeginDt());
				boolean bEDMLastAuthFound = false;
				if (((EligDetail[])aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2] != null && 
						((EligDetail[]) aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2].getEdEligibilityCargo()!=null
						) {
					aEdEligibilityCargoAuthCancel = ((EligDetail[]) aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2].getEdEligibilityCargo();
					mLength =aEdEligibilityCargoAuthCancel.length;																					
					for (int m = 0; m < mLength; m++) {
						if ((aEdEligibilityCargoAuthCancel[m].getCgStatusCd()
								.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED))
								&& aEdEligibilityCargoAuthCancel[m].getEdgNum() 
								== unAuthCurrentCargo
										.getEdgNum()) {
							if ((aEdEligibilityCargoAuthCancel[m].getRecBeginDt().before(tsMthEndEffBegDt) 
									|| aEdEligibilityCargoAuthCancel[m].getRecBeginDt().equals(tsMthEndEffBegDt))
								&& (((aEdEligibilityCargoAuthCancel[m].getRecEndDt() == null) 
									  || (aEdEligibilityCargoAuthCancel[m].getRecEndDt()
									  		.after(unAuthCurrentCargo.getRecBeginDt()) 
									  || aEdEligibilityCargoAuthCancel[m].getRecEndDt()
									  		.equals(unAuthCurrentCargo.getRecBeginDt()))))) {
								if(unAuthCurrentCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)){
									//If program is 'FS'
									if(aEdEligibilityCargoAuthCancel[m].getEstimatedEligEndDt() != null 
											&& unAuthCurrentCargo.getEstimatedEligEndDt() != null 
											&& aEdEligibilityCargoAuthCancel[m].getEstimatedEligEndDt().equals(
													unAuthCurrentCargo.getEstimatedEligEndDt())){
										bEDMLastAuthFound = true;
											lastEdbcRunAuthCargo = aEdEligibilityCargoAuthCancel[m];
										break;																														
									}											
								}else if(unAuthCurrentCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)){
									
									//nsandru----ASPEN00041603--Cannot Proceed with disposition on Certification-start
									if(aEdEligibilityCargoAuthCancel[m].getEstimatedEligEndDt() != null 
											&& unAuthCurrentCargo.getEstimatedEligEndDt() != null 
											&& aEdEligibilityCargoAuthCancel[m].getEstimatedEligEndDt().equals(
													unAuthCurrentCargo.getEstimatedEligEndDt())){
										bEDMLastAuthFound = true;
										lastEdbcRunAuthCargo = aEdEligibilityCargoAuthCancel[m];
										break;																														
									}else if(aEdEligibilityCargoAuthCancel[m].getEstimatedEligEndDt() == null ){//nsandru----ASPEN00041603--Cannot Proceed with disposition on Certification-end
										//If program is 'TF'
										bEDMLastAuthFound = true;
										lastEdbcRunAuthCargo = aEdEligibilityCargoAuthCancel[m];
										break;
									}
								}
							}											
						}
					}
				}
				//BEGIN-BRGUS00188091-upadhyayulag-For the same day run, do not use current day's 
				//authorized record to determine the benefit status
				if(bEDMLastAuthFound || (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC))){
					detBenefitStatus(
							(eligDetailCurrEDM.getEdEligibilityCargo())[0],
							((EligDetail[]) aHmParams
									.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2]
									.getEdEligibilityCargo(),
							(EgDataHandler) aHmParams
									.get(IEdEligCodes.EG_DATA_HANDLER),true);
				}else{
					detBenefitStatus(
							(eligDetailCurrEDM.getEdEligibilityCargo())[0],
							null,
					//BRGUS00104064 – kesavanr – Passing boolean variable which has the value of last edbc run check
				    //to determine benefit status.
							(EgDataHandler) aHmParams
									.get(IEdEligCodes.EG_DATA_HANDLER),true);
				}
				//END-BRGUS00188091
				//END-BRGUS00187473
			}
		} else {
			detBenefitStatus((eligDetailCurrEDM.getEdEligibilityCargo())[0],
					((EligDetail[]) aHmParams
							.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1]
							.getEdEligibilityCargo(), (EgDataHandler) aHmParams
             //BRGUS00104064 – kesavanr – Passing boolean variable which has the value of last edbc run check
		     //to determine benefit status.
							.get(IEdEligCodes.EG_DATA_HANDLER),false);
		}
		//Added method to override Supp & Recoup Sw to Y if BenenfitStatus is
		// certify for Prod Benefit Status to Reprocess change using code change
		// 113645
		detSuppAndRecoupSw((eligDetailCurrEDM.getEdEligibilityCargo())[0]);

		//determine EdgReprocessSwitch
		/*
		 * boolean bIsTanfEdgReprocessSwYes = false; for (int j = 0; j <
		 * eligDetailAllEDM.length; j++) { if (eligDetailAllEDM[j] != null) { if
		 * (eligDetailAllEDM[j].getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
		 * if(DateComparisons.getMM(eligDetailAllEDM[j].getEdEligibilityCargo()[0].getPaymentBegDt()) ==
		 * DateComparisons.getMM(eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentBegDt())) {
		 * if
		 * (eligDetailAllEDM[j].getEdEligibilityCargo()[0].getEdgReprocessSw() ==
		 * IEdEligCodes.EDG_REPROCESS_SW_YES) { bIsTanfEdgReprocessSwYes = true;
		 * break; } } } } }
		 *
		 * boolean bIsTanfEligRsltCdFail = false; for (int j = 0; j <
		 * eligDetailAllEDM.length; j++) { if (eligDetailAllEDM[j] != null) { if
		 * (eligDetailAllEDM[j].getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
		 * if(DateComparisons.getMM(eligDetailAllEDM[j].getEdEligibilityCargo()[0].getPaymentBegDt()) ==
		 * DateComparisons.getMM(eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentBegDt())) {
		 * if (eligDetailAllEDM[j].getEdEligibilityCargo()[0].getCgEligRsltCd() ==
		 * IEdEligCodes.ELIG_RSLT_CD_FAIL) { bIsTanfEligRsltCdFail = true;
		 * break; } } } } }
		 */
		if (!((EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER))
				.getModuleSw().equals(IEdEligCodes.MODULE_SWITCH_OPS)) {
			detEdgReprocessSw((eligDetailCurrEDM.getEdEligibilityCargo())[0],
					eligDetailCurrEDM.getEdIndvEligibilityCargo(),
					eligDetailAllEDM, (EgDataHandler) aHmParams
							.get(IEdEligCodes.EG_DATA_HANDLER));
		}

		//determine Action Code
		detActionCode((eligDetailCurrEDM.getEdEligibilityCargo())[0],
				(eligDetailCurrEDM.getEdEligNoticeReasonsCargo())[0]);

		//determine Failure Reason Code
		perform6020_015((eligDetailCurrEDM.getEdEligibilityCargo())[0],
				(eligDetailCurrEDM.getEdEligNoticeReasonsCargo())[0]);

		// Following ColaChanges code added for CCB:160712
		setIfColaNoticeReasonAvail((EgDataHandler) aHmParams
				.get(IEdEligCodes.EG_DATA_HANDLER), (eligDetailCurrEDM
				.getEdEligibilityCargo())[0], (eligDetailCurrEDM
				.getEdEligNoticeReasonsCargo())[0], (String) aHmParams
				.get(IEdEligCodes.SESSION_USER_ID));

		//Determine Special review dt
		if (bFirstMthFlag == true) {
			detSpecialReviewDtCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthFirstEDM);
		} else {
			detSpecialReviewDtCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					edEligibilityCargoPrevMthOtherEDM);
		}

		// CCB 203985 - EID adjustment.
		// For TP codes TP01, TP61 and TP08, compare individual’s 'EID_Elig_SW'
		// with current
		// processed records with the corresponding last authorized record. If
		// there is a change then set
		// 'EID_Change_Sw' in corresponding Ed_Eligibility record to yes.
		String tpCode = eligDetailCurrEDM.getEdEligibilityCargo()[0]
				.getTypeOfAssistanceCd();

		if (tpCode.equals(IEdEligCodes.TP_01)
				|| tpCode.equals(IEdEligCodes.TP_61)
				|| tpCode.equals(IEdEligCodes.TP_08)) {
			if (isIndvEIDSwChanged((EgDataHandler) aHmParams
					.get(IEdEligCodes.EG_DATA_HANDLER))) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEidChangeSw('Y');
			}
		}
		// Note the above code for EID Change sw should be executed before EDBC
		// Action code.
		/* Begin BRGUS00107001 – kesavanr
		 * Change in method signature to pass previous month EDM
		 */
		if (bFirstMthFlag == true) {
			detEDBCActionCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
				(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),edEligibilityCargoPrevMthFirstEDM);
		}
		else {
			detEDBCActionCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),edEligibilityCargoPrevMthOtherEDM);
		}
		
		// Star : ASPEN00055382 - Updated by Deepak Kumar for "Override is not working with no issuance change"
		if (IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL
				.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEdbcActionCd())) {
			if (overrideFields.get("EDG Status") != null) {
				String newEdgStatus = (String) overrideFields.get("EDG Status");
				if (newEdgStatus
						.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)
						&& DateComparisons.dateGTDateInTimestamp(
								eligDetailCurrEDM.getEdEligibilityCargo()[0]
										.getPaymentBegDt(), eligDetailCurrEDM
										.getEdEligibilityCargo()[0]
										.getEdbcRunDt())) {
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
				}
			}
		}
		// End : ASPEN00055382 - Updated by Deepak Kumar for "Override is not working with no issuance change"
		
		//End BRGUS00107001
		/* beniwala - ASPEN00017552 - determine EDBC Action Cd as No Issue Change for non PR , O/P Referral TANF/SNAP 
		 * edg and non individual is deceased and applicant not moved out of state and not voluntary withdrawn
		 */
		/* beniwala - ASPEN00029665  Now the recoupment rules are corrected in VCL for New Mexico, so, commenting this logic
		 * detNoIssuanceChangeEDBCActionCd(eligDetailCurrEDM.getEdEligibilityCargo()[0],eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0], 
				(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));*/

		//Setting EDBC Action Code EdEligSerServiceAuth and
		// EdIndvCdcServiceAuth
		detEDBCActionCdForSerCdc(eligDetailCurrEDM);

		//To adjust reprocess sw based on edbcactioncd being no op referral for
		// defect 175332 related MCI 8000_120 error
		// Modifed and added the ME for rebuild for defect 213091
		//PROGRAM_CD_MC added for defect #00216837 on 3/4/2005 by Sai
		//Added for Def# Looping if noop and Pending don't make it 'V'
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_TANF)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_ME)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_MC)
                //BRGUS00112283 – kesavanr – Prompt for rebuild edg if edbc action code is 54 for CDC program.
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_CDC)
				//Start : ASPEN00038636 - Updated by Deepak Kumar for "LIHEAP Issuing Multiple Benefits"
				
				//Start : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"		
				/*|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_SER)*/
				//End : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"		
				) {
			   //End : ASPEN00038636 - Updated by Deepak Kumar for "LIHEAP Issuing Multiple Benefits"
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdbcActionCd()
					.equals(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL))
			//Defect #BRGUS00034333
			//   !eligDetailCurrEDM.getEdEligibilityCargo()[0].getVerificationStatusCd().equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING))
			{
				/* Begin BRGUS00105497 – kesavanr
				 * If edgtraceid is different from reference edgtraceid for medicaid program
				 * don't set edgReprocessSw.
				 */
				if((eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FMA) ||
				   eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_ME) ||
				   eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_MC)) &&
				   eligDetailCurrEDM.getEdEligibilityCargo()[0].getReferenceEdgTraceId() > 0 &&
				   eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgTraceId() != eligDetailCurrEDM.getEdEligibilityCargo()[0].getReferenceEdgTraceId()) {
					//Don't do anything. Leave the reprocesssw as it is.
				}
				else {
						eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
				}
				//End BRGUS00105497
			}
		}
		//BEGIN-BRGUS00217525-upadhyayulag-Reset EDG Reprocess switch to 'Y' for medicaid 
		//'No Issuance Change' records when CG_SIZE is '0'
		if((eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA) 
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)) 
				&& (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgSize() == 0)){
			if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdbcActionCd().equals(
					IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL) 
					|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdbcActionCd().equals(
							IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT)){
				eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgReprocessSw(
						IEdEligCodes.EDG_REPROCESS_SW_YES);
			}
		}
		//END-BRGUS00217525
		
		//ASPEN00044702 - Added for TFS to check if a TANF closure exists - Added by Sai Suresh
		boolean bFailMode = false;
		if (requestMap.get(DIConstants.EDG_FAILURE_MODE) != null) {
			bFailMode = ((Boolean) requestMap.get(DIConstants.EDG_FAILURE_MODE)).booleanValue();
		}
		
		if(!bFailMode && IEdEligCodes.TP_01.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd())){
			
			if((EDGConstants.TERMINATED.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()) || EDGConstants.DENIED.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd())) 
			&& !IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdbcActionCd())){
				if(isRebuildClosureReason(eligDetailCurrEDM.getEdEligibilityCargo()[0], (EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER))){
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
				}
			}
		}	

		detPaymentAmt(
				(eligDetailCurrEDM.getEdEligibilityCargo())[0],
				((EligDetail[]) aHmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1]
						.getEdEligibilityCargo());

		EdIndvEligibilityCargo edIndvEligivilityCargoPrevMthFirstEDM = (EdIndvEligibilityCargo) aHmParams
				.get(IEdEligCodes.ED_INDV_PREV_MTH_FIRST_EDM);
		EdIndvEligibilityCargo[] arrEdIndvEligibilityCargoPrevMthOtherEDM = (EdIndvEligibilityCargo[]) aHmParams
				.get(IEdEligCodes.ED_INDV_PREV_MTH_OTHER_EDM);

		//BEGIN-BRGUS00161268-upadhyayulag-Override Individual level override fields
		overrideField("Participation Status",edgOverrideDetailsCollection,eligDetailCurrEDM,
				(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)){
			overrideField("Work Participation Status",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Work Participation Reason",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)
				|| eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_MC)){
			overrideField("Scope",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
			overrideField("Coverage",edgOverrideDetailsCollection,eligDetailCurrEDM,
					(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		}
		
		int iLength = 0;
		iLength = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
		int iIndvLength = 0;
		//EdIndvEligibilityCargo edIndvEligivilityCargoPrevMthOtherEDM = new
		// EdIndvEligibilityCargo();
		for (int j = 0; j < iLength; j++) {
			// Following line is commented for QA Defect 195765, since there
			// will be only one record with one IndvId per EDM
			// The declaration and allocation is done before for loop 10/18/2004
			//EdIndvEligibilityCargo edIndvEligivilityCargoPrevMthOtherEDM =
			// new EdIndvEligibilityCargo();

			//Reverted back to orginal for defect # 203361 - if prev month is
			// not there, the cargo has to be just allocated
			//EdIndvEligibilityCargo edIndvEligivilityCargoPrevMthOtherEDM =
			// new EdIndvEligibilityCargo();
			//Again Modified above line for QA : 195765 on 12/20/2004
			EdIndvEligibilityCargo edIndvEligivilityCargoPrevMthOtherEDM = null;
			if (bFirstMthFlag == false) {
				iIndvLength = 0;
				if (arrEdIndvEligibilityCargoPrevMthOtherEDM != null) {
					iIndvLength = arrEdIndvEligibilityCargoPrevMthOtherEDM.length;
				}
				for (int m = 0; m < iIndvLength; m++) {
					if (eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
							.getIndvId() == arrEdIndvEligibilityCargoPrevMthOtherEDM[m]
							.getIndvId()) {
						edIndvEligivilityCargoPrevMthOtherEDM = arrEdIndvEligibilityCargoPrevMthOtherEDM[m];
					}
				}
			}
			//Modified for QA Defect 195765, if new Indvidual is found then
			// just allocate memeory, where the refering functions uses
			// object.method .. 12/20/2004
			if (edIndvEligivilityCargoPrevMthOtherEDM == null) {
				edIndvEligivilityCargoPrevMthOtherEDM = new EdIndvEligibilityCargo();
			}

			//determine EdIndvEligibility EligRsltCd
			detIndvEligRsltCd((eligDetailCurrEDM.getEdEligibilityCargo())[0],
					(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]);

			// Reset Elig Result Code for individual
			//BEGIN-BRGUS00246315-upadhyayulag-Skip resetting the group indicator because of 
			//FIN failure when override is present
			if ((eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_CDC)) 
					&& !(eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgOverrideSw() == 'Y')) {
				detIndvGroupInd(eligDetailCurrEDM, (eligDetailCurrEDM
						.getEdIndvEligibilityCargo())[j]);
			}
			//END-BRGUS00246315

			//determine EdIndvEligibilityBegDt
			if (bFirstMthFlag == true) {
				detIndvEligBegDt(
						(eligDetailCurrEDM.getEdEligibilityCargo())[0],
						(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
						edIndvEligivilityCargoPrevMthFirstEDM,
						edEligibilityCargoPrevMthFirstEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER));
			} else {
				detIndvEligBegDt(
						(eligDetailCurrEDM.getEdEligibilityCargo())[0],
						(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
						edIndvEligivilityCargoPrevMthOtherEDM,
						edEligibilityCargoPrevMthOtherEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER));
			}

			//determine EdIndvEligibilityEndDt
			if (bFirstMthFlag == true) {
				detIndvEligEndDt(
						(eligDetailCurrEDM.getEdEligibilityCargo())[0],
						(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
						edIndvEligivilityCargoPrevMthFirstEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER));
			} else {
				detIndvEligEndDt(
						(eligDetailCurrEDM.getEdEligibilityCargo())[0],
						(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
						edIndvEligivilityCargoPrevMthOtherEDM,
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER),
						(NFDataHandler) aHmParams
								.get(IEdEligCodes.NF_DATA_HANDLER));
			}

			//Added for defect 110323
			if ((eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
					.getEligibilityEndDt() != null
					&& (eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
							.getEligibilityBegDt() != null) {
				if ((eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
						.getEligibilityEndDt()
						.before(
								(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
										.getEligibilityBegDt())) {
					(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
							.setEligibilityBegDt(null);
					(eligDetailCurrEDM.getEdIndvEligibilityCargo())[j]
							.setEligibilityEndDt(null);
				}
			}

			//Modified for defect 128210
			/*
			 * if (bFirstMthFlag == true) {
			 * detSsnReqStatusCd((eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
			 * edIndvEligivilityCargoPrevMthFirstEDM); } else {
			 * detSsnReqStatusCd((eligDetailCurrEDM.getEdIndvEligibilityCargo())[j],
			 * edIndvEligivilityCargoPrevMthOtherEDM); }
			 */

			//Added for defect 122773
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_CC)) {
				if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED)) {
					eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
							.setEligibilityBegDt(null);
					eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
							.setEligibilityEndDt(null);
				}
			}

			//determine EdIndvEligibility.PartStatusCd
			//						detIndvPartStatusCd((arrEligDetail[i].getEdIndvEligibilityCargo())[j]);

			//determine EdIndvEligibility.GroupInd
			//						detIndvGroupInd((arrEligDetail[i].getEdIndvEligibilityCargo())[j]);
		}
		//Added for defect 86792
		//Modified for defect 166259
		if (bResetSw == true) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_FMA)) {
				resetEdEligBegDt(eligDetailCurrEDM.getEdEligibilityCargo()[0],
						eligDetailCurrEDM.getEdIndvEligibilityCargo());
			}
		}
		//determine CGSize and EdgSize
		//					detGroupSize(arrEligDetail[i].getEdIndvEligibilityCargo(),
		// arrEligDetail[i].getEdEligibilityCargo()[0]);

		/*
		 * boolean bReComputeEdgReprocessSw = false; if (i != 0) { if
		 * (edEligPrevMonthForOtherMonth.getEdgReprocessSw().equals(IEdEligCodes.EDG_REPROCESS_SW_YES)) {
		 * arrEligDetail[i].getEdEligibilityCargo())[0].setEdgReprocessSw(edEligPrevMonthForOtherMonth.getEdgReprocessSw()); }
		 * else { bReComputeEdgReprocessSw = true; } }
		 *
		 * if ((i == 0) || bReComputeEdgReprocessSw) { if
		 * (arrEligDetail[i].getEdEligibilityCargo())[0].getEdgReprocessSw().equals(IEdEligCodes.EDG_REPROCESS_SW_YES)) {
		 * if
		 * (arrEligDetail[i].getEdEligibilityCargo())[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF) &&
		 * (arrEligDetail[i].getEdEligibilityCargo())[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01) ||
		 * arrEligDetail[i].getEdEligibilityCargo())[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_61))) {
		 *  } }
		 */

		if (!((EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER))
				.getModuleSw().equals(IEdEligCodes.MODULE_SWITCH_OPS)) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
			//Setting current eligibility indicator for EdEligSerServiceAuth
			// and EdIndvCdcServiceAuth
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_SER)
					&& eligDetailCurrEDM.getEdEligSerServiceAuth() != null) {
				for (int k = 0; k < eligDetailCurrEDM.getEdEligSerServiceAuth().length; k++) {
					eligDetailCurrEDM.getEdEligSerServiceAuth()[k]
							.setCurEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
				}
			}
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_CDC)) {
				if (eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null) {
					for (int k = 0; k < eligDetailCurrEDM
							.getEdIndvCdcServiceAuth().length; k++) {
						eligDetailCurrEDM.getEdIndvCdcServiceAuth()[k]
								.setCurEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
					}
				}
			}

			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_DS)) {
				if (eligDetailCurrEDM.getEdIndvDssServiceAuthCargo() != null
						&& eligDetailCurrEDM.getEdIndvDssServiceAuthCargo().length > 0) {
					for (int k = 0; k < eligDetailCurrEDM
							.getEdIndvDssServiceAuthCargo().length; k++) {
						eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[k]
								.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
					}
				}
			}

		}

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getFsExpeditedSw() == IEdEligCodes.YES
					&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getRecEndDt() == null) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setFsExpeditedSw(IEdEligCodes.NO);
			}
		}

		//Added for Tanf PFP changes
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getActivityType()
				.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_TANF)) {
				if (((EgDataHandler) aHmParams
						.get(IEdEligCodes.EG_DATA_HANDLER))
						.getEligDetailLastAuthForTanfPFP() != null
						&& ((EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER))
								.getEligDetailLastAuthForTanfPFP()
								.getEdEligibilityCargo() != null) {
					//eligDetailCurrEDM.getEdEligibilityCargo()[0].setAppAfterPfpDnSw(IEdEligCodes.YES);
				}
			}
		}

		detEdIndvServDtlsEndProcess(eligDetailCurrEDM);

		IServiceDetailWriter iServiceDetailWriter = ServiceDetailWriter
				.getInstance(null);

		/*
		 * EGDataHandler is being passed to
		 * iServiceDetailWriter.detIndvServiceDetailStatus as per defect 154888.
		 * Change made by Simran on 4/23/2004.
		 */
		iServiceDetailWriter
				.detIndvServiceDetailStatus(
						eligDetailCurrEDM.getEdEligibilityCargo()[0],
						eligDetailCurrEDM.getEdIndvEligibilityCargo(),
						(EdIndvServiceDtlsCargo[]) ((EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER))
								.getAlEdIndvServiceDtls()
								.toArray(
										new EdIndvServiceDtlsCargo[((EgDataHandler) aHmParams
												.get(IEdEligCodes.EG_DATA_HANDLER))
												.getAlEdIndvServiceDtls()
												.size()]),
						(EgDataHandler) aHmParams
								.get(IEdEligCodes.EG_DATA_HANDLER));

		//			detEdLtcEligDatesEndProcess((EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));

		// Added for CCB : 127585
		adjustEligBegDateForMM(eligDetailCurrEDM);

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getEligibilityEndDt() == null) {
			adjustEligEndDateForMM(eligDetailCurrEDM);
		}
		//Def BRGUS00049907 && BRGUS00052815
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEstimatedEligEndDt() == null) {
			DcCaseMiscInfoCargo dcCaseMiscInfoCargo = null;
			NFDataHandler nfDataHandler = (NFDataHandler) aHmParams
					.get(IEdEligCodes.NF_DATA_HANDLER);
			if (nfDataHandler.getIndivNonFinInfo().getDcCaseMiscInfoCargo() != null
					&& nfDataHandler.getIndivNonFinInfo()
							.getDcCaseMiscInfoCargo().length > 0) {
				dcCaseMiscInfoCargo = nfDataHandler.getIndivNonFinInfo()
						.getDcCaseMiscInfoCargo()[0];
				if (dcCaseMiscInfoCargo != null
						&& dcCaseMiscInfoCargo.getUnstableCircSw() == 'Y'
						&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
								.getEligibilityBegDt() != null) {
					Timestamp unstableEligEndDt = null;
					if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getEligibilityBegDt() != null) {
						unstableEligEndDt = DateComparisons
								.getLastDayOfDate(DateComparisons.addMonths(
										eligDetailCurrEDM
												.getEdEligibilityCargo()[0]
												.getEligibilityBegDt(), 2));
					}
					eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.setEstimatedEligEndDt(unstableEligEndDt);
				}
			}
		}
		//Added for Def BRGUS00037320
		adjustEligEndDateForSingleDeseasedIndv(eligDetailCurrEDM);

		/*
		 * if
		 * (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF) ) { //
		 * Added the following code for defect 232995 if
		 * (eligDetailCurrEDM.getEdEligibilityCargo()[0].getVerificationStatusCd().equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) { //
		 * Column ForfeitMthDt Deleted //&&
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].getForfeitMthDt() !=
		 * null) {
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APP_FF_MTH_PENDING); } //
		 * Commented for defect 232995 and added corresponding code in
		 * detcgeligrsltcd() logic //
		 * performForfeitAdjustments(eligDetailCurrEDM); }
		 */
		if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo() != null) {
			sortFailureReasonCode(eligDetailCurrEDM
					.getEdEligNoticeReasonsCargo());
		}

		//			Modified vide defect BRGUS00044165
		Timestamp cdEligBegDt = null;
		boolean cdEligBegDtFound = false;

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
				.equalsIgnoreCase("CD")
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
						.equals("AP") && eligDetailPrevMonth == null) {
			EdIndvCdcServiceAuthCargo[] edIndvCdcServiceAuthCargo = eligDetailCurrEDM
					.getEdIndvCdcServiceAuth();
			int cdcLength = 0;
			if (edIndvCdcServiceAuthCargo != null) {
				cdcLength = edIndvCdcServiceAuthCargo.length;
			}
			String eligCategoryCd = null;
			for (int p = 0; p < cdcLength; p++) {
				if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getEdgTraceId() == edIndvCdcServiceAuthCargo[p]
						.getEdgTraceId()) {
					eligCategoryCd = edIndvCdcServiceAuthCargo[p]
							.getEligCategoryCd();
					if (eligCategoryCd != null
							&& (eligCategoryCd.equalsIgnoreCase("16")
									|| eligCategoryCd.equalsIgnoreCase("18")
									|| eligCategoryCd.equalsIgnoreCase("21") || eligCategoryCd
									.equalsIgnoreCase("13"))) {
						cdEligBegDt = eligDetailCurrEDM.getEdEligibilityCargo()[0]
								.getPaymentBegDt();
						cdEligBegDtFound = true;
					} 
					/*
					 * BRGUS00184635 -singhh
					 * In non foster CDC scenario the eligibility begin date is 
					 * the payment begin date.					 
					 */
					//else {
					//		cdEligBegDt = eligDetailCurrEDM.getEdEligibilityCargo()[0]
					//								.getApplicationDt();
					//		cdEligBegDtFound = true;
					//	}
					//end BRGUS00184635
				}
			}

		}

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equals(
				"CD")
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
						.equals("AP")) {
			if (eligDetailPrevCD != null
					&& eligDetailPrevCD.getEdEligibilityCargo() != null
					&& eligDetailPrevCD.getEdEligibilityCargo().length > 0) {
				if (eligDetailPrevCD.getEdEligibilityCargo()[0].getCgStatusCd()
						.equalsIgnoreCase("DN")) {
					cdEligBegDt = eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getPaymentBegDt();
					cdEligBegDtFound = true;
				} else if (eligDetailPrevCD != null
						&& eligDetailPrevCD.getEdEligibilityCargo()[0]
								.getCgStatusCd().equalsIgnoreCase("AP")) {
					cdEligBegDt = eligDetailPrevCD.getEdEligibilityCargo()[0]
							.getEligibilityBegDt();
					cdEligBegDtFound = true;
				}
			}

		}

		if (cdEligBegDtFound) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
					.equals("CD")) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setEligibilityBegDt(cdEligBegDt);
				if (eligDetailCurrEDM.getEdIndvEligibilityCargo().length > 0) {
					for (int j = 0; j < eligDetailCurrEDM
							.getEdIndvEligibilityCargo().length; j++) {
						if (eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
								.getEligRsltCd() != null
								&& eligDetailCurrEDM
										.getEdIndvEligibilityCargo()[j]
										.getEligRsltCd().equalsIgnoreCase("PS")
								&& eligDetailCurrEDM
										.getEdIndvEligibilityCargo()[j]
										.getPartStatusCd() != null
								&& eligDetailCurrEDM
										.getEdIndvEligibilityCargo()[j]
										.getPartStatusCd().equalsIgnoreCase(
												"EC")) {

							eligDetailCurrEDM.getEdIndvEligibilityCargo()[j]
									.setEligibilityBegDt(cdEligBegDt);
						}
					}
				}
			}
		}

		//STFS changes code moved at the beginning
		/*
		 * EdIndvLtcPendingReasonCargo[] edIndvLtcPendingReasonCargo =
		 * eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo(); int
		 * otherPendLength = 0; if(edIndvLtcPendingReasonCargo != null) {
		 * otherPendLength = edIndvLtcPendingReasonCargo.length; }
		 * if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("TF") &&
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].getStfsPotentialEligSw() ==
		 * 'Y' &&
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].getNfEligRsltCd().equalsIgnoreCase("PE")) {
		 * for(int i =0; i < otherPendLength; i++) {
		 * if(eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i].getPendingReasonCd() !=
		 * null &&
		 * eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i].getPendingReasonCd().equalsIgnoreCase("1027")) {
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].setNfEligRsltCd("PS");
		 * eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i].setDeleteSw('Y'); } } }
		 */
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
				.equalsIgnoreCase("TF")) {
			boolean setELE60 = true;
			for (int i = 0; i < arrEligDetailOutput.length; i++) {
				if (arrEligDetailOutput[i] != null
						&& arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getProgramCd().equalsIgnoreCase("TF")) {
					if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getStfsPotentialEligSw() == IEdEligCodes.CHAR_INIT_SPACE
							|| arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getStfsPotentialEligSw() == 'Y') {
						setELE60 = false;
					}
				}
			}
			if (setELE60
					&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getNfEligRsltCd().equalsIgnoreCase("PE")) {
				for (int i = 0; i < otherPendLength; i++) {
					if (eligDetailCurrEDM.getEdIndvLtcPendingReasonCargo()[i]
							.getPendingReasonCd() != null
							&& eligDetailCurrEDM
									.getEdIndvLtcPendingReasonCargo()[i]
									.getPendingReasonCd().equalsIgnoreCase(
											"1027")) {
						InTriggerTableCargo inTriggerTableCargo = new InTriggerTableCargo();
						inTriggerTableCargo.setCaseNum(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getCaseNum());
						inTriggerTableCargo.setEdgNum(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getEdgNum());
						inTriggerTableCargo.setKeySeqNum(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getEdgTraceId());
						inTriggerTableCargo.setProgTfSw('Y');
						inTriggerTableCargo.setCgStatusCd(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getCgStatusCd());
						inTriggerTableCargo.setPaymentBegDt(eligDetailCurrEDM
								.getEdEligibilityCargo()[0].getPaymentBegDt());
						inTriggerTableCargo.setTriggerCd("ELE60");
						try {
							INTriggerBO inTriggerBO = null;
							// BRGUS00074899 added to avoid conn null crash
							if (conn != null) {
								inTriggerBO = new INTriggerBO(conn);
							} else {
								inTriggerBO = new INTriggerBO();
							}
							inTriggerBO.createTrigger(inTriggerTableCargo);
						} catch (Exception e) {
							throw new EDBCException(
									EDBCException.MAJOR,
									"EdUtil",
									"insertInterfaceTrigger:error while inserting new interface records to the database",
									e.getMessage());
						}
					}
				}
			}
		}
		//end defect BRGUS00044165
		//BEGIN-BRGUS00241368-upadhyayulag-Modify notice reason in case of AMP denial/termination
		EdDriverHelper.processAMPDenialTermination((EgDataHandler)aHmParams.get(IEdEligCodes.EG_DATA_HANDLER));
		//END-BRGUS00241368

		/* Begin BRGUS00110809 – kesavanr
		 * Determing end process for CDC to set DPStatus,AuthHoursStatus,EdbcActionCd,BeginDate and EndDate
		 */
		//Determining CDC End Process(
		try {
			if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)) {
				//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update				
				//BEGIN-BRGUS00161268-upadhyayulag-Change the method signature to send edgOverrideDetailsCollection
				EdDriverHelper.detCDCServiceEndProcess(eligDetailCurrEDM.getEdIndvCdcServiceAuth(),eligDetailPrevMonth,
						(EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER),edgOverrideDetailsCollection, 
						userInfo,isOnlineEbdcProcess,isAuthorizedRecSpecialist);
				//END-edgOverrideDetailsCollection
				//END-BRGUS00205536
			}
		}
		catch(Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"deteremineEDDetails", ex);
		}
		//End BRGUS00110809

		/* beniwala - ASPEN00022170 - tasks are now created after EDBC process is completed for all the months
		 * // Begin - beniwala - ASPEN00021700 - create NMW/IRU tasks for the individuals 
		if(eligDetailCurrEDM != null) {
			createEDMTasks(eligDetailCurrEDM, aHmParams, conn);
		}		
		// End - beniwala - ASPEN00021700
*/		
		/*
		 * Begin - beniwala - ASPEN00028805 - create CO trigger for conciliation form
		 */
		/* create CO trigger after all months are done
		 * createCOTriggerForConciliation(eligDetailCurrEDM, aHmParams, conn);*/
		// End - beniwala - ASPEN00028805
		
		//ASPEN00036737 - Decrement tanf counter if EDG is not approved - Added by Sai Suresh
		if(!IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd())){
			if(null != aHmParams.get(IEdEligCodes.KEY_TANFCOUNTER_MAP) && null != aHmParams.get(IEdEligCodes.KEY_TANFCOUNTERINCSW_MAP)){
				Map tanfCounterIncSwMap = (Map)aHmParams.get(IEdEligCodes.KEY_TANFCOUNTERINCSW_MAP);
				Set keySet = tanfCounterIncSwMap.keySet();
				Iterator keySetIter = keySet.iterator();
				Map tanfCounterMap = (Map)aHmParams.get(IEdEligCodes.KEY_TANFCOUNTER_MAP);
				while(keySetIter.hasNext()){
					Object key = keySetIter.next();
					Boolean tanfCounterIncSw = (Boolean)tanfCounterIncSwMap.get(key);
					if(tanfCounterIncSw){
						long unAuthFedCounter = (Long)tanfCounterMap.get(key);
						tanfCounterMap.put(key,unAuthFedCounter-1);
					}
				}
			}
		}
		
		return eligDetailCurrEDM;
		//		} catch (EDBCException edbcex) {
		//			throw edbcex;
		//		} catch (Exception e) {
		//			throw new EDBCException(EDBCException.MAJOR ,"EdUtil",
		// "determineEdDetails", e);
		//	 	}
	}
	

	/**
	 * Determines the Estimated Eligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            contains EdEligibilityCargo of the current month
	 * @param aEdIndvEligibilityCargo
	 *            contains EdIndvEligibilityCargo array of current month
	 * @param aEdEligibilityCargoPrevMth
	 *            contains EdEligibilityCargo of previous month
	 * @param aEdCaseRecertDates
	 *            contains EdCaseRecertDatesCargo
	 * @param aDcCaseProgramCargo
	 *            contains DcCaseProgramCargo
	 * @param aEdEligFsBudget
	 *            contains EdEligFsBudgetCargo[]
	 * @param egDataHandler
	 *            contains EgDataHandler
	 * @param nfDataHandler
	 *            contains NFDataHandler
	 * @param edEligNoticeReasonsCargo
	 *            contains the notice reasons of the current record
	 * @throws EDBCException
	 */
	
	public void detEstEligEndDt(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdCaseRecertDatesCargo[] aEdCaseRecertDates,
			DcCaseProgramCargo aDcCaseProgramCargo,
			EdEligFsBudgetCargo[] aEdEligFsBudget, EgDataHandler egDataHandler,
			NFDataHandler nfDataHandler,
			EdEligNoticeReasonsCargo edEligNoticeReasonsCargo)
			throws EDBCException {
		Timestamp tsEstimatedEligEndDt = null;		
		try {
			//<BRGUS00248390><kucherlapatis><1/12/2011>
			//<Java Fix To Extend The TMA Certification Period For 12 Months>
			//<BRGUS00264309><kucherlapatis><2/7/2011>
			//<Java Fix To Check For Eligibility Begin Date Only On Approved Records>
			// beniwala - ASPEN00017459 - fix findbugs issue
			if(IEdEligCodes.TP_07.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) && 
					aEdEligibilityCargo.getEstimatedEligEndDt() != null && 
					aEdEligibilityCargo.getEligibilityBegDt() != null)  {
				// beniwala - ASPEN00017459 - fix findbugs issue				
				if(!(egDataHandler.getEligDetailLastAuthPrevEDM() != null
								&& egDataHandler.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt() != null
								&& ("AP".equalsIgnoreCase(egDataHandler
										.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getCgStatusCd())										
										&& egDataHandler
										.getEligDetailLastAuthPrevEDM() != null && egDataHandler
										.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt().after(
												aEdEligibilityCargo
														.getEligibilityBegDt())))){
				//ASPEN00057426 -  Parma - Application error  when running eligibility -- TMA should have estimated end date for even terminated cases
				// uncommented to fix the ASPEN00057426 in diff way.	
					aEdEligibilityCargo.setEstimatedEligEndDt(null);  
				}
			}
			
			
			if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
				//Following line modified for QA Defect 00195765
				//if (aEdEligibilityCargo.getEstimatedEligEndDt() == null ||
				// aEdEligibilityCargo.getEstimatedEligEndDt().equals("")) {
				if (aEdEligibilityCargo.getEstimatedEligEndDt() == null) {
					//Added & Modifed for defect 104597
					Timestamp tsPrevMthEstEligEndDt = detPrevMthEstEligEndDt(
							aEdEligibilityCargoPrevMth, aEdEligibilityCargo);
					//						Added for CMA Changes
					Timestamp tsPrevMthCertbegDt = detPrevMthCertBegDt(
							aEdEligibilityCargoPrevMth, aEdEligibilityCargo);	
					/*
					 * Begin - beniwala - ASPEN00036467 - if there is no previousMonth, 
					 * fetch previous Month from V records and fetch estimatedEligEndDt & certBegDt from V record
					 */
					if(tsPrevMthEstEligEndDt == null) {
						EdEligibilityCargo edEligPrevMthVrecord = null;
						if(egDataHandler != null) {
							edEligPrevMthVrecord = getPreviousVRecord(egDataHandler.getEdEligibilityCargoVrecords(), aEdEligibilityCargo);
						}	
						if(edEligPrevMthVrecord != null) {
							aEdEligibilityCargoPrevMth = edEligPrevMthVrecord;
							tsPrevMthEstEligEndDt = detPrevMthEstEligEndDt(
									edEligPrevMthVrecord, aEdEligibilityCargo);
							tsPrevMthCertbegDt = detPrevMthCertBegDt(
									edEligPrevMthVrecord, aEdEligibilityCargo);	
						}
					}
					// End - beniwala - ASPEN00036467				
					// beniwala - ASPEN00017459 - fix findbugs issue
					// beniwala - ASPEN00042439 - MAPS should behave as TP40
					if (tsPrevMthEstEligEndDt != null
							&& !(IEdEligCodes.TP_02.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_40.equalsIgnoreCase(aEdEligibilityCargo
									.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MAPS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))) {
						//if
						// (aEdEligibilityCargoPrevMth.getEstimatedEligEndDt()
						// != null &&
						// !(aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_02)
						// ||
						// aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_40)))
						// {
						//BEGIN-BRGUS00146278-upadhyayulag-Don't nullify the estimated elig end date for
						//FIP and CDC if the SP review due date is populated
						/* beniwala - ASPEN00015918 - efipEligSw not used in NM
						 * if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01) &&
								(aEdEligibilityCargo.getEfipEligSw() == ' ' ||
										aEdEligibilityCargo.getEfipEligSw() == 'N')
										aEdEligibilityCargo.getSpReviewDt() == null) {
							aEdEligibilityCargo.setEstimatedEligEndDt(null);
							aEdEligibilityCargo.setEstimatedEligEndDt(tsPrevMthEstEligEndDt);
							aEdEligibilityCargo.setSpReviewDt(tsPrevMthEstEligEndDt);
						} else if(aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.CDCS) &&
									aEdEligibilityCargo.getSpReviewDt() == null){
								//aEdEligibilityCargo.setEstimatedEligEndDt(null);
							aEdEligibilityCargo.setEstimatedEligEndDt(tsPrevMthEstEligEndDt);
							aEdEligibilityCargo.setSpReviewDt(tsPrevMthEstEligEndDt);
						//END-BRGUS00146278
						}else if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.CDCS) ||
									aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_SDA)){
							aEdEligibilityCargo.setEstimatedEligEndDt(tsPrevMthEstEligEndDt);
							aEdEligibilityCargo.setSpReviewDt(tsPrevMthEstEligEndDt);
						}else{*/
						
						/* Begin - beniwala - ASPEN00034743 - determine if previous month has 24-month cert period and current month
						 * is first month after SemiAnnualReviewDt, then set EstimatedEligEndDt as new Dt , else, copy from
						 * previous month
						 */
						// beniwala - ASPEN00049529
						Timestamp newEstimatedEligEndDt = det12MonthCertPeriod(aEdEligibilityCargo, aEdEligFsBudget, nfDataHandler, 
								egDataHandler, aEdIndvEligibilityCargo, aEdEligibilityCargoPrevMth, null, aEdCaseRecertDates);
						if(newEstimatedEligEndDt == null) {
							aEdEligibilityCargo
							.setEstimatedEligEndDt(tsPrevMthEstEligEndDt);
							/*if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01)){
							aEdEligibilityCargo.setSpReviewDt(tsPrevMthEstEligEndDt);
						}*/
						aEdEligibilityCargo
								.setMidCertEndDt(aEdEligibilityCargoPrevMth
										.getMidCertEndDt());
						} else {
							aEdEligibilityCargo
							.setEstimatedEligEndDt(newEstimatedEligEndDt);
						}
						//	copy midCertificationShortenSw from 
						aEdEligibilityCargo.setMidCertificationShortenSw(aEdEligibilityCargoPrevMth.getMidCertificationShortenSw());	
						// End - beniwala - ASPEN00034743
							aEdEligibilityCargo
									.setCertEndDt(aEdEligibilityCargoPrevMth
											.getCertEndDt());
							aEdEligibilityCargo
									.setCertBegDt(tsPrevMthCertbegDt);
							//new Code
							// beniwala - ASPEN00017459 - fix findbugs issue
							if (IEdEligCodes.PROGRAM_CD_FMA.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
									&& "P0".equalsIgnoreCase(aEdEligibilityCargo.getPriorMedicalCd()) == false) {
								aEdEligibilityCargo.setCertEndDt(null);
								aEdEligibilityCargo.setCertBegDt(null);
							}

							aEdEligibilityCargo
									.setDispositionCertBegDt(aEdEligibilityCargo
											.getEdbcRunDt());
						// beniwala - ASPEN00015918
						// }
					} else {
						//added approved check based on defect 98977
						// beniwala - ASPEN00017459 - fix findbugs issue
						if (IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
							tsEstimatedEligEndDt = perform6010_080(
									aEdEligibilityCargo,
									aEdIndvEligibilityCargo,
									aEdCaseRecertDates, aDcCaseProgramCargo,
									aEdEligFsBudget, egDataHandler,
									nfDataHandler, aEdEligibilityCargoPrevMth,
									edEligNoticeReasonsCargo);
							// Modified following for Defect #186799 ,
							//BEGIN-BRGUS00146278-upadhyayulag-Override the results for FAP for Afghan/Iraqi
							//alien types. Also, change the cert end date to the newly calculated estimated
							//eligibility end date
//							<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
							/*if (aEdEligibilityCargo.getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_FS)){
								Timestamp alienAfghanIraqiEstEligEndDt = detEstEligEndDtCertifiedGroupAlienAfghanIraqi
								(aEdEligibilityCargo,aEdIndvEligibilityCargo,nfDataHandler,egDataHandler);
								if(alienAfghanIraqiEstEligEndDt != null){
									tsEstimatedEligEndDt = alienAfghanIraqiEstEligEndDt;
									aEdEligibilityCargo.setEstimatedEligEndDt(tsEstimatedEligEndDt);
									aEdEligibilityCargo.setCertEndDt(tsEstimatedEligEndDt);
								}
							}*/
							//END-BRGUS00146278
							if (tsEstimatedEligEndDt != null) {
								// beniwala - ASPEN00017459 - fix findbugs issue
								if (IEdEligCodes.TP_86.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
									aEdEligibilityCargo
											.setEstimatedEligEndDt(tsEstimatedEligEndDt);
								} else {
									tsEstimatedEligEndDt = DateComparisons
											.getLastDayOfDate(tsEstimatedEligEndDt);
									aEdEligibilityCargo
											.setEstimatedEligEndDt(tsEstimatedEligEndDt);
									//BEGIN-BRGUS00146278-upadhyayulag-For FIP/SDA/CDC, set SP Review Date
									//as estimated eligibility end date
//									<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
									/*if((aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase
											(IEdEligCodes.TP_01) 
											&& aEdEligibilityCargo.getEfipEligSw() != 'Y') ||
											aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase
											(IEdEligCodes.TP_SDA) ||
											aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase
											(IEdEligCodes.CDCS)){
										aEdEligibilityCargo.setSpReviewDt(tsEstimatedEligEndDt);
									}*/
									//END-BRGUS00146278
								}
							}
						}
					}
				} else {
					//Added else part for defect 91102
					//Added Tp40 part for defect 90863
					//added approved check based on defect 98977
					// beniwala - ASPEN00017459 - fix findbugs issue
					if (IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
						// beniwala - ASPEN00042439 - MAPS should behave like TP40
						if (IEdEligCodes.TP_02.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
                            //Begin BRGUS00107997 – kesavanr – Determine esteligenddt for RAPC even if
							//EDG carry forwards.
							|| IEdEligCodes.RAPC.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							|| IEdEligCodes.TP_40.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							|| IEdEligCodes.TP_MA_MAPS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
							tsEstimatedEligEndDt = perform6010_080(
									aEdEligibilityCargo,
									aEdIndvEligibilityCargo,
									aEdCaseRecertDates, aDcCaseProgramCargo,
									aEdEligFsBudget, egDataHandler,
									nfDataHandler, aEdEligibilityCargoPrevMth,
									edEligNoticeReasonsCargo);
							if (tsEstimatedEligEndDt != null) {
								tsEstimatedEligEndDt = DateComparisons
										.getLastDayOfDate(tsEstimatedEligEndDt);
								aEdEligibilityCargo
										.setEstimatedEligEndDt(tsEstimatedEligEndDt);
							}
						}
						// beniwala - ASPEN00015918 - calculation of EstimatedEligEndDt for TP01
						// is similar to FS for New Mexico
						//	defect BRGUS00031758
						if ((IEdEligCodes.TP_01.equalsIgnoreCase(
								aEdEligibilityCargo.getTypeOfAssistanceCd()) || IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(
								aEdEligibilityCargo.getProgramCd()))
								&&
								// BRGUS00066881 Benefit Period will be decided
								// for every ACTIVITY_TYPE except Intake and
								// Complete Review
								// beniwala - ASPEN00017459 - fix findbugs issue
								(!IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(aEdEligibilityCargo.getActivityType()) 
										&& !IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(aEdEligibilityCargo
										.getActivityType()))) {
							/*
							 * Defect ID : BRGUS00076458 Added By : phadtarep
							 * Date : 02/26/2008 Change : The FAP should
							 * estimate the Benefit period for each month unless
							 * Previous month in the current run is shortened.
							 *
							 */
							/* beniwala - ASPEN00034743 - there is not MidCert shortening logic in New Mexico
							 * if (aEdEligibilityCargo.getMidCertEndDt() != null) {//FAP
																				// was
																				// initially
																				// certified
																				// with
																				// 24
																				// months
								Timestamp tsPrevMthEstEligEndDt = detPrevMthEstEligEndDt(
										aEdEligibilityCargoPrevMth,
										aEdEligibilityCargo);
								if (aEdEligibilityCargoPrevMth != null
										&& aEdEligibilityCargoPrevMth
												.getMidCertificationShortenSw() == 'Y') {
									//if(tsPrevMthEstEligEndDt!=null){
									aEdEligibilityCargo
											.setEstimatedEligEndDt(tsPrevMthEstEligEndDt);
									aEdEligibilityCargo
											.setCertEndDt(aEdEligibilityCargoPrevMth
													.getCertEndDt());
									//	 added for defect 92340. MidCertEndDt
									// should be set to Null
									//	 when midCertificationShortenSw is set to
									// 'Y'
									aEdEligibilityCargo
											.setMidCertificationShortenSw('Y');
									//{
									aEdEligibilityCargo.setMidCertEndDt(null);
									aEdEligibilityCargo
											.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth
													.getSemiAnnualReviewDt());
									//}
									//}

								} else {
									tsEstimatedEligEndDt = perform6010_090(
											aEdEligibilityCargo,
											aEdIndvEligibilityCargo,
											aDcCaseProgramCargo,
											aEdEligFsBudget, nfDataHandler,
											egDataHandler,
											edEligNoticeReasonsCargo,
											aEdEligibilityCargoPrevMth);
									if (tsEstimatedEligEndDt != null) {
										aEdEligibilityCargo
												.setEstimatedEligEndDt(tsEstimatedEligEndDt);
									}
								}
							}else{*/
								/*BRGUS00228917 - Changing from Change reporter to simplified reporter 
								 * if change reporting client report income and EDBC been run within 4 months of cert begin date 
								 * then indentify the client as simplified reporter.  Set the SemiAnnualReviewDt as certBegDt + 5 months*/
								// beniwala - ASPEN00015918 - use logic similar to FS for TANF progCd
								if((IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
										|| IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()))
										 && aEdEligibilityCargo.getSimplifiedReportingGrpCd() != null
										 	&& "SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())){
									// beniwala - ASPEN00049529
									tsEstimatedEligEndDt = perform6010_090(
											aEdEligibilityCargo,
											aEdIndvEligibilityCargo,
											aDcCaseProgramCargo,
											aEdEligFsBudget, nfDataHandler,
											egDataHandler,
											edEligNoticeReasonsCargo,
											aEdEligibilityCargoPrevMth, aEdCaseRecertDates);
									if (tsEstimatedEligEndDt != null) {
										aEdEligibilityCargo
												.setEstimatedEligEndDt(tsEstimatedEligEndDt);
									}
									
								}
							//beniwala - ASPEN00034743
							//}
							
							
						}
						
						
		// sandhya start ASPEN00023275 - Set certend date as estimate elig end, calculated in non fon for pregnancy based TANF assistance 
						
						else if (IEdEligCodes.TP_01.equalsIgnoreCase(
						aEdEligibilityCargo.getTypeOfAssistanceCd())
						&& (IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(
						aEdEligibilityCargo.getActivityType()))){
						aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargo.getEstimatedEligEndDt());
						}
		
	   // sandhya end ASPEN00023275 - Set certend date as estimate elig end, calculated in non fon for pregnancy based TANF assistance 

						
					}
					
					
					/* Begin BRGUS00107997 – kesavanr
					 * If current month RAPC is terminated then carry forward esteligenddt from
					 * the previous month.
					 */
					// beniwala - ASPEN00017459 - fix findbugs issue
					if (IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
						if (IEdEligCodes.RAPC.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
							Timestamp tsPrevMthEstEligEndDt = detPrevMthEstEligEndDt(
									aEdEligibilityCargoPrevMth, aEdEligibilityCargo);
							if(tsPrevMthEstEligEndDt != null) {
								aEdEligibilityCargo.setEstimatedEligEndDt(DateComparisons.getLastDayOfDate(tsPrevMthEstEligEndDt));
							}
						}

					}
					//End BRGUS00107997
				}
				//BEGIN-BRGUS00216462-upadhyayulag-If the current record is an EFIP record, check if 
				//there is a previous month record for the same EDG. If it is present & has an estimated 
				//eligibility end date copy that to current record.
				/*  beniwala - ASPEN00015918 - for Transitional Bonus TOA, estimatedEligEndDt = paymentBegDt + 5 months
				 *  or copied from previous month
				 */
				/*
				 * Begin - beniwala - ASPEN00032076 - Transitional Bonus is identified by efipEligSw=Y for TP01
				 */
				if(aEdEligibilityCargo.getProgramCd() != null 
						&& IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()) 						
							/*&& IEdEligCodes.TP_TRBP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) */
						&& IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
						&& aEdEligibilityCargo.getEfipEligSw() == 'Y'
								){
					if(aEdEligibilityCargoPrevMth == null 
							|| (aEdEligibilityCargoPrevMth != null 
									&& aEdEligibilityCargoPrevMth.getEdgNum() == 
										aEdEligibilityCargo.getEdgNum()
									/*&& IEdEligCodes.TP_TRBP.equalsIgnoreCase(aEdEligibilityCargoPrevMth.
											getTypeOfAssistanceCd())*/	
									&& IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargoPrevMth.getTypeOfAssistanceCd())										
									&& ((aEdEligibilityCargoPrevMth.getEstimatedEligEndDt() == null) ||
									(aEdEligibilityCargoPrevMth.getEfipEligSw() != 'Y')))){
						aEdEligibilityCargo.setEstimatedEligEndDt(null);
						tsEstimatedEligEndDt = perform6010_080(
								aEdEligibilityCargo,
								aEdIndvEligibilityCargo,
								aEdCaseRecertDates, aDcCaseProgramCargo,
								aEdEligFsBudget, egDataHandler,
								nfDataHandler, aEdEligibilityCargoPrevMth,
								edEligNoticeReasonsCargo);
						aEdEligibilityCargo.setEstimatedEligEndDt(tsEstimatedEligEndDt);
						// beniwala - ASPEN00017348 - set SemiAnnual review Date, same as Estimated Eligibility End Date as
						// interim reporting period for Transitional Bonus is 6 months
						aEdEligibilityCargo.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
					}else if(aEdEligibilityCargoPrevMth != null 
								&& aEdEligibilityCargoPrevMth.getEdgNum() == aEdEligibilityCargo.getEdgNum() 
								/*&& IEdEligCodes.TP_TRBP.equalsIgnoreCase(aEdEligibilityCargoPrevMth.getTypeOfAssistanceCd())*/
								 && IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargoPrevMth.getTypeOfAssistanceCd())	
                                && aEdEligibilityCargoPrevMth.getEfipEligSw() == 'Y' 
								&& aEdEligibilityCargoPrevMth.getEstimatedEligEndDt() != null){
						aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargoPrevMth.getCertBegDt());
						aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargoPrevMth.getCertEndDt());
						aEdEligibilityCargo.setEstimatedEligEndDt(
								aEdEligibilityCargoPrevMth.getEstimatedEligEndDt());
						// beniwala - ASPEN00017348 - set SemiAnnual review Date from previous month
						aEdEligibilityCargo.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth.getSemiAnnualReviewDt());
					}
				}
				//END-BRGUS00216462
				//Setting estimated eligibiity end date to cert end date if
				// cert end date is greater than
				//estimated elig end date in change action mode
				//BRGUS00091726
				// beniwala - ASPEN00017459 - fix findbugs issue
				if (IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(aEdEligibilityCargo.getCgEligRsltCd())) {
					if (aEdEligibilityCargo.getCertEndDt() != null
							&& aEdEligibilityCargo.getEstimatedEligEndDt() != null
							&& DateComparisons
									.dateGTEQDateInTimestamp(
											aEdEligibilityCargo.getCertEndDt(),
											aEdEligibilityCargo
													.getEstimatedEligEndDt())) {
						if (aEdEligibilityCargo.getEstimatedEligEndDt() != null
								&& DateComparisons.dateGTEQDateInTimestamp(
										aEdEligibilityCargo.getPaymentBegDt(),
										aEdEligibilityCargo
												.getEstimatedEligEndDt())) {
							aEdEligibilityCargo
									.setEstimatedEligEndDt(aEdEligibilityCargo
											.getCertEndDt());
						}
					}
				}
				//Setting semi annual review date for all the months in a EDG.
				/*
				 * Begin - beniwala - ASPEN00032076 - set SemiAnnual Review Date from previous month
				 * for Transitional Bonus only if it has not been set already
				 */
				if (aEdEligibilityCargoPrevMth != null
						&& aEdEligibilityCargoPrevMth.getSemiAnnualReviewDt() != null) {
					/*
					 * Begin - beniwala - ASPEN00034743 - set SemiAnnualReview Date from previous month for SNAP  
					 * only if interim reporting has not changed from 12 months to 6 months ( i.e. cert period changed from 24 months to 12 months)
					 */
					if(!IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							&& !IEdEligCodes.TP_09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
						aEdEligibilityCargo
						.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth
								.getSemiAnnualReviewDt());
					}
					else if((aEdEligibilityCargo.getEfipEligSw() == 'Y' && aEdEligibilityCargo.getSemiAnnualReviewDt() == null)
							|| (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) && aEdEligibilityCargo.getEfipEligSw() != 'Y')) {
						aEdEligibilityCargo
						.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth
								.getSemiAnnualReviewDt());
					}
					else if(IEdEligCodes.TP_09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
						if(aEdEligibilityCargo.getCertBegDt() != null && aEdEligibilityCargo.getSemiAnnualReviewDt() != null
								&& aEdEligibilityCargoPrevMth.getCertBegDt() != null) {
							int interimReportingPeriod = DateComparisons.getMonthsIncludedBetween(aEdEligibilityCargo.getSemiAnnualReviewDt(), aEdEligibilityCargo.getCertBegDt());
							int interimReportingPeriodPrevMth = DateComparisons.getMonthsIncludedBetween(aEdEligibilityCargoPrevMth.getSemiAnnualReviewDt(), aEdEligibilityCargoPrevMth.getCertBegDt());
							/*
							 * copy from previous month if previous month is not 24 month cert period OR
							 * if current month is also 24 month cert period
							 */
							if(interimReportingPeriod == 12 || interimReportingPeriodPrevMth != 12) {
								aEdEligibilityCargo
								.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth
										.getSemiAnnualReviewDt());
							}
						}						
						else {
							aEdEligibilityCargo
							.setSemiAnnualReviewDt(aEdEligibilityCargoPrevMth
									.getSemiAnnualReviewDt());
						}
					}
					// End - beniwala - ASPEN00034743
					// End - beniwala - ASPEN00032076
				}
				//BEGIN-BRGUS00127510-upadhyayulag-If payment begin date is greater than semi annual review
				//date if present & if estimated eligibility end date is greater than semi annual review
				//date if present, then do not carry forward previous month's semi annual review date.
				//It should be made null.
				if(aEdEligibilityCargo.getSemiAnnualReviewDt() != null
						&& DateComparisons.dateGTDateInTimestamp(
								aEdEligibilityCargo.getPaymentBegDt(),
								aEdEligibilityCargo.getSemiAnnualReviewDt())){
					if(aEdEligibilityCargo.getEstimatedEligEndDt()!=null
							&& DateComparisons.dateGTDateInTimestamp(
									aEdEligibilityCargo.getEstimatedEligEndDt(),
									aEdEligibilityCargo.getSemiAnnualReviewDt())){
						aEdEligibilityCargo.setSemiAnnualReviewDt(null);
					}
				}
				//END-BRGUS00127510
				//BEGIN-BRGUS00136091-upadhyayulag
				//For SSIT, set estimated eligibility end date as denial date from DC_SSI cargo
				//(earliest effective begin date record) plus 2 months if it is not null. This should
				// be set only if the CG_STATUS_CD is "AP"
				//BEGIN-BRGUS00136783-upadhyayulag-Remove the check for "Approved" CG_STATUS_CD
				//BRGUS00245547-dhimark-Commenting this code to not to override ssit Estimated Elig End Date.
			/*	if(aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.SSIT)){
					//	&& aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)){
					//END-BRGUS00136783
					DcSsiCargo[] ssiCargoArray = nfDataHandler.getIndivNonFinInfo().getDcSsiCargo();
					if(ssiCargoArray != null && ssiCargoArray.length > 0){
						int ssiCargoArrayLen = ssiCargoArray.length;
						DcSsiCargo latestSsiCargo = null;
						Timestamp earliestEffBeginDt = null;
						Timestamp ssiDenialDt = null;
						int count = 0;
						boolean currentEDMRecord = false;
						for (int i = 0; i < ssiCargoArrayLen; i++) {
							//BRGUS00148074 – kesavanr – reset the boolean variable currentEDMRecord.
							currentEDMRecord = false;
							if(DateComparisons.dateLTEQDateInTimestamp(ssiCargoArray[i].getEffBeginDt(),
									aEdEligibilityCargo.getPaymentBegDt())){
								if(ssiCargoArray[i].getEffEndDt() != null){
									if(DateComparisons.dateGTEQDateInTimestamp(ssiCargoArray[i].getEffEndDt(),
											aEdEligibilityCargo.getPaymentBegDt())){
										//If needed, later a check needs to be added for open end date depending
										//on the requirements
										currentEDMRecord = true;
									}
							}else{
									currentEDMRecord = true;
								}
							}else{
								if(aEdEligibilityCargo.getPaymentEndDt() != null){
									if(DateComparisons.dateLTEQDateInTimestamp(ssiCargoArray[i].getEffBeginDt(),
											aEdEligibilityCargo.getPaymentEndDt())){
										currentEDMRecord = true;
									}
								}else{
									currentEDMRecord = true;
								}
							}
							if(currentEDMRecord){
								if(ssiCargoArray[i].getBenefitTypeCd().equals(IEdEligCodes.BENEFITTYPE_SSI)
										&& (ssiCargoArray[i].getSsiDenialDt() != null)){
										if(count==0){
											earliestEffBeginDt = ssiCargoArray[i].getEffBeginDt();
											ssiDenialDt = ssiCargoArray[i].getSsiDenialDt();
											count++;
										}else{
											if(DateComparisons.dateLTDateInTimestamp(ssiCargoArray[i].getEffBeginDt(),
													earliestEffBeginDt)){
												earliestEffBeginDt = ssiCargoArray[i].getEffBeginDt();
												ssiDenialDt = ssiCargoArray[i].getSsiDenialDt();
												count++;
											}
										}
								}
							}
						}
						if(ssiDenialDt != null){
							ssiDenialDt = DateComparisons.addMonths(ssiDenialDt,2);
							aEdEligibilityCargo.setEstimatedEligEndDt(DateComparisons.getLastDayOfDate(ssiDenialDt));
						}
					}
				}*/
				//END-BRGUS00136091
				/* Begin BRGUS00107808 – kesavanr
				 * Carry forward previous month cert end date to the current month if cert end is null.
				 */
				if (aEdEligibilityCargo.getCertEndDt() == null && aEdEligibilityCargoPrevMth != null
						&& aEdEligibilityCargoPrevMth.getCertEndDt() != null) {
					aEdEligibilityCargo
							.setCertEndDt(aEdEligibilityCargoPrevMth
									.getCertEndDt());
				}
				//End BRGUS00107808
				/* beniwala - ASPEN00015918 - EfipEligSw is not used in New Mexico
				 * //<BRGUS00144409><kucherlapatis><02/11/2009><Java Fix To Set Estimated Elig End Dte To 
				//Null For FIP. Estimated elig end date should be set only for EFIP for Cash program, 
				//it shouldn't be set for normal FIP>
				if(aEdEligibilityCargo.getProgramCd() != null &&
						aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_TANF)) {
					//BEGIN-BRGUS00233516-upadhyayulag-Remove the estimated elig end date for SDAC
					if((aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_01) &&
							aEdEligibilityCargo.getEfipEligSw() != 'Y' 
							// && aEdEligibilityCargo.getSpReviewDt() == null
							) 
							|| (aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(
									IEdEligCodes.TP_SDA))){
						//BRGUS00146278-upadhyayulag-Also check if SP Review date is null
						aEdEligibilityCargo.setEstimatedEligEndDt(null);
					}
					//END-BRGUS00233516
				}*/
				//BEGIN-BRGUS00146278-upadhyayulag-Changes for CR23169
				//Do this only for FAP(TP09), FIP(TP01), SDA(SDAC) & CDC(CDCS).
				//For CDC, make the estimated eligibility end date null if SP Review date is not populated
				//For FIP/SDA/CDC, set SP_REVIEW_DT to be same as estimated eligibility end date.
				if(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.CDCS) &&
						aEdEligibilityCargo.getSpReviewDt() == null) {
					aEdEligibilityCargo.setEstimatedEligEndDt(null);
					aEdEligibilityCargo.setSpReviewDt(null);
				}
				//BEGIN-BRGUS00200204-upadhyayulag-Do not set SP_REVIEW_DT for EFIP
//				<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
				/*if(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_09) ||
						(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_01) 
								&& aEdEligibilityCargo.getEfipEligSw() != 'Y') ||
						aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_SDA) ||
						aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.CDCS)){
					//END-BRGUS00200204
					if (aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_APPROVED)) {
						if(aEdEligibilityCargo.getEstimatedEligEndDt()!=null){
							aEdEligibilityCargo.setSpReviewDt(aEdEligibilityCargo.getEstimatedEligEndDt());
						}
					}
				}
				//END-BRGUS00146278
*/			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEstEligEndDt", ex);
		}
	}

	/**
	 * Determines the EdIndvEligibility Begin Date in the EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdIndvEligibilityCargoPrevMonth
	 *            EdIndvEligibilityCargo
	 * @param aEdEligibilityCargoPrevMonth
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aNfDataHandler
	 *            NFDataHandler
	 * @throws EDBCException
	 */
	public void detIndvEligBegDt(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargoPrevMonth,
			EdEligibilityCargo aEdEligibilityCargoPrevMonth,
			EgDataHandler aEgDataHandler, NFDataHandler aNfDataHandler)
			throws EDBCException {
		try {
			// beniwala - ASPEN00015918 - fix findbugs issue
			if (aEdIndvEligibilityCargoPrevMonth != null 
					&& ((aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() == null)
					|| (aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null))) {
				if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
						&& (aEdIndvEligibilityCargo.getEligRsltCd()
								.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
					if (aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
						//HashMap hmTemp = populateHMTPCodes();
						HashMap hmTemp = hmEMERGENCY_MA_TOA;
						if (hmTemp.containsKey(aEdEligibilityCargo
								.getTypeOfAssistanceCd())) {
							Timestamp tsHighDt = new Timestamp(Long.MAX_VALUE);
							Timestamp tsLowestEmerMedBegDt = tsHighDt;
							//							HashMap hmIndvAlien =
							// NFUtil.detMedEmerDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
							// aNfDataHandler);
							//HashMap hmAlienEmerMed =
							// EdIndvUtil.detDcAlienEmergencyMedInfoMonthlyHM(aEgDataHandler);
							//							DcAlienEmergencyMedCargo[]
							// arrDcAlienEmergencyMedCargo =
							// (DcAlienEmergencyMedCargo[])hmAlienEmerMed.get(new
							// Long(aEdIndvEligibilityCargo.getIndvId()));
							//							DcIndividualAlienCargo dcIndividualAlienCargo =
							// null;
							//DcAlienEmergencyMedCargo dcAlienEmergencyMedCargo
							// = null;
							/*
							 * int iLength = 0; if (arrDcAlienEmergencyMedCargo !=
							 * null) { iLength =
							 * arrDcAlienEmergencyMedCargo.length; }
							 */
							ArrayList alRecordForIndvDateSpecific = new ArrayList();
							/*
							 * for (int i = 0; i < iLength; i++) {
							 * dcAlienEmergencyMedCargo =
							 * arrDcAlienEmergencyMedCargo[i];
							 */
							/*
							 * CQ 1277: Table Deprecated
							 * dcAlienEmergencyMedCargo =
							 * (DcAlienEmergencyMedCargo)hmAlienEmerMed.get(new
							 * Long(aEdIndvEligibilityCargo.getIndvId())); if
							 * (dcAlienEmergencyMedCargo != null &&
							 * dcAlienEmergencyMedCargo.getEmergecyBeginDt() !=
							 * null) {
							 * alRecordForIndvDateSpecific.add(dcAlienEmergencyMedCargo);
							 * if
							 * (dcAlienEmergencyMedCargo.getEmergecyBeginDt().before(tsLowestEmerMedBegDt)) {
							 * tsLowestEmerMedBegDt =
							 * dcAlienEmergencyMedCargo.getEmergecyBeginDt(); } }
							 */
							//							}
							//createEdIndvDateSpecificCargo(alRecordForIndvDateSpecific,
							// aEdIndvEligibilityCargo, aEdEligibilityCargo,
							// aEgDataHandler);
							if (!tsLowestEmerMedBegDt.equals(tsHighDt)) {
								if (tsLowestEmerMedBegDt
										.before(aEdEligibilityCargo
												.getPaymentBegDt())) {
									aEdIndvEligibilityCargo
											.setEligibilityBegDt(aEdEligibilityCargo
													.getPaymentBegDt());
								} else {
									aEdIndvEligibilityCargo
											.setEligibilityBegDt(tsLowestEmerMedBegDt);
								}
								return;
							}
						}
						/* Begin BRGUS00130169 – kesavnr
						 * Set new indv eligibility begin date if previous month is either null or terminated.
						 */
						//ID : BRGUS00134345 -- KesireddyV -- Check previous month eligibility end date before calculating elig beg date.
						else if (aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null
								|| (aEdEligibilityCargoPrevMonth!= null && aEdEligibilityCargoPrevMonth.getCgStatusCd() != null &&
										aEdEligibilityCargoPrevMonth.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED))){
							aEdIndvEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt());
						}
						//End BRGUS00130169
					}
				}
				/* Begin BRGUS00111401 – kesavanr
				 * Carry forward eligibility begin date from previous month if current month individual
				 * eligibility result is failed.
				 */
				else {
					if(aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null && aEdIndvEligibilityCargo.getEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						aEdIndvEligibilityCargo.setEligibilityBegDt(aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt());
					}
				}
				//End BRGUS00111401
			}
			//Modified for defect 86792 based on dt 6010_331

			//Following two methods modified to use EdDcUtil instead of NFUtil
			// - 12/9/2004 - Sai
			//DcIndvCargo dcIndvCargo = (DcIndvCargo)
			// NFUtil.detDcIndvInfoMonthlyHM(aEgDataHandler,
			// aNfDataHandler).get(new
			// Long(aEdIndvEligibilityCargo.getIndvId()));
			//DcIndividualAlienCargo dcIndvAlien = (DcIndividualAlienCargo)
			// NFUtil.detDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
			// aNfDataHandler).get(new
			// Long(aEdIndvEligibilityCargo.getIndvId()));

			DcIndvCargo dcIndvCargo = (DcIndvCargo) NFUtil
					.detDcIndvInfoMonthlyHM(aEgDataHandler, aNfDataHandler)
					.get(new Long(aEdIndvEligibilityCargo.getIndvId()));
			DcIndividualAlienCargo dcIndvAlien = (DcIndividualAlienCargo) NFUtil
					.detDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
							aNfDataHandler).get(
							new Long(aEdIndvEligibilityCargo.getIndvId()));

			// Following line modified for QA Defect 00195765
			//if (aEdIndvEligibilityCargo.getEligibilityBegDt() == null ||
			// aEdIndvEligibilityCargo.getEligibilityBegDt().equals("")) {
			if (aEdIndvEligibilityCargo.getEligibilityBegDt() == null) {
				// Following if condition added of CCB:127585(MM) Scenario-1,
				// else pre existed
				// Added the condition to check for null of potentialbegdt for
				// defect 202980
				//Added MidmonthSw || TP_45 check for Defect # 239472 on
				// 8/30/2005
				// beniwala - ASPEN00015918 - fix findbugs issue
				if ((aEdIndvEligibilityCargoPrevMonth != null &&
						aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() == null)
						&& (aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)
						&& (aEdIndvEligibilityCargo.getPotentialEligBegDt() != null)
						&& ((aEdIndvEligibilityCargo.getMidMonthSw() == IEdEligCodes.YES) || (aEdEligibilityCargo
								.getTypeOfAssistanceCd()
								.equals(IEdEligCodes.TP_45)))) {
					if (aEdIndvEligibilityCargo.getMidMonthSw() == IEdEligCodes.YES) {
						if ((aEdEligibilityCargo.getPaymentBegDt())
								.after(aEdIndvEligibilityCargo
										.getPotentialEligBegDt())) {
							aEdIndvEligibilityCargo
									.setEligibilityBegDt(DateComparisons
											.getFirstDayOfDate(aEdEligibilityCargo
													.getPaymentBegDt()));
						} else {
							aEdIndvEligibilityCargo
									.setEligibilityBegDt(DateComparisons
											.getFirstDayOfDate(aEdIndvEligibilityCargo
													.getPotentialEligBegDt()));
						}
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_45)) {
						//Else condition added for defect # 238284 by sai on
						// 8/25/2005
						aEdIndvEligibilityCargo
								.setEligibilityBegDt(DateComparisons
										.getFirstDayOfDate(aEdIndvEligibilityCargo
												.getPotentialEligBegDt()));
					}
				} else {
					//if condition added for defect # 238284 by sai on
					// 8/25/2005
					//Currently it is done for TP45, other TP's can be
					// considered after analzing
					if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_45)
							&& aEdIndvEligibilityCargo.getPotentialEligBegDt() != null) {
						aEdIndvEligibilityCargo
								.setEligibilityBegDt(DateComparisons
										.getFirstDayOfDate(aEdIndvEligibilityCargo
												.getPotentialEligBegDt()));
					}
					// modified below to check for elig end dt != null - defect
					// 174924
					// Addded or condition to check if the prevmth is a going to
					// be a R record
					// and if so if the eligbegdt is not the same as the
					// paymentbegdt
					// and if so then dont use the prevmth eligbegdt for the
					// current mth compure fresh for defect 230989
					// beniwala - ASPEN00017459 - fix findbugs issue
					if (aEdIndvEligibilityCargoPrevMonth != null &&
							(aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() == null
							|| aEdIndvEligibilityCargoPrevMonth
									.getEligibilityEndDt() != null
							|| (IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL.equalsIgnoreCase(aEdEligibilityCargoPrevMonth
									.getEdbcActionCd()) && DateComparisons
									.getStringMMYYYY(
											aEdIndvEligibilityCargoPrevMonth
													.getEligibilityBegDt())
									.equals(
											DateComparisons
													.getStringMMYYYY(aEdEligibilityCargoPrevMonth
															.getPaymentBegDt()))))) {
						if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
								&& (aEdIndvEligibilityCargo.getEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
							//Modified for defect 166259
							if (aEdEligibilityCargo.getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_FMA)) {
								Timestamp tsDOB = dcIndvCargo.getDobDt();
								Timestamp tsDateOfLegalEntry = null;
								if (dcIndvAlien != null) {
									if (dcIndvAlien.getGrantDt() != null) {
										tsDateOfLegalEntry = dcIndvAlien
												.getGrantDt();
									} else {
										if (dcIndvAlien.getUsEntryDt() != null) {
											tsDateOfLegalEntry = dcIndvAlien
													.getUsEntryDt();
										}
									}
								}
								Timestamp tsDateToBeUsed = aEdEligibilityCargo
										.getPaymentBegDt();
								//<kucherlapatis><BRGUS00126328><02/25/2009><Java Fix To Set Correct Elig Beg Dt For Newborn>
								if (tsDOB != null
										&& tsDOB.after(tsDateToBeUsed)
										&& (!(aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FMA)
												|| aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_ME)
												|| aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_MC)))) {
									tsDateToBeUsed = tsDOB;
								}
								if (tsDateOfLegalEntry != null
										&& tsDateOfLegalEntry
												.after(tsDateToBeUsed)) {
									tsDateToBeUsed = tsDateOfLegalEntry;
								}
								aEdIndvEligibilityCargo
										.setEligibilityBegDt(tsDateToBeUsed);
							} else {
								if (dcIndvCargo != null
										&& dcIndvCargo.getDobDt().after(
												aEdEligibilityCargo
														.getPaymentBegDt())) {
									aEdIndvEligibilityCargo
											.setEligibilityBegDt(dcIndvCargo
													.getDobDt());
								} else {
									aEdIndvEligibilityCargo
											.setEligibilityBegDt(aEdEligibilityCargo
													.getPaymentBegDt());
								}
							}
						}
					} else {
						// beniwala - ASPEN00031274 - fix findbugs issue
						if (aEdIndvEligibilityCargoPrevMonth != null && 
								aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() == null) {
							aEdIndvEligibilityCargo
									.setEligibilityBegDt(aEdIndvEligibilityCargoPrevMonth
											.getEligibilityBegDt());
						}
					}
				}
			} else {

				// This else is added for Adjusting IndvEligBegDt for MM cases
				// when there is IndvEligBeg date is available
				/*
				 * Def: 193778 Following code is commented and modified to set
				 * IndvEligBegDt in the renamed and altered method
				 * 'adjustPrevMthIndvBegDtForMM' Timestamp tsPrevMthBegDt = null ;
				 * tsPrevMthBegDt =
				 * detPrevMthIndvBegDtForMM(aEdIndvEligibilityCargoPrevMonth,
				 * aEdEligibilityCargoPrevMonth, aEdIndvEligibilityCargo,
				 * aEdEligibilityCargo, aEgDataHandler); if(tsPrevMthBegDt !=
				 * null) {
				 * aEdIndvEligibilityCargo.setEligibilityBegDt(tsPrevMthBegDt); }
				 */
				boolean bAdjustIndvBegDtForMM = false;
				bAdjustIndvBegDtForMM = adjustPrevMthIndvBegDtForMM(
						aEdIndvEligibilityCargoPrevMonth,
						aEdEligibilityCargoPrevMonth, aEdIndvEligibilityCargo,
						aEdEligibilityCargo, aEgDataHandler);	  

				/**
				 * Start BRGUS00185613 -singhh
				 * If the indvs previous month benefit is denied or terminated 
				 * then check if current month is not denied or terminated
				 * then set the eligibility begin date as the payment begin
				 * date.
				 */
				// beniwala - ASPEN00029665 - fix findbugs issue
				if ((aEdIndvEligibilityCargoPrevMonth != null && aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
						|| (aEdEligibilityCargoPrevMonth != null
								&& aEdEligibilityCargoPrevMonth
										.getCgStatusCd() != null && (aEdEligibilityCargoPrevMonth
								.getCgStatusCd().equals(
										IEdEligCodes.STATUS_CD_DENIED) || 
										IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(
												aEdEligibilityCargoPrevMonth.getCgStatusCd())))) {
					//BEGIN-BRGUS00194799-upadhyayulag-Set the payment begin date as individual's
					//eligibility begin date only if the current record is approved or pending & the
					//individual is eligible for current month
					if((aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED) 
							|| aEdEligibilityCargo.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_PENDING)) 
							&& (aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)){
						aEdIndvEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt());
					}
					//END-BRGUS00194799
				}	
				//End BRGUS00185613

				// Step 1. if previous month is end dated , reset current month
				// IndvEligBegDt to PaymentbegDt
				// Step 2. Carry fwd the new IndvEligBegDate to subsequent EDMS.
				//Do Step1 and Step2 only if the Prev month is immediate Prev
				// month - Sai 1/14/2005 . Defect # 195131(8000_120)
				// The DOB part of the defect is will be resolved as CCB
				//Moved the MM scenario out of the immd prev month logic for
				// defect 212410
				boolean isMM = false;
				//BEGIN-BRGUS00142815-upadhyayulag-If the same individual in the same EDG is previously terminated
				//(moving from one TOA to another and coming back), do not carry forward the eligibility begin date
				//populated by EDG. Set the group payment begin date as individual begin date
				//<BRGUS00259908><kucherlapatis><03/08/2011>
				//<Logic is restricted to be perfomed only for medicaid as this is resulting
				// in incorrect eligibility begin dates when program is reinstated>
				if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
						IEdEligCodes.PROGRAM_CD_FMA)
						|| aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
								IEdEligCodes.PROGRAM_CD_ME)
						|| aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
								IEdEligCodes.PROGRAM_CD_MC)) {
					if (aEgDataHandler.getEligDetailLastAuth() != null) {
						EdIndvEligibilityCargo[] lastAuthIndvArr = (EdIndvEligibilityCargo[]) aEgDataHandler
								.getEligDetailLastAuth()
								.getEdIndvEligibilityCargo();
						if (lastAuthIndvArr != null
								&& lastAuthIndvArr.length > 0) {
							for (int i = 0; i < lastAuthIndvArr.length; i++) {
								if (lastAuthIndvArr[i].getIndvId() == aEdIndvEligibilityCargo
										.getIndvId()) {
									if (lastAuthIndvArr[i]
											.getEligibilityEndDt() != null) {
										if ((aEdIndvEligibilityCargo
												.getGroupInd() == IEdEligCodes.GROUP_IND_C)
												&& (aEdIndvEligibilityCargo
														.getEligRsltCd()
														.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
											aEdIndvEligibilityCargo
													.setEligibilityBegDt(aEdEligibilityCargo
															.getPaymentBegDt());
											isMM = true;
										}
									}
								}
							}
						}
					}
				}
				//END-BRGUS00142815
				// beniwala - ASPEN00031274 - fix findbugs issue
				if (aEdIndvEligibilityCargoPrevMonth != null &&
						(aEdIndvEligibilityCargoPrevMonth.getGroupInd() == IEdEligCodes.GROUP_IND_C)
						&& (IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(aEdIndvEligibilityCargoPrevMonth.getEligRsltCd()))) {
					//Step 1:
					if ((aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
							&& (aEdIndvEligibilityCargoPrevMonth
									.getEligibilityEndDt()
									.after(aEdIndvEligibilityCargo
											.getEligibilityBegDt()))) {
						// Commenting with defect 241025 - should reset only if
						// indv in CG
						//aEdIndvEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt());
						//isMM = true;
						if ((aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)
								&& (aEdIndvEligibilityCargo.getEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
							aEdIndvEligibilityCargo
									.setEligibilityBegDt(aEdEligibilityCargo
											.getPaymentBegDt());
							isMM = true;
						}
					}
				}
				Timestamp tsPrevMonth = null;
				if (!isMM) {
					if (aEdEligibilityCargoPrevMonth.getPaymentBegDt() != null) {
						tsPrevMonth = DateComparisons.addMonths(
								aEdEligibilityCargoPrevMonth.getPaymentBegDt(),
								1);
					}
					if ((tsPrevMonth != null)
							&& (DateComparisons.getStringMMYYYY(tsPrevMonth))
									.equals(DateComparisons
											.getStringMMYYYY(aEdEligibilityCargo
													.getPaymentBegDt()))) {
						if ((aEdIndvEligibilityCargoPrevMonth
								.getEligibilityEndDt() != null)
								&& (aEdIndvEligibilityCargoPrevMonth
										.getEligibilityEndDt()
										.after(aEdIndvEligibilityCargo
												.getEligibilityBegDt()))) {
							if ((aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)
									&& (aEdIndvEligibilityCargo.getEligRsltCd()
											.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
								aEdIndvEligibilityCargo
										.setEligibilityBegDt(aEdEligibilityCargo
												.getPaymentBegDt());
							}
						}
					}
				}
				//Step 2:
				// beniwala - ASPEN00031274 - fic findbugs issue
				if (aEdIndvEligibilityCargoPrevMonth != null && 
						(aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() != null)
						&& (aEdIndvEligibilityCargoPrevMonth
								.getEligibilityBegDt()
								.after(aEdIndvEligibilityCargo
										.getEligibilityBegDt()))) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdIndvEligibilityCargoPrevMonth
									.getEligibilityBegDt());
				}

			}// end of else
			// Following IndvEligBegDt adjustment for MA is done for CCB:
			// 00155757 Dt 30/09/2004
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FMA)) {
				if (aEdIndvEligibilityCargo.getIndvDataRetrievalDt() != null) {
					//if(aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_45))
					// {
					aEdIndvEligibilityCargo.setEligibilityBegDt(DateComparisons
							.getFirstDayOfDate(aEdIndvEligibilityCargo
									.getIndvDataRetrievalDt()));
					//}
					//	else {
					//		aEdIndvEligibilityCargo.setEligibilityBegDt(aEdIndvEligibilityCargo.getIndvDataRetrievalDt());
					//	}
				}
			}
			//Following IndvEligBegDt adjustment done for MC & TP24
			// (ContinousQMBDT) for CCB: 00195312 0n 2/1/2005
			if ((aEdEligibilityCargo.getActivityType()
					.equalsIgnoreCase(IEdEligCodes.ACTIVITY_TYPE_INTAKE))
					&& (aEdEligibilityCargo.getProgramCd()
							.equals(IEdEligCodes.PROGRAM_CD_MC))
					&& (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.TP_24))) {
				if (aEdIndvEligibilityCargo.getContinuousQmbDt() != null) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdIndvEligibilityCargo
									.getContinuousQmbDt());
				}

			}

			// CCB 225269 - Indiv Begin Date adjustment based on PreTiersBeginDt
			if (aEdEligibilityCargo.getActivityType().equalsIgnoreCase(
					IEdEligCodes.ACTIVITY_TYPE_INTAKE)
					&& aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_CC)
					&& aEdEligibilityCargo.getPtbdSw() == 'Y') {
				if (aEdIndvEligibilityCargo.getPreTiersBeginDt() != null) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdIndvEligibilityCargo
									.getPreTiersBeginDt());
				}

			}

			//Setting Indv Eligibility Begin Date for STFS Records
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_71)) {
				aEdIndvEligibilityCargo.setEligibilityBegDt(DateComparisons
						.getFirstDayOfDate(aEdEligibilityCargo.getRequestDt()));
			}

			//			Setting eligibility begin date for SER records
			if (aEdIndvEligibilityCargo.getGroupInd() == 'C'
					&& aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("SE")) {
				aEdIndvEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
						.getPaymentBegDt());
			}
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				//ID : KesireddyV --BRGUS00131080-- set  eligibility beg date is edg carry forward elig beg date if previous month eligibility
				// beg date is null for SER closure month.
				if (aEdIndvEligibilityCargoPrevMonth != null
						&& aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() != null ) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdIndvEligibilityCargoPrevMonth
									.getEligibilityBegDt());
				}
			}
			//<BRGUS00149688><kucherlapatis><05/28/2009><Java Fix To Build DSS For One Day>
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_DS)) {
				aEdIndvEligibilityCargo
				.setEligibilityBegDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));
			}
			
			//Setting eligibility begin date for Spenddown TOA
			//			Eligibility begin date for Spend down TOAs
			/*
			 * Begin BRGUS00101897 – kesavanr Setting individual eligibility
			 * begin date for spend down TOAs.
			 */
			//<BRGUS00259964><kucherlapatis><03/09/2011>
			//<Do not reset the eligibility begin date for G2 if it is already set by EDG>
			//<Reverting back the changes as interface is going to modify their logic while
			// reading individual's eligibility to look at cv_ed_mci_edg_individual table>
			if (aEdEligibilityCargo.getTypeOfAssistanceCd() != null
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith(
							"G2")) {
				aEdIndvEligibilityCargo.setEligibilityBegDt(null);
			}
			if ((aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)
					&& (aEdIndvEligibilityCargo.getEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
				if (aEdEligibilityCargo.getTypeOfAssistanceCd()
						.startsWith("G2")
						&& aEdEligibilityCargo.getCgStatusCd()
								.equalsIgnoreCase(
										IEdEligCodes.STATUS_CD_APPROVED)) {

					if (aEdEligibilityCargo.getSpendDownMetDt() != null) {
						aEdIndvEligibilityCargo
								.setEligibilityBegDt(aEdEligibilityCargo
										.getSpendDownMetDt());
					} else if (aEdEligibilityCargo.getSpendDownAmt() == 0) {
						aEdIndvEligibilityCargo
								.setEligibilityBegDt(aEdEligibilityCargo
										.getPaymentBegDt());
					} else if (aEdEligibilityCargo.getSpendDownAmt() > 0) {
						aEdIndvEligibilityCargo.setEligibilityBegDt(null);


					}
				}
			}
			/* Begin BRGUS00111500 – kesavanr
			 * Carry forwarding individual eligibility begin date from previous month 'V' record
			 * is commented as it is giving data integrity error.
			 */
			/* Begin BRGUS00109539 – kesavanr
			 * Carry forward individual eligibility begin date if previous month is V record for that edg and individual.
			 */
			/*if(aEdIndvEligibilityCargoPrevMonth.getEligibilityBegDt() == null) {
				EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
						aEgDataHandler.getEdEligibilityCargoVrecords(),aEdEligibilityCargo);
				if(edEligibilityCargoV != null) {
					EdIndvEligibilityCargo edIndvEligibilityVRecord = getPrevEdIndvEligibilityVRecord(edEligibilityCargoV,aEgDataHandler.getEligDetailVRecords(),aEdIndvEligibilityCargo.getIndvId());
					if(edIndvEligibilityVRecord != null) {
						aEdIndvEligibilityCargo.setEligibilityBegDt(edIndvEligibilityVRecord.getEligibilityBegDt());
					}
				}
			}*/
			//End BRGUS00109539
			//End BRGUS00111500

			//End BRGUS00101897
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_DENIED)) {
				aEdIndvEligibilityCargo.setEligibilityBegDt(null);
			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvEligBegDt", ex);
		}
	}

	/**
	 * Determines the EdIndvEligibility End Date in the EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdIndvEligibilityCargoPrevMonth
	 *            EdIndvEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aNfDataHandler
	 *            NFDataHandler
	 * @throws EDBCException
	 */
	public void detIndvEligEndDt(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargoPrevMonth,
			EgDataHandler aEgDataHandler, NFDataHandler aNfDataHandler)
			throws EDBCException {
		try {

			//Moved out of the if else for Emergency TP codes for defect 220794
			if ((aEdIndvEligibilityCargo.getEligibilityBegDt() != null)
					&& (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) {
				if (aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() == null) {
					//HashMap hmTemp = populateHMTPCodes();
					HashMap hmTemp = hmEMERGENCY_MA_TOA;
					if (hmTemp.containsKey(aEdEligibilityCargo
							.getTypeOfAssistanceCd())) {
						Timestamp tsLowDt = DateComparisons
								.getDate(IEdEligCodes.LOW_DATE);
						Timestamp tsHighestEmerMedEndDt = tsLowDt;
						//								HashMap hmIndvAlien =
						// NFUtil.detMedEmerDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
						// aNfDataHandler);
						//HashMap hmAlienEmerMed =
						// EdIndvUtil.detDcAlienEmergencyMedInfoMonthlyHM(aEgDataHandler);
						//						DcAlienEmergencyMedCargo[]
						// arrDcAlienEmergencyMedCargo =
						// (DcAlienEmergencyMedCargo[])hmAlienEmerMed.get(new
						// Long(aEdIndvEligibilityCargo.getIndvId()));
						//								DcIndividualAlienCargo dcIndividualAlienCargo = null;
						//DcAlienEmergencyMedCargo dcAlienEmergencyMedCargo =
						// null;
						/*
						 * int iLength = 0; if (arrDcAlienEmergencyMedCargo !=
						 * null) { iLength = arrDcAlienEmergencyMedCargo.length; }
						 * for (int i = 0; i < iLength; i++) {
						 * dcAlienEmergencyMedCargo =
						 * arrDcAlienEmergencyMedCargo[i];
						 */
						//dcAlienEmergencyMedCargo =
						// (DcAlienEmergencyMedCargo)hmAlienEmerMed.get(new
						// Long(aEdIndvEligibilityCargo.getIndvId()));
						/*
						 * if (dcAlienEmergencyMedCargo != null &&
						 * dcAlienEmergencyMedCargo.getEmergecyEndDt() != null) {
						 * if
						 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(tsHighestEmerMedEndDt)) {
						 * //Modified for CCB 70149 if
						 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(aEdEligibilityCargo.getPaymentEndDt())) {
						 * tsHighestEmerMedEndDt =
						 * aEdEligibilityCargo.getPaymentEndDt(); } else {
						 * tsHighestEmerMedEndDt =
						 * dcAlienEmergencyMedCargo.getEmergecyEndDt(); } } }
						 * else { tsHighestEmerMedEndDt =
						 * DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt()); }
						 */
						//						}
						if (!tsHighestEmerMedEndDt.equals(tsLowDt)) {
							if (tsHighestEmerMedEndDt.after(DateComparisons
									.getLastDayOfDate(aEdEligibilityCargo
											.getPaymentBegDt()))) {
								aEdIndvEligibilityCargo
										.setEligibilityEndDt(DateComparisons
												.getLastDayOfDate(aEdEligibilityCargo
														.getPaymentBegDt()));
							} else {
								aEdIndvEligibilityCargo
										.setEligibilityEndDt(tsHighestEmerMedEndDt);
							}
							return;
						}
					}
				}
				/* Begin BRGUS00111401 – kesavanr
				 * Carry forward eligibility end date from previous month if current month individual
				 * eligibility result is failed.
				 */
				else {
					if(aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null && aEdIndvEligibilityCargo.getEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						aEdIndvEligibilityCargo.setEligibilityEndDt(aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt());
					}
				}
				//End BRGUS00111401
			}

			//Following method modified to use EdDcuTil instead of NFUtil by
			// Sai on 12/9/2004
			DcIndvCargo dcIndvCargo = (DcIndvCargo) NFUtil
					.detDcIndvInfoMonthlyHM(aEgDataHandler, aNfDataHandler)
					.get(new Long(aEdIndvEligibilityCargo.getIndvId()));
			//DcIndvCargo dcIndvCargo = (DcIndvCargo)
			// edDcUtil.detDcIndvInfoMonthlyHM(aEgDataHandler).get(new
			// Long(aEdIndvEligibilityCargo.getIndvId()));

			// Folowing if added for CCB: 127585(MM) - Scenario-1, else pre
			// existed, changed simple if to else if.
			if (((aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.YES) || (aEdIndvEligibilityCargo
					.getAdverseActionAllowedSw() == IEdEligCodes.YES))
					&& (aEdIndvEligibilityCargo.getPotentialEligEndDt() != null)) {
				if ((aEdIndvEligibilityCargo.getEligibilityBegDt() != null)
						&& (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) {
					aEdIndvEligibilityCargo
							.setEligibilityEndDt(aEdIndvEligibilityCargo
									.getPotentialEligEndDt());
				}
			}
			//Added for defect 106645 & 107793
			else if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.YES ||
					aEdEligibilityCargo.getAdequateNoticeReqSw() == IEdEligCodes.YES) {//BRGUS00132438-upadhyayulag-Check for adequate notice required switch also
				/*
				 * if ((aEdIndvEligibilityCargo.getEligibilityBegDt() != null) &&
				 * (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) { if
				 * (aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() ==
				 * null) { //HashMap hmTemp = populateHMTPCodes(); HashMap
				 * hmTemp = hmEMERGENCY_MA_TOA; if
				 * (hmTemp.containsKey(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
				 * Timestamp tsLowDt =
				 * DateComparisons.getDate(IEdEligCodes.LOW_DATE); Timestamp
				 * tsHighestEmerMedEndDt = tsLowDt; // HashMap hmIndvAlien =
				 * NFUtil.detMedEmerDcIndividualAlienInfoMonthlyHM(aEgDataHandler,
				 * aNfDataHandler); HashMap hmAlienEmerMed =
				 * EdIndvUtil.detDcAlienEmergencyMedInfoMonthlyHM(aEgDataHandler); //
				 * DcAlienEmergencyMedCargo[] arrDcAlienEmergencyMedCargo =
				 * (DcAlienEmergencyMedCargo[])hmAlienEmerMed.get(new
				 * Long(aEdIndvEligibilityCargo.getIndvId())); //
				 * DcIndividualAlienCargo dcIndividualAlienCargo = null;
				 * DcAlienEmergencyMedCargo dcAlienEmergencyMedCargo = null; /*
				 * int iLength = 0; if (arrDcAlienEmergencyMedCargo != null) {
				 * iLength = arrDcAlienEmergencyMedCargo.length; } for (int i =
				 * 0; i < iLength; i++) { dcAlienEmergencyMedCargo =
				 * arrDcAlienEmergencyMedCargo[i];
				 */
				/*
				 * dcAlienEmergencyMedCargo =
				 * (DcAlienEmergencyMedCargo)hmAlienEmerMed.get(new
				 * Long(aEdIndvEligibilityCargo.getIndvId())); if
				 * (dcAlienEmergencyMedCargo != null &&
				 * dcAlienEmergencyMedCargo.getEmergecyEndDt() != null) { if
				 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(tsHighestEmerMedEndDt)) {
				 * //Modified for CCB 70149 if
				 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(aEdEligibilityCargo.getPaymentEndDt())) {
				 * tsHighestEmerMedEndDt =
				 * aEdEligibilityCargo.getPaymentEndDt(); } else {
				 * tsHighestEmerMedEndDt =
				 * dcAlienEmergencyMedCargo.getEmergecyEndDt(); } } } else {
				 * tsHighestEmerMedEndDt =
				 * DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt()); } // }
				 * if (!tsHighestEmerMedEndDt.equals(tsLowDt)) { if
				 * (tsHighestEmerMedEndDt.after(DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt()))) {
				 * aEdIndvEligibilityCargo.setEligibilityEndDt(DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt())); }
				 * else {
				 * aEdIndvEligibilityCargo.setEligibilityEndDt(tsHighestEmerMedEndDt); }
				 * return; } } } }
				 */
				if (((aEdIndvEligibilityCargo.getEligRsltCd() != null) && (aEdIndvEligibilityCargo
						.getEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)))
						&& (aEdIndvEligibilityCargo.getEligibilityBegDt() != null)
						&& (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) {
					if (aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null) {
						aEdIndvEligibilityCargo
								.setEligibilityEndDt(aEdIndvEligibilityCargoPrevMonth
										.getEligibilityEndDt());
					} else {
						if (aEdIndvEligibilityCargoPrevMonth
								.getEligibilityEndDt() == null) {
							if (aEdEligibilityCargo.getPaymentBegDt() != null) {
								if (aEdEligibilityCargo.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_FS)
										|| aEdEligibilityCargo
												.getProgramCd()
												.equals(
														IEdEligCodes.PROGRAM_CD_TANF)) {
									aEdIndvEligibilityCargo
											.setEligibilityEndDt(DateComparisons
													.getLastDayOfPreviousMonth(aEdEligibilityCargo
															.getPaymentBegDt()));
								} else if (aEdEligibilityCargo.getProgramCd()
										.equalsIgnoreCase("CD")) {
									aEdIndvEligibilityCargo
											.setEligibilityEndDt(DateComparisons
													.subDays(
															aEdEligibilityCargo
																	.getPaymentBegDt(),
															1));
								} else {
									if (dcIndvCargo != null) {
										//Above if is added for QA Defect for
										// Null check Build 49
										//if (dcIndvCargo != null &&
										// (dcIndvCargo.getDeathDt() == null ||
										// dcIndvCargo.getDeathDt().after(DateComparisons.getTimestamp(DateComparisons.getLastDayOfPreviousMonth(aEdEligibilityCargo.getPaymentBegDt())))))
										// {
										if (dcIndvCargo.getDeathDt() == null
												|| dcIndvCargo
														.getDeathDt()
														.after(
																DateComparisons
																		.getLastDayOfPreviousMonth(aEdEligibilityCargo
																				.getPaymentBegDt()))) {
											aEdIndvEligibilityCargo
													.setEligibilityEndDt(DateComparisons
															.getLastDayOfPreviousMonth(aEdEligibilityCargo
																	.getPaymentBegDt()));
										} else {
											//BEGIN-BRGUS00209870-upadhyayulag-If the previous month doesn't have
											//eligibility end date or previous month is a 'V' record, set the 
											//individual's eligibility end date as last day of previous month, not
											//the month end of individual's death date
											//BRGUS00105127 – kesavanr – Setting last date of death date as individual eligibility end date.
											//aEdIndvEligibilityCargo
												//.setEligibilityEndDt(DateComparisons
													//	.getLastDayOfDate(dcIndvCargo.getDeathDt()));
											aEdIndvEligibilityCargo
												.setEligibilityEndDt(DateComparisons
													.getLastDayOfPreviousMonth(aEdEligibilityCargo
														.getPaymentBegDt()));
											//END-BRGUS00209870
										}
									}
								}
							}
						}
					}
				} else {
					// Modified to add TP_56 for defect 93425
					if (aEdEligibilityCargo.getPriorMedicalCd().equals(
							IEdEligCodes.PRIOR_MED_CD_1)
							|| aEdEligibilityCargo.getPriorMedicalCd().equals(
									IEdEligCodes.PRIOR_MED_CD_2)
							|| aEdEligibilityCargo.getPriorMedicalCd().equals(
									IEdEligCodes.PRIOR_MED_CD_3)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_56)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_69)) {
						if (aEdIndvEligibilityCargo.getEligibilityBegDt() != null) {
							aEdIndvEligibilityCargo
									.setEligibilityEndDt(aEdEligibilityCargo
											.getPaymentEndDt());
						}
					}
				}
			} else { // BN - Adverse action == N Defect 174924

				if ((aEdIndvEligibilityCargo.getEligibilityBegDt() != null)
						&& (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) {
					if (aEdIndvEligibilityCargo.getEligRsltCd() != null
							&& aEdIndvEligibilityCargo.getEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						//Added if for defect 226614
						if (aEdIndvEligibilityCargoPrevMonth
								.getEligibilityEndDt() != null) {
							aEdIndvEligibilityCargo
									.setEligibilityEndDt(aEdIndvEligibilityCargoPrevMonth
											.getEligibilityEndDt());
						} else {
							if (aEgDataHandler.getEligDetailLastAuth() != null) {
								EdIndvEligibilityCargo[] lastAuthEdIndvCargo = aEgDataHandler
										.getEligDetailLastAuth()
										.getEdIndvEligibilityCargo();
								int iLength = 0;

								if (lastAuthEdIndvCargo != null) {

									iLength = lastAuthEdIndvCargo.length;
								}
								//Added the boolean condition for defect 187697
								boolean bIndvFound = false;
								for (int i = 0; i < iLength; i++) {

									if (lastAuthEdIndvCargo[i].getIndvId() == aEdIndvEligibilityCargo
											.getIndvId()) {
										if (lastAuthEdIndvCargo[i]
												.getEligibilityEndDt() != null) {
											aEdIndvEligibilityCargo
													.setEligibilityEndDt(lastAuthEdIndvCargo[i]
															.getEligibilityEndDt());
											bIndvFound = true;
										} else {
											//Added for defect 175678
											if (lastAuthEdIndvCargo[i]
													.getGroupInd() != IEdEligCodes.GROUP_IND_C) {
												if (aEdEligibilityCargo
														.getProgramCd()
														.equals(
																IEdEligCodes.PROGRAM_CD_FS)
														|| aEdEligibilityCargo
																.getProgramCd()
																.equals(
																		IEdEligCodes.PROGRAM_CD_TANF)) {
													aEdIndvEligibilityCargo
															.setEligibilityEndDt(DateComparisons
																	.getLastDayOfPreviousMonth(aEdEligibilityCargo
																			.getPaymentBegDt()));
													bIndvFound = true;
												} else if (aEdEligibilityCargo
														.getProgramCd()
														.equalsIgnoreCase("CD")) {
													if(!(isCDCAuthHrsZero(aEgDataHandler,lastAuthEdIndvCargo[i]))) {
													aEdIndvEligibilityCargo
															.setEligibilityEndDt(DateComparisons
																	.subDays(
																			aEdEligibilityCargo
																					.getPaymentBegDt(),
																			1));
													}
												} else {
													if (dcIndvCargo != null) {
														//Above if is Added for
														// QQ Defect for NULL
														// Check Build 49
														//if (dcIndvCargo !=
														// null &&
														// (dcIndvCargo.getDeathDt()
														// == null ||
														// dcIndvCargo.getDeathDt().after(DateComparisons.getTimestamp(DateComparisons.getLastDayOfPreviousMonth(aEdEligibilityCargo.getPaymentBegDt())))))
														// {
														if (dcIndvCargo
																.getDeathDt() == null
																|| dcIndvCargo
																		.getDeathDt()
																		.after(
																				DateComparisons
																						.getLastDayOfPreviousMonth(aEdEligibilityCargo
																								.getPaymentBegDt()))) {
															aEdIndvEligibilityCargo
																	.setEligibilityEndDt(DateComparisons
																			.getLastDayOfPreviousMonth(aEdEligibilityCargo
																					.getPaymentBegDt()));
														} else {
															//BRGUS00105127 – kesavanr – Setting last date of death date as individual eligibility end date.
															aEdIndvEligibilityCargo
																	.setEligibilityEndDt(DateComparisons.getLastDayOfDate(dcIndvCargo.getDeathDt()));
														}
														bIndvFound = true;
													}
												}
											}
										}
										//Uncommented for defect 231681, the
										// comment was allowing enddt to be
										// determined for Adverse action not
										// allowed records even if found in last
										// auth.
										//commented and moved into the last
										// auth if to be set if the enddt is set
										// based on last auth or dcindv for
										// defect 226614
										bIndvFound = true;
										break;
									} else {
										continue;
									}
								}
								if (!bIndvFound) {
									//Added for defect 175678
									if (aEdEligibilityCargo.getProgramCd()
											.equals(IEdEligCodes.PROGRAM_CD_FS)
											|| aEdEligibilityCargo
													.getProgramCd()
													.equals(
															IEdEligCodes.PROGRAM_CD_TANF)) {
										aEdIndvEligibilityCargo
												.setEligibilityEndDt(DateComparisons
														.getLastDayOfPreviousMonth(aEdEligibilityCargo
																.getPaymentBegDt()));
									} else {
										if (dcIndvCargo != null) {
											// Above if is added for QA Defect
											// for NULL check, Build 49
											//if (dcIndvCargo != null &&
											// (dcIndvCargo.getDeathDt() == null
											// ||
											// dcIndvCargo.getDeathDt().after(DateComparisons.getTimestamp(DateComparisons.getLastDayOfPreviousMonth(aEdEligibilityCargo.getPaymentBegDt())))))
											// {
											if (dcIndvCargo.getDeathDt() == null
													|| dcIndvCargo
															.getDeathDt()
															.after(
																	DateComparisons
																			.getLastDayOfPreviousMonth(aEdEligibilityCargo
																					.getPaymentBegDt()))) {
												aEdIndvEligibilityCargo
														.setEligibilityEndDt(DateComparisons
																.getLastDayOfPreviousMonth(aEdEligibilityCargo
																		.getPaymentBegDt()));
											} else {
												//BRGUS00105127 – kesavanr – Setting last date of death date as individual eligibility end date.
												aEdIndvEligibilityCargo
														.setEligibilityEndDt(DateComparisons.getLastDayOfDate(dcIndvCargo.getDeathDt()));
											}
										}
									}
								}
							}
						}
					}
				}
			}
			//			Setting eligibility end date for SER records
			if (aEdIndvEligibilityCargo.getGroupInd() == 'C'
					&& aEdEligibilityCargo.getProgramCd()
							.equalsIgnoreCase("SE")) {
				aEdIndvEligibilityCargo.setEligibilityEndDt(aEdEligibilityCargo
						.getPaymentEndDt());
			}
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_SER)) {
				if (aEdIndvEligibilityCargoPrevMonth != null) {
					//ID : KesireddyV --BRGUS00131080-- set  eligibility end date is payment beg date - 1 sub days if previous month eligibility
					// end date is null for SER closure month.
					if(aEdIndvEligibilityCargoPrevMonth.getEligibilityEndDt() != null)
					{
						aEdIndvEligibilityCargo
						.setEligibilityEndDt(aEdIndvEligibilityCargoPrevMonth
								.getEligibilityEndDt());
					}
					else
					{
						aEdIndvEligibilityCargo
						.setEligibilityEndDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));
					}

				}
			}
			//<BRGUS00149688><kucherlapatis><05/28/2009><Java Fix To Build DSS For One Day>
			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_DS)) {
				aEdIndvEligibilityCargo
				.setEligibilityEndDt(DateComparisons.subDays(aEdEligibilityCargo.getPaymentBegDt(),1));
			}
			//Setting eligibility end date for spenddown TOAs
			/*
			 * Begin BRGUS00101130 – kesavanr Setting individual eligibility end
			 * date for spend down TOAs if terminated.
			 */
			if (aEdEligibilityCargo.getTypeOfAssistanceCd() != null
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith(
							"G2")) {
				aEdIndvEligibilityCargo.setEligibilityEndDt(null);
			}
			if (aEdIndvEligibilityCargo.getEligibilityBegDt() != null
					&& aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith(
							"G2")
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_APPROVED)) {
				aEdIndvEligibilityCargo.setEligibilityEndDt(aEdEligibilityCargo
						.getPaymentEndDt());
			}
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				if (aEdIndvEligibilityCargo.getEligibilityBegDt() != null) {
					aEdIndvEligibilityCargo.setEligibilityEndDt(DateComparisons
							.getLastDayOfPreviousMonth(aEdEligibilityCargo
									.getPaymentBegDt()));
				}
			}
			//End BRGUS00101130

			if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_DENIED)) {
				aEdIndvEligibilityCargo.setEligibilityEndDt(null);
			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvEligEndDt", ex);
		}
	}

	/**
	 * Determines the EligRsltCd in the EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public static void detIndvEligRsltCd(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo)
			throws EDBCException {
		try {
			if (((aEdEligibilityCargo.getCgStatusCd() != null) && (aEdEligibilityCargo
					.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED)))
					|| ((aEdEligibilityCargo.getCgStatusCd() != null) && (aEdEligibilityCargo
							.getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_TERMINATED)))) {
				aEdIndvEligibilityCargo
						.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			} else if (aEdEligibilityCargo.getCgStatusCd() != null
					&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_APPROVED)
					&& aEdEligibilityCargo.getCgEligRsltCd() != null
					&& aEdEligibilityCargo.getCgEligRsltCd().equalsIgnoreCase(
							IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aEdIndvEligibilityCargo.getEligibilityBegDt() == null) {
					aEdIndvEligibilityCargo
							.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
				//BEGIN-BRGUS00158837-upadhyayulag-For ongoing 'No Issuance Change' 
				//records, set the elig_rslt_cd to PASS.
				}else{
					if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
							&& (aEdIndvEligibilityCargo.getEligRsltCd()
									.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
						if(aEdEligibilityCargo.getPaymentEndDt() == null 
								&& (aEdEligibilityCargo.getEdbcActionCd().equals
								(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL)
								|| aEdEligibilityCargo.getEdbcActionCd().equals
								(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT))){
							aEdIndvEligibilityCargo
								.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						}
					}
				}
				//END-BRGUS00158837
			} else if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
					&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
				aEdIndvEligibilityCargo
						.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
			} else if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
					&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
				aEdIndvEligibilityCargo
						.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
			} else if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
					&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
				aEdIndvEligibilityCargo
						.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvEligRsltCd", ex);
		}
	}

	/**
	 * Determines the EdIndvElgibility Group Ind.
	 *
	 * @param aEdIndvEligibilityCargo
	 *            us.nm.state.hsd.aspen.business.entities.eligibility.EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public void detIndvGroupInd(EdIndvEligibilityCargo aEdIndvEligibilityCargo)
			throws EDBCException {
		try {
			if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
					&& (aEdIndvEligibilityCargo.getEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
				if ((aEdIndvEligibilityCargo.getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE)
						&& (aEdIndvEligibilityCargo.getGroupInd() == IEdEligCodes.GROUP_IND_C)) {
					aEdIndvEligibilityCargo
							.setGroupInd(IEdEligCodes.GROUP_IND_X);
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvGroupInd", ex);
		}
	}

	/**
	 * Determines the Individual Part Status Cd.
	 *
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public void detIndvPartStatusCd(
			EdIndvEligibilityCargo aEdIndvEligibilityCargo)
			throws EDBCException {
		try {
			if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
					&& (aEdIndvEligibilityCargo.getEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
				if ((aEdIndvEligibilityCargo.getPartStatusCd() != null)
						&& (aEdIndvEligibilityCargo.getPartStatusCd()
								.equals(IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT))) {
					aEdIndvEligibilityCargo
							.setPartStatusCd(IEdEligCodes.PART_STATUS_CD_EXCLUDED_ADULT);
				} else if ((aEdIndvEligibilityCargo.getPartStatusCd() != null)
						&& (aEdIndvEligibilityCargo.getPartStatusCd()
								.equals(IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD))) {
					aEdIndvEligibilityCargo
							.setPartStatusCd(IEdEligCodes.PART_STATUS_CD_EXCLUDED_CHILD);
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvPartStatusCd", ex);
		}
	}

	/**
	 * Determines the Maximum Eligibility Determination Month.
	 *
	 * @param aEligDetail
	 *            EligDetail[]
	 * @return java.sql.Timestamp
	 * @throws EDBCException
	 */
	public java.sql.Timestamp detMaxEDM(EligDetail[] aEligDetail)
			throws EDBCException {
		EdEligibilityCargo[] arrEdEligibilityCargo = null;
		java.sql.Timestamp tsMaxEDM = null;
		boolean onlySER = true;

		try {
			arrEdEligibilityCargo = aEligDetail[0].getEdEligibilityCargo();
			int iLength = 0;
			iLength = arrEdEligibilityCargo.length;
			tsMaxEDM = arrEdEligibilityCargo[0].getPaymentBegDt();
			java.sql.Timestamp tsToBeUsed = null;
			for (int i = 0; i < iLength; i++) {
				tsToBeUsed = null;
				if (arrEdEligibilityCargo[i].getProgramCd().equalsIgnoreCase(
						"CD")
						&& arrEdEligibilityCargo[i].getPaymentEndDt() != null) {
					tsToBeUsed = arrEdEligibilityCargo[i].getPaymentEndDt();
				} else {
					tsToBeUsed = arrEdEligibilityCargo[i].getPaymentBegDt();
				}
				if (tsMaxEDM.before(tsToBeUsed)) {
					tsMaxEDM = tsToBeUsed;
				}
			}
			//BRGUS00056674-Start If This is Only SER case, then add 30 days to
			// max EDM
			for (int i = 0; i < iLength; i++) {
				if (!(arrEdEligibilityCargo[i].getProgramCd()
						.equalsIgnoreCase("SE"))) {
					onlySER = false;
					break;
				}
			}
			//End

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil", "detMaxEDM",
					ex);
		}
		//
		if (onlySER)
			return DateComparisons.addDays(tsMaxEDM, 30);
		else
			return DateComparisons.getLastDayOfDate(tsMaxEDM);
	}

	/**
	 * Determines the Minimum Eligibility Determination Month.
	 *
	 * @param eligDetail
	 *            EligDetail[]
	 * @return java.sql.Timestamp
	 * @throws EDBCException
	 */
	public java.sql.Timestamp detMinEDM(EligDetail[] eligDetail)
			throws EDBCException {
		EdEligibilityCargo[] arrEdEligibilityCargo = null;
		java.sql.Timestamp tsMinEDM = null;
		try {
			arrEdEligibilityCargo = ((EligDetail) eligDetail[0])
					.getEdEligibilityCargo();
			int iLength = 0;
			iLength = arrEdEligibilityCargo.length;
			tsMinEDM = arrEdEligibilityCargo[0].getPaymentBegDt();
			java.sql.Timestamp tsPaymentBegDt = null;
			for (int i = 0; i < iLength; i++) {
				tsPaymentBegDt = null;
				tsPaymentBegDt = arrEdEligibilityCargo[i].getPaymentBegDt();
				if (tsMinEDM.after(tsPaymentBegDt)) {
					tsMinEDM = tsPaymentBegDt;
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil", "detMinEDM",
					ex);
		}
		return tsMinEDM;
	}

	/**
	 * Determines the list of edgNum's for case.
	 *
	 * @param aEligDetail
	 *            EligDetail[]
	 * @return Long[]
	 * @throws EDBCException
	 */
	public Long[] detEdgNums(EligDetail[] aEligDetail) throws EDBCException {
		EdEligibilityCargo[] arrEdEligibilityCargo = null;
		ArrayList alTemp = new ArrayList();
		try {
			arrEdEligibilityCargo = aEligDetail[0].getEdEligibilityCargo();
			int iLength = 0;
			iLength = arrEdEligibilityCargo.length;
			long lEdgNum = 0;
			for (int i = 0; i < iLength; i++) {
				lEdgNum = arrEdEligibilityCargo[i].getEdgNum();
				if (alTemp.contains(new Long(lEdgNum))) {
					continue;
				} else {
					alTemp.add(new Long(lEdgNum));
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil", "detMaxEDM",
					ex);
		}
		return (Long[]) alTemp.toArray(new Long[alTemp.size()]);
	}

	/**
	 * Determines the whether EDG has to run or not.
	 *
	 * @param aArrEdEligibilityCargo
	 *            EdEligibilityCargo[]
	 * @param sMode
	 *            String
	 * @return boolean
	 * @throws EDBCException
	 */
	public boolean detEdgHasToBeRun(
			EdEligibilityCargo[] aArrEdEligibilityCargo, String sMode)
			throws EDBCException {
		try {
			int iLength = 0;
			iLength = aArrEdEligibilityCargo.length;
			for (int i = 0; i < iLength; i++) {
				//Modified switch for QA : 195765
				//switch (sMode.substring(0, 1).toCharArray()[0]) {
				switch (sMode.charAt(0)) {
				case ('N'):
					if (aArrEdEligibilityCargo[i].getNfEligRsltCd() != null) {
						return true;
					}
					break;
				case ('R'):
					if (aArrEdEligibilityCargo[i].getRscEligRsltCd() != null) {
						return true;
					}
					break;
				case ('F'):
					if (aArrEdEligibilityCargo[i].getFinEligRsltCd() != null) {
						return true;
					}
					break;
				case ('E'):
					// Added != NA for CCB:00127585(MM)
					//If condition added for Defect: 230778
					// Else was pre-existing done for CCB 127585
					if (aArrEdEligibilityCargo[i].getEdbcActionCd() != null
							&& (aArrEdEligibilityCargo[i]
									.getEdbcActionCd()
									.equals(
											IEdEligCodes.EDBC_ACTION_CD_FF_MTH1_PENDING)
									|| aArrEdEligibilityCargo[i]
											.getEdbcActionCd()
											.equals(
													IEdEligCodes.EDBC_ACTION_CD_FF_MTH2_PENDING) || aArrEdEligibilityCargo[i]
									.getEdbcActionCd()
									.equals(
											IEdEligCodes.EDBC_ACTION_CD_SANCTION_ON_DENIED))) {
						return false;
					} else if ((aArrEdEligibilityCargo[i].getNfEligRsltCd() != null && !aArrEdEligibilityCargo[i]
							.getNfEligRsltCd().equalsIgnoreCase(
									IEdEligCodes.ELIG_RSLT_CD_NA))
							|| (aArrEdEligibilityCargo[i].getRscEligRsltCd() != null && !aArrEdEligibilityCargo[i]
									.getRscEligRsltCd().equalsIgnoreCase(
											IEdEligCodes.ELIG_RSLT_CD_NA))
							|| (aArrEdEligibilityCargo[i].getFinEligRsltCd() != null && !aArrEdEligibilityCargo[i]
									.getFinEligRsltCd().equalsIgnoreCase(
											IEdEligCodes.ELIG_RSLT_CD_NA))) {
						return true;
					}
					break;
				default:
					return false;
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEdgHasToBeRun", ex);
		}
		return false;
	}

	/**
	 * This method is part of the logic involved in determining the
	 * EstimatedEligEndDt.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEdCaseRecertDates
	 *            EdCaseRecertDatesCargo[]
	 * @param aDcCaseProgramCargo
	 *            DcCaseProgramCargo
	 * @param aEdEligFsBudget
	 *            EdEligFsBudgetCargo[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @param nfDataHandler
	 *            NFDataHandler
	 * @return Timestamp
	 * @throws EDBCException
	 */
	public Timestamp perform6010_080(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EdCaseRecertDatesCargo[] aEdCaseRecertDates,
			DcCaseProgramCargo aDcCaseProgramCargo,
			EdEligFsBudgetCargo[] aEdEligFsBudget, EgDataHandler egDataHandler,
			NFDataHandler nfDataHandler,
			EdEligibilityCargo edEligibilityCargoPrevMonth,
			EdEligNoticeReasonsCargo edEligNoticeReasonsCargo)
			throws EDBCException {
		Timestamp tsEstimatedEligEndDt = null;
		try {
			//Added second part of if for defect 91102
			//Added Tp40 part for defect 90863
			//Following line modified for QA Defect 00195765
			//if ((aEdEligibilityCargo.getEstimatedEligEndDt() != null &&
			// (!aEdEligibilityCargo.getEstimatedEligEndDt().equals(""))) &&
			// (!aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_02))
			// &&
			// (!aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_40)))
			// {
			// beniwala - ASPEN00017459 - fix findbugs issue
			if ((aEdEligibilityCargo.getEstimatedEligEndDt() != null)
					&& (!IEdEligCodes.TP_02.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))
                    //Begin BRGUS00107997 – kesavanr – Return esteligenddt if TOA is not RAPC.
                    && (!IEdEligCodes.RAPC.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))
					&& (!IEdEligCodes.TP_40.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))
					// beniwala - ASPEN00042439 - MAPS should work as TP40
					&& !IEdEligCodes.TP_MA_MAPS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
				return tsEstimatedEligEndDt;
			} else {
				// beniwala - ASPEN00015918 - logic of estimatedEligEndDt for TP01 made similar to FS
				/* beniwala - ASPEN00017348 - for Wage Subsidy, cert period is 12 month and Intermim Review period is 6 month
				 * For GA- Unrelated Child, cert period is 3 month. For Eduction Works, its fixed 6 month cert period
				 * For Diversion Payment and ARSCH, cert period is 12 month
				 */
				// beniwala - ASPEN00036947 - set cert period for Support Services also
				if (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
						 || IEdEligCodes.WASU.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.TP_GAUC.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.TP_SDA.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.ENWP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.TP_71.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.TP_ARSH.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
						 || IEdEligCodes.TP_SSSA.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					//Added for CMA Changes
					//Re Determination For CR 21023
					if (IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())) {
						aEdEligibilityCargo.setCertBegDt(DateComparisons
								.getFirstDayOfDate(aEdEligibilityCargo
										.getPaymentBegDt()));
					} else {
						aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo
								.getPaymentBegDt());
					} ///Re Determination For CR 21023

					aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo
							.getPaymentBegDt());
					aEdEligibilityCargo
							.setDispositionCertBegDt(aEdEligibilityCargo
									.getEdbcRunDt());
					//added for defect 104597
					Timestamp tsDateToBeUsed = detEligOrPaymentBegDt(
							aEdEligibilityCargo, egDataHandler);
					egDataHandler
							.setTsDateToBeUsedForFSEstEligEndDt(tsDateToBeUsed);

					// beniwala - ASPEN00049529
					tsEstimatedEligEndDt = perform6010_090(aEdEligibilityCargo,
							aEdIndvEligibilityCargo, aDcCaseProgramCargo,
							aEdEligFsBudget, nfDataHandler, egDataHandler,
							edEligNoticeReasonsCargo,
							edEligibilityCargoPrevMonth, aEdCaseRecertDates);
					// beniwala - ASPEN00017459 - EstimatedEligibilityEnd Date might be null 
					if(tsEstimatedEligEndDt != null) {
						int iEstYear = DateComparisons
								.getYYYY(tsEstimatedEligEndDt);
						int iEstMth = DateComparisons.getMM(tsEstimatedEligEndDt);
						int iRunYear = DateComparisons.getYYYY(aEdEligibilityCargo
								.getEdbcRunDt());
						int iRunMth = DateComparisons.getMM(aEdEligibilityCargo
								.getEdbcRunDt());
						// beniwala - ASPEN00015918
						if (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
								|| IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
							if (iEstYear < iRunYear) {
								tsEstimatedEligEndDt = DateComparisons
										.getLastDayOfDate(DateComparisons
												.getFirstDayOfNextMonth(aEdEligibilityCargo
														.getEdbcRunDt()));
							} else if (iEstYear == iRunYear && iEstMth < iRunMth) {
								tsEstimatedEligEndDt = DateComparisons
										.getLastDayOfDate(DateComparisons
												.getFirstDayOfNextMonth(aEdEligibilityCargo
														.getEdbcRunDt()));
							}
						}
					}
					
				} else {
					// beniwala - ASPEN00042439 - MAPS should behave like TP40
					/*if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_40)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.G2PM)) {*/
					if (IEdEligCodes.TP_40.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							|| IEdEligCodes.G2PM.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							|| IEdEligCodes.TP_MA_MAPS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
						int iLength = 0;
						iLength = aEdIndvEligibilityCargo.length;
						//Timestamp tsEligBegDtPlusElevenMths = null;
						//Commented for defect - 132263
						/*
						 * if (aEdEligibilityCargo.getEligibilityBegDt() !=
						 * null) { tsEligBegDtPlusElevenMths =
						 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEligibilityBegDt(),
						 * 11)))); }
						 */
						HashMap hmDcPregnancies = null;
						Timestamp tsTermDueDt = null;
						for (int i = 0; i < iLength; i++) {
							if (aEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE
									&& aEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
								//HashMap hmDcPregnancies =
								// NFUtil.detDcPregnanciesInfoMonthlyHM(nfDataHandler.getIndivNonFinInfo().getDcPregnanciesCargo(),
								// aEdEligibilityCargo.getPaymentBegDt(), false,
								// null);
								//Following method is modified to use EdDcUtil
								// instead of NFUtil - Sai 12/9/2004
								hmDcPregnancies = NFUtil
										.detDcPregnanciesInfoMonthlyHM(
												egDataHandler, nfDataHandler);
								// hmDcPregnancies =
								// edDcUtil.detDcPregnanciesInfoMonthlyHM(egDataHandler);
								if (hmDcPregnancies
										.containsKey(new Long(
												aEdIndvEligibilityCargo[i]
														.getIndvId()))) {
									tsTermDueDt = ((DcPregnanciesCargo) hmDcPregnancies
											.get(new Long(
													aEdIndvEligibilityCargo[i]
															.getIndvId())))
											.getTerminationDt();
									if (tsTermDueDt == null) {
										tsTermDueDt = ((DcPregnanciesCargo) hmDcPregnancies
												.get(new Long(
														aEdIndvEligibilityCargo[i]
																.getIndvId())))
												.getDueDt();
									}
									tsEstimatedEligEndDt = DateComparisons
											.getLastDayOfDate(DateComparisons
													.addMonths(tsTermDueDt, 2));
									//Added for defect 154259
									//									if (aEdCaseRecertDates != null &&
									// aEdCaseRecertDates[0] != null &&
									// aEdCaseRecertDates[0].getRecertReviewDueDt()
									// != null) {
									//Modified for defect 172917
									if (egDataHandler
											.getEligDetailUnAuthCurrEDM()
											.getEdCaseRecertDatesCargo() != null
											&& egDataHandler
													.getEligDetailUnAuthCurrEDM()
													.getEdCaseRecertDatesCargo()[0] != null
											&& egDataHandler
													.getEligDetailUnAuthCurrEDM()
													.getEdCaseRecertDatesCargo()[0]
													.getRecertReviewDueDt() != null) {
										if (tsEstimatedEligEndDt
												.after(egDataHandler
														.getEligDetailUnAuthCurrEDM()
														.getEdCaseRecertDatesCargo()[0]
														.getRecertReviewDueDt())
												|| tsEstimatedEligEndDt
														.equals(egDataHandler
																.getEligDetailUnAuthCurrEDM()
																.getEdCaseRecertDatesCargo()[0]
																.getRecertReviewDueDt())) {
										} else {
											if (tsEstimatedEligEndDt
													.before(DateComparisons
															.getLastDayOfDate(aEdEligibilityCargo
																	.getEdbcRunDt()))
													|| tsEstimatedEligEndDt
															.equals(DateComparisons
																	.getLastDayOfDate(aEdEligibilityCargo
																			.getEdbcRunDt()))) {
												if (aEdEligibilityCargo
														.getEdbcRunDt()
														.after(
																getBiCutOffDate(aEdEligibilityCargo))) {
													if (DateComparisons
															.getLastDayOfDate(
																	DateComparisons
																			.addMonths(
																					aEdEligibilityCargo
																							.getEdbcRunDt(),
																					1))
															.before(
																	egDataHandler
																			.getEligDetailUnAuthCurrEDM()
																			.getEdCaseRecertDatesCargo()[0]
																			.getRecertReviewDueDt())) {
														tsEstimatedEligEndDt = DateComparisons
																.getLastDayOfDate(DateComparisons
																		.addMonths(
																				aEdEligibilityCargo
																						.getEdbcRunDt(),
																				1));
													} else {
														tsEstimatedEligEndDt = egDataHandler
																.getEligDetailUnAuthCurrEDM()
																.getEdCaseRecertDatesCargo()[0]
																.getRecertReviewDueDt();
													}
												} else {
													if (DateComparisons
															.getLastDayOfDate(
																	aEdEligibilityCargo
																			.getEdbcRunDt())
															.before(
																	egDataHandler
																			.getEligDetailUnAuthCurrEDM()
																			.getEdCaseRecertDatesCargo()[0]
																			.getRecertReviewDueDt())) {
														tsEstimatedEligEndDt = DateComparisons
																.getLastDayOfDate(aEdEligibilityCargo
																		.getEdbcRunDt());
													} else {
														tsEstimatedEligEndDt = egDataHandler
																.getEligDetailUnAuthCurrEDM()
																.getEdCaseRecertDatesCargo()[0]
																.getRecertReviewDueDt();
													}
												}
											} else {
											}
										}
									}
									//Added for defect 90863, //Commented for
									// defect - 132263
									/*
									 * if (tsEligBegDtPlusElevenMths != null &&
									 * tsEstimatedEligEndDt != null &&
									 * tsEstimatedEligEndDt.after(tsEligBegDtPlusElevenMths)) {
									 * tsEstimatedEligEndDt =
									 * tsEligBegDtPlusElevenMths; }
									 */
									break;
								}
							}
						}
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_45)) {
						// done by NF (2000_166)
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_02)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.RAPC)) {
						/* Begin BRGUS00078797 – kesavanr
						 * Determining RAPC estimated eligibility end date as latest USEntryDt or GrantDt + 7 months.
						 */
						Timestamp tsHighestEntryDt = null;
						//tsLowestEntryDt = DateComparisons.getRunDate();
						tsHighestEntryDt = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
						//End BRGUS00078797
						int iLength = 0;
						iLength = aEdIndvEligibilityCargo.length;
						boolean bFlag = false;
						//<BRGUS00146278><kucherlapatis><03/17/2009><Java and DT Fix For Afghan and Iraqi Aliens>
//						<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
						/*boolean bAlienA4A5 = false;
						String greatestAlienTypeCd = null;*/
						ArrayList alTemp = new ArrayList();
						Timestamp tsMaxEDM = detMaxEDM(egDataHandler
								.getEligDetail());
						HashMap hmDcIndividualAlien = null;
						for (int i = 0; i < iLength; i++) {
							if (aEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE
									&& aEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
								//Following method is modified to use EdDcUtil
								// instead of NFUtil - Sai 12/9/2004
								//hmDcIndividualAlien =
								// edDcUtil.detDcIndividualAlienInfoMonthlyHM(egDataHandler);
								hmDcIndividualAlien = NFUtil
										.detDcIndividualAlienInfoMonthlyHM(
												egDataHandler, nfDataHandler);
								if (hmDcIndividualAlien
										.containsKey(new Long(
												aEdIndvEligibilityCargo[i]
														.getIndvId()))) {
									if (((DcIndividualAlienCargo) hmDcIndividualAlien
											.get(new Long(
													aEdIndvEligibilityCargo[i]
															.getIndvId())))
											.getGrantDt() != null) {
										if (((DcIndividualAlienCargo) hmDcIndividualAlien
												.get(new Long(
														aEdIndvEligibilityCargo[i]
																.getIndvId())))
												/* Begin BRGUS00078797 – kesavanr
												 * Determining RAPC estimated eligibility end date as latest USEntryDt or GrantDt + 7 months.
												 */
												.getGrantDt().after(
														tsHighestEntryDt)) {
											tsHighestEntryDt = ((DcIndividualAlienCargo) hmDcIndividualAlien
													.get(new Long(
															aEdIndvEligibilityCargo[i]
																	.getIndvId())))
													.getGrantDt();
//											<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
											/*greatestAlienTypeCd = ""+((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(aEdIndvEligibilityCargo[i].getIndvId()))).getAlienTypeCd();
											if(greatestAlienTypeCd.equalsIgnoreCase("A4") ||
													greatestAlienTypeCd.equalsIgnoreCase("A5")) {
												bAlienA4A5 =  true;
											}*/
											alTemp.add(tsHighestEntryDt);
										}
									} else {
										if (((DcIndividualAlienCargo) hmDcIndividualAlien
												.get(new Long(
														aEdIndvEligibilityCargo[i]
																.getIndvId())))
												.getUsEntryDt() != null) {
											if (((DcIndividualAlienCargo) hmDcIndividualAlien
													.get(new Long(
															aEdIndvEligibilityCargo[i]
																	.getIndvId())))
													/* Begin BRGUS00078797 – kesavanr
													 * Determining RAPC estimated eligibility end date as latest USEntryDt or GrantDt + 7 months.
													 */
													.getUsEntryDt().after(
															tsHighestEntryDt)) {
												tsHighestEntryDt = ((DcIndividualAlienCargo) hmDcIndividualAlien
														.get(new Long(
																aEdIndvEligibilityCargo[i]
																		.getIndvId())))
														.getUsEntryDt();
//												<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
												/*greatestAlienTypeCd = ""+((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(aEdIndvEligibilityCargo[i].getIndvId()))).getAlienTypeCd();
												if(greatestAlienTypeCd.equalsIgnoreCase("A4") ||
														greatestAlienTypeCd.equalsIgnoreCase("A5")) {
													bAlienA4A5 =  true;
												}*/
												//End BRGUS00078797
												alTemp.add(tsHighestEntryDt);
											}
										}
									}
								}

							}
						}
						//Modifed for defect 96146 for changing the driver
						// logic to pick up the next lowest entry person whose
						// estimatedeligend is coming on or after the max run
						// month for RMA
						/* Begin BRGUS00078797 – kesavanr
						 * Determining RAPC estimated eligibility end date as latest USEntryDt or GrantDt + 7 months.
						 */
						Timestamp[] arrTsHighest = (Timestamp[]) alTemp
								.toArray(new Timestamp[alTemp.size()]);
						//BRGUS00078797 – kesavanr – Determining RAPC estimated eligibility end date as latest USEntryDt or GrantDt + 7 months.
						//<BRGUS00146278><kucherlapatis><03/17/2009><Java and DT Fix For Afghan and Iraqi Aliens>
						int iHighestLength = arrTsHighest.length;
						int iEstYear = 0;
						int iEstMth = 0;
						int iRunYear = 0;
						int iRunMth = 0;
						for (int i = iHighestLength - 1; i >= 0; i--) {
//							<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
							/*if(bAlienA4A5) {
								iEstYear = DateComparisons.getYYYY(DateComparisons
										.addMonths(arrTsHighest[i], 5));
								iEstMth = DateComparisons.getMM(DateComparisons
										.addMonths(arrTsHighest[i], 5));
							} else {*/
							iEstYear = DateComparisons.getYYYY(DateComparisons
									.addMonths(arrTsHighest[i], 7));
							iEstMth = DateComparisons.getMM(DateComparisons
									.addMonths(arrTsHighest[i], 7));
						//	}
							iRunYear = DateComparisons.getYYYY(tsMaxEDM);
							iRunMth = DateComparisons.getMM(tsMaxEDM);
							if (iEstYear > iRunYear) {
//								<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
								/*if(bAlienA4A5) {
									tsEstimatedEligEndDt = DateComparisons
									.addMonths(arrTsHighest[i],5);
								}  else {*/
								tsEstimatedEligEndDt = DateComparisons
										.addMonths(arrTsHighest[i], 7);
								//}
								bFlag = true;
								break;
							} else if (iEstYear == iRunYear
									&& iEstMth >= iRunMth) {
//								<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
								/*if(bAlienA4A5) {
									tsEstimatedEligEndDt = DateComparisons
									.addMonths(arrTsHighest[i],5);
								}  	else {*/
								tsEstimatedEligEndDt = DateComparisons
										.addMonths(arrTsHighest[i], 7);
								//}
								bFlag = true;
								break;
							}
						}
						if (bFlag == false) {
							//Added the length check for defect 234937
							if (arrTsHighest.length > 0) {
								tsEstimatedEligEndDt = DateComparisons
										.addMonths(
												arrTsHighest[arrTsHighest.length - 1],
												7);
							}
						}
						//End BRGUS00078797
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_20)) {
						egDataHandler.detEligDetailLastAuthPrevEDM(
								egDataHandler.getEligDetail()[1],
								aEdEligibilityCargo);
						if ((egDataHandler.getEligDetailLastAuthPrevEDM() != null && egDataHandler
								.getEligDetailLastAuthPrevEDM()
								.getEdEligibilityCargo()[0]
								.getEstimatedEligEndDt() != null)
								&& (egDataHandler
										.getEligDetailLastAuthPrevEDM() != null && egDataHandler
										.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt().after(
												aEdEligibilityCargo
														.getEligibilityBegDt()))) {
							tsEstimatedEligEndDt = egDataHandler
									.getEligDetailLastAuthPrevEDM()
									.getEdEligibilityCargo()[0]
									.getEstimatedEligEndDt();
						} else {
							tsEstimatedEligEndDt = DateComparisons.addMonths(
									aEdEligibilityCargo.getEligibilityBegDt(),
									3);
						}
						//<BRGUS00248390><kucherlapatis><1/12/2011>
						//<Java Fix To Extend The TMA Certification Period For 12 Months>
					} else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_07)) {
						egDataHandler.detEligDetailLastAuthPrevEDM(
								egDataHandler.getEligDetail()[1],
								aEdEligibilityCargo);
						if (egDataHandler.getEligDetailLastAuthPrevEDM() != null
								&& egDataHandler.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt() != null
								&& (egDataHandler
										.getEligDetailLastAuthPrevEDM() != null && egDataHandler
										.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt().after(
												aEdEligibilityCargo
														.getEligibilityBegDt())
										&& egDataHandler
										.getEligDetailLastAuthPrevEDM()
										.getEdEligibilityCargo()[0]
										.getCgStatusCd()
										.equalsIgnoreCase("AP"))) {
							tsEstimatedEligEndDt = egDataHandler
									.getEligDetailLastAuthPrevEDM()
									.getEdEligibilityCargo()[0]
									.getEstimatedEligEndDt();
						} else {
							tsEstimatedEligEndDt = DateComparisons.addMonths(
									aEdEligibilityCargo.getEligibilityBegDt(),
									11);
						}
						//Development Activity : 29164
						//Setting Estimated eligibility end date and cert end
						// dt to null for TOA 'RUMM' and ProgramCd 'MA'
					} else if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FMA)
							&& aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_RUMM)) {
						tsEstimatedEligEndDt = null;
						aEdEligibilityCargo.setCertEndDt(null);
					}
					//new Code

					else if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FMA)
							&& aEdEligibilityCargo.getPriorMedicalCd().equals(
									"P0") == false) {
						aEdEligibilityCargo.setCertEndDt(null);
					}

					//Setting estimated eligibility end date for TSO
					else if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_ME)
							&& aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.SSIT)) {
						tsEstimatedEligEndDt = DateComparisons.addMonths(
								aEdEligibilityCargo.getEligibilityBegDt(), 1);
					} 
					/*  beniwala - ASPEN00015918 - for Transitional Bonus, estEligEndDt = paymentBegDt + 5 months
					 *  For TP01, the logic is similar to FS now, so commenting out if condition for TP01
					 */
					/* beniwala - ASPEN00032076 - Transitional Bonus is not a separate TOA
					 * else if (IEdEligCodes.TP_TRBP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
							aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_01)
							&& aEdEligibilityCargo.getEfipEligSw() == 'Y') {
						tsEstimatedEligEndDt = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(
								aEdEligibilityCargo.getPaymentBegDt(), 5));
						// beniwala - ASPEN00017348 - cert period is 18 month 
						aEdEligibilityCargo.setCertEndDt(DateComparisons.
								getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 17)));
						aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo
								.getPaymentBegDt());
					//BEGIN-BRGUS00146278-upadhyayulag-For non-EFIP records,SDAC & CDCS, calculate
					//the estimated eligibility end date from alien information (Afghan/Iraqi)
//						<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
					}else if ((aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01) 
									&& aEdEligibilityCargo.getEfipEligSw() != 'Y') ||
								aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_SDA) ||
								aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.CDCS)){
						tsEstimatedEligEndDt = detEstEligEndDtCertifiedGroupAlienAfghanIraqi(aEdEligibilityCargo,
								aEdIndvEligibilityCargo,nfDataHandler,egDataHandler);
					//END-BRGUS00146278
					
					 * Defect ID : BRGUS00097583 Added By : kesavanr Date :
					 * 02/15/2008 Change : Setting cert begin date and cert end
					 * date same as TP43 and TP44.
					 *
					 
					}*/else if (aEdEligibilityCargo.getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_43)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_44)
							|| aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.HKEM)) {
						// beniwala - ASPEN00043823 - do not calculate cert period for Child MA COEs
						/*detCMACertificationPeriod(aEdEligibilityCargo,
								aEdIndvEligibilityCargo, egDataHandler,
								nfDataHandler);*/
						/*
						 * if
						 * (aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
						 * Timestamp tsTemp =
						 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEdbcRunDt(),
						 * 6)))); int iLength = 0; iLength =
						 * aEdIndvEligibilityCargo.length; for (int i = 0; i <
						 * iLength; i++) { if
						 * (aEdIndvEligibilityCargo[i].getGroupInd() !=
						 * IEdEligCodes.CHAR_INIT_SPACE &&
						 * aEdIndvEligibilityCargo[i].getGroupInd() ==
						 * IEdEligCodes.GROUP_IND_C) { HashMap hmDcIdnv =
						 * NFUtil.detDcIndvInfoMonthlyHM(egDataHandler,
						 * nfDataHandler); if (hmDcIdnv.containsKey(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))) { if
						 * (((DcIndvCargo) hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt() !=
						 * null) { if
						 * (DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
						 * hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
						 * 19)))).before(tsTemp)) { tsTemp =
						 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
						 * hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
						 * 19)))); } } } } } tsEstimatedEligEndDt = tsTemp; }
						 * else { if
						 * (aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
						 * Timestamp tsTemp =
						 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEdbcRunDt(),
						 * 5)))); int iLength = 0; iLength =
						 * aEdIndvEligibilityCargo.length; for (int i = 0; i <
						 * iLength; i++) { if
						 * (aEdIndvEligibilityCargo[i].getGroupInd() !=
						 * IEdEligCodes.CHAR_INIT_SPACE &&
						 * aEdIndvEligibilityCargo[i].getGroupInd() ==
						 * IEdEligCodes.GROUP_IND_C) { HashMap hmDcIdnv =
						 * NFUtil.detDcIndvInfoMonthlyHM(egDataHandler,
						 * nfDataHandler); if (hmDcIdnv.containsKey(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))) { if
						 * (((DcIndvCargo) hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt() !=
						 * null) { if
						 * (DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
						 * hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
						 * 19)))).before(tsTemp)) { tsTemp =
						 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
						 * hmDcIdnv.get(new
						 * Long(aEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
						 * 19)))); } } } } } tsEstimatedEligEndDt = tsTemp; } }
						 */
						// Added for defect 121033
					}
					//Start : ASPEN00022082 - Updated by Deepak for MA - CHIP to set tsEstimatedEligEndDt and cert period for 12 month
					else if (IEdEligCodes.TP_CHIP.equalsIgnoreCase(
							aEdEligibilityCargo.getTypeOfAssistanceCd())							) {
						tsEstimatedEligEndDt = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(
								aEdEligibilityCargo.getPaymentBegDt(), 11));
						// beniwala - ASPEN00043823 - do not calculate cert period for CHIP
						/*aEdEligibilityCargo.setCertEndDt(DateComparisons.
								getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 11)));
						aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo
								.getPaymentBegDt());*/
					}
					//End : ASPEN00022082 - Updated by Deepak for MA - CHIP to set cert period for 12 month
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"perform6010_080", ex);
		}
		return tsEstimatedEligEndDt;
	}

	/**
	 * This method is part of the logic involved in determining the
	 * EstimatedEligEndDt.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEdCaseRecertDates
	 *            EdCaseRecertDatesCargo[]
	 * @param aDcCaseProgramCargo
	 *            DcCaseProgramCargo
	 * @param aEdEligFsBudget
	 *            EdEligFsBudgetCargo[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @param nfDataHandler
	 *            NFDataHandler
	 * @return Timestamp
	 * @throws EDBCException
	 */
	public static Timestamp perform6010_085(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EdCaseRecertDatesCargo[] aEdCaseRecertDates,
			DcCaseProgramCargo aDcCaseProgramCargo,
			EdEligFsBudgetCargo[] aEdEligFsBudget, EgDataHandler egDataHandler,
			NFDataHandler nfDataHandler) throws EDBCException {
		Timestamp tsEstimatedEligEndDt = null;
		Timestamp tsEligibilityBegDt = null;
		Timestamp tsEligibilityBegDtPlus5Mths = null;
		//Commented due to FindBugs Analysis
		//Timestamp tsEligibilityBegDtPlus11Mths = null;
		//added for defect 104597
		tsEligibilityBegDt = egDataHandler.getTsDateToBeUsedForFSEstEligEndDt();
		//			tsEligibilityBegDt = aEdEligibilityCargo.getEligibilityBegDt();
		if (tsEligibilityBegDt != null) {
			tsEligibilityBegDtPlus5Mths = DateComparisons
					.getLastDayOfDate(DateComparisons.addMonths(
							tsEligibilityBegDt, 5));
			//Commented due to FindBugs Analysis
			//tsEligibilityBegDtPlus11Mths =
			// DateComparisons.getLastDayOfDate(DateComparisons.addMonths(tsEligibilityBegDt,
			// 11));
		}
		if ((aEdEligibilityCargo.getTypeOfAssistanceCd() != null)
				&& (aEdEligibilityCargo.getTypeOfAssistanceCd()
						.equals(IEdEligCodes.TP_06))) {
			tsEstimatedEligEndDt = tsEligibilityBegDtPlus5Mths;
			if (detTanfPayeeParentORC(aEdIndvEligibilityCargo, egDataHandler) == true) {
				if (aEdCaseRecertDates != null) {
					Timestamp tsRecertReviewDueDtMonthEnd = null;
					for (int i = 0; i < aEdCaseRecertDates.length; i++) {
						if (aEdCaseRecertDates[i].getRecertReviewDueDt() != null) {
							tsRecertReviewDueDtMonthEnd = DateComparisons
									.getLastDayOfDate(aEdCaseRecertDates[i]
											.getRecertReviewDueDt());
						}
						if (((tsRecertReviewDueDtMonthEnd != null)
								&& (tsRecertReviewDueDtMonthEnd
										.after(tsEligibilityBegDtPlus5Mths)) || (tsRecertReviewDueDtMonthEnd != null)
								&& (tsRecertReviewDueDtMonthEnd
										.equals(tsEligibilityBegDtPlus5Mths)))
								&& ((aEdCaseRecertDates[i].getProgramCd() != null) && (aEdCaseRecertDates[i]
										.getProgramCd()
										.equals(IEdEligCodes.PROGRAM_CD_TANF)))) {
							if (((tsRecertReviewDueDtMonthEnd != null)
									&& (tsRecertReviewDueDtMonthEnd
											.after(tsEligibilityBegDtPlus5Mths)) || (tsRecertReviewDueDtMonthEnd != null)
									&& (tsRecertReviewDueDtMonthEnd
											.equals(tsEligibilityBegDtPlus5Mths)))
									&& ((aEdCaseRecertDates[i].getProgramCd() != null) && (aEdCaseRecertDates[i]
											.getProgramCd()
											.equals(IEdEligCodes.PROGRAM_CD_TANF)))) {
								tsEstimatedEligEndDt = tsEligibilityBegDtPlus5Mths;
								break;
							} else {
								tsEstimatedEligEndDt = tsRecertReviewDueDtMonthEnd;
								break;
							}
						}
					}
				}
			}
		} else if ((aEdEligibilityCargo.getTypeOfAssistanceCd() != null)
				&& (aEdEligibilityCargo.getTypeOfAssistanceCd()
						.equals(IEdEligCodes.TP_09))) {
			// beniwala - ASPEN00049529
			tsEstimatedEligEndDt = perform6010_090(aEdEligibilityCargo,
					aEdIndvEligibilityCargo, aDcCaseProgramCargo,
					aEdEligFsBudget, nfDataHandler, egDataHandler, null, null, aEdCaseRecertDates);
		}
		return tsEstimatedEligEndDt;
	}

	/**
	 * Method detTanfPayeeParentORC, determines the Tanf Payee parent for minor
	 * or Other related care taker.
	 *
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @return boolean
	 * @throws EDBCException
	 */
	public static boolean detTanfPayeeParentORC(
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EgDataHandler egDataHandler) throws EDBCException {
		boolean isTanfPayeeParentORC = false;
		EligDetail[] arrEligDetailPrevProcLocal = egDataHandler
				.getEligDetailUAProcTfFmaCurrEDMEdges();
		int iLengthPrevProc = 0;
		if (arrEligDetailPrevProcLocal != null) {
			iLengthPrevProc = arrEligDetailPrevProcLocal.length;
		}
		int iLengthIndvCurr = aEdIndvEligibilityCargo.length;
		long lIndvId = 0;
		for (int k = 0; k < iLengthIndvCurr; k++) {
			if (aEdIndvEligibilityCargo[k].getTargetSw() == IEdEligCodes.YES) {
				lIndvId = aEdIndvEligibilityCargo[k].getIndvId();
			}
		}
		int iLengthIndv = 0;
		for (int i = 0; i < iLengthPrevProc; i++) {
			iLengthIndv = 0;
			iLengthIndv = arrEligDetailPrevProcLocal[i]
					.getEdIndvEligibilityCargo().length;
			if (arrEligDetailPrevProcLocal[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
				for (int j = 0; j < iLengthIndv; j++) {
					if (arrEligDetailPrevProcLocal[i]
							.getEdIndvEligibilityCargo()[j].getInclusionRsnCd()
							.equals(IEdEligCodes.INCLUSION_RSN_MINOR_PARENT)
							|| arrEligDetailPrevProcLocal[i]
									.getEdIndvEligibilityCargo()[j]
									.getInclusionRsnCd()
									.equals(
											IEdEligCodes.INCLUSION_RSN_OTHER_RELATED_CARE_TAKER)) {
						if (lIndvId == arrEligDetailPrevProcLocal[i]
								.getEdIndvEligibilityCargo()[j].getIndvId()) {
							isTanfPayeeParentORC = true;
							break;
						}
					}
				}
			}
		}
		return isTanfPayeeParentORC;
	}


	/**
	 * This method is part of the logic involved in determining the
	 * EstimatedEligEndDt.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aDcCaseProgram
	 *            DcCaseProgramCargo
	 * @param aEdEligFsBudget
	 *            EdEligFsBudgetCargo[]
	 * @param nfDataHandler
	 *            NFDataHandler
	 * @param egDataHandler
	 *            EgDataHandler
	 * @return Timestamp
	 * @throws EDBCException
	 */
	public static Timestamp perform6010_090(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			DcCaseProgramCargo aDcCaseProgram,
			EdEligFsBudgetCargo[] aEdEligFsBudget, NFDataHandler nfDataHandler,
			EgDataHandler egDataHandler,
			EdEligNoticeReasonsCargo edEligNoticeReasonCargo,
			EdEligibilityCargo edEligibilityCargoPrevMonth, EdCaseRecertDatesCargo[] aEdCaseRecertDatesCargo)
			throws EDBCException {

		//Dev Activity : BRGUS00010277
		Timestamp tsEstimatedEligEndDt = null;
		boolean estEligFlag24 = false;
		// Defect: BRGUS00084957
		// Changed the variable name
		boolean agedAndDisabledIndvFlag = false;
		boolean isEarnedIncome = true;
		boolean midCertShortSwFlagByDriver = false;
		boolean earnigsReported = false;
		DiFsCertification diFsCertification = new DiFsCertification();
		DcCaseMiscInfoCargo dcCaseMiscInfoCargo = null;
		if (nfDataHandler.getIndivNonFinInfo().getDcCaseMiscInfoCargo() != null
				&& nfDataHandler.getIndivNonFinInfo().getDcCaseMiscInfoCargo().length > 0) {
			dcCaseMiscInfoCargo = nfDataHandler.getIndivNonFinInfo()
					.getDcCaseMiscInfoCargo()[0];
		}
		//BRGUS00252918 - Last authorized edEeligibilityRecord
		EdEligibilityCargo lastAuthorizedEdEligiCargo = null;
		if(egDataHandler.getEligDetailLastAuth() != null &&
				egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null &&
				egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length > 0){
			lastAuthorizedEdEligiCargo = egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0];
		}
		//BRGUS00252918 - End
		//MICAP Changes
		DcCaseProgramIndvCargo[] dcCasePgmIndvCargo = null;
		boolean miCapindv = false;
		if (nfDataHandler.getIndivNonFinInfo() != null) {
			dcCasePgmIndvCargo = nfDataHandler.getIndivNonFinInfo()
					.getDcCaseProgramIndvCargo();
		}
		if (dcCasePgmIndvCargo != null) {
			for (int len = 0; len < dcCasePgmIndvCargo.length; len++) {
				if (dcCasePgmIndvCargo[len].getProgCd().equalsIgnoreCase(
						IEdEligCodes.PROGRAM_CD_FS)
						&& dcCasePgmIndvCargo[len].getMaFormCd() != null
						&& dcCasePgmIndvCargo[len].getMaFormCd()
								.equalsIgnoreCase("MC"))
					miCapindv = true;
				break;
			}
		}
		if(miCapindv){

			if(aEdEligibilityCargo.getCertEndDt() == null){
				tsEstimatedEligEndDt = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(),35));
				aEdEligibilityCargo.setCertEndDt(tsEstimatedEligEndDt);
				return tsEstimatedEligEndDt;
			}

		}
		//END
		/*
		 * Defect ID : BRGUS00076458 Added By : phadtarep Date : 02/26/2008
		 * Change : Logic to decide benefit period is separated from EdUtil and
		 * called from DiFsCertification
		 *
		 */
		/*
		 * Defect ID : BRGUS00100240 Added By : phadtarep Date : 03/21/2008
		 * Change : Unstable circumstances will get next priority over SR to
		 * decide Benefit Period for FAP
		 *
		 */
		//	 if(dcCaseMiscInfoCargo != null &&
		// dcCaseMiscInfoCargo.getUnstableCircSw() == 'N') {
		isEarnedIncome = diFsCertification.verifyEarnings(aEdEligibilityCargo,
				aEdIndvEligibilityCargo, aEdEligFsBudget, nfDataHandler,
				egDataHandler, edEligibilityCargoPrevMonth);

		agedAndDisabledIndvFlag = diFsCertification.verifyDisablityAndAge(
				aEdEligibilityCargo, aEdIndvEligibilityCargo, aEdEligFsBudget,
				nfDataHandler, egDataHandler, edEligibilityCargoPrevMonth);
		//	}
		if (!isEarnedIncome && agedAndDisabledIndvFlag) {
			estEligFlag24 = true;
		}
		if (estEligFlag24) {
			if (aEdEligibilityCargo.getCertEndDt() == null) {//Intake
															 // BRGUS00078188
				if (edEligibilityCargoPrevMonth != null
						&& edEligibilityCargoPrevMonth.getCgStatusCd() != null
						&& edEligibilityCargoPrevMonth
								.getCgStatusCd()
								.equalsIgnoreCase(IEdEligCodes.STATUS_CD_DENIED)
						&& edEligNoticeReasonCargo != null
						&& edEligNoticeReasonCargo.getFailureReasonCode() != null
						&& edEligNoticeReasonCargo.getFailureReasonCode()
								.indexOf("EL3032") != -1) {
					tsEstimatedEligEndDt = DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									edEligibilityCargoPrevMonth
											.getPaymentBegDt(), 23));
				} else {
					tsEstimatedEligEndDt = DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getPaymentBegDt(), 23));
				}
				aEdEligibilityCargo.setCertEndDt(tsEstimatedEligEndDt);
				/*
				 * Begin - beniwala - ASPEN00034743 - estimatedEligEndDt should be 12 months and set in semiAnnualReviewDt
				 * as same form is sent out in NM for 24-month cert period (ISD120) at interim reporting
				 */
				tsEstimatedEligEndDt = DateComparisons
						.getLastDayOfDate(DateComparisons.addMonths(
								aEdEligibilityCargo.getPaymentBegDt(), 11));
				aEdEligibilityCargo.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
				// End - beniwala - ASPEN00034743
				aEdEligibilityCargo.setMidCertEndDt(DateComparisons
						.getLastDayOfDate(DateComparisons.addMonths(
								aEdEligibilityCargo.getPaymentBegDt(), 11)));
				
			}
		} else {
			/*
			 * Defect ID : BRGUS00100240 Added By : phadtarep Date : 03/21/2008
			 * Change : Unstable circumstances will get next priority over SR to
			 * decide Benefit Period for FAP
			 *
			 */
			if (aEdEligibilityCargo.getCertEndDt() == null) {//Intake defect
															 // BRGUS00031758
															 // added only if
															 // condition
				/*
				 * Begin - beniwala - ASPEN00032076 - if efipSw=Y for TP01, then cert period is 18 month and interim reporting period is 6 month
				 */
				if(IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
						&& aEdEligibilityCargo.getEfipEligSw() == 'Y') {
					aEdEligibilityCargo.setCertEndDt(DateComparisons.
							getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 17)));
				}
				// End - beniwala - ASPEN00032076
				// beniwala - ASPEN00017459 - for TP01, in case of simplified reporting, cert period is of 12 months.
				// Else, it is 6 months
				else if (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					if (aEdEligibilityCargo.getSimplifiedReportingGrpCd() != null
							&& "SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())) {
						aEdEligibilityCargo.setCertEndDt(DateComparisons.
								getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 11)));
					} else {
						aEdEligibilityCargo.setCertEndDt(DateComparisons.
								getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 5)));
					}
				}
				// beniwala - ASPEN00017459 - GA-Unrelated Child
				else if(IEdEligCodes.TP_GAUC.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					aEdEligibilityCargo.setCertEndDt(DateComparisons.
							getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 2)));
					//return null;
				}
				/* beniwala - ASPEN00017459 - for GA-Disability, in case of set term cert period is 8 month
				 * for variable term, cert period is 12 month
				 */				
				else if(IEdEligCodes.TP_SDA.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					/*
					 * beniwala - ASPEN00032273 - egDataHandler is needed to fetch Disability Determination details.
					 * EndIndvEligibilityCargos are needed to fetch indvIds
					 */
					detGADCCertDate(aEdEligibilityCargo, egDataHandler, aEdIndvEligibilityCargo);
				}
				/*
				 * beniwala - ASPEN00017459 - for Education Works, 6 month cert period is fixed i.e.
				 * cert period should end either in May or Jul or Dec
				 */
				else if(IEdEligCodes.ENWP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					int monthDiff = 0;					
					if((DateComparisons.getMM(aEdEligibilityCargo.getCertBegDt())-1) <= GregorianCalendar.MAY) {
						monthDiff = GregorianCalendar.MAY - DateComparisons.getMM(aEdEligibilityCargo.getCertBegDt()) + 1;
					}
					else if((DateComparisons.getMM(aEdEligibilityCargo.getCertBegDt())-1) <= GregorianCalendar.JULY) {
						monthDiff = GregorianCalendar.JULY -  DateComparisons.getMM(aEdEligibilityCargo.getCertBegDt()) + 1;
					}
					else {
						monthDiff = GregorianCalendar.DECEMBER - DateComparisons.getMM(aEdEligibilityCargo.getCertBegDt()) + 1;
					}
					Timestamp certEndDate = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getCertBegDt(), monthDiff));
					aEdEligibilityCargo.setCertEndDt(certEndDate);
				}
				/*
				 * beniwala - ASPEN00017459 - for Transistional SNAP, cert period is 5 month and no Interim Reporting period
				 */
				else if (IEdEligCodes.TP_TRFS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					aEdEligibilityCargo.setCertEndDt(DateComparisons.
							getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 4)));
				}
				// Begin - beniwala - ASPEN00036947 - set certification period for Support Services as 6 months
				else if(IEdEligCodes.TP_SSSA.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) {
					aEdEligibilityCargo.setCertEndDt(DateComparisons.
							getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 5)));
				}
				// End - beniwala - ASPEN00036947 
				else {
					aEdEligibilityCargo.setCertEndDt(DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getPaymentBegDt(), 11)));					
				}
				
				// beniwala - ASPEN00017459 - for Wage Subsidy, Interim Reporting Period is 6 months
				/*
				 * beniwala - ASPEN00032076 - for Transitional Bonus (TP01 with efipEligSw as Y) , Interim 
				 * Reporting period is 6 months
				 */
				if ((aEdEligibilityCargo.getSimplifiedReportingGrpCd() != null
						&& "SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())
						// ASPEN00045164 - semi annual review date need not be set on TRFS - Added by Sai Suresh
						&& !IEdEligCodes.TP_TRFS.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) ||
								(IEdEligCodes.WASU.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))
								|| (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
										&& aEdEligibilityCargo.getEfipEligSw() == 'Y')) {
					tsEstimatedEligEndDt = DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getPaymentBegDt(), 5));
					aEdEligibilityCargo
							.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
				} else // added for FAP Unstable Circumstances BRGUS00060254
				if (dcCaseMiscInfoCargo != null
						&& dcCaseMiscInfoCargo.getUnstableCircSw() == 'Y' 
						&& (IEdEligCodes.TP_09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))) {//For Regular Reporting Estimated_Elig_End_Dt and Certifcation_End_End_Dt is set to three months for TP09 only - nsandru - ASPEN00045721) {
					aEdEligibilityCargo.setCertEndDt(DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getPaymentBegDt(), 2)));
					tsEstimatedEligEndDt = DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getPaymentBegDt(), 2));
				} else {
					tsEstimatedEligEndDt = aEdEligibilityCargo.getCertEndDt();
				}
				//}

			} else {
				/*
				 * Begin - beniwala - ASPEN00032076 - if efipSw=Y for TP01, then cert period is 18 month and interim reporting period is 6 month
				 */
				if(IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
						&& aEdEligibilityCargo.getEfipEligSw() == 'Y') {
					aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo.getPaymentBegDt());
					aEdEligibilityCargo.setCertEndDt(DateComparisons.
							getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 17)));
					tsEstimatedEligEndDt = DateComparisons
							.getLastDayOfDate(DateComparisons
									.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 5));
					aEdEligibilityCargo
							.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
				}
				/*BRGUS00228917 - Changing from Change reporter to simplified reporter 
				 * if change reporting client report income and EDBC been run within 4 months of cert begin date 
				 * then indentify the client as simplified reporter.  Set the SemiAnnualReviewDt as certBegDt + 5 months*/
				// beniwala - ASPEN00015918 - estimatedEligEndDt logic  for TP01 is made similar to FS
				else if ((IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
						 || IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()))
							&& (!aEdEligibilityCargo.getActivityType().equalsIgnoreCase(
									IEdEligCodes.ACTIVITY_TYPE_INTAKE) && !aEdEligibilityCargo
									.getActivityType()
									.equalsIgnoreCase(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW))
							&& aEdEligibilityCargo.getSimplifiedReportingGrpCd() != null
							&& "SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())) {
				// End - beniwala - ASPEN00032076
						/*BRGUS00252918 - Calculate the tsEstimatedEligEndDt only if 
						 * last authorized segment was not evaluated as SR1  */
					//<BRGUS00273752><kucherlapatis><05/17/2011>
					//<Java fix to set correct EEED for simplified reporting food stamps>
					if (aEdEligibilityCargo
							.getCertBegDt() != null && DateComparisons.dateLTEQDateInTimestamp(
							aEdEligibilityCargo.getEdbcRunDt(), DateComparisons
									.getFirstDayOfDate(DateComparisons
											.addMonths(aEdEligibilityCargo
													.getCertBegDt(), 3)))) {
						if (lastAuthorizedEdEligiCargo != null
								&& !"SR1"
										.equalsIgnoreCase(lastAuthorizedEdEligiCargo
												.getSimplifiedReportingGrpCd())) {
							tsEstimatedEligEndDt = DateComparisons
									.getLastDayOfDate(DateComparisons
											.addMonths(aEdEligibilityCargo
													.getCertBegDt(), 5));
							aEdEligibilityCargo
									.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
						}
					}
				}
				// beniwala - ASPEN00034743
				// beniwala - ASPEN00049529
				tsEstimatedEligEndDt = det12MonthCertPeriod(aEdEligibilityCargo,aEdEligFsBudget,nfDataHandler,egDataHandler,
						aEdIndvEligibilityCargo,edEligibilityCargoPrevMonth, tsEstimatedEligEndDt,aEdCaseRecertDatesCargo );
				/* beniwala - ASPEN00034743 - there is no Midcert shortening logic in New Mexico
				 * // added else part for change action defect BRGUS00031758
				//ID : BRGUS00098342 Kesireddyv -- set Semi Annual review date if Earned income is greater Than 0
				if (aEdEligibilityCargo.getMidCertEndDt() != null &&
						(EdDriverHelper.isNetIncomeAmount(aEdEligFsBudget) ||
						!agedAndDisabledIndvFlag ||
						EdDriverHelper.isUnEarIncomeNotEqual(aEdEligFsBudget)))// BRGUS00066881
				{
					if (EdDriverHelper.isNetIncomeAmount(aEdEligFsBudget)) {
						//This means that client is not eligible for 24months
						// cert in FAP because earned
						//income was reported in the case.
						Timestamp tempDate = null;
						Timestamp edbcRunDtPlus11Months = DateComparisons
								.addMonths(aEdEligibilityCargo.getEdbcRunDt(),
										11);
						edbcRunDtPlus11Months = DateComparisons
								.getLastDayOfDate(edbcRunDtPlus11Months);
						//if 12 or more months are remaining in the cert
						// period, set it to 12 months from the current date
						//This will happen only if the existing cert period is
						// more than 12 months. So it can be assumned
						//that it is 24 months in Bridges
						if (DateComparisons.dateLTEQDateInTimestamp(
								edbcRunDtPlus11Months, aEdEligibilityCargo
										.getCertEndDt())) {
							//if(aEdEligibilityCargo.getSimplifiedReportingGrpCd()
							// != null &&
							// aEdEligibilityCargo.getSimplifiedReportingGrpCd().equals("SR1"))
							// {
							// 	  BRGUS00095847 added check for getNetSeIncAmt also
							//if(edEligFsBudget!=null &&
							// (edEligFsBudget.getNetErnIncAmt()>0.00 ||
							// edEligFsBudget.getNetSeIncAmt()>0)) {//Earnings
							// reported BRGUS00078188
							tsEstimatedEligEndDt = DateComparisons
									.getLastDayOfDate(DateComparisons
											.addMonths(aEdEligibilityCargo
													.getEdbcRunDt(), 5)); // changed
																		  // to
																		  // hv 6
																		  // months
																		  // diff
																		  // bet
																		  // Semi
																		  // annual
																		  // review
																		  // date
																		  // and
																		  // Cert
																		  // Enda
																		  // Date


								aEdEligibilityCargo
									.setSemiAnnualReviewDt(tsEstimatedEligEndDt);
							aEdEligibilityCargo.setSimplifiedReportingGrpCd("SR1");
							aEdEligibilityCargo
									.setCertEndDt(edbcRunDtPlus11Months);
							aEdEligibilityCargo.setMidCertEndDt(tempDate); // set
																		   // Mid
																		   // Cert
																		   // Date
																		   // to
																		   // null
							aEdEligibilityCargo
									.setMidCertificationShortenSw('Y');
							midCertShortSwFlagByDriver = true; //BRGUS00066881
							earnigsReported = true; //BRGUS00095847 added
							//}
							
							 * else { tsEstimatedEligEndDt =
							 * edbcRunDtPlus11Months;
							 *  }
							 
						}
						else
						{
							aEdEligibilityCargo
							.setMidCertificationShortenSw('Y');
							midCertShortSwFlagByDriver = true; //BRGUS00066881
							earnigsReported = true; //BRGUS00095847 added
						}

					}
					if (earnigsReported == false)//No new earnings reported
					{
						//ID : BRGUS00098342 Kesireddyv -- set Semi Annual review date if Earned income is greater Than 0
						//if (!agedAndDisabledIndvFlag) {
							//This means that client is not eligible for
							// 24months cert in FAP because atleast one
							// one nonAgedAndDisabled person in the EDG.
							tsEstimatedEligEndDt = DateComparisons
									.getLastDayOfDate(DateComparisons
											.addMonths(aEdEligibilityCargo
													.getEdbcRunDt(), 1));
							aEdEligibilityCargo
									.setCertEndDt(tsEstimatedEligEndDt);
							aEdEligibilityCargo.setMidCertEndDt(null); // set
																	   // Mid
																	   // Cert
																	   // Date
																	   // to
																	   // null
							aEdEligibilityCargo
									.setMidCertificationShortenSw('Y');
							midCertShortSwFlagByDriver = true; //BRGUS00066881

						//}
					}
				}*/
			}

		}

		//  Form Mid Cert is not returned timely then this code is executed
		// Logic to determine if form is not returned timely is in Non_fin
		// 2010_160 BRGUS00066881
		/* beniwala - ASPEN00034743 - there is no Midcert shortening logic in New Mexico
		 * if (aEdEligibilityCargo.getMidCertEndDt() != null)// FAP already has 24
														  // months cert period
		{
			if (midCertShortSwFlagByDriver == false)//FAP is shortening because
													// mid cert packet was not
													// returned timely
			{
				if (aEdEligibilityCargo.getMidCertificationShortenSw() == 'Y') {//set
																				// by
																				// Non
																				// Fin
					//if(aEdEligibilityCargo.getMidCertEndDt() != null) {
					aEdEligibilityCargo.setCertEndDt(DateComparisons
							.getLastDayOfDate(DateComparisons.addMonths(
									aEdEligibilityCargo.getEdbcRunDt(), 1)));
					aEdEligibilityCargo.setMidCertEndDt(null);
					tsEstimatedEligEndDt = aEdEligibilityCargo.getCertEndDt();
					//}
				}
			}
		}*/

		return tsEstimatedEligEndDt;
	}	


	/**
	 * This method is part of the logic involved in determining the
	 * EstimatedEligEndDt.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEdEligFsBudget
	 *            EdEligFsBudgetCargo[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @return Timestamp
	 */
	public static Timestamp perform6010_091(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EdEligFsBudgetCargo[] aEdEligFsBudget, EgDataHandler egDataHandler) {
		Timestamp tsEstimatedEligEndDt = null;
		int iLength = 0;
		//Added for Def# 00228148 ABAWD - 3 Months Certification
		if (aEdEligibilityCargo.getAbawdSw() == IEdEligCodes.YES) {
			tsEstimatedEligEndDt = DateComparisons
					.getLastDayOfDate(DateComparisons.addMonths(egDataHandler
							.getTsDateToBeUsedForFSEstEligEndDt(), 2));
			aEdEligibilityCargo.setEstimatedEligEndDt(tsEstimatedEligEndDt);
		}
		if ((aEdEligFsBudget != null)
				&& ((aEdEligFsBudget[0].getSeIncEligEidAmt() > 0) || (aEdEligFsBudget[0]
						.getSeIncIneligEidAmt() > 0))) {
			tsEstimatedEligEndDt = DateComparisons.addMonths(egDataHandler
					.getTsDateToBeUsedForFSEstEligEndDt(), 11);
			//tsEstimatedEligEndDt =
			// DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEligibilityBegDt(),
			// 11));
		} else {
			int count = 0;
			iLength = aEdIndvEligibilityCargo.length;
			for (int i = 0; i < iLength; i++) {
				if ((aEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE)
						&& (aEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C)) {
					if ((aEdIndvEligibilityCargo[i].getAgeInMonths() > 780)
							|| ((aEdIndvEligibilityCargo[i].getDisabilitySw() != IEdEligCodes.CHAR_INIT_SPACE) && (aEdIndvEligibilityCargo[i]
									.getDisabilitySw() == IEdEligCodes.DISABILITY_SW_YES))) {
						count = count + 1;
					}
				}
			}
			if (aEdEligibilityCargo.getCgSize() == count) {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					tsEstimatedEligEndDt = DateComparisons.addMonths(
							egDataHandler.getTsDateToBeUsedForFSEstEligEndDt(),
							11);
					//tsEstimatedEligEndDt =
					// DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEligibilityBegDt(),
					// 11));
				}
			} else if (true) {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					tsEstimatedEligEndDt = DateComparisons.addMonths(
							egDataHandler.getTsDateToBeUsedForFSEstEligEndDt(),
							5);
					//tsEstimatedEligEndDt =
					// DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEligibilityBegDt(),
					// 5));
				}
			} else {
				if (aEdEligibilityCargo.getEligibilityBegDt() != null) {
					tsEstimatedEligEndDt = DateComparisons.addMonths(
							egDataHandler.getTsDateToBeUsedForFSEstEligEndDt(),
							5);
					//tsEstimatedEligEndDt =
					// DateComparisons.getTimestamp(DateComparisons.addMonths(aEdEligibilityCargo.getEligibilityBegDt(),
					// 5));
				}
			}
		}
		return tsEstimatedEligEndDt;
	}

	/**
	 * Determmines the EdEligNoticeReasons Action Code.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 * @throws EDBCException
	 */
	public void detActionCode(EdEligibilityCargo aEdEligibilityCargo,
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getBenefitStatus() != null
					&& aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_CERTIFY)) {
				aEdEligNoticeReasonsCargo
						.setActionCode(IEdEligCodes.ACTION_CODE_APPROVED);
			} else if (aEdEligibilityCargo.getCgStatusCd() != null
					&& aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_DENIED)) {
				aEdEligNoticeReasonsCargo
						.setActionCode(IEdEligCodes.ACTION_CODE_DENIED);
			} else if (aEdEligibilityCargo.getCgStatusCd() != null
					&& aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				aEdEligNoticeReasonsCargo
						.setActionCode(IEdEligCodes.ACTION_CODE_TERMINATED);
			} else {
				aEdEligNoticeReasonsCargo
						.setActionCode(IEdEligCodes.ACTION_CODE_CHANGE);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detActionCode", ex);
		}
	}

	/**
	 * Determines the EdEligNoticeReasons FailureReasonCode.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 */
	public void perform6020_015(EdEligibilityCargo aEdEligibilityCargo,
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo) {
		String sFailureReasonCode = null;
		sFailureReasonCode = aEdEligNoticeReasonsCargo.getFailureReasonCode();
		if (sFailureReasonCode == null) {
			sFailureReasonCode = "";
		}
		if (aEdEligNoticeReasonsCargo.getActionCode() == IEdEligCodes.ACTION_CODE_APPROVED) {
			if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(lookForEL5Series(
								aEdEligNoticeReasonsCargo,
								IEdEligCodes.FAILURE_REASON_CODE_EL5001));
			} else {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(sFailureReasonCode
								+ IEdEligCodes.FAILURE_REASON_CODE_EL5001);
			}
		}
		if (aEdEligNoticeReasonsCargo.getActionCode() == IEdEligCodes.ACTION_CODE_DENIED
				|| aEdEligNoticeReasonsCargo.getActionCode() == IEdEligCodes.ACTION_CODE_TERMINATED) {
			if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
				//Added for defect 145483
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(lookForEL5Series(
								aEdEligNoticeReasonsCargo,
								IEdEligCodes.FAILURE_REASON_CODE_EL5002));
				/*
				 * String sTemp =
				 * aEdEligNoticeReasonsCargo.getFailureReasonCode(); int iStart =
				 * sTemp.indexOf(IEdEligCodes.FAILURE_REASON_CODE_EL5001);
				 * StringBuffer sbTemp = new
				 * StringBuffer(aEdEligNoticeReasonsCargo.getFailureReasonCode());
				 * if (iStart >= 0) { sbTemp.replace(iStart, iStart +
				 * IEdEligCodes.FAILURE_REASON_CODE_EL5001.length(),
				 * IEdEligCodes.FAILURE_REASON_CODE_EL5002);
				 * aEdEligNoticeReasonsCargo.setFailureReasonCode(sbTemp.toString()); }
				 * else {
				 * sbTemp.append(IEdEligCodes.FAILURE_REASON_CODE_EL5002);
				 * aEdEligNoticeReasonsCargo.setFailureReasonCode(sbTemp.toString()); }
				 */
			} else {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(sFailureReasonCode
								+ IEdEligCodes.FAILURE_REASON_CODE_EL5002);
			}
		}
		/*
		 * if (aEdEligNoticeReasonsCargo.getActionCode() ==
		 * IEdEligCodes.ACTION_CODE_TERMINATED) {
		 * aEdEligNoticeReasonsCargo.setFailureReasonCode(sFailureReasonCode +
		 * IEdEligCodes.FAILURE_REASON_CODE_EL5002); }
		 */
		if (aEdEligibilityCargo.getBenefitStatus() != null
				&& aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_INCREASE)) {

			if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(lookForEL5Series(
								aEdEligNoticeReasonsCargo,
								IEdEligCodes.FAILURE_REASON_CODE_EL5003));
			} else {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(sFailureReasonCode
								+ IEdEligCodes.FAILURE_REASON_CODE_EL5003);
			}
		}
		if (aEdEligibilityCargo.getBenefitStatus() != null
				&& aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
			if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(lookForEL5Series(
								aEdEligNoticeReasonsCargo,
								IEdEligCodes.FAILURE_REASON_CODE_EL5004));
			} else {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(sFailureReasonCode
								+ IEdEligCodes.FAILURE_REASON_CODE_EL5004);
			}
		}
		if (aEdEligibilityCargo.getBenefitStatus() != null
				&& aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_SUSTAIN)) {
			if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(lookForEL5Series(
								aEdEligNoticeReasonsCargo,
								IEdEligCodes.FAILURE_REASON_CODE_EL5005));
			} else {
				aEdEligNoticeReasonsCargo
						.setFailureReasonCode(sFailureReasonCode
								+ IEdEligCodes.FAILURE_REASON_CODE_EL5005);
			}
		}
		aEdEligNoticeReasonsCargo
				.setFailureReasonCode(lookForELTestSeries(aEdEligNoticeReasonsCargo));
	}

	/**
	 * Determines the CGSize and EDGSize.
	 *
	 * @param arrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detGroupSize(
			EdIndvEligibilityCargo[] arrEdIndvEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		long lCGCount = 0;
		long lEGCount = 0;
		int iLength = 0;
		try {
			iLength = arrEdIndvEligibilityCargo.length;
			for (int i = 0; i < iLength; i++) {
				if (arrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
					lCGCount = lCGCount + 1;
					lEGCount = lEGCount + 1;
				} else if (arrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_E) {
					lEGCount = lEGCount + 1;
				}
			}
			aEdEligibilityCargo.setCgSize(lCGCount);
			aEdEligibilityCargo.setEdgSize(lEGCount);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detGroupSize", ex);
		}
	}

	/**
	 * Method detCombinedPaymentSw, determines combined payment switch.
	 *
	 * @param aCurrEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aPrevEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEligDetailPrevMth
	 *            EligDetail
	 * @param aDcCaseProgramCargo
	 *            DcCaseProgramCargo
	 * @throws EDBCException
	 */
	public void detCombinedPaymentSw(
			EdEligibilityCargo aCurrEdEligibilityCargo,
			EdEligibilityCargo aPrevEdEligibilityCargo,
			EligDetail aEligDetailPrevMth,
			DcCaseProgramCargo aDcCaseProgramCargo) throws EDBCException {
		try {
			Timestamp tsRequestDt = null;
			if (aDcCaseProgramCargo != null
					&& aDcCaseProgramCargo.getProgCd().equals(
							IEdEligCodes.PROGRAM_CD_FS)) {
				tsRequestDt = aDcCaseProgramCargo.getRequestDt();
			}
			if (tsRequestDt == null) {
				return;
			}
			GregorianCalendar calendar = new GregorianCalendar();
			calendar.setTime((java.util.Date) tsRequestDt);
			//System.out
				//	.println("the date 1 is " + calendar.getTime().toString());
			//System.out.println("the date 2 is "
				//	+ calendar.get(GregorianCalendar.DAY_OF_MONTH));
			//Added for development activity 109687
			if (aPrevEdEligibilityCargo != null
					&& aPrevEdEligibilityCargo.getPaymentBegDt() != null) {
				if (aCurrEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FS)) {
					//Commented for defect 107950
					//				if
					// (aCurrEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))
					// {
					if (calendar.get(GregorianCalendar.DAY_OF_MONTH) > 15) {
						if (DateComparisons
								.getStringMMYYYY(
										aCurrEdEligibilityCargo
												.getPaymentBegDt())
								.equals(
										DateComparisons
												.getStringMMYYYY(DateComparisons
														.addMonths(tsRequestDt,
																1)))) {
							GregorianCalendar calendarFromPaymentBegDt = new GregorianCalendar();
							calendarFromPaymentBegDt
									.setTime((java.util.Date) aPrevEdEligibilityCargo
											.getPaymentBegDt());
							if (calendarFromPaymentBegDt
									.get(GregorianCalendar.DAY_OF_MONTH) != 1) {
								//Added for defect 107950
								if (aPrevEdEligibilityCargo.getCgEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)
										|| (aPrevEdEligibilityCargo
												.getCgEligRsltCd()
												.equals(
														IEdEligCodes.ELIG_RSLT_CD_FAIL) && (aEligDetailPrevMth != null
												&& aEligDetailPrevMth
														.getEdEligNoticeReasonsCargo() != null
												&& aEligDetailPrevMth
														.getEdEligNoticeReasonsCargo().length > 0 && aEligDetailPrevMth
												.getEdEligNoticeReasonsCargo()[0]
												.getFailureReasonCode()
												.indexOf(
														IEdEligCodes.FAILURE_REASON_CODE_EL3032) != -1))) {
									if (aCurrEdEligibilityCargo
											.getCgEligRsltCd()
											.equals(
													IEdEligCodes.ELIG_RSLT_CD_PASS)) {
										aCurrEdEligibilityCargo
												.setCombinedPaymentSw(IEdEligCodes.YES);
									} else {
										if (aCurrEdEligibilityCargo
												.getCgEligRsltCd()
												.equals(
														IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
											//Modifed for defect 81855
											if (aPrevEdEligibilityCargo
													.getFsExpeditedSw() == IEdEligCodes.YES) {
												aCurrEdEligibilityCargo
														.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												aCurrEdEligibilityCargo
														.setCombinedPaymentSw(IEdEligCodes.YES);
											}
										}
									}
								}
							}
						}
					}
					//				}
				}
			}
		} catch (Exception ex) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detCombinedPaymentSw", ex);
		}
	}

	/**
	 * The method performEDBCNRFV performs EDBC/NF/RSC/FIN/VCL modules and calls
	 * the Rules Engine based on the program selected.
	 *
	 * @param aMapRequest
	 *            Map
	 * @return boolean
	 * @throws ApplicationException
	 * @throws FrameworkException
	 * @throws SQLException
	 */
	public boolean performEDBCNRFV(Map aMapRequest)
			throws ApplicationException, FrameworkException, SQLException {
		EligDetail[] arrEligDetailInput = null;
		EligDetail[] arrEligDetailOutput = null;
		ArrayList alEligDetailVoidedForMM = new ArrayList();
		DcCaseProgramCargo[] arrDcCaseProgramCargo = null;
		String aSReqModSw = (String) aMapRequest
				.get(IEdEligCodes.REQUEST_MODULE_SWITCH);
		long aLCaseNum = ((Long) aMapRequest.get(IEdEligCodes.REQUEST_CASE_NUM))
				.longValue(); 
		String aSUserId = (String) aMapRequest
				.get(IEdEligCodes.SESSION_USER_ID);
		Connection conn = (Connection) aMapRequest
				.get(IEdEligCodes.REQUEST_CONNECTION);
		boolean bFSOverrideAndTanf = true;
		boolean bMMPandPrecord = false;
		
		//ASPEN00036737 - TANF Support Services - Added by Sai Suresh
		this.requestMap = aMapRequest;
		
		/*
		 * initialization of corticon rules engine done at startup of application
		String filePath = FwPropertyLoader.getPropertyOf("CR_RulesEngine", "DSD_PATH");
		try {
			DecisionServiceDirectory.initialize(filePath);
		} catch (CorticonRulesException e) {
			e.printStackTrace();
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getMessage());
		}
		*/
		NFManager nfManagerObj;
		String rulesEngineNFN = FwPropertyLoader.getPropertyOf(GenericConstants.TIERS_PROPERTIES_NAME, GenericConstants.RULES_ENGINE_NFN);
		if(rulesEngineNFN != null && GenericConstants.CORTICON_RULES_ENGINE.equalsIgnoreCase(rulesEngineNFN)) {
			nfManagerObj = new CorticonNFNManager();
		}
		else {
			nfManagerObj = new NFManager();
		}
		
		String rulesEngineRsc = FwPropertyLoader.getPropertyOf(GenericConstants.TIERS_PROPERTIES_NAME, GenericConstants.RULES_ENGINE_RSC);
		ResourceManager resManagerObj;
		if(rulesEngineRsc != null && GenericConstants.CORTICON_RULES_ENGINE.equalsIgnoreCase(rulesEngineRsc)) {
			resManagerObj = new CorticonResourceManager();
		}
		else {
			resManagerObj = new ResourceManager();
		}
		 
		//BRGUS00166527-Mulpuriv-Passing Connection as a parameter for Finmanager class
		FinManager finManagerObj;
		String rulesEngineFin = FwPropertyLoader.getPropertyOf(GenericConstants.TIERS_PROPERTIES_NAME, GenericConstants.RULES_ENGINE_FIN);		
		if(rulesEngineFin != null && GenericConstants.CORTICON_RULES_ENGINE.equalsIgnoreCase(rulesEngineFin)) {
			finManagerObj = new CorticonFinManager(conn);
		}
		else {
			finManagerObj = new FinManager(conn);
		}
		
		EdDcUtil edDcUtil = new EdDcUtil();
		
		User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);//BRGUS00205536-upadhyayulag
		
		//Added for CCB : 158628 on 4/25/2005
		ArrayList alEligDetailForPFPSanction = null;

		//Added for CCB : 158628 on 4/25/2005
		HashMap hEdgDetails = new HashMap();
		// For logging added by Sai
		String stLogCategory = "edbc";
		StringBuffer sbLogMessage = new StringBuffer();
		long EndTime = 0;
		long StTimeEP = 0;
		long EDBCStTime = 0;
		float TotFinTime = 0;
		float TotNFTime = 0;
		float TotResTime = 0;
		float TotVCLTime = 0;
		float TotRMTime = 0;
		float ReadEligTime = 0;
		float WriteEligTime = 0;
		float COTime = 0;
		float ALTime = 0;
		float EPTime = 0;
		float DiffTime = 0;
		float totalEdTime = 0;
		float totalSERTime = 0;
		float totalCDCTime = 0;
		float totalDSSTime = 0;
		long NumOfRec = 0;
		float ReadDCDataTime = 0;

		double grossFSSupplementAmt = 0;
		double grossTFSupplementAmt = 0;
		// End added by Sai for logging
		/**
		 * Begin BrgId: BRGUS00115857
		 * UserId: Ganta
		 * Date: 07/17/2008
		 * Modified the current performance log entry for EDBC operations
		 */
		String pageId = (String)aMapRequest.get(TIERSConstants.PAGE);
		String sessID = (String)aMapRequest.get(IEdEligCodes.SESSION_ID);		
		String currentEdgRunCount = "0";
		String methodName = null;
		FwTimer tg = null;
		EDBCStTime = System.currentTimeMillis();
		if (sbLogMessage.length() > 0) {
			sbLogMessage.delete(0, sbLogMessage.length());
		}
		sbLogMessage.append("---------------------------- Begin Case Num: ' ");
		sbLogMessage.append(aLCaseNum);
		sbLogMessage.append(" ' -------------------------------");
		log(stLogCategory, ILog.DEBUG, sbLogMessage.toString());
		
		boolean isOnlineEbdcProcess = false;
		boolean isAuthorizedRecSpecialist = false;
		boolean isDCHBusinessFunctionsUser = false;//BRGUS00153284-upadhyayulag
		if (aMapRequest.get("BATCH") != null
				&& ((String) aMapRequest.get("BATCH")).startsWith("MU-OED")){
			aMapRequest.put(DIConstants.CASE_RUN_MODE, DIConstants.ONLINE);	
			isOnlineEbdcProcess = true;
			if(aMapRequest.get("isAuthorizedRecSpecialist") != null &&
					((Boolean)aMapRequest.get("isAuthorizedRecSpecialist")).booleanValue()){
				isAuthorizedRecSpecialist = true;						
			}
			aMapRequest.put("ONLINEBATCHREQ", "Y");
		}
		//BEGIN-BRGUS00217436-upadhyayulag-FindBugs				
		aMapRequest.put("ONLINEBATCHREQUIRED",Boolean.valueOf(isOnlineEbdcProcess));
		//END-BRGUS00217436
		/**
		 * Begin BrgId:BRGUS00215118
		 * UserId: GANTAC
		 * Date: 01/30/2010
		 * MIChild Changes 
		 */
		if(aMapRequest.get("BATCH")!= null && ((String)aMapRequest.get("BATCH")).startsWith("MU"))
		{
			TIERSBatchController tbc = new TIERSBatchController();
			aMapRequest.put(DiAttributes.MI_CHILD_DEPLOY_SW,tbc.getTIERSProperties().getProperty(DiAttributes.MI_CHILD_DEPLOY_SW));	
		}
		else 
		{
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.MI_CHILD_DEPLOY_SW)!=null)
			{
				aMapRequest.put(DiAttributes.MI_CHILD_DEPLOY_SW,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.MI_CHILD_DEPLOY_SW));
			}
		}		
		if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_EDG)) {
			//call the EgManager
			IEgManager iEgMan = EgDriverFactory.getEDGDriver();
			//Timestamp[] tsInput = new Timestamp[2];
			try {
				// iEgMan.execute(aMapRequest);
				tg = new FwTimer();
				setTimer(tg,aMapRequest,sessID);
				/*if (aMapRequest.get("BATCH") != null
						&& ((String) aMapRequest.get("BATCH")).startsWith("MU-OED")){
					aMapRequest.put(DIConstants.CASE_RUN_MODE, DIConstants.ONLINE);	
					isOnlineEbdcProcess = true;	
					if(aMapRequest.get("isAuthorizedRecSpecialist") != null &&
							((Boolean)aMapRequest.get("isAuthorizedRecSpecialist")).booleanValue()){
						isAuthorizedRecSpecialist = true;						
					}
					aMapRequest.put("ONLINEBATCHREQ", "Y");
				}*/
				iEgMan.execute(aMapRequest);
				//BrgId:BRGUS00154303 UserId:GANTAC	Date:04/06/2009
				aMapRequest.put("totalTimeTakenForRules",null);
				currentEdgRunCount = (String)aMapRequest.get(IEdEligCodes.RUN_EDG_MONTHS);
				methodName = "performEDBCNRFV" + "_" + "Edg" + "(" + currentEdgRunCount + ")";
			    if(sessID != null){
				reportTime(tg,pageId,methodName);
			    }
			} catch (TIERSValidationException tve) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
				throw tve;
			} catch (EDBCException e) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
				throw new FrameworkException(e.getErrorProfile());
			} catch (DataException e) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
				throw new FrameworkException(e.getErrorProfile());

			} catch (Exception e) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
				throw new FrameworkException(e.getMessage());

			}
			//set the data in the request to be forwarded by Controller
			return true;
		}

		if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_RM)) {
			return performRM(aMapRequest);
		}

		//BEGIN-BRGUS00153284-upadhyayulag
		if(aMapRequest.get("isDCHBusinessFunctionsUser") != null){
			isDCHBusinessFunctionsUser = 
				((Boolean)aMapRequest.get("isDCHBusinessFunctionsUser")).booleanValue();
		}
		//END-BRGUS00153284
		/**
		 * Begin:BRGUS00191175
		 * UserId: GANTAC
		 * Date:09/24/2009	 
		 * EDBC Performance Changes: MU Trigger From Online.
		 **/
		 String manualCascade = (String)aMapRequest.get("manualCascade");
	
		
		if(aMapRequest.get("ONLINEBATCHREQ")!= null &&
				((String) aMapRequest.get("ONLINEBATCHREQ")).equalsIgnoreCase("Y") &&
				manualCascade == null && aMapRequest.get(DiAttributes.ENABLE_ONLINE_BATCH)!= null &&
				((String) aMapRequest.get(DiAttributes.ENABLE_ONLINE_BATCH)).equalsIgnoreCase("Y")){
			try{
			showOnlineBatchResults(aMapRequest,conn);
			} catch (EDBCException e) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);			
				throw new FrameworkException(e.getErrorProfile());
			} 
			
		}else{//BRGUS00191175
			try {

			StTime = System.currentTimeMillis();
			//load the data using the datahandler
			EgDataHandler egDataHandler = new EgDataHandler();
			egDataHandler.setModuleSw(aSReqModSw);
			egDataHandler.setFSOverrideSw((String) aMapRequest
					.get(IEdEligCodes.FS_OVERRIDES));
			//BEGIN-BRGUS00129499-upadhyayulag
			//egDataHandler.loadEligDetail(aLCaseNum, conn);
			//BEGIN-BRGUS00148880-upadhyayulag-Load the pending hearing details
			egDataHandler.loadHearingOverrides(aLCaseNum, conn);
			//END-BRGUS00148880
			HeRestoreBenefitsCargo[] heRestoreBenefitsCargo = egDataHandler
			.getPendingHearingOverrides();
			if(heRestoreBenefitsCargo != null && heRestoreBenefitsCargo.length > 0){
				if(egDataHandler.getHmParamForEndProcess()!=null){
					egDataHandler.getHmParamForEndProcess().put("overrideExists","Y");
				}else{
					HashMap tempHM= new HashMap();
					tempHM.put("overrideExists","Y");
					egDataHandler.setHmParamForEndProcess(tempHM);
				}
			}
			egDataHandler.loadEligDetail(aLCaseNum, conn);
			//END-BRGUS00129499
			arrEligDetailInput = egDataHandler.getEligDetail();
			//Added by Sai on 11-9-2004
			egDataHandler.setEdDcUtil(edDcUtil);
			EndTime = System.currentTimeMillis();
			ReadEligTime = ((EndTime - StTime) / 1000F);
			//Modified to pass correct string for defect 219447
			Object obj = aMapRequest.get("caseModeCd");
			String sMode = "";
			if (obj != null) {
				sMode = (String) obj;
			}
			//Throw exception if case mode code is 'CV' for the batch processes
			// other than conversion
			if (aMapRequest.get("BATCH") != null
					&& ((String) aMapRequest.get("BATCH")).startsWith("MU")) {
				if (arrEligDetailInput == null) {
					aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW,
							Boolean.valueOf(false));
					return true;
				}
			}
			//Passing run mode to NF
			/*
			 * Defect ID : BRGUS00101140 Added By : Ethirajue Date : 03/06/2008
			 * Change : Setting RumMode
			 *
			 */
			//Start
			String runMode = null;
			if (!isOnlineEbdcProcess && aMapRequest.get("BATCH") != null
					&& ((String) aMapRequest.get("BATCH")).startsWith("MU")) {
				runMode = "BATCH";
			} else {
				runMode = "ONLINE";
			}
			//BRGUS00124647 – kesavanr – variable to store whether mode is online or batch.
			egDataHandler.setMode(runMode);
			//End

			//this code could move to the datahandler
			if (arrEligDetailInput == null
					|| arrEligDetailInput[0].getEdEligibilityCargo().length == 0) {
				if (sMode.equalsIgnoreCase(EDGConstants.PROVIDER_PAYMENT)) {
					//					Modified to return if no T records without error
					//providerPaymentException();
					//Commented due to FindBugs Analysis
					//aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW,
					// new Boolean(false));
					aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW,
							Boolean.valueOf(false));

					return true;
				} else {
					ArrayList alError = new ArrayList();
					ArrayList alPlaces = new ArrayList();
					alError.add(IEdEligCodes.EC_NO_RECORDS_FOUND);
					throw new TIERSValidationException(alError, alPlaces);
				}

			} else {

				//CR 20799- Setting the warning message for Military income if the Military check method returns true

				if(aMapRequest.get("fristTimeThrow") == null) {

				if(aMapRequest.get("miltrIncome") == null){

				boolean warningMessage = false;

			    warningMessage = militaryCheck(conn,aLCaseNum,egDataHandler);

			    if (warningMessage ){
			    aMapRequest.put("miltrIncome", "TRUE");

			    return true;
		}

			}
				}
				java.sql.Timestamp tsMaxEDM = null;
				java.sql.Timestamp tsMinEDM = null;
				Long[] arrEdgNums = null;
				Long lEdgNum = null;

				//Added for defect 101099
				HashMap hmEdgTraceId = new HashMap();
				int iLengthInput = egDataHandler.getEligDetail()[0]
						.getEdEligibilityCargo().length;
				for (int i = 0; i < iLengthInput; i++) {
					if (egDataHandler.getEligDetail()[0]
							.getEdEligibilityCargo()[i].getCurrentEligInd() != IEdEligCodes.CURRENT_ELIG_INDICATOR_P) {
						hmEdgTraceId.put(new Long(
								egDataHandler.getEligDetail()[0]
										.getEdEligibilityCargo()[i]
										.getEdgTraceId()), new Long(
								egDataHandler.getEligDetail()[0]
										.getEdEligibilityCargo()[i]
										.getEdgTraceId()));
					}
					//Added for CCB: 158628 on 4/25/2005
					//Calculate Max EDM for Each EDG
					lEdgNum = new Long(egDataHandler.getEligDetail()[0]
							.getEdEligibilityCargo()[i].getEdgNum());
					if (!hEdgDetails.containsKey(lEdgNum)) {
						hEdgDetails.put(lEdgNum,
								egDataHandler.getEligDetail()[0]
										.getEdEligibilityCargo()[i]
										.getPaymentBegDt());
					} else {
						if (egDataHandler.getEligDetail()[0]
								.getEdEligibilityCargo()[i].getPaymentBegDt()
								.after((Timestamp) hEdgDetails.get(lEdgNum))) {
							hEdgDetails.put(lEdgNum,
									egDataHandler.getEligDetail()[0]
											.getEdEligibilityCargo()[i]
											.getPaymentBegDt());
						}
					}
				}
				egDataHandler.setEdgTraceIdForOverrides(hmEdgTraceId);

				//determine the Max & Min EDM's
				tsMaxEDM = detMaxEDM(arrEligDetailInput);
				tsMinEDM = detMinEDM(arrEligDetailInput);
				aMapRequest.put(IEdEligCodes.REQUEST_EDBC_MAX_DATE, tsMaxEDM);
				aMapRequest.put(IEdEligCodes.REQUEST_EDBC_MIN_DATE, tsMinEDM);
				//Added for defect 99266 to find the min, max of processed
				// records not picked up EDBC but still needs to be displayed
				// after running edbc
				detMimMaxEDMForDisplay(egDataHandler, aMapRequest);
				arrEdgNums = detEdgNums(arrEligDetailInput);

				NFDataHandler nfDataHandler = null;
				ResourceDataHandler resDataHandler = null;
				FinDataHandler finDataHandler = null;
				RMDataHandler rmDataHandler = null;

				//Dev Activity : BRGUS00015186
				SerDataHandler serDataHandler = null;
				CdcDataHandler cdcDataHandler = null;
				DSSDataHandler dssDataHandler = null;
				//OPSServicesDataHandler opsServicesDataHandler = null;

				EdEligibilityCargo[] arrEdEligibilityCargo = null;
				arrEdEligibilityCargo = arrEligDetailInput[0]
						.getEdEligibilityCargo();
				int iLength = 0;
				/*
				 * BRGUS00089276 - since CDC sorting was after SER sorting, SER
				 * was no longer the last program to execute
				 */
				arrEdEligibilityCargo = getCDCSortedEdEligibilityCargo(arrEdEligibilityCargo);
				arrEdEligibilityCargo = getSERSortedEdEligibilityCargo(arrEdEligibilityCargo);
				//BRGUS00075235 - Start
				//arrEdEligibilityCargo =
				// getCDCSortedEdEligibilityCargo(arrEdEligibilityCargo);
				//End
				iLength = arrEdEligibilityCargo.length;
				arrEligDetailOutput = new EligDetail[iLength];

				DcCaseProgramCargo dcCaseProgramCargo = null;
				DcCaseProfileCargo dcCaseProfileCargo = null;
				if (egDataHandler.getDcCaseProfileCargo() != null
						&& egDataHandler.getDcCaseProfileCargo().length > 0) {
					dcCaseProfileCargo = egDataHandler.getDcCaseProfileCargo()[0];
				}
				if (egDataHandler.getFSOverrideSw() == null
						|| !egDataHandler.getFSOverrideSw().equals(
								IEdEligCodes.FS_OVERRIDES)) {
					boolean bEdgHasToBeRun = detEdgHasToBeRun(
							arrEligDetailInput[0].getEdEligibilityCargo(),
							aSReqModSw);
					if (bEdgHasToBeRun == true) {
						if (sMode
								.equalsIgnoreCase(EDGConstants.PROVIDER_PAYMENT)) {
							providerPaymentException();
						} else {
							ArrayList alError = new ArrayList();
							ArrayList alPlaces = new ArrayList();
							alError.add(IEdEligCodes.EC_NO_RECORDS_FOUND);
							throw new TIERSValidationException(alError,
									alPlaces);
						}
					}
				}
				/**
				 * Begin BrgId: BRGUS00144585
				 * UserId: Gantac
				 * Date: 01/29/2009
				 * EDBC Logger enhancements with execution timings
				 */
				StTimeEP = System.currentTimeMillis();
				//Modified by Sai for Defect # 196302
				boolean bFinanceSw = false;
				nfDataHandler = new NFDataHandler();
				if (dcCaseProfileCargo != null
						&& dcCaseProfileCargo.getIncExpTestedSw() != IEdEligCodes.NO) {
					bFinanceSw = true;
					nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(
							aLCaseNum, tsMaxEDM, tsMinEDM, egDataHandler
									.getPreStrikeMinEDM(), conn, bFinanceSw,
							egDataHandler));
					//Code Added for Filtering DC Tables on monthly basis and
					// use across NF/Res/Fin/VCL 11-9-2004 by Sai
					edDcUtil.setIndivNonFinInfo(nfDataHandler
							.getIndivNonFinInfo());
				} else {
					nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(
							aLCaseNum, tsMaxEDM, tsMinEDM, egDataHandler
									.getPreStrikeMinEDM(), conn, bFinanceSw,
							egDataHandler));
					//Code Added for Filtering DC Tables on monthly basis and
					// use across NF/Res/Fin/VCL 11-9-2004 by Sai
					edDcUtil.setIndivNonFinInfo(nfDataHandler
							.getIndivNonFinInfo());
				}

				// beniwala - ASPEN00022170 - put NFDataHandler in aMapRequest which will be used while creating EDM tasks
				aMapRequest.put(IEdEligCodes.NF_DATA_HANDLER,nfDataHandler);
				EndTime = System.currentTimeMillis();
				ReadDCDataTime = (EndTime - StTimeEP)/1000F;

				 /* BrgId: BRGUS00106674
				  * UserId: Gantac
				  * Date: 05/08/2008
				  */
				//BrgId: BRGUS00101846 UserId:GANTAC Date: 05/15/2008
				//Needs Info required to call this method(as per the discussion with Jason).
//				BrgId: BRGUS00110974 UserId:GANTAC Date: 05/22/2008
				//Passing new parameter to evaluate the Edit for Disability Individuals

				// ID : BRGUS00115461 kesireddyV -- call validateCashProgram() is only for online , not for batch
				if(runMode!=null && runMode.equals(IEdEligCodes.CASE_RUN_MODE_ONLINE))
				{
					//BEGIN-BRGUS00153284-upadhyayulag-Do not throw the validation for DCH business functions user
					
					
					//ASPEN00019394--Disability Check #21762 needs to be disabled in EDBC. This doesn't apply to NM.
					
					/*if(!isDCHBusinessFunctionsUser){
						validateCashProgram(arrEdEligibilityCargo, arrEligDetailInput[0].getEdIndvEligibilityCargo(),
								nfDataHandler.getIndivNonFinInfo().getDcIndvEmpServExemptionCargo(),
								nfDataHandler.getIndivNonFinInfo().getDcDisabilityCargo());
					}*/
					
					
					//END-BRGUS00153284
					//BEGIN-BRGUS00131829-upadhyayulag-Throw validation if there is no address within max & min EDM
					//BEGIN-BRGUS00145083-upadhyayulag-Modified the method call to include
					//connection in the parameter list
					if(!isValidCaseAddressExists(aLCaseNum,tsMinEDM,tsMaxEDM,conn)){
						ArrayList alError = new ArrayList();
						ArrayList alPlaces = new ArrayList();
						String alPlaces1 = (tsMinEDM.getMonth()+1)+"/"+tsMinEDM.getDate()+"/"+(tsMinEDM.getYear()+1900);
						String alPlaces2 = (tsMaxEDM.getMonth()+1)+"/"+tsMaxEDM.getDate()+"/"+(tsMaxEDM.getYear()+1900);
						alPlaces.add("|"+alPlaces1+"|"+alPlaces2);
						alError.add("21785");
						throw new TIERSValidationException(alError,alPlaces);
					}
					//END-BRGUS00145083
					//END-BRGUS00131829
				}
				//HashMap hmProgramCd = detProgramCd(arrEligDetailInput[0]);
				if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_EDBC)) {
					//nfDataHandler = new NFDataHandler();
					tg = new FwTimer();
					setTimer(tg,aMapRequest,sessID);
					resDataHandler = new ResourceDataHandler();
					finDataHandler = new FinDataHandler();
					rmDataHandler = new RMDataHandler();

					//Dev Activity : BRGUS00015186
					serDataHandler = new SerDataHandler();
					cdcDataHandler = new CdcDataHandler();
					dssDataHandler = new DSSDataHandler();

					boolean bResourceSw = false;
					//boolean bFinanceSw = false;

					StTime = System.currentTimeMillis();
					//Commented folowwing lines and moved before 'if' for
					// defect#196302
					/*
					 * if (dcCaseProfileCargo != null &&
					 * dcCaseProfileCargo.getIncExpTestedSw() !=
					 * IEdEligCodes.NO) { bFinanceSw = true;
					 * nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, egDataHandler.getPreStrikeMinEDM(),
					 * conn, bFinanceSw, egDataHandler)); //Code Added for
					 * Filtering DC Tables on monthly basis and use across
					 * NF/Res/Fin/VCL 11-9-2004 by Sai
					 * edDcUtil.setIndivNonFinInfo(nfDataHandler.getIndivNonFinInfo()); }
					 * else {
					 * nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, egDataHandler.getPreStrikeMinEDM(),
					 * conn, bFinanceSw, egDataHandler)); //Code Added for
					 * Filtering DC Tables on monthly basis and use across
					 * NF/Res/Fin/VCL 11-9-2004 by Sai
					 * edDcUtil.setIndivNonFinInfo(nfDataHandler.getIndivNonFinInfo()); }
					 */
					if (dcCaseProfileCargo != null
							&& dcCaseProfileCargo.getResourceTestedSw() != IEdEligCodes.NO) {
						//get all individuals for all months for all Resource
						// tables
						bResourceSw = true;
						resDataHandler.setIndivResInfo(resDataHandler
								.getResourceDetail(aLCaseNum, tsMaxEDM,
										tsMinEDM, egDataHandler
												.getPreStrikeMinEDM(),
										nfDataHandler, conn, bResourceSw,
										egDataHandler));
					} else {
						resDataHandler.setIndivResInfo(resDataHandler
								.getResourceDetail(aLCaseNum, tsMaxEDM,
										tsMinEDM, egDataHandler
												.getPreStrikeMinEDM(),
										nfDataHandler, conn, bResourceSw,
										egDataHandler));
					}
					bFinanceSw = false;
					if (dcCaseProfileCargo != null
							&& dcCaseProfileCargo.getIncExpTestedSw() != IEdEligCodes.NO) {
						//get all individuals for all months for all Finance
						// tables
						bFinanceSw = true;
						finDataHandler.setIndivFinInfo(finDataHandler
								.getFinDetail(aLCaseNum, tsMaxEDM, tsMinEDM,
										egDataHandler.getPreStrikeMinEDM(),
										arrEdgNums, nfDataHandler,
										resDataHandler, conn, bFinanceSw,
										egDataHandler));
					} else {
						finDataHandler.setIndivFinInfo(finDataHandler
								.getFinDetail(aLCaseNum, tsMaxEDM, tsMinEDM,
										egDataHandler.getPreStrikeMinEDM(),
										arrEdgNums, nfDataHandler,
										resDataHandler, conn, bFinanceSw,
										egDataHandler));
					}

					//get all individuals for all months for all RM tables
					//					if
					// (((String)aMapRequest.get(IEdEligCodes.REQUEST_CASE_RUN_MODE)).equals(IEdEligCodes.CASE_RUN_MODE_ONLINE))
					// {
					//? obsolete functionality - Defect BRGUS00055256
					/*
					 * ?if (aMapRequest.get(MU_RUN_MODE) == null ||
					 * (!((String)aMapRequest.get(MU_RUN_MODE)).equals("CV") &&
					 * !egDataHandler.getDcCasesCargo()[0].getCaseModeCd().equals("CV"))) {
					 * rmDataHandler.setIndivRMInfo(rmDataHandler.getRMDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, egDataHandler.getPreStrikeMinEDM(),
					 * nfDataHandler, conn, egDataHandler)); }?
					 */
					//					}
					EndTime = System.currentTimeMillis();
					ReadDCDataTime += ((EndTime - StTime) / 1000F);

					//to be revisited
					/*
					 * if (hmProgramCd.containsKey(IEdEligCodes.PROGRAM_CD_CC) ||
					 * hmProgramCd.containsKey(IEdEligCodes.PROGRAM_CD_ME) ||
					 * hmProgramCd.containsKey(IEdEligCodes.PROGRAM_CD_FMA)) {
					 * opsServicesDataHandler = new OPSServicesDataHandler();
					 * opsServicesDataHandler.setIndivOPSServicesInfo(opsServicesDataHandler.getOPSServicesDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, conn, egDataHandler)); }
					 */

					//for VCL pre process
					//?if (aMapRequest.get(MU_RUN_MODE) == null ||
					// (!((String)aMapRequest.get(MU_RUN_MODE)).equals("CV") &&
					// !egDataHandler.getDcCasesCargo()[0].getCaseModeCd().equals("CV")))
					// {
					// Defect BRGUS00055256
					if (aMapRequest.get(MU_RUN_MODE) == null
							|| (!((String) aMapRequest.get(MU_RUN_MODE))
									.equals("CV") && !allPgmsInCvMode(egDataHandler))) {
						checkVCLDueDtMakeVoid(egDataHandler);
						//Added for Defect # 206710 on 5/23/2005
						checkVCLDueDtMakeVoidPgmBased(egDataHandler);
					}

					//for EDBC end process
					arrDcCaseProgramCargo = egDataHandler
							.getDcCaseProgramCargo();
					int iDcCaseProgramLength = 0;
					if (arrDcCaseProgramCargo != null) {
						iDcCaseProgramLength = arrDcCaseProgramCargo.length;
					}
					for (int j = 0; j < iDcCaseProgramLength; j++) {
						if (arrDcCaseProgramCargo[j].getProgCd().equals(
								IEdEligCodes.PROGRAM_CD_FS)) {
							dcCaseProgramCargo = arrDcCaseProgramCargo[j];
						}
					}
				} else if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_NF)) {
					/*
					 * nfDataHandler = new NFDataHandler(); boolean bFinanceSw =
					 * false; if (dcCaseProfileCargo != null &&
					 * dcCaseProfileCargo.getIncExpTestedSw() !=
					 * IEdEligCodes.NO) { bFinanceSw = true;
					 * nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, egDataHandler.getPreStrikeMinEDM(),
					 * conn, bFinanceSw, egDataHandler)); } else {
					 * nfDataHandler.setIndivNonFinInfo(nfDataHandler.getNFDetail(aLCaseNum,
					 * tsMaxEDM, tsMinEDM, egDataHandler.getPreStrikeMinEDM(),
					 * conn, bFinanceSw, egDataHandler)); } //Code Added for
					 * Filtering DC Tables on monthly basis and use across
					 * NF/Res/Fin/VCL 11-9-2004 by Sai
					 * edDcUtil.setIndivNonFinInfo(nfDataHandler.getIndivNonFinInfo());
					 */
				} else if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_RSC)) {
					boolean bResourceSw = false;
					resDataHandler = new ResourceDataHandler();
					if (dcCaseProfileCargo != null
							&& dcCaseProfileCargo.getResourceTestedSw() != IEdEligCodes.NO) {
						bResourceSw = true;
						resDataHandler.setIndivResInfo(resDataHandler
								.getResourceDetail(aLCaseNum, tsMaxEDM,
										tsMinEDM, egDataHandler
												.getPreStrikeMinEDM(), null,
										conn, bResourceSw, egDataHandler));
					} else {
						resDataHandler.setIndivResInfo(resDataHandler
								.getResourceDetail(aLCaseNum, tsMaxEDM,
										tsMinEDM, egDataHandler
												.getPreStrikeMinEDM(), null,
										conn, bResourceSw, egDataHandler));
					}
					//Code Added for Filtering DC Tables on monthly basis and
					// use across NF/Res/Fin/VCL 11-9-2004 by Sai
					edDcUtil.setIndivNonFinInfo(nfDataHandler
							.getIndivNonFinInfo());
				} else if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_FIN)) {
					finDataHandler = new FinDataHandler();
					bFinanceSw = false;
					if (dcCaseProfileCargo != null
							&& dcCaseProfileCargo.getIncExpTestedSw() != IEdEligCodes.NO) {
						bFinanceSw = true;
						finDataHandler.setIndivFinInfo(finDataHandler
								.getFinDetail(aLCaseNum, tsMaxEDM, tsMinEDM,
										egDataHandler.getPreStrikeMinEDM(),
										arrEdgNums, null, null, conn,
										bFinanceSw, egDataHandler));
					} else {
						finDataHandler.setIndivFinInfo(finDataHandler
								.getFinDetail(aLCaseNum, tsMaxEDM, tsMinEDM,
										egDataHandler.getPreStrikeMinEDM(),
										arrEdgNums, null, null, conn,
										bFinanceSw, egDataHandler));
					}
					//Code Added for Filtering DC Tables on monthly basis and
					// use across NF/Res/Fin/VCL 11-9-2004 by Sai
					edDcUtil.setIndivNonFinInfo(nfDataHandler
							.getIndivNonFinInfo());
				} else if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_RM)) {
					if (((String) aMapRequest
							.get(IEdEligCodes.REQUEST_CASE_RUN_MODE))
							.equals(IEdEligCodes.CASE_RUN_MODE_ONLINE)) {
						rmDataHandler = new RMDataHandler();
						egDataHandler.loadEligDetailForRM(aLCaseNum, conn);
					}
					//Code Added for Filtering DC Tables on monthly basis and
					// use across NF/Res/Fin/VCL 11-9-2004 by Sai
					edDcUtil.setIndivNonFinInfo(nfDataHandler
							.getIndivNonFinInfo());
				}

				String sCurrMthProc = null;
				boolean bTA10PassProc = false;
				HashMap hmWaiverTpCodes = populateWaiverHMTPCodes();

				NumOfRec = iLength;
				if (sbLogMessage.length() > 0) {
					sbLogMessage.delete(0, sbLogMessage.length());
				}
				sbLogMessage.append("Total Number of 'T'- Records: ");
				sbLogMessage.append(NumOfRec);
				log(stLogCategory, ILog.INFO, sbLogMessage.toString());
				EligDetail eligDetailPrevMth = null;
				HashMap hmParams = null;
				EligDetail edgMMCopiedEligDetail = null;
				String sPrevEDM = null;

				//Calling BV
				//Dev Activity : BRGUS00031007

				try {
					BvDeletePendingClaims bvDeletePendingClaims = new BvDeletePendingClaims(
							conn);
					//BRGUS00099372 – kesavanr – Passing array of edg numbers
					// to be processed to BV to delete pending claims.

					String edgDecider = (String)aMapRequest.get("EdgDecider");
					// ID : BRGUS00112103 kesireddyV --- to differntiate for normal edg and rebuild edg
					if("P".equals(edgDecider))
					{
						int length = 0;
						long[] edgNumArr = null;
						Timestamp[] arrPayBegDate = null;
						ArrayList edgList = new ArrayList();
						ArrayList begDtlist = new ArrayList();
						if (arrEdEligibilityCargo!=null)
							length = arrEdEligibilityCargo.length;
						for(int len = 0 ; len<length; len++){
							if("TF".equalsIgnoreCase(arrEdEligibilityCargo[len].getProgramCd())||
									"FS".equalsIgnoreCase(arrEdEligibilityCargo[len].getProgramCd())||
									"CD".equalsIgnoreCase(arrEdEligibilityCargo[len].getProgramCd()))
							{
								edgList.add(new Long(arrEdEligibilityCargo[len].getEdgNum()));
							    begDtlist.add(arrEdEligibilityCargo[len].getPaymentBegDt());

							}
						}
						 edgNumArr = new long[edgList.size()];
						 arrPayBegDate = new Timestamp[begDtlist.size()];
						 for(int i = 0; i<edgList.size(); i++){
						 	edgNumArr[i] = ((Long)edgList.get(i)).longValue();
						 	arrPayBegDate[i] = (Timestamp)begDtlist.get(i);
						 }
						 if(edgNumArr.length > 0)
						 	bvDeletePendingClaims.deleteSelectivePendingClaims( aLCaseNum, edgNumArr, arrPayBegDate);

					}
					else
					{
						long[] arrEdgNum = EdDriverHelper
						.getEdgNumArray(arrEdEligibilityCargo);
						bvDeletePendingClaims.deletePendingClaims(aLCaseNum,
								arrEdgNum);
					}
				}
				/* Begin BRGUS00111665 – kesavanr
				 * Handling exception thrown by benefit recovery while deleting pending claims.
				 */
				catch (TIERSValidationException tve) {
					EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
					throw tve;
				}
				catch (Exception e) {
					EDBCLogger.writeExceptionStackTrace(
							DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
					throw new EDBCException(EDBCException.MAJOR, "EdUtil",
							"performEDBCNRFV",
							"Error while deleting pending claims in BV "+e.getMessage());
				}
				//End BRGUS00111665
				//Instantiating BVComputeCDCDiscrepancyBO
				BVComputeCDCDiscrepancyBO bvComputeCDCDiscrepancyBO = new BVComputeCDCDiscrepancyBO(
						conn);
				egDataHandler
						.setBvComputeCDCDiscrepancyBO(bvComputeCDCDiscrepancyBO);

				//BEGIN-BRGUS00161268-upadhyayulag-Initialization
				HashMap overrideFields = new HashMap();
				EdEdgOverrideDetailsCollection edgOverrideDetailsCollection;
				if(conn != null){
					edgOverrideDetailsCollection = new EdEdgOverrideDetailsCollection(conn);
				}else{
					edgOverrideDetailsCollection = new EdEdgOverrideDetailsCollection();
				}
				//END-BRGUS00161268
				for (int i = 0; i < iLength; i++) {

					bMMPandPrecord = false;

					//BEGIN-upadhyayulag-BRGUS00161268-Retrieve override details
					boolean overrideDataExists = false;
					EdEdgOverrideCargo edgOverrideCargo = new EdEdgOverrideCargo();
					edgOverrideCargo.setCaseNum(arrEdEligibilityCargo[i].getCaseNum());
					edgOverrideCargo.setEdgNum(arrEdEligibilityCargo[i].getEdgNum());
					edgOverrideCargo.setBeginDt(arrEdEligibilityCargo[i].getPaymentBegDt());
					edgOverrideCargo.setEndDt(arrEdEligibilityCargo[i].getPaymentEndDt());
					EdEdgOverrideCollection edgOverrideCollection = new EdEdgOverrideCollection();
					if(conn != null){
						edgOverrideCollection = new EdEdgOverrideCollection(conn);
					}else{
						edgOverrideCollection = new EdEdgOverrideCollection();
					}
					edgOverrideCollection.setCargo(edgOverrideCargo);
					EdEdgOverrideCargo[] edgOverrideCargos = 
						(EdEdgOverrideCargo[])edgOverrideCollection.select("findByCaseNumEdgNumDates");
					
					// ASPEN00060947 - Parma - starts - LIHEAP should not be overridden for ongoing month
					if(arrEdEligibilityCargo[i].getProgramCd().equalsIgnoreCase("SE") && (arrEdEligibilityCargo[i].getPaymentEndDt() != null)){
						if(edgOverrideCargos != null && edgOverrideCargos.length > 0){
							EdEdgOverrideDetailsCargo edEdgOverrideDetailsCargo = new EdEdgOverrideDetailsCargo();
							edEdgOverrideDetailsCargo.setCaseNum(edgOverrideCargos[0].getCaseNum());
							edEdgOverrideDetailsCargo.setEdgNum(edgOverrideCargos[0].getEdgNum());
							edEdgOverrideDetailsCargo.setOvrdId(edgOverrideCargos[0].getOvrdId());
							edgOverrideDetailsCollection.setCargo(edEdgOverrideDetailsCargo);
							EdEdgOverrideDetailsCargo[] edgOverrideDetailsCargos = 
								(EdEdgOverrideDetailsCargo[])edgOverrideDetailsCollection.select
								("findByCaseNumEdgNumOvrdId");
							if(edgOverrideDetailsCargos != null && edgOverrideDetailsCargos.length > 0){
								overrideDataExists = true;
								edgOverrideDetailsCollection.clear();
								edgOverrideDetailsCollection.setResults(edgOverrideDetailsCargos);
								overrideFields = populateOverrideFields(overrideFields, edgOverrideDetailsCollection);
							}
						}
					}					
					else if(!(arrEdEligibilityCargo[i].getProgramCd().equalsIgnoreCase("SE"))){
						// ASPEN00060947 - Parma - ends - LIHEAP should not be overridden for ongoing month
						if(edgOverrideCargos != null && edgOverrideCargos.length > 0){
							EdEdgOverrideDetailsCargo edEdgOverrideDetailsCargo = new EdEdgOverrideDetailsCargo();
							edEdgOverrideDetailsCargo.setCaseNum(edgOverrideCargos[0].getCaseNum());
							edEdgOverrideDetailsCargo.setEdgNum(edgOverrideCargos[0].getEdgNum());
							edEdgOverrideDetailsCargo.setOvrdId(edgOverrideCargos[0].getOvrdId());
							edgOverrideDetailsCollection.setCargo(edEdgOverrideDetailsCargo);
							EdEdgOverrideDetailsCargo[] edgOverrideDetailsCargos = 
								(EdEdgOverrideDetailsCargo[])edgOverrideDetailsCollection.select
								("findByCaseNumEdgNumOvrdId");
							if(edgOverrideDetailsCargos != null && edgOverrideDetailsCargos.length > 0){
								overrideDataExists = true;
								edgOverrideDetailsCollection.clear();
								edgOverrideDetailsCollection.setResults(edgOverrideDetailsCargos);
								overrideFields = populateOverrideFields(overrideFields, edgOverrideDetailsCollection);
							}else{
								edgOverrideDetailsCollection.clear();
								overrideFields.clear();
							}
						}else{
							edgOverrideDetailsCollection.clear();
							overrideFields.clear();
						}
					}
					//END-BRGUS00161268
					
					if (sCurrMthProc != null
							&& !sCurrMthProc.equals(DateComparisons
									.getStringMMYYYY(arrEdEligibilityCargo[i]
											.getPaymentBegDt()))) {
						performWaiverAdjustments(sCurrMthProc,
								arrEligDetailInput, arrEligDetailOutput,
								dcCaseProgramCargo, egDataHandler,
								nfDataHandler, hmWaiverTpCodes, aSReqModSw, aSUserId, conn);
						bTA10PassProc = false;
						sCurrMthProc = null;
					}

					detRequestDtForProgCd(egDataHandler,
							arrEdEligibilityCargo[i].getProgramCd());
					if (arrEdEligibilityCargo[i].getProgramCd().equals("CD")
							&& arrEdEligibilityCargo[i].getPaymentEndDt() != null) {
						egDataHandler
								.setEDMToBeProcessed(arrEdEligibilityCargo[i]
										.getPaymentEndDt());
					} else {
						egDataHandler
								.setEDMToBeProcessed(arrEdEligibilityCargo[i]
										.getPaymentBegDt());
					}

					//Application Month for Program code TANF
					if (arrEdEligibilityCargo[i].getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FS)) {
						egDataHandler
								.setApplicationDateFS(arrEdEligibilityCargo[i]
										.getApplicationDt());
					}

					//Following code is added by Sai on 11-9-2004 to filter DC
					// Tables once per EDM
					if (i == 0) {
						egDataHandler.setFirstEDM(true);
						egDataHandler.detEligDetailFiltered(
								arrEdEligibilityCargo[i],
								arrEligDetailInput[0], null, false,
								IEdEligCodes.MODULE_SWITCH_NF);
						arrEligDetailOutput[i] = egDataHandler
								.getEligDetailFiltered();
					} else {
						egDataHandler.setFirstEDM(false);
						eligDetailPrevMth = null;
						eligDetailPrevMth = validRecordForPrevMth(
								arrEligDetailOutput, arrEdEligibilityCargo[i]);
						//Following code commented and moved back into the
						// nonfin process in the loop for defect 227929
						//Defect 131956
						//Added for defect 192029
						//						detEdVerificationChecklistFiltered(egDataHandler,
						// arrEdEligibilityCargo[i].getEdgNum(), false, true);
						//Added for Defect 206710 on 5/23/2005
						//						detEdVerificationChecklistFiltered(egDataHandler,
						// arrEdEligibilityCargo[i].getProgramCd(), false,
						// true);
						egDataHandler.detEligDetailFiltered(
								arrEdEligibilityCargo[i],
								arrEligDetailInput[0], eligDetailPrevMth,
								false, IEdEligCodes.MODULE_SWITCH_NF);
						arrEligDetailOutput[i] = egDataHandler
								.getEligDetailFiltered();
					}
					egDataHandler.setIndvIdDataRetrivalDtHMap();

					if (sPrevEDM == null
							|| sPrevEDM.equals(DateComparisons
									.getStringMMYYYY(arrEdEligibilityCargo[i]
											.getPaymentBegDt()))) {
						//sPrevEDM =
						// DateComparisons.getStringMMYYYY(arrEdEligibilityCargo[i].getPaymentBegDt());
						edDcUtil.filterEdDcInfoForNonFin(egDataHandler,
								arrEdEligibilityCargo[i].getProgramCd());
					}

					if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_EDBC)) {

						if ((arrEdEligibilityCargo[i].getCreatorInd() == EDGConstants.COPY_CREATED)
								&& (arrEdEligibilityCargo[i]
										.getCurrentEligInd() == IEdEligCodes.CURRENT_ELIG_INDICATOR_P)) {
							// Refer EgDataHandler::loadEligDetail()
							egDataHandler.setForMMProcessFlag(true);
							arrEligDetailOutput[i] = egDataHandler
									.detEligDetailFiltered(
											arrEdEligibilityCargo[i],
											arrEligDetailInput[0], null, false,
											null);
							egDataHandler.setForMMProcessFlag(false);
							bMMPandPrecord = true;
						} else {
							// Commented for QA DEFECT DIOL on 10/18/2004
							//NFManager nfManagerObj = new NFManager();
							if (i == 0) {
								//Defect 131956
								//Added for defect 192029
								//modified for BRGUS00092096
								detEdVerificationChecklistFiltered(
										egDataHandler, arrEdEligibilityCargo[i]
												.getProgramCd(), false, true);
								//Added for defect # 206710 on 5/23/2005

								egDataHandler.setFirstEDM(true);
								StTime = System.currentTimeMillis();
								if (isNFRequired(arrEdEligibilityCargo[i])) {
									arrEligDetailOutput[i] = nfManagerObj
											.doProcess(
													arrEdEligibilityCargo[i],
													arrEligDetailInput, null,
													null, nfDataHandler,
													egDataHandler, conn,
													runMode,aMapRequest);
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger.writeRulesEngineTimerLog(DiffTime,
//										stLogCategory,
//										"NF Time in seconds :  ", sbLogMessage);
								//								if (sbLogMessage.length() > 0) {
								//									sbLogMessage.delete(0, sbLogMessage
								//											.length());
								//								}
								//								sbLogMessage.append("NF Time in Seconds: ");
								//								sbLogMessage.append(DiffTime);
								//								log(stLogCategory, ILog.DEBUG, sbLogMessage
								//										.toString());
								TotNFTime += DiffTime;
							} else {
								//egDataHandler.setFirstEDM(false);
								//eligDetailPrevMth = null;
								//eligDetailPrevMth =
								// validRecordForPrevMth(arrEligDetailOutput,
								// arrEdEligibilityCargo[i]);

								//Defect 131956
								//Added for defect 192029
								//modified for BRGUS00092096
								/*
								 * detEdVerificationChecklistFiltered(
								 * egDataHandler, arrEdEligibilityCargo[i]
								 * .getEdgNum(), false, true);
								 */
								//Added to move from the general process to
								// here for defect 227929
								//Added for Defect 206710 on 5/23/2005
								detEdVerificationChecklistFiltered(
										egDataHandler, arrEdEligibilityCargo[i]
												.getProgramCd(), false, true);

								StTime = System.currentTimeMillis();
								if (isNFRequired(arrEdEligibilityCargo[i])) {
									arrEligDetailOutput[i] = nfManagerObj
											.doProcess(
													arrEdEligibilityCargo[i],
													arrEligDetailInput,
													eligDetailPrevMth,
													arrEligDetailOutput,
													nfDataHandler,
													egDataHandler, conn,
													runMode,aMapRequest);
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger.writeRulesEngineTimerLog(DiffTime,
//										stLogCategory,
//										"NF Time in seconds :  ", sbLogMessage);
								//								if (sbLogMessage.length() > 0) {
								//									sbLogMessage.delete(0, sbLogMessage
								//											.length());
								//								}
								//								sbLogMessage.append("NF Time in Seconds: ");
								//								sbLogMessage.append(DiffTime);
								//								log(stLogCategory, ILog.DEBUG, sbLogMessage
								//										.toString());
								TotNFTime += DiffTime;
							}
							//Defect 131956
							if (egDataHandler
									.getAlEdVerificationChecklistFiltered() != null) {
								egDataHandler
										.getAlEdVerificationChecklistModApp()
										.addAll(
												egDataHandler
														.getAlEdVerificationChecklistFiltered());
								egDataHandler
										.setAlEdVerificationChecklistFiltered(null);
							}
							//Commented for QA DEFECT DIOL on 10/18/2004
							//ResourceManager resManagerObj = new
							// ResourceManager();
							//Added for DcFilter 12/28/2004

							if (i == 0) {
								egDataHandler.detEligDetailFiltered(
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0],
										arrEligDetailOutput[i], null, false,
										IEdEligCodes.MODULE_SWITCH_RSC);
								egDataHandler
										.setPreStrikeDt(detPreStrikeDt(
												egDataHandler
														.getEligDetailFiltered(),
												egDataHandler
														.getPreStrikeDcEmploymentCargo()));
							} else {
								eligDetailPrevMth = null;
								eligDetailPrevMth = validRecordForPrevMth(
										arrEligDetailOutput,
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]);
								egDataHandler.detEligDetailFiltered(
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0],
										arrEligDetailOutput[i],
										eligDetailPrevMth, false,
										IEdEligCodes.MODULE_SWITCH_RSC);
								egDataHandler
										.setPreStrikeDt(detPreStrikeDt(
												egDataHandler
														.getEligDetailFiltered(),
												egDataHandler
														.getPreStrikeDcEmploymentCargo()));
							}
							if (sPrevEDM == null
									|| sPrevEDM
											.equals(DateComparisons
													.getStringMMYYYY(arrEdEligibilityCargo[i]
															.getPaymentBegDt()))) {
								//sPrevEDM =
								// DateComparisons.getStringMMYYYY(arrEdEligibilityCargo[i].getPaymentBegDt());
								edDcUtil.filterDcInfoForResMonthly(
										egDataHandler, resDataHandler);
							}

							if (i == 0) {
								StTime = System.currentTimeMillis();
								if (isResourceRequired(arrEdEligibilityCargo[i])) {
									arrEligDetailOutput[i] = resManagerObj
											.doProcess(
													arrEligDetailOutput[i]
															.getEdEligibilityCargo()[0],
													arrEligDetailOutput[i],
													null, null, resDataHandler,
													egDataHandler,arrEligDetailInput);
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"RES Time in seconds :  ",
//												sbLogMessage);

								//								if (sbLogMessage.length() > 0) {
								//									sbLogMessage.delete(0, sbLogMessage
								//											.length());
								//								}
								//								sbLogMessage.append("Res Time in Seconds: ");
								//								sbLogMessage.append(DiffTime);
								//								log(stLogCategory, ILog.DEBUG, sbLogMessage
								//										.toString());
								TotResTime += DiffTime;

							} else {
								eligDetailPrevMth = null;
								eligDetailPrevMth = validRecordForPrevMth(
										arrEligDetailOutput,
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]);
								StTime = System.currentTimeMillis();
								if (isResourceRequired(arrEdEligibilityCargo[i])) {
									arrEligDetailOutput[i] = resManagerObj
											.doProcess(
													arrEligDetailOutput[i]
															.getEdEligibilityCargo()[0],
													arrEligDetailOutput[i],
													eligDetailPrevMth,
													arrEligDetailOutput,
													resDataHandler,
													egDataHandler,
													arrEligDetailInput);
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"RES Time in seconds :  ",
//												sbLogMessage);

								//								if (sbLogMessage.length() > 0) {
								//									sbLogMessage.delete(0, sbLogMessage
								//											.length());
								//								}
								//								sbLogMessage.append("Res Time in Seconds: ");
								//								sbLogMessage.append(DiffTime);
								//								log(stLogCategory, ILog.DEBUG, sbLogMessage
								//										.toString());
								TotResTime += DiffTime;

							}
							//Commented for QA DEFECT DIOL on 10/18/2004
							//FinManager finManagerObj = new FinManager();
							finManagerObj.init();
							//Following code is added by Sai on 12-11-2004 to
							// filter DC Tables once per EDM
							if (i == 0) {
								egDataHandler.detEligDetailFiltered(
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0],
										arrEligDetailOutput[i], null, false,
										IEdEligCodes.MODULE_SWITCH_FIN);
								egDataHandler
										.setPreStrikeDt(detPreStrikeDt(
												egDataHandler
														.getEligDetailFiltered(),
												egDataHandler
														.getPreStrikeDcEmploymentCargo()));
								finDataHandler.setPreStrikeDt(egDataHandler
										.getPreStrikeDt());
							} else {
								eligDetailPrevMth = null;
								eligDetailPrevMth = validRecordForPrevMth(
										arrEligDetailOutput,
										arrEdEligibilityCargo[i]);
								egDataHandler.detEligDetailFiltered(
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0],
										arrEligDetailOutput[i], null, false,
										IEdEligCodes.MODULE_SWITCH_FIN);
								egDataHandler
										.setPreStrikeDt(detPreStrikeDt(
												egDataHandler
														.getEligDetailFiltered(),
												egDataHandler
														.getPreStrikeDcEmploymentCargo()));
								finDataHandler.setPreStrikeDt(egDataHandler
										.getPreStrikeDt());
								//finManagerObj.isExecutedBillsFm = false;
							}
							if (sPrevEDM == null
									|| sPrevEDM
											.equals(DateComparisons
													.getStringMMYYYY(arrEdEligibilityCargo[i]
															.getPaymentBegDt()))) {
								//sPrevEDM =
								// DateComparisons.getStringMMYYYY(arrEdEligibilityCargo[i].getPaymentBegDt());
								edDcUtil
										.filterDcInfoForFinMonthly(
												egDataHandler, finDataHandler,
												arrEdEligibilityCargo[i]
														.getProgramCd());
							}

							if (i == 0) {
								StTime = System.currentTimeMillis();
								if (isFinRequired(arrEdEligibilityCargo[i])) {
									if (isFinRequired(arrEdEligibilityCargo[i])) {
										arrEligDetailOutput[i] = finManagerObj
												.doProcess(
														arrEligDetailOutput[i]
																.getEdEligibilityCargo()[0],
														arrEligDetailOutput[i],
														arrEligDetailInput[1],
														null, null,
														finDataHandler,
														egDataHandler,
														arrEligDetailInput);
									}
								}
								if (arrEdEligibilityCargo[i]
										.getTypeOfAssistanceCd()
										.equalsIgnoreCase(IEdEligCodes.G2CM)
										|| arrEdEligibilityCargo[i]
												.getTypeOfAssistanceCd()
												.equalsIgnoreCase(
														IEdEligCodes.G2PM)
										|| arrEdEligibilityCargo[i]
												.getTypeOfAssistanceCd()
												.equalsIgnoreCase(
														IEdEligCodes.G2SM)
										|| arrEdEligibilityCargo[i]
												.getTypeOfAssistanceCd()
												.equalsIgnoreCase(
														IEdEligCodes.G2UM)) {
									finManagerObj.isExecutedBillsFm = false;
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
								//								if (sbLogMessage.length() > 0) {
								//								sbLogMessage.delete(0, sbLogMessage
								//										.length());
								//							}
								//							sbLogMessage.append("Fin Time in Seconds: ");
								//							sbLogMessage.append(DiffTime);
								//							log(stLogCategory, ILog.DEBUG, sbLogMessage
								//									.toString());
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"FIN Time in seconds :  ",
//												sbLogMessage);

								TotFinTime += DiffTime;

							} else {
								//eligDetailPrevMth = null;
								//eligDetailPrevMth = validRecordForPrevMth(
								// arrEligDetailOutput,
								// arrEligDetailOutput[i].getEdEligibilityCargo()[0]);
								StTime = System.currentTimeMillis();
								if (isFinRequired(arrEdEligibilityCargo[i])) {
									arrEligDetailOutput[i] = finManagerObj
											.doProcess(
													arrEligDetailOutput[i]
															.getEdEligibilityCargo()[0],
													arrEligDetailOutput[i],
													arrEligDetailInput[1],
													arrEligDetailOutput,
													eligDetailPrevMth,
													finDataHandler,
													egDataHandler,arrEligDetailInput);
								}
								if ((arrEdEligibilityCargo[i]
										.getTypeOfAssistanceCd()
										.equalsIgnoreCase(IEdEligCodes.G2CM)
										|| arrEdEligibilityCargo[i]
												.getTypeOfAssistanceCd()
												.equalsIgnoreCase(
														IEdEligCodes.G2PM)
										|| arrEdEligibilityCargo[i]
												.getTypeOfAssistanceCd()
												.equalsIgnoreCase(
														IEdEligCodes.G2SM) || arrEdEligibilityCargo[i]
										.getTypeOfAssistanceCd()
										.equalsIgnoreCase(IEdEligCodes.G2UM))
										&& finManagerObj.isExecutedBillsFm == true) {
									finManagerObj.isExecutedBillsFm = false;
								}
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
								//								if (sbLogMessage.length() > 0) {
								//								sbLogMessage.delete(0, sbLogMessage
								//										.length());
								//							}
								//							sbLogMessage.append("Fin Time in Seconds: ");
								//							sbLogMessage.append(DiffTime);
								//							log(stLogCategory, ILog.DEBUG, sbLogMessage
								//									.toString());
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"FIN Time in seconds :  ",
//												sbLogMessage);

								TotFinTime += DiffTime;

							}

							//Dev Activity : BRGUS00015186
							//Calling SER Services
							/*
							 * BRGUS00060177 - Issue: for 2nd EDG Services wast
							 * not been called Fix - removed the isSERcalled
							 * flag
							 */
							serDataHandler.setSerServiceInfo(serDataHandler
									.getSerDetail(aLCaseNum, conn));
							/* beniwala - ASPEN00018950
							 * SERManager is not used in New Mexico
							 * if (arrEdEligibilityCargo[i].getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_SER)) {
								//Added Log file logic for all Services --
								// DevActivity: BRGUS00097455.
								StTime = System.currentTimeMillis();
								if (i == arrEdEligibilityCargo.length - 1) {
									 BRGUS00060985 added edEligibilityOtherTP 
									EdEligibilityCargo[] edEligibilityOtherTP = egDataHandler
											.getEdOtherTPCargo(
													arrEligDetailInput[0],
													arrEligDetailOutput[0]);
									SERManager serManager = new SERManager();
									for (int x = 0; x < arrEdEligibilityCargo.length; x++) {
										if (arrEdEligibilityCargo[x]
												.getProgramCd()
												.equalsIgnoreCase("SE")
												&& !(arrEdEligibilityCargo[x]
														.getPaymentEndDt() == null && arrEdEligibilityCargo[x]
														.getCgSize() == 0)) {
											 BrgId:BRGUS00073750
											 * userId:GANTAC
											 * Date:04/22/2008
											 * Passing arrEligDetailOutput (all processed cargos to Service eligibility)
											 
											 Begin BRGUS00113124 – kesavanr
											 * Calling VCL after executing each SER service.
											 
											 Begin BRGUS00113479 – kesavanr
											 * Sorting failure reason code before calling SER service.
											 
											if (arrEligDetailOutput[x].getEdEligNoticeReasonsCargo() != null) {
												sortFailureReasonCode(arrEligDetailOutput[x]
														.getEdEligNoticeReasonsCargo());
											}
											//End BRGUS00113479
											 Begin BRGUS00114625 – kesavanr
											 * Calling supporting methods before calling vcl for SER program.
											 
											egDataHandler.detEligDetailLastAuth(egDataHandler
													.getEligDetail()[1], arrEligDetailOutput[x]
													.getEdEligibilityCargo()[0]);

											egDataHandler.detEligDetailPrevProc(
													arrEligDetailOutput, arrEligDetailOutput[x]
															.getEdEligibilityCargo()[0]);

											egDataHandler.detEligDetailFiltered(
													arrEligDetailOutput[x]
															.getEdEligibilityCargo()[0],
													arrEligDetailOutput[x], null, false,
													IEdEligCodes.MODULE_SWITCH_FIN);

											detEdVerificationChecklistFiltered(
													egDataHandler, arrEdEligibilityCargo[x]
															.getProgramCd(), false, true);
											//End BRGUS00114625
											serManager
													.executeSerServices(
															aLCaseNum,
															serDataHandler,
															arrEligDetailOutput[x],
															finDataHandler,
															egDataHandler,
															null,
															arrEligDetailInput[0],
															arrEligDetailOutput,
															arrEligDetailInput,
															null,
															conn);//BrgId:BRGUS00160516 UserId: GANTAC Date: 05/08/2009 SER bacth changes passing conn parameter
											//BEGIN-BRGUS00161268-upadhyayulag-Override SER fields
											EdEdgOverrideCargo serEdgOverrideCargo = new EdEdgOverrideCargo();
											serEdgOverrideCargo.setCaseNum(arrEdEligibilityCargo[i].getCaseNum());
											serEdgOverrideCargo.setEdgNum(arrEdEligibilityCargo[i].getEdgNum());
											serEdgOverrideCargo.setBeginDt(arrEdEligibilityCargo[i].getPaymentBegDt());
											serEdgOverrideCargo.setEndDt(arrEdEligibilityCargo[i].getPaymentEndDt());
											EdEdgOverrideCollection serEdgOverrideCollection = new EdEdgOverrideCollection();
											if(conn != null){
												serEdgOverrideCollection = new EdEdgOverrideCollection(conn);
											}else{
												serEdgOverrideCollection = new EdEdgOverrideCollection();
											}
											serEdgOverrideCollection.setCargo(serEdgOverrideCargo);
											EdEdgOverrideCargo[] serEdgOverrideCargos = 
												(EdEdgOverrideCargo[])serEdgOverrideCollection.select("findByCaseNumEdgNumDates");
											if(serEdgOverrideCargos != null && serEdgOverrideCargos.length > 0){
												EdEdgOverrideDetailsCargo serEdEdgOverrideDetailsCargo = new EdEdgOverrideDetailsCargo();
												serEdEdgOverrideDetailsCargo.setCaseNum(edgOverrideCargos[0].getCaseNum());
												serEdEdgOverrideDetailsCargo.setEdgNum(edgOverrideCargos[0].getEdgNum());
												serEdEdgOverrideDetailsCargo.setOvrdId(edgOverrideCargos[0].getOvrdId());
												edgOverrideDetailsCollection.setCargo(serEdEdgOverrideDetailsCargo);
												EdEdgOverrideDetailsCargo[] serEdgOverrideDetailsCargos = 
													(EdEdgOverrideDetailsCargo[])edgOverrideDetailsCollection.select
													("findByCaseNumEdgNumOvrdId");
												if(serEdgOverrideDetailsCargos != null && serEdgOverrideDetailsCargos.length > 0){
													overrideDataExists = true;
													edgOverrideDetailsCollection.clear();
													edgOverrideDetailsCollection.setResults(serEdgOverrideDetailsCargos);
												}else{
													edgOverrideDetailsCollection.clear();
													overrideFields.clear();
												}
											}
											overrideField("Request Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Shortfall Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Co-payment Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Client Contribution Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Prorated Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Final Payment Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("SER Service Eligibility Status",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Emergency Resolved",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Override Amount",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Override Service Code",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											overrideField("Funding Source",edgOverrideDetailsCollection,arrEligDetailOutput[x],egDataHandler);
											//END-BRGUS00161268
											checkFundingSource(arrEligDetailOutput[x]);//BRGUS00224819-upadhyayulag
// BRGUS00224287 rampurkara passing connection object											
											performVCL(arrEligDetailOutput[x],
													arrEligDetailInput[1],
													egDataHandler, finDataHandler,
													resDataHandler, nfDataHandler,
													serDataHandler, dssDataHandler,arrEligDetailOutput,arrEligDetailInput, conn,aMapRequest);
											//End BRGUS00113124
											// end BRGUS00224287
										}
									}
								}

								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"SER Time in seconds :  ",
//												sbLogMessage);
								totalSERTime += DiffTime;
								//Removed arrEligDetailInput[0] .

							} else */
								if (arrEdEligibilityCargo[i].getProgramCd()
									.equals(IEdEligCodes.PROGRAM_CD_CDC)) {
								/* Begin BRGUS00113479 – kesavanr
								 * Sorting failure reason code before calling CDC service.
								 */
								if (arrEligDetailOutput[i].getEdEligNoticeReasonsCargo() != null) {
									sortFailureReasonCode(arrEligDetailOutput[i]
											.getEdEligNoticeReasonsCargo());
								}
								//End BRGUS00113479
								StTime = System.currentTimeMillis();
								//EligDetail eligDetailTP01 = egDataHandler
								//	.getEdTP01Cargo(arrEligDetailInput[0]);
								EligDetail eligDetailTP01 = egDataHandler
										.getEdTP01Cargo(arrEligDetailOutput[i],
												arrEligDetailInput[1]);
								EligDetail eligDetailTP13 = egDataHandler
										.getEdTP13Cargo(arrEligDetailInput[0]);
								CDCManager cdcManager = new CDCManager();
								cdcDataHandler.setCdcServiceInfo(cdcDataHandler
										.getCdcDetail(aLCaseNum, conn));
								cdcManager.executeCdcService(aLCaseNum,
										cdcDataHandler, nfDataHandler,
										egDataHandler, arrEligDetailOutput[i],
										eligDetailTP01, eligDetailTP13,
										arrEligDetailOutput,arrEligDetailInput,aMapRequest);
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"CDC Time in seconds :  ",
//												sbLogMessage);
								totalCDCTime += DiffTime;
							} else if (arrEdEligibilityCargo[i].getProgramCd()
									.equals(IEdEligCodes.PROGRAM_CD_DS)) {
								StTime = System.currentTimeMillis();
								/* Begin BRGUS00113479 – kesavanr
								 * Sorting failure reason code before calling DSS service.
								 */
								if (arrEligDetailOutput[i].getEdEligNoticeReasonsCargo() != null) {
									sortFailureReasonCode(arrEligDetailOutput[i]
											.getEdEligNoticeReasonsCargo());
								}
								//End BRGUS00113479
								DSSManager dssManager = new DSSManager();
								dssDataHandler.setDSSServiceInfo(dssDataHandler
										.getDSSDetail(aLCaseNum, conn,
												tsMaxEDM, tsMinEDM,
												nfDataHandler,arrEdEligibilityCargo[i].getEdbcRunDt(),egDataHandler));//BRGUS00205923 GANTAC 11/05/2009
								edDcUtil.filterDcInfoForDSSMonthly(
										egDataHandler, dssDataHandler);
								dssManager.executeDSSService(aLCaseNum,
										dssDataHandler, nfDataHandler,
										arrEligDetailOutput[i], egDataHandler,arrEligDetailInput);
								//BEGIN-BRGUS00161268-upadhyayulag-Override DSS fields
								overrideField("Service Payment Amount",edgOverrideDetailsCollection,
										arrEligDetailOutput[i],egDataHandler);
								overrideField("Service Result",edgOverrideDetailsCollection,
										arrEligDetailOutput[i],egDataHandler);
								//END-BRGUS00161268
								DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//								EDBCLogger
//										.writeRulesEngineTimerLog(DiffTime,
//												stLogCategory,
//												"DSS Time in seconds :  ",
//												sbLogMessage);
								totalDSSTime += DiffTime;
							}
							// Added for Defect #BRGUS00063527 By Sairama
							// Processing Scope and Coverage Indicator
							//Moved to end process to get the cgstatuscd
							/*
							 * if
							 * (arrEdEligibilityCargo[i].getProgramCd().equals(
							 * IEdEligCodes.PROGRAM_CD_ME) ||
							 * arrEdEligibilityCargo[i].getProgramCd().equals(
							 * IEdEligCodes.PROGRAM_CD_FMA) ||
							 * arrEdEligibilityCargo[i].getProgramCd().equals(
							 * IEdEligCodes.PROGRAM_CD_MC)) { EDScopeCoverageBO
							 * edScopeCoverageBo = new EDScopeCoverageBO();
							 * edScopeCoverageBo.processScopeCoverage(egDataHandler,
							 * arrEligDetailOutput[i]);
							 *  }
							 */

						}// End of MM-Tand P record check
						// changed for the defect # 00187402 to invoke
						// detEligDetailLastAuth for both
						// P&P and NOOP-IndvAdverseAction=Y MM Types
						if (bMMPandPrecord == false) {
							egDataHandler.detEligDetailLastAuth(egDataHandler
									.getEligDetail()[1], arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0]);
						}
						egDataHandler.detEligDetailUAProcTfFmaCurrEDMEdges(
								arrEligDetailOutput, arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]);
						egDataHandler.detEligDetailPrevProc(
								arrEligDetailOutput, arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]);
						// Added for Tanf PFP changes
						egDataHandler
								.detEligDetailLastAuthForTanfPFP(egDataHandler
										.getEligDetail()[1],
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]);

						egDataHandler.detEligDetailPrevProc(
								arrEligDetailOutput, arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]);
						bFSOverrideAndTanf = true;
						//Modified for defect101099
						if (egDataHandler.getFSOverrideSw() != null
								&& egDataHandler.getFSOverrideSw().equals(
										IEdEligCodes.FS_OVERRIDES)
								&& arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getCurrentEligInd() == IEdEligCodes.CURRENT_ELIG_INDICATOR_P) {

							bFSOverrideAndTanf = false;
						}

						/*
						 * if
						 * ((arrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CC) ||
						 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA) ||
						 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)) &&
						 * (egDataHandler.getHmProgramCd().containsKey(IEdEligCodes.PROGRAM_CD_CC))) {
						 *
						 * OPSServicesManager opsServicesObj = new
						 * OPSServicesManager(); if (i == 0) {
						 * egDataHandler.setFirstEDM(true);
						 * arrEligDetailOutput[i] =
						 * opsServicesObj.doProcess(arrEligDetailOutput[i].getEdEligibilityCargo()[0],
						 * arrEligDetailOutput[i], null, null,
						 * opsServicesDataHandler, nfDataHandler,
						 * egDataHandler); } else {
						 * egDataHandler.setFirstEDM(false); EligDetail
						 * eligDetailPrevMth = null; eligDetailPrevMth =
						 * validRecordForPrevMth( arrEligDetailOutput,
						 * arrEligDetailOutput[i].getEdEligibilityCargo()[0]);
						 * arrEligDetailOutput[i] =
						 * opsServicesObj.doProcess(arrEligDetailOutput[i].getEdEligibilityCargo()[0],
						 * arrEligDetailOutput[i], eligDetailPrevMth,
						 * arrEligDetailOutput, opsServicesDataHandler,
						 * nfDataHandler, egDataHandler); } }
						 */

						if (bFSOverrideAndTanf == true) {
							if ((arrEdEligibilityCargo[i].getCreatorInd() == EDGConstants.COPY_CREATED)
									&& (arrEdEligibilityCargo[i]
											.getCurrentEligInd() == IEdEligCodes.CURRENT_ELIG_INDICATOR_P)) {
								// CCB: 00127585: Do nothing for T and P records
							} else {
								//? if (aMapRequest.get(MU_RUN_MODE) == null ||
								// (!((String)aMapRequest.get(MU_RUN_MODE)).equals("CV")
								// &&
								// !egDataHandler.getDcCasesCargo()[0].getCaseModeCd().equals("CV")))
								// {
								//? Defect BRGUS00055256
								if (aMapRequest.get(MU_RUN_MODE) == null
										|| (!((String) aMapRequest
												.get(MU_RUN_MODE)).equals("CV") && !allPgmsInCvMode(egDataHandler))){
									StTime = System.currentTimeMillis();
									//BRGUS00084723 - bhuvane - adding ed output tables in vcl parameter
									//BRGUS00113124 – kesavanr – VCL called after executing each service. No need to cal VCL here for SER service.
// BRGUS00224287 rampurkara passing connection object	
									
									/*
									 * beniwala - ASPEN00018950 - perform VCL for LIHEAP also at this stage as the previous call of performVCL
									 * has been commmented out
									 */
									//if(!arrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE")) {
									performVCL(arrEligDetailOutput[i],
											arrEligDetailInput[1],
											egDataHandler, finDataHandler,
											resDataHandler, nfDataHandler,
											serDataHandler, dssDataHandler,arrEligDetailOutput,arrEligDetailInput, conn,aMapRequest);
									//}
// end of BRGUS00224287									
									//arrEligDetailOutput[i].getEdEligibilityCargo()[0].setVerificationStatusCd(IEdEligCodes.VERIFICATION_STATUS_CD_PASS);
									//EndTime = System.currentTimeMillis();
									DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
//									EDBCLogger.writeRulesEngineTimerLog(
//											DiffTime, stLogCategory,
//											"VCL Time in seconds :  ",
//											sbLogMessage);
									//									if (sbLogMessage.length() > 0) {
									//										sbLogMessage.delete(0, sbLogMessage
									//												.length());
									//									}
									//									sbLogMessage
									//											.append("VCL Time in Seconds: ");
									//									sbLogMessage.append(DiffTime);
									//									log(stLogCategory, ILog.DEBUG,
									// sbLogMessage
									//											.toString());
									TotVCLTime += DiffTime;
									//									StTime = System.currentTimeMillis();
									//performRMEDBC(arrEligDetailOutput[i],
									// egDataHandler, finDataHandler,
									// resDataHandler, nfDataHandler,
									// rmDataHandler);
									//EndTime = System.currentTimeMillis();
									//									DiffTime = ((System.currentTimeMillis() -
									// StTime) / 1000F);
									//									if (sbLogMessage.length() > 0) {
									//										sbLogMessage.delete(0, sbLogMessage
									//												.length());
									//									}
									//									sbLogMessage
									//											.append("Perform-RM Time in Seconds: ");
									//									sbLogMessage.append(DiffTime);
									//									log(stLogCategory, ILog.DEBUG,
									// sbLogMessage
									//											.toString());
									//									TotRMTime += DiffTime;
								} else {
									arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.setVerificationStatusCd(IEdEligCodes.VERIFICATION_STATUS_CD_PASS);
								}
							}
							hmParams = detParamsForEDBCEndProcess(
									arrEligDetailOutput, arrEligDetailOutput[i]);
							hmParams.put(DiAttributes.MI_CHILD_DEPLOY_SW,aMapRequest.get(DiAttributes.MI_CHILD_DEPLOY_SW));//BRGUS00215118
							hmParams.put(IEdEligCodes.ELIG_DETAIL_ALL_DB,
									arrEligDetailInput);
							hmParams.put(IEdEligCodes.DC_CASE_PROGRAM_CARGO,
									dcCaseProgramCargo);
							hmParams.put(IEdEligCodes.EG_DATA_HANDLER,
									egDataHandler);
							hmParams.put(IEdEligCodes.NF_DATA_HANDLER,
									nfDataHandler);
							hmParams.put(
									IEdEligCodes.MODULE_SWITCH_FROM_REQUEST,
									aSReqModSw);
							//Addded for CCB:160712
							hmParams
									.put(IEdEligCodes.SESSION_USER_ID, aSUserId);

							hmParams.put("CONNECTION", conn);
							hmParams.put("USER_ID", aSUserId);
							hmParams.put("overrideFields",overrideFields);
							hmParams.put("edgOverrideDetailsCollection",edgOverrideDetailsCollection);
							//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update
							hmParams.put("userInfo",userInfo);
							//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
							hmParams.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
							hmParams.put("isAuthorizedRecSpecialist",Boolean.valueOf(isAuthorizedRecSpecialist));
							//END-BRGUS00217436
							//END-BRGUS00205536
							// beniwala - ASPEN00021700
							hmParams.put(IEdEligCodes.USER_INFO, (User) aMapRequest.get(IEdEligCodes.USER_INFO));
							
							//ASPEN00036737 - TANF Support Services - Added by Sai Suresh
							hmParams.put(IEdEligCodes.KEY_TANFCOUNTER_MAP, aMapRequest.get(IEdEligCodes.KEY_TANFCOUNTER_MAP));
							hmParams.put(IEdEligCodes.KEY_TANFCOUNTERINCSW_MAP,aMapRequest.get(IEdEligCodes.KEY_TANFCOUNTERINCSW_MAP));
							
							if (i == 0) {
								//Commented due to FindBugs Analysis
								//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
								// new Boolean(true));
								hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
										Boolean.valueOf(true));
							} else {
								//Commented due to FindBugs Analysis
								//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
								// new Boolean(false));
								hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
										Boolean.valueOf(false));
							}
							
							//added for defect 104597
							egDataHandler.setHmParamForEndProcess(hmParams);

							//Getting previous eligdetail for CDC
							for (int j = i - 1; j >= 0; j--) {
								if (arrEligDetailOutput[j] != null
										&& arrEligDetailOutput[j]
												.getEdEligibilityCargo() != null
										&& arrEligDetailOutput[j]
												.getEdEligibilityCargo().length > 0) {
									if (arrEligDetailOutput[j]
											.getEdEligibilityCargo()[0]
											.getProgramCd().equalsIgnoreCase(
													"CD")) {
										eligDetailPrevCD = arrEligDetailOutput[j];
										break;
									} else {
										continue;
									}
								}
							}
							if (!arrEdEligibilityCargo[i].getProgramCd()
									.equalsIgnoreCase("SE")) {
								arrEligDetailOutput[i] = determineEdDetails(
										hmParams, eligDetailPrevMth,
										arrEligDetailOutput);
							}
							egDataHandler.deteligDetailLastAuthOpenEndedEDM(
									egDataHandler.getEligDetail()[1],
									arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]);
							//Following code is added for PFP - CCB: 158628-
							// Scn-2 by Sai on 4/20/2005
							ArrayList alarrEdIndvPenToBeImposedCargo = null;
							if (!checkIfAlreadyPFPProcessed(
									arrEligDetailOutput[i], egDataHandler)) {
								alarrEdIndvPenToBeImposedCargo = new ArrayList();
								if (checkForPFPProcessing(
										arrEligDetailOutput[i], egDataHandler,
										hEdgDetails,
										alarrEdIndvPenToBeImposedCargo)
										&& arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getSpecialTriggerCd() == null) {
									EligDetail newEligDetail = new EligDetail();
									HashMap hmEdgParams = new HashMap();
									hmEdgParams.put(CASE_NUM, new Long(
											aLCaseNum));
									hmEdgParams.put(
											IEdEligCodes.SESSION_USER_ID,
											aSUserId);
									hmEdgParams.put(
											IEdEligCodes.REQUEST_CASE_RUN_MODE,
											IEdEligCodes.CASE_RUN_MODE_ONLINE);
									hmEdgParams
											.put(
													EDGConstants.EDG_RUN_MODE,
													new Character(
															EDGConstants.EDGRunMode.SANCTION_COPY));
									hmEdgParams.put(
											EDGConstants.EDBC_PROC_ELIG_DETAIL,
											arrEligDetailOutput[i]);
									hmEdgParams.put(
											EDGConstants.AUTH_ELIG_DETAIL,
											egDataHandler
													.getEligDetailOpenAuth());
									hmEdgParams.put("CONNECTION", conn);//BRGUS00190358-upadhyayulag
									newEligDetail = performEDGCopyProcess(hmEdgParams);
									newEligDetail = performPFPCopyProcess(
											arrEligDetailOutput[i],
											newEligDetail, egDataHandler
													.getEligDetailOpenAuth(),
											aLCaseNum, conn);
									//								Added if condition for Defect # 227184
									if (newEligDetail.getEdEligibilityCargo()[0]
											.getProgramCd().equals(
													IEdEligCodes.PROGRAM_CD_FS)) {
										newEligDetail.getEdEligibilityCargo()[0]
												.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_SANCTION_ON_DENIED);
										newEligDetail.getEdEligibilityCargo()[0]
												.setAdverseActionAllowedSw(IEdEligCodes.YES);
										newEligDetail.getEdEligibilityCargo()[0]
												.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
									} else {
										newEligDetail.getEdEligibilityCargo()[0]
												.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_FF_MTH1_PENDING);
										newEligDetail.getEdEligibilityCargo()[0]
												.setAdverseActionAllowedSw(IEdEligCodes.YES);
										newEligDetail.getEdEligibilityCargo()[0]
												.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
									}
									//Set Create Indicator to 'C'
									newEligDetail.getEdEligibilityCargo()[0]
											.setCreatorInd(EDGConstants.COPY_COMPLETED);
									//Carry Fwd to next month record
									if ((alarrEdIndvPenToBeImposedCargo != null)
											&& (alarrEdIndvPenToBeImposedCargo
													.size() > 0)) {
										newEligDetail
												.setEdIndvPenToBeImposedCargo((EdIndvPenToBeImposedCargo[]) alarrEdIndvPenToBeImposedCargo
														.toArray(new EdIndvPenToBeImposedCargo[alarrEdIndvPenToBeImposedCargo
																.size()]));
									}

									//1. Setting this as UnAuthCurrEDM and
									// EligdetailFiltered is requiredas NonFin
									// uses this.
									//2. Don't invoke EndProcess, it will
									// change the result, which is not required.
									egDataHandler
											.setEligDetailUnAuthCurrEDM(newEligDetail);
									egDataHandler
											.setEligDetailFiltered(newEligDetail);
									//Invokde NF Process
									if (isNFRequired(arrEdEligibilityCargo[i])) {
										newEligDetail = nfManagerObj
												.doProcess(
														newEligDetail
																.getEdEligibilityCargo()[0],
														arrEligDetailInput,
														eligDetailPrevMth,
														arrEligDetailOutput,
														nfDataHandler,
														egDataHandler, conn,
														runMode,aMapRequest);
									}
									if (alEligDetailForPFPSanction == null) {
										alEligDetailForPFPSanction = new ArrayList();
									}
									alEligDetailForPFPSanction
											.add(newEligDetail);
									newEligDetail.setRecordInsertFlag(true);
									appendEligDetailProcessed(newEligDetail,
											egDataHandler);

								}
								//Following if added for PFP - CCB: 158628-
								// Scn-3 by Sai on 4/27/2005
								if ((bMMPandPrecord)
										&& (arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getProgramCd()
												.equals(IEdEligCodes.PROGRAM_CD_TANF))
										&& (arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getSpecialTriggerCd() != null && arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getSpecialTriggerCd()
												.equals(
														IEdEligCodes.SPECIAL_TRIGGER_CD_SP002))) {
									EligDetail newEligDetail = null;
									egDataHandler.setForMMProcessFlag(true);
									egDataHandler
											.detEligDetailLastAuth(
													egDataHandler
															.getEligDetail()[1],
													arrEligDetailOutput[i]
															.getEdEligibilityCargo()[0]);
									egDataHandler.setForMMProcessFlag(false);
									newEligDetail = arrEligDetailOutput[i];
									performPFPCopyProcess(
											arrEligDetailOutput[i],
											newEligDetail, egDataHandler
													.getEligDetailLastAuth(),
											aLCaseNum, conn);

									newEligDetail.getEdEligibilityCargo()[0]
											.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_FF_MTH1_PENDING);
									newEligDetail.getEdEligibilityCargo()[0]
											.setAdverseActionAllowedSw(IEdEligCodes.YES);
									newEligDetail.getEdEligibilityCargo()[0]
											.setCurrentEligInd(IEdEligCodes.CURRENT_ELIG_INDICATOR_P);
									//Set Create Indicator to 'C'
									newEligDetail.getEdEligibilityCargo()[0]
											.setCreatorInd(EDGConstants.COPY_COMPLETED);

									//1. Setting this as UnAuthCurrEDM and
									// EligdetailFiltered is requiredas NonFin
									// uses this.
									//2. Don't invoke EndProcess, it will
									// change the result, which is not required.

									egDataHandler
											.setEligDetailUnAuthCurrEDM(newEligDetail);
									egDataHandler
											.setEligDetailFiltered(newEligDetail);
									//Carry Fwd to next month record
									if (alarrEdIndvPenToBeImposedCargo != null) {
										newEligDetail
												.setEdIndvPenToBeImposedCargo((EdIndvPenToBeImposedCargo[]) alarrEdIndvPenToBeImposedCargo
														.toArray(new EdIndvPenToBeImposedCargo[alarrEdIndvPenToBeImposedCargo
																.size()]));
									}
									//Invokde NF Process
									if (isNFRequired(arrEdEligibilityCargo[i])) {
										newEligDetail = nfManagerObj
												.doProcess(
														newEligDetail
																.getEdEligibilityCargo()[0],
														arrEligDetailInput,
														eligDetailPrevMth,
														arrEligDetailOutput,
														nfDataHandler,
														egDataHandler, conn,
														runMode,aMapRequest);
									}
									newEligDetail.getEdEligibilityCargo()[0]
											.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_FF_MTH2_PENDING);
									arrEligDetailOutput[i] = newEligDetail;
									//appendEligDetailProcessed(newEligDetail,
									// egDataHandler);
									if (alEligDetailForPFPSanction == null) {
										alEligDetailForPFPSanction = new ArrayList();
									}
									alEligDetailForPFPSanction
											.add(newEligDetail);
									//Do End Process for the cloned eEliDetail
									// Later this can be made as function
									hmParams = detParamsForEDBCEndProcess(
											arrEligDetailOutput, newEligDetail);
									hmParams.put(
											IEdEligCodes.ELIG_DETAIL_ALL_DB,
											arrEligDetailInput);
									hmParams.put(
											IEdEligCodes.DC_CASE_PROGRAM_CARGO,
											dcCaseProgramCargo);
									hmParams.put(IEdEligCodes.EG_DATA_HANDLER,
											egDataHandler);
									hmParams.put(IEdEligCodes.NF_DATA_HANDLER,
											nfDataHandler);
									hmParams
											.put(
													IEdEligCodes.MODULE_SWITCH_FROM_REQUEST,
													aSReqModSw);
									//Added for CCB: 160712
									hmParams.put(IEdEligCodes.SESSION_USER_ID,
											aSUserId);

									hmParams.put("CONNECTION", conn);
									hmParams.put("USER_ID", aSUserId);
									hmParams.put("overrideFields",overrideFields);
									hmParams.put("edgOverrideDetailsCollection",edgOverrideDetailsCollection);
									//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update
									hmParams.put("userInfo",userInfo);
									//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
									hmParams.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
									hmParams.put("isAuthorizedRecSpecialist",Boolean.valueOf(
											isAuthorizedRecSpecialist));
									//END-BRGUS00217436
									//END-BRGUS00205536
									if (i == 0) {
										//Commented due to FindBugs Analysis
										//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
										// new Boolean(true));
										hmParams.put(
												IEdEligCodes.FIRST_MONTH_FLAG,
												Boolean.valueOf(true));
									} else {
										//Commented due to FindBugs Analysis
										//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
										// new Boolean(false));
										hmParams.put(
												IEdEligCodes.FIRST_MONTH_FLAG,
												Boolean.valueOf(false));
									}

									//added for defect 104597
									egDataHandler
											.setHmParamForEndProcess(hmParams);
									if (!arrEdEligibilityCargo[i]
											.getProgramCd().equalsIgnoreCase(
													"SE")) {
										newEligDetail = determineEdDetails(
												hmParams, eligDetailPrevMth,
												arrEligDetailOutput);
										newEligDetail.setRecordInsertFlag(true);
										appendEligDetailProcessed(
												newEligDetail, egDataHandler);
									}

								}
							}//End of CheckIf alreadyPFPProcessed
							// Following if is added for CCB(MM):00127585
							//Note : P and P from Edg can be for MM or PFP-2 ,
							// if condition modified to tak eonly MM here
							if ((bMMPandPrecord && (!arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0].getProgramCd()
									.equals(IEdEligCodes.PROGRAM_CD_TANF)))
									|| (checkForMMProcessing(arrEligDetailOutput[i]))) {
								//Moved here for the defect #00187402 to invoke
								// detEligDetailLastAuth for both P&P
								// and NOOP-IndvAdverseAction=Y types
								egDataHandler.setForMMProcessFlag(true);
								egDataHandler.detEligDetailLastAuth(
										egDataHandler.getEligDetail()[1],
										arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]);
								egDataHandler.setForMMProcessFlag(false);

								HashMap hmEdgParams = new HashMap();
								edgMMCopiedEligDetail = null;
								// Scenario - 3: If Cr eate_Indicator == 'P'
								// invode Process2
								if (bMMPandPrecord) {
									edgMMCopiedEligDetail = arrEligDetailOutput[i];
								} else {
									//Invoke EDG:Process1
									arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.setDeleteSw(IEdEligCodes.VOID_SW_YES);
									alEligDetailVoidedForMM
											.add(arrEligDetailOutput[i]);
									hmEdgParams.put(CASE_NUM, new Long(
											aLCaseNum)); //IR/PR//1500051942,1500055089
									hmEdgParams.put(
											IEdEligCodes.SESSION_USER_ID,
											aSUserId);
									hmEdgParams.put(
											IEdEligCodes.REQUEST_CASE_RUN_MODE,
											IEdEligCodes.CASE_RUN_MODE_ONLINE);
									hmEdgParams
											.put(
													EDGConstants.EDG_RUN_MODE,
													new Character(
															EDGConstants.EDGRunMode.MIDMONTH_COPY));
									hmEdgParams.put(
											EDGConstants.EDBC_PROC_ELIG_DETAIL,
											arrEligDetailOutput[i]);
									hmEdgParams.put(
											EDGConstants.AUTH_ELIG_DETAIL,
											egDataHandler
													.getEligDetailLastAuth());
									hmEdgParams.put("CONNECTION", conn);//BRGUS00190358-upadhyayulag
									edgMMCopiedEligDetail = performEDGCopyProcess(hmEdgParams);
									// The above cargo has EdEligibility,
									// EdIndvCargos, EdIndvNoticeReasons,
									// EdElig, EdIndvDateSpecific
								}

								//Invoke EDBC:Process2
								arrEligDetailOutput[i] = performDriverMMProcess(
										edgMMCopiedEligDetail, egDataHandler
												.getEligDetailLastAuth());
								//Set Create Indicator to 'C'
								arrEligDetailOutput[i].getEdEligibilityCargo()[0]
										.setCreatorInd(EDGConstants.COPY_COMPLETED);
								if (bMMPandPrecord == false) {
									arrEligDetailOutput[i]
											.setRecordInsertFlag(true);
								}

								//Do End Process for the cloned eEliDetail
								// Later this can be made as function
								hmParams = detParamsForEDBCEndProcess(
										arrEligDetailOutput,
										arrEligDetailOutput[i]);
								hmParams.put(IEdEligCodes.ELIG_DETAIL_ALL_DB,
										arrEligDetailInput);
								hmParams.put(
										IEdEligCodes.DC_CASE_PROGRAM_CARGO,
										dcCaseProgramCargo);
								hmParams.put(IEdEligCodes.EG_DATA_HANDLER,
										egDataHandler);
								hmParams.put(IEdEligCodes.NF_DATA_HANDLER,
										nfDataHandler);
								hmParams
										.put(
												IEdEligCodes.MODULE_SWITCH_FROM_REQUEST,
												aSReqModSw);
								//Added for CCB: 160712
								hmParams.put(IEdEligCodes.SESSION_USER_ID,
										aSUserId);

								hmParams.put("CONNECTION", conn);
								hmParams.put("USER_ID", aSUserId);
								hmParams.put("overrideFields",overrideFields);
								hmParams.put("edgOverrideDetailsCollection",edgOverrideDetailsCollection);
								//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update
								hmParams.put("userInfo",userInfo);
								//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
								hmParams.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
								hmParams.put("isAuthorizedRecSpecialist",Boolean.valueOf(
										isAuthorizedRecSpecialist));
								//END-BRGUS00217436
								//END-BRGUS00205536
								if (i == 0) {
									//Commented due to FindBugs Analysis
									//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
									// new Boolean(true));
									hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
											Boolean.valueOf(true));
								} else {
									//Commented due to FindBugs Analysis
									//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
									// new Boolean(false));
									hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
											Boolean.valueOf(false));
								}

								//added for defect 104597
								egDataHandler.setHmParamForEndProcess(hmParams);
								if (!arrEdEligibilityCargo[i].getProgramCd()
										.equalsIgnoreCase("SE")) {
									arrEligDetailOutput[i] = determineEdDetails(
											hmParams, eligDetailPrevMth,
											arrEligDetailOutput);
								}

							}// End of MM Processing

							appendEligDetailProcessed(arrEligDetailOutput[i],
									egDataHandler);

							//Determine End Process for SER EDGs
							if (arrEdEligibilityCargo[i].getProgramCd()
									.equalsIgnoreCase("SE")
									&& (i == arrEdEligibilityCargo.length - 1)) {
								for (int r = 0; r < arrEligDetailOutput.length; r++) {
									if (arrEligDetailOutput[r] != null
											&& arrEligDetailOutput[r]
													.getEdEligibilityCargo()[0]
													.getProgramCd()
													.equalsIgnoreCase("SE")) {
										hmParams = detParamsForEDBCEndProcess(
												arrEligDetailOutput,
												arrEligDetailOutput[r]);
										hmParams
												.put(
														IEdEligCodes.ELIG_DETAIL_ALL_DB,
														arrEligDetailInput);
										hmParams
												.put(
														IEdEligCodes.DC_CASE_PROGRAM_CARGO,
														dcCaseProgramCargo);
										egDataHandler
												.detEligDetailLastAuth(
														egDataHandler
																.getEligDetail()[1],
														arrEligDetailOutput[r]
																.getEdEligibilityCargo()[0]);
										//Start : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"
										egDataHandler.detEligDetailLastForLiheap(arrEdEligibilityCargo[i]);
										//End : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"
										hmParams.put(
												IEdEligCodes.EG_DATA_HANDLER,
												egDataHandler);
										hmParams.put(
												IEdEligCodes.NF_DATA_HANDLER,
												nfDataHandler);
										hmParams
												.put(
														IEdEligCodes.MODULE_SWITCH_FROM_REQUEST,
														aSReqModSw);
										hmParams.put(
												IEdEligCodes.FIRST_MONTH_FLAG,
												Boolean.valueOf(false));
										//Added for CCB: 160712
										hmParams.put(
												IEdEligCodes.SESSION_USER_ID,
												aSUserId);

										hmParams.put("CONNECTION", conn);
										hmParams.put("USER_ID", aSUserId);
										hmParams.put("overrideFields",overrideFields);
										hmParams.put("edgOverrideDetailsCollection",edgOverrideDetailsCollection);
										//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update
										hmParams.put("userInfo",userInfo);
										//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
										hmParams.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
										hmParams.put("isAuthorizedRecSpecialist",Boolean.valueOf(
												isAuthorizedRecSpecialist));
										//END-BRGUS00217436
										//END-BRGUS00205536
										arrEligDetailOutput[r] = determineEdDetails(
												hmParams, null,
												arrEligDetailOutput);
									}
								}
							}
							//Added the pending condition for defect 190998
							// Bridges Defect No BRGUS00022818 -
							// performWaiverAdjustments Commented
							/*
							 * if
							 * ((arrEligDetailOutput[i].getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_MEDICAID_WAIVERS) ||
							 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getTypeOfAssistanceCd().equals(IEdEligCodes.TP_14)) &&
							 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS) ||
							 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getCgEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
							 * bTA10PassProc = true; sCurrMthProc =
							 * DateComparisons.getStringMMYYYY(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getPaymentBegDt()); }
							 *
							 * if ((bTA10PassProc == true) && (i == iLength -
							 * 1)) { performWaiverAdjustments(sCurrMthProc,
							 * arrEligDetailInput, arrEligDetailOutput,
							 * dcCaseProgramCargo, egDataHandler, nfDataHandler,
							 * hmWaiverTpCodes, aSReqModSw); bTA10PassProc =
							 * false; sCurrMthProc = null; }
							 */

						}
					}

					if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_NF)) {
						//call the NFManager
						//Commented for QA DEFECT DIOL on 10/18/2004
						//NFManager nfManagerObj = new NFManager();
						if (i == 0) {
							egDataHandler.setFirstEDM(true);
							if (isNFRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = nfManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput, null, null,
												nfDataHandler, egDataHandler,
												conn, runMode,aMapRequest);
							}
						} else {
							egDataHandler.setFirstEDM(false);
							eligDetailPrevMth = null;
							eligDetailPrevMth = validRecordForPrevMth(
									arrEligDetailOutput,
									arrEdEligibilityCargo[i]);
							if (isNFRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = nfManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput,
												eligDetailPrevMth,
												arrEligDetailOutput,
												nfDataHandler, egDataHandler,
												conn, runMode,aMapRequest);
							}
						}

						appendEligDetailProcessed(arrEligDetailOutput[i],
								egDataHandler);

					}

					if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_RSC)) {
						//call the ResManager
						//Commented for QA DEFECT DIOL on 10/18/2004
						//ResourceManager resManagerObj = new
						// ResourceManager();
						if (i == 0) {
							if (isResourceRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = resManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput[0], null,
												null, resDataHandler,
												egDataHandler, arrEligDetailInput);
							}
						} else {
							eligDetailPrevMth = null;
							eligDetailPrevMth = validRecordForPrevMth(
									arrEligDetailOutput,
									arrEdEligibilityCargo[i]);
							if (isResourceRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = resManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput[0],
												eligDetailPrevMth,
												arrEligDetailOutput,
												resDataHandler, egDataHandler,
												arrEligDetailInput);
							}
						}

						appendEligDetailProcessed(arrEligDetailOutput[i],
								egDataHandler);
					}

					if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_FIN)) {
						//call the FinManager
						//Commented for QA DEFECT DIOL on 10/18/2004
						//FinManager finManagerObj = new FinManager();
						finManagerObj.init();
						//Following code is added by Sai on 12-11-2004 to
						// filter DC Tables once per EDM
						if (i == 0) {
							egDataHandler.detEligDetailFiltered(
									arrEdEligibilityCargo[i],
									arrEligDetailInput[0], null, false,
									IEdEligCodes.MODULE_SWITCH_FIN);
							finDataHandler.setPreStrikeDt(detPreStrikeDt(
									egDataHandler.getEligDetailFiltered(),
									egDataHandler
											.getPreStrikeDcEmploymentCargo()));
							//finManagerObj.isExecutedBillsFm = true;
						} else {
							eligDetailPrevMth = null;
							eligDetailPrevMth = validRecordForPrevMth(
									arrEligDetailOutput,
									arrEdEligibilityCargo[i]);
							egDataHandler.detEligDetailFiltered(
									arrEdEligibilityCargo[i],
									arrEligDetailInput[0], null, false,
									IEdEligCodes.MODULE_SWITCH_FIN);
							finDataHandler.setPreStrikeDt(detPreStrikeDt(
									egDataHandler.getEligDetailFiltered(),
									egDataHandler
											.getPreStrikeDcEmploymentCargo()));
						}
						if (sPrevEDM == null
								|| sPrevEDM
										.equals(DateComparisons
												.getStringMMYYYY(arrEdEligibilityCargo[i]
														.getPaymentBegDt()))) {
							//sPrevEDM =
							// DateComparisons.getStringMMYYYY(arrEdEligibilityCargo[i].getPaymentBegDt());
							edDcUtil.filterDcInfoForFinMonthly(egDataHandler,
									finDataHandler, arrEdEligibilityCargo[i]
											.getProgramCd());
						}

						if (i == 0) {
							if (isFinRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = finManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput[0],
												arrEligDetailInput[1], null,
												null, finDataHandler,
												egDataHandler,arrEligDetailInput);
							}
						} else {
							eligDetailPrevMth = null;
							eligDetailPrevMth = validRecordForPrevMth(
									arrEligDetailOutput,
									arrEdEligibilityCargo[i]);
							if (isFinRequired(arrEdEligibilityCargo[i])) {
								arrEligDetailOutput[i] = finManagerObj
										.doProcess(arrEdEligibilityCargo[i],
												arrEligDetailInput[0],
												arrEligDetailInput[1],
												arrEligDetailOutput,
												eligDetailPrevMth,
												finDataHandler, egDataHandler,arrEligDetailInput);
							}
						}

						appendEligDetailProcessed(arrEligDetailOutput[i],
								egDataHandler);

						//End Process start for BRGUS00048581
						arrDcCaseProgramCargo = egDataHandler
								.getDcCaseProgramCargo();
						int iDcCaseProgramLength = 0;
						if (arrDcCaseProgramCargo != null) {
							iDcCaseProgramLength = arrDcCaseProgramCargo.length;
						}
						for (int j = 0; j < iDcCaseProgramLength; j++) {
							if (arrDcCaseProgramCargo[j].getProgCd().equals(
									IEdEligCodes.PROGRAM_CD_FS)) {
								dcCaseProgramCargo = arrDcCaseProgramCargo[j];
							}
						}

						hmParams = detParamsForEDBCEndProcess(
								arrEligDetailOutput, arrEligDetailOutput[i]);
						hmParams.put(IEdEligCodes.ELIG_DETAIL_ALL_DB,
								arrEligDetailInput);
						hmParams.put(IEdEligCodes.DC_CASE_PROGRAM_CARGO,
								dcCaseProgramCargo);
						hmParams.put(IEdEligCodes.EG_DATA_HANDLER,
								egDataHandler);
						hmParams.put(IEdEligCodes.NF_DATA_HANDLER,
								nfDataHandler);
						hmParams.put(IEdEligCodes.MODULE_SWITCH_FROM_REQUEST,
								aSReqModSw);
						//Addded for CCB:160712
						hmParams.put(IEdEligCodes.SESSION_USER_ID, aSUserId);

						hmParams.put("CONNECTION", conn);
						hmParams.put("USER_ID", aSUserId);
						hmParams.put("overrideFields",overrideFields);
						hmParams.put("edgOverrideDetailsCollection",edgOverrideDetailsCollection);
						//BEGIN-BRGUS00205536-upadhyayulag-Send other parameters for BV update
						hmParams.put("userInfo",userInfo);
						//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
						hmParams.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
						hmParams.put("isAuthorizedRecSpecialist",Boolean.valueOf(isAuthorizedRecSpecialist));
						//END-BRGUS00217436
						//END-BRGUS00205536
						if (i == 0) {
							//Commented due to FindBugs Analysis
							//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
							// new Boolean(true));
							hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG, Boolean
									.valueOf(true));
						} else {
							//Commented due to FindBugs Analysis
							//hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG,
							// new Boolean(false));
							hmParams.put(IEdEligCodes.FIRST_MONTH_FLAG, Boolean
									.valueOf(false));
						}

						//added for defect 104597
						egDataHandler.setHmParamForEndProcess(hmParams);

						//Getting previous eligdetail for CDC
						for (int j = i - 1; j >= 0; j--) {
							if (arrEligDetailOutput[j] != null
									&& arrEligDetailOutput[j]
											.getEdEligibilityCargo() != null
									&& arrEligDetailOutput[j]
											.getEdEligibilityCargo().length > 0) {
								if (arrEligDetailOutput[j]
										.getEdEligibilityCargo()[0]
										.getProgramCd().equalsIgnoreCase("CD")) {
									eligDetailPrevCD = arrEligDetailOutput[j];
									break;
								} else {
									continue;
								}
							}
						}
						if (!arrEdEligibilityCargo[i].getProgramCd()
								.equalsIgnoreCase("SE")) {
							arrEligDetailOutput[i] = determineEdDetails(
									hmParams, eligDetailPrevMth,
									arrEligDetailOutput);
						}
						//End for BRGUS00048581

					}

					//Processing Level of Care
					//Dev Activity : BRGUS00010278
					/* Begin BRGUS00111108 – kesavanr
					 * Not to process level of care for MC program.
					 */
					if (arrEdEligibilityCargo[i].getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_ME)
							|| arrEdEligibilityCargo[i].getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_FMA)) {
							/* Begin BRGUS00107657 – kesavanr
							 * Not to call level of care BO if edg is denied
							 */
							//if(!arrEdEligibilityCargo[i].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_DENIED)) {
								/*
								 * Begin BRGUS00086055 – kesavanr Not to process
								 * level of care for MC if level of care for MA and
								 * ME is processed
								 */
								/*boolean isLocCanbeProcessed = true;
								if (arrEdEligibilityCargo[i].getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_MC)) {
									isLocCanbeProcessed = EdDriverHelper
											.isLocCanBeProcessed(arrEligDetailOutput);
								}*/
								//if (isLocCanbeProcessed) {
									/* beniwala - ASPEN00016697 
									 * EDBC does not need to calculate Level Of Care in New Mexico
									 * The information comes from Molina
									 * EDLevelOfCareBO edLevelOfCareBo = new EDLevelOfCareBO();
									//BRGUS00099653 – kesavanr – Passing previously processed eligdetail structure to level of care BO.
									//BEGIN-BRGUS00144468-upadhyayulag-Send connection as additional parameter
									edLevelOfCareBo.processLevelOfCare(
											egDataHandler, arrEligDetailOutput[i],
											eligDetailPrevMth,arrEligDetailOutput,conn);*/
									//END-BRGUS00144468
								//}
							//}
							//End BRGUS00107657
							// End BRGUS00086055
					}
					//End BRGUS00111108
					//Processing MBSCode for Clients
					//If ProgramCode is MA, MC, ME

					if (arrEdEligibilityCargo[i].getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_ME)
							|| arrEdEligibilityCargo[i].getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_FMA)
							|| arrEdEligibilityCargo[i].getProgramCd().equals(
									IEdEligCodes.PROGRAM_CD_MC)) {
						EdMBSCodesBO edMBSCodesBO = new EdMBSCodesBO();
						/*
						 * Defect ID : BRGUS00097326 Added By : rampurkara Date :
						 * 02/25/2008 Change : Added new input to call
						 * processMBSCodes , new input is arrEligDetailInput[0]
						 *
						 */

						edMBSCodesBO.processMBSCodes(egDataHandler,
								nfDataHandler, finDataHandler,
								arrEligDetailOutput[i], arrEligDetailInput[0]);
					}

					//Calling BV
					//Development Activity kesireddyv : BRGUS00109402
					try {
						if ((aMapRequest.get("BATCH") == null ||isOnlineEbdcProcess)&& egDataHandler.getDcCasesCargo()[0].getConversionDt() != null &&
								arrEdEligibilityCargo[i].getPaymentBegDt()
								//BRGUS00124647 – kesavanr – Not to call BV in online if payment begin date is less than the conversion date.
								.before(egDataHandler.getDcCasesCargo()[0].getConversionDt()))
							{
							// don't call BV
							continue;
							}
						else
						{
								/*
								 * Begin BRGUS00095464 – kesavanr BV should not be
								 * called from EDBC driver if eligibility is pending not
								 * due to STFS.
								 */
								if (arrEdEligibilityCargo[i].getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_FS)
										|| arrEdEligibilityCargo[i].getProgramCd()
												.equals(IEdEligCodes.PROGRAM_CD_TANF)) {
									/* Begin BRGUS00146715 – kesavanr
									 * If last authorized amount - current benefit amt is less than the threshold
									 * value then set the edbc action code as No Issuance Change.
									 */
									/**
									 * Begin BrgId:BRGUS00148018
									 * userId: Gantac
									 * Date:02/25/2009
									 * Adding null pointer checks
									 */
									double lastAuthBenefitAmt = 0;
									//BEGIN-BRGUS00187473-upadhyayulag-On a given day, if driver comes up with OP-Referral for a 'FAP' EDG,
									//then since the CG_STATUS_CD is 'AP', last EDBC run would come into effect. In this case, the last 
									//authorized amount to be sent to BV is computed using the Authorized & Cancelled records for that EDG 
									//prior to that day with estimated eligibility end date being equal to the current record. For a 'TF' 
									//EDG, estimated eligibility end date check is not used. If no valid record found from the Auth & 
									//Cancelled records, then last authorized record from the same day would be used.
										if (!egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getCgEligRsltCd().
												equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
											int mLength = 0;
											int aLength = 0;
											EdEligibilityCargo[] aEdEligibilityCargoAuthCancel=null;
											EdEligibilityCargo[] aEdEligibilityCargoAuth=null;
											EdEligibilityCargo lastAuthCargo = null;
											EdEligibilityCargo unAuthCurrentCargo = egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0];
											Timestamp tsMthEndEffBegDt = DateComparisons.getLastDayOfDate(unAuthCurrentCargo.getRecBeginDt());
											boolean bEDMLastAuthFound = false;
												if (((EligDetail[])hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2] != null && 
														((EligDetail[]) hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2].getEdEligibilityCargo()!=null
														) {
													aEdEligibilityCargoAuthCancel = ((EligDetail[]) hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[2].getEdEligibilityCargo();
													mLength =aEdEligibilityCargoAuthCancel.length;																					
													for (int m = 0; m < mLength; m++) {
														if ((aEdEligibilityCargoAuthCancel[m].getCgStatusCd()
																.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED))
																&& aEdEligibilityCargoAuthCancel[m].getEdgNum() 
																== unAuthCurrentCargo
																		.getEdgNum()) {
															if ((aEdEligibilityCargoAuthCancel[m].getRecBeginDt().before(tsMthEndEffBegDt) 
																	|| aEdEligibilityCargoAuthCancel[m].getRecBeginDt().equals(tsMthEndEffBegDt))
																&& (((aEdEligibilityCargoAuthCancel[m].getRecEndDt() == null) 
																	  || (aEdEligibilityCargoAuthCancel[m].getRecEndDt()
																	  		.after(unAuthCurrentCargo.getRecBeginDt()) 
															  || aEdEligibilityCargoAuthCancel[m].getRecEndDt().equals(unAuthCurrentCargo.getRecBeginDt()))))) {
																lastAuthCargo = aEdEligibilityCargoAuthCancel[m];
														if(unAuthCurrentCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)){
															//If program is 'FS'
															if(lastAuthCargo.getEstimatedEligEndDt() != null 
																	&& unAuthCurrentCargo.getEstimatedEligEndDt() != null 
																	&& lastAuthCargo.getEstimatedEligEndDt().equals(unAuthCurrentCargo.getEstimatedEligEndDt())){
																lastAuthBenefitAmt = lastAuthCargo.getBenefitAmt();
																bEDMLastAuthFound = true;
																break;
															}
														}else if(unAuthCurrentCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)){
															//If program is 'TF'
															lastAuthBenefitAmt = lastAuthCargo.getBenefitAmt();
															bEDMLastAuthFound = true;
															break;
														}
													}											
												}
											}
										}
										if(!bEDMLastAuthFound){
											if (((EligDetail[])hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1] != null && 
													((EligDetail[]) hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1].getEdEligibilityCargo()!=null
													) {
												//Loop through the authorized records on the same day to find out if 
												//there is a valid record
												aEdEligibilityCargoAuth = ((EligDetail[]) hmParams.get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1].getEdEligibilityCargo();
												aLength =aEdEligibilityCargoAuth.length;
												for (int a = 0; a < aLength; a++) {

													if ((aEdEligibilityCargoAuth[a].getEdbcRunDt().equals(unAuthCurrentCargo.getEdbcRunDt()))
															&& (aEdEligibilityCargoAuth[a].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED))
															&& aEdEligibilityCargoAuth[a].getEdgNum() == unAuthCurrentCargo.getEdgNum()) {
														if ((aEdEligibilityCargoAuth[a].getRecBeginDt().before(tsMthEndEffBegDt) 
																|| aEdEligibilityCargoAuth[a].getRecBeginDt().equals(tsMthEndEffBegDt))
															&& (((aEdEligibilityCargoAuth[a].getRecEndDt() == null) 
																  || (aEdEligibilityCargoAuth[a].getRecEndDt().after(unAuthCurrentCargo.getRecBeginDt()) 
																  || aEdEligibilityCargoAuth[a].getRecEndDt().equals(unAuthCurrentCargo.getRecBeginDt()))))) {
																lastAuthCargo = aEdEligibilityCargoAuth[a];
																lastAuthBenefitAmt = lastAuthCargo.getBenefitAmt();
																break;
															}											
														}
													}
												}
											}
										} else {
											if(egDataHandler.getEligDetailLastAuth() != null &&
													egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null &&
													egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length > 0){
											 lastAuthBenefitAmt = egDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getBenefitAmt();
											}
										}
										double currBenefitAmt = 0;
										double minimumAmt = 0;
										if(egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo() != null &&
												egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo().length > 0){
											currBenefitAmt = egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getBenefitAmt();
											if(egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getProgramCd() != null){
												minimumAmt = Double.parseDouble(ReferenceTableManager.getValueByColumn(true, "Edminoverpayamt", egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getProgramCd(), "MINIMUMAMT"));
											}
											if(egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getEdbcActionCd() != null
													&& egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].getEdbcActionCd().equalsIgnoreCase(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL)) {
												if(((lastAuthBenefitAmt - currBenefitAmt) - minimumAmt) <= 0) {
													egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
													egDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0].setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
												}
											}
										}
									//END-BRGUS00187473

									//End BRGUS00146715
									boolean isBVEdCanBeProcessed = isBVEdCanBeProcessed(arrEdEligibilityCargo[i]);

									if (isBVEdCanBeProcessed
											&& arrEdEligibilityCargo[i]
													.getEdbcActionCd() != null
											&& !arrEdEligibilityCargo[i]
													.getEdbcActionCd()
													.equals(
															IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT)
											&& !arrEdEligibilityCargo[i]
													.getEdbcActionCd()
													.equals(
															IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL)) {
										//End BRGUS00095464

										BvComputeDiscrepancy bvComputeDiscrepancy = new BvComputeDiscrepancy(
												conn);
										
										
										BvRecoupmentVO bvRecoupmentVO = new BvRecoupmentVO();
										bvRecoupmentVO
												.setBenefitAmount(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getBenefitAmt());
//	BRGUS00258144 rampurkara pass edg_transaction_id
										if(arrEligDetailOutput[i].getEdEligibilityCargo()[0] != null && 
												arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgTransactionId() > 0)
										{
											/*
											*Start 
											*ASPEN00016240
											* Added by Deepak Kumar for
											* LIHEAP EDBC fix
											*/
											
											bvRecoupmentVO.setEdgTransactionId(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0].getEdgTransactionId());
											/*
											* ASPEN00016240
											* Added by Deepak Kumar for
											* LIHEAP EDBC fix
											* END
											*/
										}
// end BRGUS00258144												
										bvRecoupmentVO.setCaseNum(aLCaseNum);
										bvRecoupmentVO
												.setEdgNum(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getEdgNum());
										bvRecoupmentVO
												.setEdgTraceId(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getEdgTraceId());
										bvRecoupmentVO
												.setPayBeginDate(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getPaymentBegDt());
										bvRecoupmentVO
												.setProgramCd(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getProgramCd());
										bvRecoupmentVO
												.setTypeOfAssistance(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getTypeOfAssistanceCd());
										String fundingSourceCd = arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getFundingSourceCd();
										char fundingSrcCd = ' ';

										if (fundingSourceCd == null
												|| fundingSourceCd.equals("F")) {
											fundingSrcCd = 'F';
										} else if (fundingSourceCd.equals("S")) {
											fundingSrcCd = 'S';
										}
										bvRecoupmentVO.setFundingSourceCd(fundingSrcCd);

										EdIndvEligibilityCargo[] edIndvEligibilityCargo = arrEligDetailOutput[i]
												.getEdIndvEligibilityCargo();
										long[] indvIds = new long[edIndvEligibilityCargo.length];
										String[] partStatusCodes = new String[edIndvEligibilityCargo.length];
										char[] considerIncomeSw = new char[edIndvEligibilityCargo.length];
										char[] considerResourceSw = new char[edIndvEligibilityCargo.length];
										for (int k = 0; k < edIndvEligibilityCargo.length; k++) {
											indvIds[k] = edIndvEligibilityCargo[k]
													.getIndvId();
											partStatusCodes[k] = edIndvEligibilityCargo[k]
													.getPartStatusCd();
											considerIncomeSw[k]= edIndvEligibilityCargo[k].getConsiderIncomeSw();
											considerResourceSw[k] = edIndvEligibilityCargo[k].getConsiderResourceSw();
										}
										bvRecoupmentVO.setIndvIds(indvIds);
										bvRecoupmentVO.setPartStatusCd(partStatusCodes);
										bvRecoupmentVO.setConsiderIncomeSw(considerIncomeSw);
										bvRecoupmentVO.setConsiderResourceSw(considerResourceSw);

										bvRecoupmentVO
												.setApplicationDt(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getApplicationDt());
										bvRecoupmentVO
												.setEdbcRunDt(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getEdbcRunDt());
										bvRecoupmentVO
												.setEligibilityBegDt(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getEligibilityBegDt());
										if (arrEligDetailOutput[i]
												.getEdEligTanfBudgetCargo() != null
												&& arrEligDetailOutput[i]
														.getEdEligTanfBudgetCargo().length > 0) {
											bvRecoupmentVO
													.setMaxGrantAmt(arrEligDetailOutput[i]
															.getEdEligTanfBudgetCargo()[0]
															.getMaxGrantAmt());
										}
										if (arrEligDetailOutput[i]
												.getEdEligFsBudgetCargo() != null
												&& arrEligDetailOutput[i]
														.getEdEligFsBudgetCargo().length > 0) {
											bvRecoupmentVO
													.setIpvSize(arrEligDetailOutput[i]
															.getEdEligFsBudgetCargo()[0]
															.getIpvSize());
											bvRecoupmentVO
													.setMaxCgipvAllotAmt(arrEligDetailOutput[i]
															.getEdEligFsBudgetCargo()[0]
															.getMaxCgipvAllotAmt());
											bvRecoupmentVO
													.setMaxFsAllotAmt(arrEligDetailOutput[i]
															.getEdEligFsBudgetCargo()[0]
															.getMaxFsAllotAmt());
											bvRecoupmentVO
													.setMthlyFSNetInc30PctAmt(arrEligDetailOutput[i]
															.getEdEligFsBudgetCargo()[0]
															.getNetInc30PctAmt());
										}
										bvRecoupmentVO
												.setActivityType(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getActivityType());
										bvRecoupmentVO
												.setEdbcActionCd(arrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getEdbcActionCd());
										//BEGIN-BRGUS00187473-upadhyayulag-send the correct last authorized
										//benefit amount depending on the Last EDBC run
										/*
										if (egDataHandler.getEligDetailLastAuth() != null
												&& egDataHandler
														.getEligDetailLastAuth()
														.getEdEligibilityCargo() != null
												&& egDataHandler
														.getEligDetailLastAuth()
														.getEdEligibilityCargo().length > 0) {
											bvRecoupmentVO
													.setPrevAuthBenefitAmt(egDataHandler
															.getEligDetailLastAuth()
															.getEdEligibilityCargo()[0]
															.getBenefitAmt());
										}
										*/
										bvRecoupmentVO.setPrevAuthBenefitAmt(lastAuthBenefitAmt);
										//END-BRGUS00187473
										bvRecoupmentVO
												.setEdIndvPenalitiesCargos(arrEligDetailOutput[i]
														.getEdIndvPenaltiesCargo());
										bvRecoupmentVO.setUserInfo(userInfo);
										if(isOnlineEbdcProcess){											
											bvRecoupmentVO.setAuthorizedRecSpecialist(isAuthorizedRecSpecialist);
											bvRecoupmentVO.setOnlineBacthProcess(isOnlineEbdcProcess);
										}
										
										
										BvRecoupmentReturnVO returnVO = bvComputeDiscrepancy
												.computeDiscrepancy(bvRecoupmentVO);

										/* Modified by Sai Suresh
										 * ASPEN00011022
										 * Budgeting Fixes
										 * START
										 */
										double netBenefitAmt = arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0].getNetBenefitAmt()											
												  - returnVO.getRecoupmentAmount();
										/* Modified by Sai Suresh
										 * ASPEN00011022
										 * Budgeting Fixes
										 * END
										 */
										double netSupplementAmt = returnVO
												.getSupplementAmount()
												- (returnVO
														.getSupplementRecoupmentAmount() + returnVO
														.getOffsetAmount());

										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setNetBenefitAmt(netBenefitAmt);
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setNetSupplementAmt(netSupplementAmt);		
										
										 arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setSupplementAmt(returnVO
														.getSupplementAmount());
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setSupplementRecoupmentAmt(returnVO
														.getSupplementRecoupmentAmount());
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setRecoupmentAmt(returnVO
														.getRecoupmentAmount());
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setOverpaymentAmt(returnVO
														.getOverPayAmount());
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setRecoupmentErrorTypeCd(returnVO
														.getClaimErrorType());
										arrEligDetailOutput[i].getEdEligibilityCargo()[0]
												.setSupplementOffsetAmt(returnVO
														.getOffsetAmount());
										/* Begin BRGUS00095532 – kesavanr
										 * Logging return VO object details from benefit recovery.
										 */
										/*logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"EdgTraceId: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgTraceId());
										logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"BenefitAmt: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getBenefitAmt());
										logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"RecoupmentAmt: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getRecoupmentAmt());
										logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"SupplementAmt: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getSupplementAmt());
										logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"OverpayAmt: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getOverpaymentAmt());
										logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
												"OffsetAmt: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getSupplementOffsetAmt());*/
										//End BRGUS00095532

									}
								}
								/* Begin BRGUS00095532 – kesavanr
								 * Benefit recovery can be called from edbc if edg is not in pending,no supplement and
								 * no O/P referral. Logging return VO object details and setting
								 * recoupment percentage benefit recovery.
								 */
								/* Begin BRGUS00113495 – kesavanr
								 * Logic to call BV at group level is commented.
								 */
								/*else if (arrEdEligibilityCargo[i].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC) &&
										 !arrEdEligibilityCargo[i].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_PENDING) &&
										 !arrEdEligibilityCargo[i].getEdbcActionCd().equals(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT) &&
									     !arrEdEligibilityCargo[i].getEdbcActionCd().equals(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL)) {
											if (arrEligDetailOutput[i]
													.getEdIndvCdcServiceAuth() != null) {
												BvRecoupmentReturnVO returnVO = bvComputeCDCDiscrepancyBO
														.computeCDCRecoupment(arrEligDetailOutput[i]
																.getEdIndvCdcServiceAuth());
												 Begin BRGUS00113495 – kesavanr
												 * Set the edbc action code to 54 if CDC is verbally withdrawn.(advance notice request switch is 'Y').

												if(arrEdEligibilityCargo[i].getPaymentBegDt().after(arrEdEligibilityCargo[i].getEdbcRunDt())) {
													if(arrEdEligibilityCargo[i].getAdverseActionAllowedSw() == 'N' && arrEdEligibilityCargo[i].getAdvanceNoticeReqSw() == 'Y' &&
													arrEdEligibilityCargo[i].getEdbcActionCd().equalsIgnoreCase(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL)){
														arrEligDetailOutput[i].getEdEligibilityCargo()[0]
																			.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
													}
												}
												else {
													if(arrEdEligibilityCargo[i].getAdverseActionAllowedSw() == 'N' &&
													   arrEdEligibilityCargo[i].getEdbcActionCd().equalsIgnoreCase(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL) &&
													   returnVO.getOverPayAmount() == 0) {
														arrEligDetailOutput[i].getEdEligibilityCargo()[0]
																			.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
													}
												}
												//End BRGUS00113495
												logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
														"EdgTraceId: "+arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgTraceId());
												logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
														"OverpayAmt: "+returnVO.getOverPayAmount());
												logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG,
														"Recoupment%: "+returnVO.getRecoupmentPercentage());
												if(arrEdEligibilityCargo[i].getCgStatusCd() != null && arrEdEligibilityCargo[i].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)) {
													if(arrEligDetailOutput[i].getEdIndvCdcServiceAuth() != null &&
													   arrEligDetailOutput[i].getEdIndvCdcServiceAuth().length > 0) {
														int cdcLength = arrEligDetailOutput[i].getEdIndvCdcServiceAuth().length;
														for(int t=0; t<cdcLength; t++) {
															int recoupmentPercentage = new Double(returnVO.getRecoupmentPercentage()).intValue();
															arrEligDetailOutput[i].getEdIndvCdcServiceAuth()[t].setRecoupmentPercentage(recoupmentPercentage);
														}
													}

												}
												//End BRGUS00095532
											}
								}*/
								//End BRGUS00113495
						}
					}
					/* Begin BRGUS00111665 – kesavanr
					 * Handling exception thrown by benefit recovery while computing discrepancy.
					 */
					catch (TIERSValidationException tve) {
						EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
						throw tve;
					}
					catch (Exception e) {
						EDBCLogger.writeExceptionStackTrace(
								DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
						throw new EDBCException(EDBCException.MAJOR, "EdUtil",
								"performEDBCNRFV",
								"Error while computing discrepancy in BV "+e.getMessage());
					}
					//End BRGUS00111665
					//If supplement amt is greater than threshold amt throw
					// exception in batch
					if (!isOnlineEbdcProcess && aMapRequest.get("BATCH") != null
							&& ((String) aMapRequest.get("BATCH"))
									.startsWith("MU")
							&& !((String) aMapRequest.get("BATCH"))
									.startsWith("MU-CEDBC-ONR")) {
						double supplementAmt = arrEligDetailOutput[i]
								.getEdEligibilityCargo()[0].getSupplementAmt();
						double dThresholdAmt = 0;
						String strThresholdAmt = null;
						if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getProgramCd().equalsIgnoreCase("TF")) {
							strThresholdAmt = ReferenceTableManager
									.getValueByColumn(true, "EDSUPPLTHRESHOLD",
											"TF", "MONTHLY",
											arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPaymentBegDt());
							if (strThresholdAmt != null) {
								dThresholdAmt = Double
										.parseDouble(strThresholdAmt);
							}
							grossTFSupplementAmt = grossTFSupplementAmt
									+ supplementAmt;
							if (supplementAmt > dThresholdAmt) {
								ArrayList alError = new ArrayList();
								alError.add("778");
								ArrayList alPlaces = new ArrayList();
								logger
										.log(
												DIConstants.LOGGING_CATEGORY_EDBC,
												ILog.DEBUG,
												"Second Level Review required for the case "
														+ aLCaseNum
														+ " because supplement amount is greater than threshold");
								throw new TIERSValidationException(alError,
										alPlaces);
							}
						} else if (arrEligDetailOutput[i]
								.getEdEligibilityCargo()[0].getProgramCd()
								.equalsIgnoreCase("FS")) {
							strThresholdAmt = ReferenceTableManager
									.getValueByColumn(true, "EDSUPPLTHRESHOLD",
											"FS", "MONTHLY",
											arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPaymentBegDt());
							if (strThresholdAmt != null) {
								dThresholdAmt = Double
										.parseDouble(strThresholdAmt);
							}
							grossFSSupplementAmt = grossFSSupplementAmt
									+ supplementAmt;
							if (supplementAmt > dThresholdAmt) {
								ArrayList alError = new ArrayList();
								alError.add("778");
								ArrayList alPlaces = new ArrayList();
								logger
										.log(
												DIConstants.LOGGING_CATEGORY_EDBC,
												ILog.DEBUG,
												"Second Level Review required for the case "
														+ aLCaseNum
														+ " because supplement amount is greater than threshold");
								throw new TIERSValidationException(alError,
										alPlaces);
							}
						}
					}
					//Start Non- Finance Other Memeber Activity code for DLEG
					if (i > 0) {
						/*arrEligDetailOutput[i] = detOtherMember(
								arrEligDetailOutput[i],
								arrEligDetailOutput[i - 1], egDataHandler);*/
						/*
						 * Defect ID : BRGUS00111826 Added By : alamm2 Date : 05/21/2008
						 * Change : arrEligDetailOutput[i - 1] would not give the correct previous month record for the same EDG
						 * Passing eligDetailPrevMth
						 *
						 */
						arrEligDetailOutput[i] = detOtherMember(
								arrEligDetailOutput[i],
								eligDetailPrevMth, egDataHandler);
					} else {
						arrEligDetailOutput[i] = detOtherMember(
								arrEligDetailOutput[i], arrEligDetailOutput[i],
								egDataHandler);
					}
					if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.TP_01))
							&& (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getEfipEligSw() != IEdEligCodes.CHAR_INIT_SPACE)
							&& (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getEfipEligSw() == IEdEligCodes.YES)) {
						EdIndvEligibilityCargo[] edIndvEligibilityArry = arrEligDetailOutput[i]
								.getEdIndvEligibilityCargo();
						boolean workForce = false;
						if (edIndvEligibilityArry != null) {
							for (int x = 0; x < edIndvEligibilityArry.length; x++) {
								DcIndvEmpServExemptionCargo dcIndvEmpServ = (DcIndvEmpServExemptionCargo) egDataHandler
										.getEdDcUtil()
										.getDcIndvEmpServExemptionInfoMonthlyHM()
										.get(
												new Long(
														edIndvEligibilityArry[x]
																.getIndvId()));
								//BEGIN-BRGUS00209215-upadhyayulag-Only 'NO' should be treated as No. If 
								//nothing is selected means if the field value is blank, that should be
								//treated as 'YES'.
								if ((dcIndvEmpServ != null)
										&& (dcIndvEmpServ
												.getDlegEmpServicesSw() == IEdEligCodes.NO)) {
								/*
								 * Defect ID : BRGUS00111826 Added By : alamm2 Date : 05/21/2008
								 * Change : Insted of explictly compair with NO, modify not equal yes
								 * this way even if the switch is null driver would able to set activity type to OM
								 *
								 */
								/*if ((dcIndvEmpServ != null)
										&& (dcIndvEmpServ
												.getDlegEmpServicesSw() != IEdEligCodes.YES)) {*/
									/*
									 * Defect ID : BRGUS00093801 Added By :
									 * Ethirajue Date : 02/14/2008 Change :
									 * Setter Method has been changed for
									 * activity type(always setting last month
									 * only)
									 *
									 */

									//edIndvEligibilityArry[x]
									//	.setEtActTypeCd("OM");
									arrEligDetailOutput[i]
											.getEdIndvEligibilityCargo()[x]
											.setEtActTypeCd("OM");
								}
								//END-BRGUS00209215
							}
						}

					}
					//END Non- Finance Other Memeber Activity code for DLEG

				}// End of for

				//Throw exception gross supplement is greater than the
				// threshold
				// BRGUS00066540 added a null check as it ws crashing for online
				// mode
				if (!isOnlineEbdcProcess && (aMapRequest.get("BATCH") != null)
						&& !((String) aMapRequest.get("BATCH"))
								.startsWith("MU-CEDBC-ONR")) {
					String strTFThresholdAmt = ReferenceTableManager
							.getValueByColumn(true, "EDSUPPLTHRESHOLD", "TF",
									"DAILYSUM", DateComparisons.getRunDate());
					double dTFThresholdAmt = 0;
					if (strTFThresholdAmt != null) {
						dTFThresholdAmt = Double.parseDouble(strTFThresholdAmt);
					}
					if (grossTFSupplementAmt > dTFThresholdAmt) {
						ArrayList alError = new ArrayList();
						alError.add("778");
						ArrayList alPlaces = new ArrayList();
						logger
								.log(
										DIConstants.LOGGING_CATEGORY_EDBC,
										ILog.DEBUG,
										"Second Level Review required for the case "
												+ aLCaseNum
												+ " because supplement amount is greater than threshold");
						throw new TIERSValidationException(alError, alPlaces);
					}

					String strFSThresholdAmt = ReferenceTableManager
							.getValueByColumn(true, "EDSUPPLTHRESHOLD", "FS",
									"DAILYSUM", DateComparisons.getRunDate());
					double dFSThresholdAmt = 0;
					if (strFSThresholdAmt != null) {
						dFSThresholdAmt = Double.parseDouble(strFSThresholdAmt);
					}
					if (grossFSSupplementAmt > dFSThresholdAmt) {
						ArrayList alError = new ArrayList();
						alError.add("778");
						ArrayList alPlaces = new ArrayList();
						logger
								.log(
										DIConstants.LOGGING_CATEGORY_EDBC,
										ILog.DEBUG,
										"Second Level Review required for the case "
												+ aLCaseNum
												+ " because supplement amount is greater than threshold");
						throw new TIERSValidationException(alError, alPlaces);
					}
				}
				
				// beniwala - ASPEN00049529
				alignTANFCertPeriod(arrEligDetailOutput, conn, egDataHandler);
				//Setting STFS Potential elig sw
				//setStfsPotentialEligSw(arrEligDetailOutput);

				//Set EdgReprocessSw flag in Request Map
				setEdgReprocessSw(arrEligDetailOutput, aMapRequest);
				//BEGIN-BRGUS00156670-upadhyayulag-Set variable to rebuild MA alone
				setMaOnlyEdgReprocessSw(arrEligDetailOutput, aMapRequest, runMode);
				//END-BRGUS00156670
				
				// Begin - beniwala - ASPEN00022170 - create EDM NMW/IRU tasks
				// Start : ASPEN00045455 : Updated by Deepak Kumar to fix the null pointer issue for egDataHandler issue while creating EDMTasks
				//createEDMTasks(arrEligDetailOutput, aMapRequest, conn);
				  createEDMTasks(arrEligDetailOutput, aMapRequest, conn,egDataHandler);
				// End : ASPEN00045455 : Updated by Deepak Kumar to fix the null pointer issue for egDataHandler issue while creating EDMTasks
				// End - beniwala - ASPEN00022170 - create EDM NMW/IRU tasks
				
				/*
				 *  Begin - beniwala - ASPEN00028805 - trigger CO for noncoops for which conciliation form is to
				 *  sent or new sanction is created or a sanction is progressed
				 */
				createCOTriggerForSanctionsConciliation(arrEligDetailOutput,aMapRequest, conn, egDataHandler);
				// End - beniwala - ASPEN00028805
				setMapRequest(arrEligDetailOutput, aMapRequest);
				//Added for CCB: 203727
				String sSPTriggerCode = (String) aMapRequest
						.get(TRIGGER_CODE_LIST);
				boolean bIgnoreVCL = false;
				// Start :  ASPEN00011723 Updated by dkumar for Mass Update triggers
				/*
				if ((sSPTriggerCode != null)
						&& ((sSPTriggerCode
								.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP001) > 0)
								|| (sSPTriggerCode
										.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP002) > 0) || (sSPTriggerCode
								.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP003) > 0))) {
					bIgnoreVCL = true;
				}
				}*/
				if ((sSPTriggerCode != null)
						&& ((sSPTriggerCode
								.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP001) > 0))) {
					bIgnoreVCL = true;
				}
			// End :  ASPEN00011723 Updated by dkumar for Mass Update triggers
				if (aSReqModSw.equals(IEdEligCodes.MODULE_SWITCH_EDBC)) {
					if (aMapRequest.get(MU_RUN_MODE) == null
							|| (!((String) aMapRequest.get(MU_RUN_MODE))
									.equals("CV") && !egDataHandler
									.getDcCasesCargo()[0].getCaseModeCd()
									.equals("CV")) && (!bIgnoreVCL)) {
						detDeniedEdgForVCL(egDataHandler, arrEligDetailOutput);
						boolean bEdgReprocessSwYes = false;
						int ieligLength = arrEligDetailOutput.length;
						//Defect 153694
						for (int i = 0; i < ieligLength; i++) {
							if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getEdgReprocessSw() == IEdEligCodes.YES) {
								bEdgReprocessSwYes = true;
								break;
							}
						}
						if (bEdgReprocessSwYes == false) {
							if (egDataHandler
									.getAlEdVerificationChecklistModApp() != null) {
								Iterator itAlVCL = egDataHandler
										.getAlEdVerificationChecklistModApp()
										.iterator();
								EdVerificationChecklistCargo cargo = null;
								boolean bIssuedTrigger = false;
								boolean vclType = false ;
//	BRGUS00224271 rampurkara changes for chipra 
								
								Iterator itAlChipraVCL = egDataHandler
								.getAlEdVerificationChecklistModApp().iterator();
								
								aMapRequest.put("ChipraSw",new Boolean(false));
								aMapRequest.put("nonMACitzIdSw",new Boolean(false));
								while(itAlChipraVCL.hasNext())
								{
// BRGUS00233323 rampurkara changes for 3503-C 									
									cargo = (EdVerificationChecklistCargo) itAlChipraVCL.next();
// If vcl is due to citizenship or ID then set ChipraSW								
									if ((cargo.getVclTypeCd().equalsIgnoreCase("V003") ||
												cargo.getVclTypeCd().equalsIgnoreCase("V010") ||	
												cargo.getVclTypeCd().equalsIgnoreCase("V532") ||
												cargo.getVclTypeCd().equalsIgnoreCase("V533"))
												&& ((cargo.getVclDueDt() == null
														&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
														.getDeleteBySupervisorInd() == 'P')
														|| (cargo.getVclRequestDt() == null
																&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
																.getDeleteBySupervisorInd() == 'P')))
										{
											if (cargo.getProgramCd().equalsIgnoreCase("MA")
													|| cargo.getProgramCd().equalsIgnoreCase("ME"))
											{
												aMapRequest.put("ChipraSw",new Boolean(true));																										
											}
											else
											{
													aMapRequest.put("nonMACitzIdSw",new Boolean(true));
											}
										}	
// if vcl not due to id and citizenship then set nonMACitzSw									
										else {
												if (!(cargo.getVclTypeCd().equalsIgnoreCase("V003") ||									
														cargo.getVclTypeCd().equalsIgnoreCase("V010") ||	
														cargo.getVclTypeCd().equalsIgnoreCase("V532") ||
														cargo.getVclTypeCd().equalsIgnoreCase("V533"))
														&& ((cargo.getVclDueDt() == null
																&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
																    .getDeleteBySupervisorInd() == 'P')
																	|| (cargo.getVclRequestDt() == null
																			&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
																			.getDeleteBySupervisorInd() == 'P')))
										{
											aMapRequest.put("nonMACitzIdSw",new Boolean(true));
										}
								
									}
								}
// end BRGUS00233323								
// end of chipra changes 									
								
								
								//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
								while (itAlVCL.hasNext()) {
									cargo = (EdVerificationChecklistCargo) itAlVCL
											.next();
									// Added the or condition for the scenario
									// where edg is retaining all recs as 'P'
									// and since VCL records were created
									// in the previous rebuild it has vclduedt,
									// but the 1020 has not gone because of
									// reprocess for defect 236024
									// Added the void_sw condition in the or for
									// defect 237568
									//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
									if(cargo.getVclTypeCd() != null && cargo.getVclTypeCd().equals("V515"))
									{
										vclType = true;
									}
									if ((cargo.getVclDueDt() == null
											&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
											.getDeleteBySupervisorInd() == 'P')
											|| (cargo.getVclRequestDt() == null
													&& cargo.getVoidSw() == IEdEligCodes.NO && cargo
													.getDeleteBySupervisorInd() == 'P')) {
										bIssuedTrigger = true;
										StTime = System.currentTimeMillis();
										//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
										//BEGIN-BRGUS00136484-upadhyayulag-call the new method whose signature
										//is changed to pass the verfication check list cargo also to the method
										//issueCOTrigger
										issueCOTrigger(cargo, arrEligDetailOutput, aSUserId, conn,
												bIssuedTrigger, egDataHandler
														.getDcCasesCargo(),
												aMapRequest,
												vclType);
										//END-BRGUS00136484
										EndTime = System.currentTimeMillis();
										DiffTime = ((EndTime - StTime) / 1000F);
										COTime = DiffTime;

										break;
									}
								}
								if (bIssuedTrigger == false) {
									StTime = System.currentTimeMillis();
									//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
									issueCOTrigger(arrEligDetailOutput, aSUserId, conn,
											bIssuedTrigger, egDataHandler
													.getDcCasesCargo(),
											aMapRequest,
											vclType);
									EndTime = System.currentTimeMillis();
									COTime = ((EndTime - StTime) / 1000F);

								}
							}
						} else {
							//Code commented not to send correspondence trigger
							// if EdgReprocessSw is Yes.
							/*
							 * if
							 * (egDataHandler.getAlEdVerificationChecklistModApp() !=
							 * null) { Iterator itAlVCL =
							 * egDataHandler.getAlEdVerificationChecklistModApp().iterator();
							 * EdVerificationChecklistCargo cargo = null;
							 * boolean bFoundValidVCL = false; while
							 * (itAlVCL.hasNext()) { cargo =
							 * (EdVerificationChecklistCargo) itAlVCL.next(); if
							 * (cargo.getVclRequestDt() == null &&
							 * cargo.getVoidSw() == IEdEligCodes.NO) {
							 * bFoundValidVCL = true; break; } } if
							 * (bFoundValidVCL == false) { StTime =
							 * System.currentTimeMillis();
							 * issueCOTrigger(arrEligDetailOutput[0].getEdEligibilityCargo()[0].getCaseNum(),
							 * aSUserId, conn, bFoundValidVCL,
							 * egDataHandler.getDcCasesCargo(), aMapRequest);
							 * EndTime = System.currentTimeMillis(); COTime =
							 * ((EndTime - StTime)/1000F); } }
							 */
						}
						StTime = System.currentTimeMillis();
						arrEligDetailOutput = removeOtherPendingRsn(arrEligDetailOutput);
						cleanUpVCL(arrEligDetailOutput, egDataHandler);
						DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
						//System.out
						//		.println("CleanUpVCL in Seconds: " + DiffTime);

						//Added for defect 119517`
						if (egDataHandler.getAlEdVerificationChecklistModApp() != null) {
							Map hmMap = new HashMap();
							hmMap.put(IEdEligCodes.CASE_NUM, new Long(
									arrEligDetailOutput[0]
											.getEdEligibilityCargo()[0]
											.getCaseNum()));
							hmMap
									.put(
											IEdEligCodes.VCL_CARGO_ARRAY,
											(EdVerificationChecklistCargo[]) egDataHandler
													.getAlEdVerificationChecklistModApp()
													.toArray(
															new EdVerificationChecklistCargo[egDataHandler
																	.getAlEdVerificationChecklistModApp()
																	.size()]));
							hmMap.put(IEdEligCodes.PRINT_DATE,
									arrEligDetailOutput[0]
											.getEdEligibilityCargo()[0]
											.getEdbcRunDt());
							hmMap.put(IEdEligCodes.REQUEST_CONNECTION, conn);
							hmMap.put(IEdEligCodes.EDBC_PROCESSED,
									arrEligDetailOutput);
							//Added by Sai for CCB : 199383
							hmMap.put(IEdEligCodes.EG_DATA_HANDLER,
									egDataHandler);
							IEdVCLUpdate iEdVCLUpdate = EdVCLUpdate
									.getInstance();
							egDataHandler
									.setAlEdVerificationChecklistModApp(iEdVCLUpdate
											.updateEdVCL(hmMap));
						}
					}
				}

				//Void CC Record if no request exists and if denied
				if (detProgramCd(arrEligDetailInput[0]).containsKey(
						IEdEligCodes.PROGRAM_CD_MC)) {
					voidDeniedMCEdg(arrEligDetailOutput, egDataHandler);
				}

				//Added for defect 111585
				//Commented for defect 219122, because OPS is not invoked from
				// here.
				/*
				 * IServiceOverlapEntity iServiceOverlapEntity =
				 * ServiceOverlapEntity.getInstance(); Long[] lCCArray =
				 * makeEdgArrays(arrEligDetailOutput,
				 * IEdEligCodes.PROGRAM_CD_CC); Long[] lMEArray =
				 * makeEdgArrays(arrEligDetailOutput,
				 * IEdEligCodes.PROGRAM_CD_ME);
				 * iServiceOverlapEntity.overlapCheck((EdIndvServiceDtlsCargo[])egDataHandler.getAlEdIndvServiceDtls().toArray(new
				 * EdIndvServiceDtlsCargo[egDataHandler.getAlEdIndvServiceDtls().size()]),
				 * lMEArray, lCCArray);
				 */

				// Added for CCB: 150756
				alignCMACertificationPeriod(arrEligDetailOutput, egDataHandler);

				/* Begin BRGUS00067319 – kesavanr
				 * Processing scope and coverage for G2 type of assistances alone after determining eligibility
				 * of all programs.
				 */
				if(arrEligDetailOutput != null && arrEligDetailOutput.length > 0) {
					int eligDetailLength = arrEligDetailOutput.length;
					for(int s=0; s<eligDetailLength; s++) {
						if (arrEligDetailOutput[s] != null &&
							arrEligDetailOutput[s].getEdEligibilityCargo()[0].
							getTypeOfAssistanceCd().startsWith("G2")) {
								//BEGIN-BRGUS00161268-upadhyayulag-Override Scope & Coverage
								EDScopeCoverageBO edScopeCoverageBo = new EDScopeCoverageBO();
								edScopeCoverageBo.processScopeCoverage(egDataHandler, 
										arrEligDetailOutput[s],arrEligDetailOutput);
								EdEdgOverrideCargo edgOverrideCargo = new EdEdgOverrideCargo();
								edgOverrideCargo.setCaseNum(
										arrEligDetailOutput[s].getEdEligibilityCargo()[0].getCaseNum());
								edgOverrideCargo.setEdgNum(
										arrEligDetailOutput[s].getEdEligibilityCargo()[0].getEdgNum());
								edgOverrideCargo.setBeginDt(
										arrEligDetailOutput[s].getEdEligibilityCargo()[0].getPaymentBegDt());
								edgOverrideCargo.setEndDt(
										arrEligDetailOutput[s].getEdEligibilityCargo()[0].getPaymentEndDt());
								EdEdgOverrideCollection edgOverrideCollection = new EdEdgOverrideCollection();
								if(conn != null){
									edgOverrideCollection = new EdEdgOverrideCollection(conn);
								}else{
									edgOverrideCollection = new EdEdgOverrideCollection();
								}
								edgOverrideCollection.setCargo(edgOverrideCargo);
								EdEdgOverrideCargo[] edgOverrideCargos = 
									(EdEdgOverrideCargo[])edgOverrideCollection.select("findByCaseNumEdgNumDates");
								if(edgOverrideCargos != null && edgOverrideCargos.length > 0){
									EdEdgOverrideDetailsCargo edEdgOverrideDetailsCargo = 
										new EdEdgOverrideDetailsCargo();
									edEdgOverrideDetailsCargo.setCaseNum(edgOverrideCargos[0].getCaseNum());
									edEdgOverrideDetailsCargo.setEdgNum(edgOverrideCargos[0].getEdgNum());
									edEdgOverrideDetailsCargo.setOvrdId(edgOverrideCargos[0].getOvrdId());
									edgOverrideDetailsCollection.setCargo(edEdgOverrideDetailsCargo);
									EdEdgOverrideDetailsCargo[] edgOverrideDetailsCargos = 
										(EdEdgOverrideDetailsCargo[])edgOverrideDetailsCollection.select
										("findByCaseNumEdgNumOvrdId");
									if(edgOverrideDetailsCargos != null && edgOverrideDetailsCargos.length > 0){
										edgOverrideDetailsCollection.clear();
										edgOverrideDetailsCollection.setResults(edgOverrideDetailsCargos);
										overrideFields = populateOverrideFields(overrideFields, 
												edgOverrideDetailsCollection);
									}else{
										edgOverrideDetailsCollection.clear();
										overrideFields.clear();
									}
								}else{
									edgOverrideDetailsCollection.clear();
									overrideFields.clear();
								}
								overrideField("Scope",edgOverrideDetailsCollection,
										arrEligDetailOutput[s],egDataHandler);
								overrideField("Coverage",edgOverrideDetailsCollection,
										arrEligDetailOutput[s],egDataHandler);
								edgOverrideDetailsCollection.clear();
								//END-BRGUS00161268
						}
					}
				}
				//End BRGUS00067319
		//dhimark BRGUS00232287 EDBC to cancel MC record if no AP record on reinstated MC
					int isize = 0;
					int mLength = 0;
					int eligDetailLength=0;
					boolean mcApprovedFound = false;
					boolean reBuildRequired = false;
					EdEligibilityCargo edEligCargo = null;
					if (arrDcCaseProgramCargo != null ) {
					isize = arrDcCaseProgramCargo.length;
					}
					if(arrEligDetailOutput != null && arrEligDetailOutput.length > 0){
					 eligDetailLength = arrEligDetailOutput.length;
					}
					for (int k = 0; k < eligDetailLength; k++) {
						if (arrEligDetailOutput[k].getEdEligibilityCargo()[0]
								.getEdgReprocessSw() == 'Y') {
							reBuildRequired = true;
							break;
						}
						//break;
					}

					if (!reBuildRequired) {
						for (int i = 0; i < isize; i++) {
							if (arrDcCaseProgramCargo[i].getProgCd()
									.equalsIgnoreCase("MC")
									&& arrDcCaseProgramCargo[i]
											.getProgStatusCd() != null
									&& arrDcCaseProgramCargo[i]
											.getProgStatusCd()
											.equals(
													IEdEligCodes.STATUS_CD_TERMINATED)
									&& arrDcCaseProgramCargo[i].getEffEndDt() == null
									&& arrDcCaseProgramCargo[i]
											.getProgRescindCd() == null) {
								for (int j = 0; j < eligDetailLength; j++) {
									if (arrEligDetailOutput[j]
											.getEdEligibilityCargo()[0]
											.getProgramCd().equalsIgnoreCase(
													"MC")
											&& arrEligDetailOutput[j]
													.getEdEligibilityCargo()[0]
													.getCgStatusCd()
													.equalsIgnoreCase(
															IEdEligCodes.STATUS_CD_APPROVED)) {

										mcApprovedFound = true;
										break;

									}

								}

								if (!mcApprovedFound) {
									for (int j = 0; j < eligDetailLength; j++) {
										if (arrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getProgramCd()
												.equalsIgnoreCase("MC")) {
											arrEligDetailOutput[j]
													.getEdEligibilityCargo()[0]
													.setDeleteSw('Y');
										}
									}
								}
							}
						}
					}
				

				//Calling EDG for STFS Records
				EligDetail[] eligDetailEDG = buildSTFSRecords(
						arrEligDetailOutput, conn);

				// CCB: 00127585: Copy MM Voided record
				if (alEligDetailVoidedForMM.size() > 0) {
					egDataHandler
							.writeEdEligDetailVoidRec(
									aSReqModSw,
									(EligDetail[]) alEligDetailVoidedForMM
											.toArray(new EligDetail[alEligDetailVoidedForMM
													.size()]), egDataHandler,
									aSUserId, conn);
				}

				//set the data using the datahandler
				//BrgId: BRGUS00124354 --- KesireddyV -- CR -20695
				EdDriverHelper.processEligibilityFailureForEarlyReview(arrEligDetailOutput);
// BRGUS00251500 rampurkara merging from DEV-CR2 
//	BRGUS00229515 - kucherlapatis - 04/07/2010 - Added to reset chip referral sw for AD-Care
				resetChipReferralSw(arrEligDetailOutput);
				
				StTime = System.currentTimeMillis();
				
				//BEGIN-BRGUS00223920-upadhyayulag-Trigger CO for 3503-G
				if(!isRebuildDone(arrEligDetailOutput)){
					EdDriverHelper.issueCOTrigger(arrEligDetailOutput, aSUserId, conn, 
							egDataHandler.getDcCasesCargo(), aMapRequest);
				}
				//END-BRGUS00223920
// BRGUS00256141 rampurkara commenting the call here to call adjustbenefitAmountForSTFS				
// BRGUS00254549 rampurkara call to STFS method so that writeEligDetail is called only once
//				adjustBenefitAmountForSTFS(eligDetailEDG);
				
				egDataHandler.writeEligDetail(aSReqModSw, arrEligDetailOutput,
						egDataHandler, aSUserId, conn);
				//Added for CCB: PFP 158628 on 4/25/2005 by Sai
				if (alEligDetailForPFPSanction != null
						&& alEligDetailForPFPSanction.size() > 0) {
					// Added for defect 232041
					egDataHandler.setWritingNotRequired(true);
					egDataHandler
							.writeEligDetail(
									aSReqModSw,
									(EligDetail[]) alEligDetailForPFPSanction
											.toArray(new EligDetail[alEligDetailForPFPSanction
													.size()]), egDataHandler,
									aSUserId, conn);
					egDataHandler.setWritingNotRequired(false);
				}
				
// BRGUS00256141 calling adjustbenefitamtforstfs and writeeligdetail 
// this is to fix stfs dropping issue				
// BRGUS00254549 rampurkara commenting this code and calling	
//	adjustBenefitAmountForSTFS() prior to calling writeEligDetail() so that there is no 
// error page if the case has pending VCL.				
				
				//				Write EDG returned STFS Records	  
				adjustBenefitAmountForSTFS(eligDetailEDG);
				
// BRGUS00256543 rampurkara stopped calling writeEligDetail and with this WR will call writeEligDetailForSTFS
//  as only tables that got newly created by edg process needs to be written to DB				
	/*			
				if (eligDetailEDG != null && eligDetailEDG[0] != null) {
					egDataHandler.writeEligDetail(aSReqModSw, eligDetailEDG,
							egDataHandler, aSUserId, conn);
				}
			*/
				
				if (eligDetailEDG != null && eligDetailEDG[0] != null) 
				{
					egDataHandler.writeEligDetailForSTFS( eligDetailEDG,aSUserId, conn);
				}				
// end BRGUS00256141	
// end BRGUS00254549				
				//EndTime = System.currentTimeMillis();
				WriteEligTime = ((System.currentTimeMillis() - StTime) / 1000F);
				DiffTime = ((System.currentTimeMillis() - StTime) / 1000F);
				//				if(sbLogMessage.length() > 0){
				//				sbLogMessage.delete(0,sbLogMessage.length());
				//			}
				//			sbLogMessage.append("Write Elig Detail in Seconds: ");
				//			sbLogMessage.append(DiffTime);
				//			log(stLogCategory,ILog.DEBUG,sbLogMessage.toString());
//				EDBCLogger.writeRulesEngineTimerLog(DiffTime, stLogCategory,
//						"Write Elig Detail in Seconds: ", sbLogMessage);

				StTimeEP = System.currentTimeMillis();

				if (aMapRequest.get(IEdEligCodes.REQUEST_CASE_RUN_MODE) != null
						&& ((String) aMapRequest
								.get(IEdEligCodes.REQUEST_CASE_RUN_MODE))
								.equals(IEdEligCodes.CASE_RUN_MODE_ONLINE)
						&& bFSOverrideAndTanf == true) {
					if (isRebuildDone(arrEligDetailOutput) == false) {
						HashMap hmAlertIds = mapAlertIds();
						Map hmEdgesForAlerts = mapEdgesForAlerts(
								arrEligDetailOutput, hmAlertIds);
//						String pageId = (String) aMapRequest
//								.get(TIERSConstants.PAGE);
						String caseMode = egDataHandler.getDcCasesCargo()[0]
								.getCaseModeCd();
						//Set se = hmEdgesForAlerts.keySet();
						Iterator it = hmEdgesForAlerts.keySet().iterator();
						ArrayList alHmAlerts = new ArrayList();
						long lEmpID = 0;
						Long lAlertId = null;
						HashMap hmEmpIdToEdges = null;
						while (it.hasNext()) {
							lEmpID = 0;
							lAlertId = (Long) it.next();
							if (egDataHandler.getMoEmployeeCasesCargo() == null
									|| egDataHandler.getMoEmployeeCasesCargo().length == 0) {
								lEmpID = ((Long) aMapRequest
										.get(IEdEligCodes.EMP_ID)).longValue();
							} else {
								hmEmpIdToEdges = mapEmpIdToEdges(egDataHandler);
								//if
								// (hmEmpIdToEdges.get(hmEdgesForAlerts.get(lAlertId))
								// == null) {
								if (hmEmpIdToEdges
										.get(((HashMap) hmEdgesForAlerts
												.get(lAlertId))
												.get(IEdEligCodes.KEY_EDG_NUM)) == null) {
									//Added if condition for Defect :211181
									if (hmEmpIdToEdges
											.get(((HashMap) hmEdgesForAlerts
													.get(lAlertId))
													.get(IEdEligCodes.KEY_PGMCD)) == null) {
										lEmpID = ((Long) aMapRequest
												.get(IEdEligCodes.EMP_ID))
												.longValue();
									} else {
										lEmpID = ((Long) hmEmpIdToEdges
												.get(((HashMap) hmEdgesForAlerts
														.get(lAlertId))
														.get(IEdEligCodes.KEY_PGMCD)))
												.longValue();
									}
								} else {
									lEmpID = lEmpID = ((Long) hmEmpIdToEdges
											.get(((HashMap) hmEdgesForAlerts
													.get(lAlertId))
													.get(IEdEligCodes.KEY_EDG_NUM)))
											.longValue();
								}
							}
							alHmAlerts
									.add(issueALTrigger(
											arrEligDetailOutput[0]
													.getEdEligibilityCargo()[0]
													.getCaseNum(),
											caseMode,
											lAlertId.longValue(),
											pageId,
											lEmpID,
											aSUserId,
											DateComparisons
													.getTimestamp(new java.util.Date()),conn,isOnlineEbdcProcess));
						}
						try {
							IAlerts alertObject = AlAlertManager.getInstance();
							StTime = System.currentTimeMillis();
							alertObject
									.generateMultipleAlerts((HashMap[]) alHmAlerts
											.toArray(new HashMap[alHmAlerts
													.size()]));
							EndTime = System.currentTimeMillis();
							ALTime = ((EndTime - StTime) / 1000F);
						} catch (Exception e) {
							String info = "EXC in AL Trigger process "
									+ e.getMessage();
							log(FwConstants.LOGGING_CATEGORY_LEGACY,
									ILog.FATAL, info);
							EDBCLogger.writeExceptionStackTrace(
									DIConstants.LOGGING_CATEGORY_EDBC,
									ILog.DEBUG, e);
							throw new FrameworkException(e.getMessage()
									+ " Error While Triggering Alerts ");
						}
					}
				}
				//Hearing override code changes
				//Dev Activity BRGUS00005538
				detHearingOverrides(egDataHandler, aLCaseNum, conn,
						aMapRequest, aSUserId);
				//ASPEN00021378 - Update request due date for Auto denial
				detProgramRequestDueDate(arrEligDetailOutput, egDataHandler, conn);	
				//BEGIN-BRGUS00243669-upadhyayulag-Skip Ex-Parte review when processing SP004/SP005 triggers
				boolean doExParteReview = true;
				//BEGIN-BRGUS00245019-upadhyayulag-Skip Ex-Parte review when processing SP015/SP016 triggers
				// Start :  ASPEN00011723 Updated by dkumar for Mass Update triggers
				/*
				if ((sSPTriggerCode != null) 
						&& ((sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP004) != -1) 
								|| (sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP005) != -1)
								|| (sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP015) != -1)
								|| (sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP016) != -1))) {
					doExParteReview = false;
				}*/
				if ((sSPTriggerCode != null) 
						&& ((sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP004) != -1)//ASPEN00033530 Null point check Mass update trigger SP005 and SP010
						|| (sSPTriggerCode.indexOf(IEdEligCodes.SPECIAL_TRIGGER_CD_SP005) != -1))) {//ASPEN00033530 Mass update trigger SP005 and SP010
					doExParteReview = false;
				}
				
				//END-BRGUS00245019
				// End :  ASPEN00011723 Updated by dkumar for Mass Update triggers
				//BEGIN-BRGUS00242165-upadhyayulag-Process Ex-Parte Review
				try {
					if(doExParteReview && (!isRebuildDone(arrEligDetailOutput))){
						//END-BRGUS00243669
						String exParteSwFromProperties = FwPropertyLoader.getPropertyOf(
								IEdEligCodes.TIERS_PROPERTIES, IEdEligCodes.EX_PARTE_REVIEW_SW);
						if(exParteSwFromProperties.charAt(0) == IEdEligCodes.YES){
							EgDataHandler egDataHandlerExParte = new EgDataHandler();
							egDataHandlerExParte.loadEligDetailForExParteReview(aLCaseNum, conn);
							EdDriverHelper.processExParteReview(egDataHandler, egDataHandlerExParte);
							egDataHandlerExParte.writeEligDetailExParteReview(
									egDataHandlerExParte, aSUserId, conn);
						}
					}
				} catch (Exception e) {
					// TODO: handle exception
				}
				//END-BRGUS00242165
			}

			// Deleting Alert ID # 1117 After process the records
			//String pageId = (String) aMapRequest.get(TIERSConstants.PAGE);
			String caseMode = null;
			if (aMapRequest.get("CASE_RUN_MODE") != null) {
				caseMode = (String) aMapRequest.get("CASE_RUN_MODE");
			}

			int alertId = IEdEligCodes.ALERT_JET_ID;

			if (arrEligDetailOutput.length > 0) {
				int edEligLength = arrEligDetailOutput.length;


				if (edEligLength > 0) {
					for (int i = 0; i < edEligLength; i++) {
						if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getProgramCd().equalsIgnoreCase("TF")
								&& (arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getCgStatusCd().equalsIgnoreCase(
												IEdEligCodes.STATUS_CD_DENIED)
										|| arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getCgStatusCd()
												.equalsIgnoreCase(
														IEdEligCodes.STATUS_CD_TERMINATED) || arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getCgStatusCd()
										.equalsIgnoreCase(
												IEdEligCodes.STATUS_CD_APPROVED))) {
							EdEligibilityCargo edEligibilityCargo = arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0];

							deleteAlert(edEligibilityCargo, alertId, pageId,
									caseMode, conn, aSUserId,isOnlineEbdcProcess);
							break;
						}

					}

				}
			}
			//Log Changes
			ArrayList edEligCargolist = new ArrayList();
			int eligRecLen = 0;
			if(arrEligDetailOutput != null ){
				eligRecLen = arrEligDetailOutput.length;
				for(int a=0; a<eligRecLen; a++){
					if(arrEligDetailOutput[a]
														.getEdEligibilityCargo()[0] != null){
					edEligCargolist.add(arrEligDetailOutput[a]
														.getEdEligibilityCargo()[0]);
					}
				}
				if(edEligCargolist != null && edEligCargolist.size() >0){
					//countOfCurrentEdgNumAndMonths(edEligCargolist);//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
				}
			}//Log Changes
			methodName = "performEDBCNRFV" + "_" + "Edbc" + "(" + String.valueOf(arrEligDetailOutput.length) + ")";
			if(sessID != null){
				reportTime(tg,pageId,methodName);
			}
			EPTime = ((System.currentTimeMillis() - StTimeEP) / 1000F);
			if (sbLogMessage.length() > 0) {
				sbLogMessage.delete(0, sbLogMessage.length());
			}
			sbLogMessage.append("Total Time Taken for Read Data : ");

			float totDataReadTime = ReadEligTime + ReadDCDataTime;
				sbLogMessage.append(ReadDCDataTime ) ;
			log(stLogCategory, ILog.INFO, sbLogMessage.toString());
			totalEdTime = TotNFTime + TotFinTime + TotResTime + TotVCLTime
					+ totalSERTime + totalDSSTime + totalCDCTime;
			float TotalEDBC = ((System.currentTimeMillis() - EDBCStTime) / 1000F);
		StringBuffer edbcModuleTime = new StringBuffer();
		edbcModuleTime.append(aLCaseNum);
		edbcModuleTime.append(",");
		edbcModuleTime.append(sessID);
		edbcModuleTime.append(",");
		edbcModuleTime.append(NumOfRec) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(numberOfMonths) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(ReadEligTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(ReadDCDataTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(totDataReadTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotNFTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotFinTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotResTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(totalSERTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(totalCDCTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(totalDSSTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotVCLTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(WriteEligTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(COTime) ;
		edbcModuleTime.append(",");
		edbcModuleTime.append(ALTime);
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotalEDBC - (COTime + ALTime + ReadEligTime
					+ ReadDCDataTime + WriteEligTime + TotNFTime + TotFinTime
				+ TotResTime + TotVCLTime + TotRMTime));
		edbcModuleTime.append(",");
		edbcModuleTime.append(TotalEDBC);
			if (sbLogMessage.length() > 0) {
			sbLogMessage.delete(0, sbLogMessage.length());
		}
		EDBCLogger.writeRulesEngineTimerLog(arrEligDetailInput[0].getDssRulesEngineTime()+arrEligDetailInput[0].getResRulesEngineTime()+arrEligDetailInput[0].getFinRulesEngineTime()+arrEligDetailInput[0].getVclRulesEngineTime()
				+ arrEligDetailInput[0].getSerRulesEngineTime()+arrEligDetailInput[0].getDssRulesEngineTime()+arrEligDetailInput[0].getCdcRulesEngineTime(),stLogCategory,"Total Edbc Rules Engine Time in seconds", sbLogMessage);
		if (sbLogMessage.length() > 0) {
			sbLogMessage.delete(0, sbLogMessage.length());
		}
		EDBCLogger.writeRulesEngineTimerLog(ReadEligTime+ReadDCDataTime,stLogCategory,"Edbc ED/DC Data Read Time in seconds", sbLogMessage);

		if (sbLogMessage.length() > 0) {
			sbLogMessage.delete(0, sbLogMessage.length());
		}
		if (sbLogMessage.length() > 0) {
			sbLogMessage.delete(0, sbLogMessage.length());
		}
		EDBCLogger.writeRulesEngineTimerLogForEdbcProcess(edbcModuleTime,stLogCategory,
				"EDBC Status : ", sbLogMessage);
		/*if (sbLogMessage.length() > 0) {
				sbLogMessage.delete(0, sbLogMessage.length());
			}
			sbLogMessage
					.append("----------------------------------------------------------");
		 log(stLogCategory, ILog.INFO, sbLogMessage.toString());*/
		} catch (TIERSValidationException tve) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
			throw tve;
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (RulesException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getMessage());
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getMessage());
		}
		}
		//set the data in the request to be forwarded by Controller
		return true;
	}


	/**
	 * Method cleanUpVCL, cleans up VCL.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public void cleanUpVCL(EligDetail[] aArrEligDetailOutput,
			EgDataHandler egDataHandler) throws EDBCException {
		try {
			if (egDataHandler.getAlEdVerificationChecklistModApp() == null) {
				return;
			}
			Iterator itVCL = egDataHandler.getAlEdVerificationChecklistModApp()
					.iterator();
			EdVerificationChecklistCargo cargo = null;
			boolean bEdgFound = false;
			boolean bEdgReprocessSwYesFound = false;
			HashMap hmEdgesFound = new HashMap();
			// beniwala - ASPEN00015918 - fix findbugs issue
			int iLength = 0;
			if(aArrEligDetailOutput != null) {
				iLength = aArrEligDetailOutput.length;
			}
			
			for (int i = 0; i < iLength; i++) {
				if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0]
						.getEdgReprocessSw() == IEdEligCodes.YES) {
					bEdgReprocessSwYesFound = true;
					break;
				}
			}
			int iTempLength = 0;
			int iProcLength = 0;
			EdVerificationChecklistCargo tempCargo = null;
			Iterator itTempVCL = null;
			if (bEdgReprocessSwYesFound == false) {
				while (itVCL.hasNext()) {
					cargo = (EdVerificationChecklistCargo) itVCL.next();
					if (cargo.getVoidSw() == IEdEligCodes.VOID_SW_NO) {
						if (!hmEdgesFound.containsKey(new Long(cargo
								.getEdgNum()))) {
							iTempLength = 0;
							if (aArrEligDetailOutput != null) {
								iTempLength = aArrEligDetailOutput.length;
							}
							for (int i = 0; i < iTempLength; i++) {
								if (cargo.getEdgNum() == aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0].getEdgNum()) {
									bEdgFound = true;
									hmEdgesFound.put(
											new Long(cargo.getEdgNum()),
											new Long(cargo.getEdgNum()));
									break;
								}
							}
							if (!bEdgFound) {
								iProcLength = 0;
								if (egDataHandler
										.getEdEligibilityCargoProcessed() != null) {
									iProcLength = egDataHandler
											.getEdEligibilityCargoProcessed().length;
								}
								for (int j = 0; j < iProcLength; j++) {
									if (cargo.getEdgNum() == egDataHandler
											.getEdEligibilityCargoProcessed()[j]
											.getEdgNum()) {
										bEdgFound = true;
										hmEdgesFound.put(new Long(cargo
												.getEdgNum()), new Long(cargo
												.getEdgNum()));
										break;
									}
								}
							}
							if (!bEdgFound) {
								int iVrecLength = 0;
								if (egDataHandler
										.getEdEligibilityCargoVrecords() != null) {
									iVrecLength = egDataHandler
											.getEdEligibilityCargoVrecords().length;
								}
								for (int j = 0; j < iVrecLength; j++) {
									if (cargo.getEdgNum() == egDataHandler
											.getEdEligibilityCargoVrecords()[j]
											.getEdgNum()) {
										bEdgFound = true;
										hmEdgesFound.put(new Long(cargo
												.getEdgNum()), new Long(cargo
												.getEdgNum()));
										break;
									}
								}
							}
							if (!bEdgFound) {
								itTempVCL = egDataHandler
										.getAlEdVerificationChecklistModApp()
										.iterator();

								while (itTempVCL.hasNext()) {
									tempCargo = (EdVerificationChecklistCargo) itTempVCL
											.next();
									/*
									 * Modified if condition for the Defect #
									 * 206710 , on 5/17/2005 permit deleting
									 * only if vclRequestDt is not present
									 */
									if (tempCargo.getEdgNum() == cargo
											.getEdgNum()
											&& (tempCargo.getVclRequestDt() == null)) {
										tempCargo
												.setVoidSw(IEdEligCodes.VOID_SW_YES);
									}
								}
							}
							bEdgFound = false;
						}
					}
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"cleanUpVCL", ex);
		}
	}

	/**
	 * Method detDeniedEdgForVCL determines denied Edg for VCL.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @throws EDBCException
	 */
	public void detDeniedEdgForVCL(EgDataHandler aEgDataHandler,
			EligDetail[] aArrEligDetailOutput) throws EDBCException {
		//boolean bPendingSw = false;
		if (aEgDataHandler.getAlEdVerificationChecklistModApp() == null) {
			return;
		}
		Iterator itAlVCL = aEgDataHandler.getAlEdVerificationChecklistModApp()
				.iterator();
		EdVerificationChecklistCargo cargo = null;
		HashMap hmEdgesChecked = new HashMap();
		boolean edgCheck = false;
		int iLengthEdges = 0;
		EdEligibilityCargo lastCargo = null;
		while (itAlVCL.hasNext()) {
			edgCheck = false;
			cargo = (EdVerificationChecklistCargo) itAlVCL.next();
			if (cargo.getVclDueDt() == null
					&& cargo.getVoidSw() == IEdEligCodes.NO) {
				if (hmEdgesChecked.containsKey(new Long(cargo.getEdgNum())) == false) {
					iLengthEdges = aArrEligDetailOutput.length;
					lastCargo = null;
					for (int i = 0; i < iLengthEdges; i++) {
						if (cargo.getEdgNum() == aArrEligDetailOutput[i]
								.getEdEligibilityCargo()[0].getEdgNum()) {
							if (edgCheck) {
								break;
							} else {
								lastCargo = aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0];
								//Defect -- when we run edg, If the
								// future/future future month eligibility is
								// denied,
								// Driver is voiding the VCL record, modified
								// logic to pend instead of voiding
								/*
								 * if(!(lastCargo.getTypeOfAssistanceCd().equalsIgnoreCase(IEdEligCodes.TP_40))){
								 * if(lastCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_PENDING)){
								 * bPendingSw = true; break; } }
								 */
							}
						}
						if (lastCargo != null
								&& (lastCargo.getCgStatusCd().equals(
										IEdEligCodes.STATUS_CD_DENIED) || lastCargo
										.getCgStatusCd()
										.equals(
												IEdEligCodes.STATUS_CD_TERMINATED))) {
							hmEdgesChecked.put(new Long(cargo.getEdgNum()),
									String.valueOf(IEdEligCodes.VOID_SW_YES));
						} else {
							hmEdgesChecked.put(new Long(cargo.getEdgNum()),
									String.valueOf(IEdEligCodes.VOID_SW_NO));
							if (lastCargo != null
									&& !(lastCargo.getTypeOfAssistanceCd()
											.equalsIgnoreCase(IEdEligCodes.TP_40))) {
								edgCheck = true;
							}
						}
					}
				}
			}
		}

		itAlVCL = aEgDataHandler.getAlEdVerificationChecklistModApp()
				.iterator();
		while (itAlVCL.hasNext()) {
			cargo = (EdVerificationChecklistCargo) itAlVCL.next();
			if (cargo.getVclDueDt() == null
					&& cargo.getVoidSw() == IEdEligCodes.NO) {
				if (((String) hmEdgesChecked.get(new Long(cargo.getEdgNum())))
						.equals(String.valueOf(IEdEligCodes.VOID_SW_YES))) {
					cargo.setVoidSw(IEdEligCodes.YES);
				}
			}
		}
	}

	/**
	 * Method detParamsForEDBCEndProcess, determines required parametrs for EDBC
	 * End Process.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param aEligDetail
	 *            EligDetail
	 * @return HashMap
	 * @throws EDBCException
	 */
	public HashMap detParamsForEDBCEndProcess(
			EligDetail[] aArrEligDetailOutput, EligDetail aEligDetail)
			throws EDBCException {
		HashMap hmParams = new HashMap();
		try {
			EdEligibilityCargo edEligPrevMonthForFirstEDM = new EdEligibilityCargo();
			EdEligibilityCargo edEligPrevMonthForOtherEDM = new EdEligibilityCargo();
			EdEligibilityCargo edEligPrevPrevMonthForFirstEDM = new EdEligibilityCargo();
			EdEligibilityCargo edEligPrevPrevMonthForOtherEDM = new EdEligibilityCargo();
			EdIndvEligibilityCargo edIndvEligPrevMonthForFirstEDM = new EdIndvEligibilityCargo();
			EdIndvEligibilityCargo[] arrEdIndvEligPrevMonthForOtherEDM = null;
			EligDetail eligDetailPrevMonth = new EligDetail();
			//Commented due to FindBugs Analysis
			//EligDetail eligDetailPrevPrevMonth = new EligDetail();
			int iEligDetailOutputLength = 0;
			iEligDetailOutputLength = aArrEligDetailOutput.length;
			int iLength = 0;
			if (!aEligDetail.getEdEligibilityCargo()[0].getProgramCd()
					.equalsIgnoreCase("CD")) {
				Timestamp tsLastMthPaymentBegDt = null;
				Timestamp tsPrevPrevLastMthPaymentBegDt = null;
				tsLastMthPaymentBegDt = DateComparisons.subMonths(aEligDetail
						.getEdEligibilityCargo()[0].getPaymentBegDt(), 1);
				tsPrevPrevLastMthPaymentBegDt = DateComparisons.subMonths(
						aEligDetail.getEdEligibilityCargo()[0]
								.getPaymentBegDt(), 2);

				for (int j = 0; j < iEligDetailOutputLength; j++) {
					if (aArrEligDetailOutput[j] != null) {
						if (aArrEligDetailOutput[j].getEdEligibilityCargo()[0]
								.getEdgNum() == aEligDetail
								.getEdEligibilityCargo()[0].getEdgNum()) {
							if (!(aArrEligDetailOutput[j]
									.getEdEligibilityCargo()[0]
									.getPriorMedicalCd().equals(
											IEdEligCodes.PRIOR_MED_CD_1)
									|| aArrEligDetailOutput[j]
											.getEdEligibilityCargo()[0]
											.getPriorMedicalCd()
											.equals(IEdEligCodes.PRIOR_MED_CD_2) || aArrEligDetailOutput[j]
									.getEdEligibilityCargo()[0]
									.getPriorMedicalCd().equals(
											IEdEligCodes.PRIOR_MED_CD_3))) {
								//						if
								// (!aArrEligDetailOutput[j].getEdEligibilityCargo()[0].getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_1)
								// ||
								// !aArrEligDetailOutput[j].getEdEligibilityCargo()[0].getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_2)
								// ||
								// !aArrEligDetailOutput[j].getEdEligibilityCargo()[0].getPriorMedicalCd().equals(IEdEligCodes.PRIOR_MED_CD_3))
								// {
								if (aArrEligDetailOutput[j]
										.getEdEligibilityCargo()[0]
										.getPaymentBegDt()
										.before(
												aEligDetail
														.getEdEligibilityCargo()[0]
														.getPaymentBegDt())
										&& ((aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt() == null) || (aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt().after(
														tsLastMthPaymentBegDt) || aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt().equals(
														tsLastMthPaymentBegDt)))) {
									eligDetailPrevMonth = aArrEligDetailOutput[j];
									// beniwala - ASPEN00015918 - fix findbugs issue
									if(eligDetailPrevMonth != null) {
										edEligPrevMonthForOtherEDM = eligDetailPrevMonth
												.getEdEligibilityCargo()[0];
									}									
									iLength = 0;
									iLength = aArrEligDetailOutput[j]
											.getEdIndvEligibilityCargo().length;
									arrEdIndvEligPrevMonthForOtherEDM = new EdIndvEligibilityCargo[iLength];
									for (int k = 0; k < iLength; k++) {
										if (eligDetailPrevMonth != null) {
											if (eligDetailPrevMonth
													.getEdIndvEligibilityCargo() != null) {
												arrEdIndvEligPrevMonthForOtherEDM[k] = eligDetailPrevMonth
														.getEdIndvEligibilityCargo()[k];
											}
										}
									}
									break;
								}
								if (aArrEligDetailOutput[j]
										.getEdEligibilityCargo()[0]
										.getPaymentBegDt().before(
												tsLastMthPaymentBegDt)
										&& ((aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt() == null) || (aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt()
												.after(
														tsPrevPrevLastMthPaymentBegDt) || aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt()
												.equals(
														tsPrevPrevLastMthPaymentBegDt)))) {
									//Commented due to FindBugs Analysis
									//eligDetailPrevPrevMonth =
									// aArrEligDetailOutput[j];
									//edEligPrevPrevMonthForOtherEDM =
									// eligDetailPrevPrevMonth.getEdEligibilityCargo()[0];
									edEligPrevPrevMonthForOtherEDM = aArrEligDetailOutput[j]
											.getEdEligibilityCargo()[0];
								}
							}
						}
					}
				}
			} else { //If program is CD
				Timestamp prevPayPeriodEndDate = null;
				for (int j = 0; j < iEligDetailOutputLength; j++) {
					if (aArrEligDetailOutput[j] != null) {
						if (aArrEligDetailOutput[j].getEdEligibilityCargo()[0]
								.getEdgNum() == aEligDetail
								.getEdEligibilityCargo()[0].getEdgNum()) {
							prevPayPeriodEndDate = DateComparisons.subDays(
									aEligDetail.getEdEligibilityCargo()[0]
											.getPaymentBegDt(), 1);
							if (aArrEligDetailOutput[j].getEdEligibilityCargo()[0]
									.getPaymentEndDt() != null) {
								if (DateComparisons.dateEqualsDateInTimestamp(
										aArrEligDetailOutput[j]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt(),
										prevPayPeriodEndDate)) {
									eligDetailPrevMonth = aArrEligDetailOutput[j];
									// beniwala - ASPEN00015918 - fix findbugs issue
									if (eligDetailPrevMonth != null) {
										edEligPrevMonthForOtherEDM = eligDetailPrevMonth
												.getEdEligibilityCargo()[0];
									}									
									iLength = 0;
									iLength = aArrEligDetailOutput[j]
											.getEdIndvEligibilityCargo().length;
									arrEdIndvEligPrevMonthForOtherEDM = new EdIndvEligibilityCargo[iLength];
									for (int k = 0; k < iLength; k++) {
										if (eligDetailPrevMonth != null) {
											if (eligDetailPrevMonth
													.getEdIndvEligibilityCargo() != null) {
												arrEdIndvEligPrevMonthForOtherEDM[k] = eligDetailPrevMonth
														.getEdIndvEligibilityCargo()[k];
											}
										}
									}
									break;
								}
							}
						}
					}
				}

			}
			hmParams.put(IEdEligCodes.ED_ELIG_PREV_MTH_FIRST_EDM,
					edEligPrevMonthForFirstEDM);
			hmParams.put(IEdEligCodes.ED_ELIG_PREV_MTH_OTHER_EDM,
					edEligPrevMonthForOtherEDM);
			hmParams.put(IEdEligCodes.ED_ELIG_PREV_PREV_MTH_FIRST_EDM,
					edEligPrevPrevMonthForFirstEDM);
			hmParams.put(IEdEligCodes.ED_ELIG_PREV_PREV_MTH_OTHER_EDM,
					edEligPrevPrevMonthForOtherEDM);
			hmParams.put(IEdEligCodes.ED_INDV_PREV_MTH_FIRST_EDM,
					edIndvEligPrevMonthForFirstEDM);
			hmParams.put(IEdEligCodes.ED_INDV_PREV_MTH_OTHER_EDM,
					arrEdIndvEligPrevMonthForOtherEDM);
			hmParams
					.put(IEdEligCodes.ELIG_DETAIL_PREV_MTH, eligDetailPrevMonth);
			hmParams.put(IEdEligCodes.ELIG_DETAIL_PROCCESSED, aEligDetail);
			hmParams.put(IEdEligCodes.ELID_DETAIL_ALL_PROCCESSED,
					aArrEligDetailOutput);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"detParamsForEDBCEndProcess", ex);
		}
		return hmParams;
	}

	/**
	 * This method checks each EdVerificationChecklistCargo for VCL_Due_Dt and
	 * voids them.
	 *
	 * @param aEgDataHandler
	 *            us.nm.state.hsd.aspen.business.rules.ed.EgDataHandler
	 * @throws EDBCException
	 */
	public void checkVCLDueDtMakeVoid(EgDataHandler aEgDataHandler)
			throws EDBCException {
		try {
			int iVerChkList = 0;
			if (aEgDataHandler.getEdVerificationChecklistCargo() != null) {
				iVerChkList = aEgDataHandler.getEdVerificationChecklistCargo().length;
			}
			ArrayList alTempVCL = null;
			alTempVCL = new ArrayList();
			EdVerificationChecklistCargo edVCLCargoTemp = null;
			boolean bEdgFound = false;
			int iProcLength = 0;
			int iVoidLength = 0;
			for (int j = 0; j < iVerChkList; j++) {
				edVCLCargoTemp = (EdVerificationChecklistCargo) aEgDataHandler
						.getEdVerificationChecklistCargo()[j].clone();
				//Modified for defect 119517
				//if (edVCLCargoTemp.getVclDueDt() == null) {
				if (edVCLCargoTemp.getVclRequestDt() == null) {
					bEdgFound = false;
					iProcLength = 0;
					if (aEgDataHandler.getEdEligibilityCargoProcessed() != null) {
						iProcLength = aEgDataHandler
								.getEdEligibilityCargoProcessed().length;
					}
					for (int k = 0; k < iProcLength; k++) {
						if (edVCLCargoTemp.getEdgNum() == aEgDataHandler
								.getEdEligibilityCargoProcessed()[k]
								.getEdgNum()) {
							//BRGUS00134324 - Bhuvane - checking disability not to fail
							if ((aEgDataHandler.getEdEligibilityCargoProcessed()[k]
									.getCgEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING))
								||(edVCLCargoTemp.getVclTypeCd().equalsIgnoreCase("V017")
										&& edVCLCargoTemp.getProgramCd().equalsIgnoreCase("FS"))){
								//BRGUS00134324 - End
								bEdgFound = true;
								break;
							}
						}
					}
					iVoidLength = 0;
					if (aEgDataHandler.getEdEligibilityCargoVrecords() != null) {
						iVoidLength = aEgDataHandler
								.getEdEligibilityCargoVrecords().length;
					}
					for (int k = 0; k < iVoidLength; k++) {
						if (edVCLCargoTemp.getEdgNum() == aEgDataHandler
								.getEdEligibilityCargoVrecords()[k].getEdgNum()) {
							if (aEgDataHandler.getEdEligibilityCargoVrecords()[k]
									.getCgEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
								bEdgFound = true;
								break;
							}
						}
					}
					if (bEdgFound == false) {
						edVCLCargoTemp.setVoidSw(IEdEligCodes.VOID_SW_YES);
					}
				}
				// commented for FS late certification changes
				//	if (edVCLCargoTemp.getValidSourceRcvDt() == null ||
				// (edVCLCargoTemp.getValidSourceRcvDt() != null &&
				// edVCLCargoTemp.getVoidSw() == IEdEligCodes.VOID_SW_YES)) {
				alTempVCL.add(edVCLCargoTemp);
				//	}
			}
			aEgDataHandler.setAlEdVerificationChecklistModApp(alTempVCL);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"checkVCLDueDtMakeVoid", ex.getMessage());
		}
	}

	/**
	 * This method checks each EdVerificationChecklistCargo for VCL_Due_Dt and
	 * voids them.
	 *
	 * @param aEgDataHandler
	 *            us.nm.state.hsd.aspen.business.rules.ed.EgDataHandler
	 * @throws EDBCException
	 */
	public void checkVCLDueDtMakeVoidPgmBased(EgDataHandler aEgDataHandler)
			throws EDBCException {
		try {
			int iVerChkList = 0;
			if (aEgDataHandler.getEdVerificationChecklistCargo() != null) {
				iVerChkList = aEgDataHandler.getEdVerificationChecklistCargo().length;
			}
			ArrayList alTempVCL = null;
			alTempVCL = new ArrayList();
			EdVerificationChecklistCargo edVCLCargoTemp = null;
			boolean bEdgFound = false;
			int iProcLength = 0;
			int iVoidLength = 0;
			for (int j = 0; j < iVerChkList; j++) {
				edVCLCargoTemp = (EdVerificationChecklistCargo) aEgDataHandler
						.getEdVerificationChecklistCargo()[j].clone();
				if (edVCLCargoTemp.getVclRequestDt() == null) {
					bEdgFound = false;
					iProcLength = 0;
					if (aEgDataHandler.getEdEligibilityCargoProcessed() != null) {
						iProcLength = aEgDataHandler
								.getEdEligibilityCargoProcessed().length;
					}
					for (int k = 0; k < iProcLength; k++) {
						if (edVCLCargoTemp
								.getProgramCd()
								.equalsIgnoreCase(
										aEgDataHandler
												.getEdEligibilityCargoProcessed()[k]
												.getProgramCd())) {
							if (aEgDataHandler.getEdEligibilityCargoProcessed()[k]
									.getCgEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
								bEdgFound = true;
								break;
							}
						}
					}
					iVoidLength = 0;
					if (aEgDataHandler.getEdEligibilityCargoVrecords() != null) {
						iVoidLength = aEgDataHandler
								.getEdEligibilityCargoVrecords().length;
					}
					for (int k = 0; k < iVoidLength; k++) {
						if (edVCLCargoTemp
								.getProgramCd()
								.equalsIgnoreCase(
										aEgDataHandler
												.getEdEligibilityCargoVrecords()[k]
												.getProgramCd())) {
							if (aEgDataHandler.getEdEligibilityCargoVrecords()[k]
									.getCgEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
								bEdgFound = true;
								break;
							}
						}
					}
					if (bEdgFound == false) {
						edVCLCargoTemp.setVoidSw(IEdEligCodes.VOID_SW_YES);
					}
				}
				// commented for FS late certification changes
				//	if (edVCLCargoTemp.getValidSourceRcvDt() == null ||
				// (edVCLCargoTemp.getValidSourceRcvDt() != null &&
				// edVCLCargoTemp.getVoidSw() == IEdEligCodes.VOID_SW_YES)) {
				alTempVCL.add(edVCLCargoTemp);
				//	}
			}
			aEgDataHandler.setEdVerificationChecklistModAppPgmBased(alTempVCL);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"checkVCLDueDtMakeVoidPgmBased", ex.getMessage());
		}
	}

	/**
	 * This method filters EdVerificationChecklistModApp arraylist and creates
	 * EdVerificationChecklistFiltered arraylist.
	 *
	 * @param aEgDataHandler
	 *            contains the EgDataHandler
	 * @param aLEdgNum
	 *            contains the EDG number
	 * @param aBVCLFilterFlag
	 *            contains the VCL filter switch
	 * @param bNFModuleFlg
	 *            contains the non-fin module switch
	 * @throws EDBCException
	 */
	
	public void detEdVerificationChecklistFiltered(
			EgDataHandler aEgDataHandler, long aLEdgNum,
			boolean aBVCLFilterFlag, boolean bNFModuleFlg) throws EDBCException {
		try {
			ArrayList alTemp = new ArrayList();

			//Added for FS Late Certification - vcl changes
			Timestamp tsRecertReviewDueDt = null;
			EdEligibilityCargo edEligCargo = null;
			EdCaseRecertDatesCargo[] arrEdCaseRecert = null;
			EligDetail aEligUnauthCurEdm = aEgDataHandler
					.getEligDetailUnAuthCurrEDM();
			if (aEligUnauthCurEdm != null) {
				edEligCargo = aEligUnauthCurEdm.getEdEligibilityCargo()[0];
				arrEdCaseRecert = aEligUnauthCurEdm.getEdCaseRecertDatesCargo();
			}

			//Added for FS Late Certification - vcl changes
			if (edEligCargo != null) {
				if (arrEdCaseRecert != null) {
					int iEdCaseRecertLength = arrEdCaseRecert.length;
					for (int i = 0; i < iEdCaseRecertLength; i++) {
						if (arrEdCaseRecert[i].getProgramCd().equalsIgnoreCase(
								edEligCargo.getProgramCd())) {
							if (arrEdCaseRecert[i].getRecertReviewDueDt() != null) {
								tsRecertReviewDueDt = arrEdCaseRecert[i]
										.getRecertReviewDueDt();
							}
						}
					}
				}
			}

			EdVerificationChecklistCargo edVCLTemp = null;
			if (aEgDataHandler.getAlEdVerificationChecklistModApp() != null) {
				Iterator alIterator = aEgDataHandler
						.getAlEdVerificationChecklistModApp().iterator();
				while (alIterator.hasNext()) {
					edVCLTemp = (EdVerificationChecklistCargo) alIterator
							.next();
					//					if (aBVCLFilterFlag != true) {
					//Added for defect 192029
					if (bNFModuleFlg == true) {
						if ((edVCLTemp.getVoidSw() == IEdEligCodes.VOID_SW_NO || edVCLTemp
								.getVoidSw() == IEdEligCodes.VOID_SW_P)
								//Added condtion to include vcl rec with
								// validsourcereceive date or if the case is not
								// disposed
								// CCB 150549
								&& (edVCLTemp.getValidSourceRcvDt() == null)
								//BRGUS00134324 - Bhuvane - Adding Delete by supervisor indicator check
								&& (edVCLTemp.getDeleteBySupervisorInd() == 'P')
								&& edVCLTemp.getEdgNum() == aLEdgNum) {
							alIterator.remove();
							alTemp.add(edVCLTemp);
						}
					} else {
						if ((edVCLTemp.getVoidSw() == IEdEligCodes.VOID_SW_NO || edVCLTemp
								.getVoidSw() == IEdEligCodes.VOID_SW_P)
								//Added condtion to include vcl rec with
								// validsourcereceive date or if the case is not
								// disposed
								// CCB 150549
								//BRGUS00134324 - Bhuvane - Adding delete by supervisor indicator check
								/*&& (edVCLTemp.getValidSourceRcvDt() == null || (edVCLTemp
										.getValidSourceRcvDt() != null && edVCLTemp
										.getDispositionDt() == null))*/
								&& (edVCLTemp.getDeleteBySupervisorInd() == 'P')
								&& edVCLTemp.getEdgNum() == aLEdgNum) {
							alIterator.remove();
							alTemp.add(edVCLTemp);
						}
					}
					//Commented FS Late Certification changes for CCB 150549
					/*
					 * else { //Added for FS Late Certification
					 * if(aEgDataHandler.getValidForVclSw() == true) {
					 * if(edEligCargo != null) {
					 * if(edEligCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS) &&
					 * edVCLTemp.getValidSourceRcvDt() != null &&
					 * tsRecertReviewDueDt != null) { if(edVCLTemp.getEdgNum() ==
					 * aLEdgNum) {
					 * if(DateComparisons.dateGTDateInTimestamp(edEligCargo.getPaymentBegDt(),
					 * tsRecertReviewDueDt)) { alIterator.remove();
					 * alTemp.add(edVCLTemp); } }
					 *  } } }
					 *
					 *  }
					 */
					/*
					 * } else { if (edVCLTemp.getVoidSw() ==
					 * IEdEligCodes.VOID_SW_NO) { alIterator.remove();
					 * alTemp.add(edVCLTemp); } }
					 */
				}
				aEgDataHandler.setAlEdVerificationChecklistFiltered(alTemp);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"detEdVerificationChecklistFiltered", ex.getMessage());
		}
	}

	/**
	 * This method filters EdVerificationChecklistModApp arraylist and creates
	 * EdVerificationChecklistFiltered arraylist.
	 *
	 * @param aEgDataHandler
	 *            contains the EgDataHandler
	 * @param sPgmCd
	 *            contains the program code
	 * @param aBVCLFilterFlag
	 *            contains the VLC filter flag
	 * @param bNFModuleFlg
	 *            contains the Non-Fiin module switch
	 * @throws EDBCException
	 */
	
	public void detEdVerificationChecklistFiltered(
			EgDataHandler aEgDataHandler, String sPgmCd,
			boolean aBVCLFilterFlag, boolean bNFModuleFlg) throws EDBCException {
		ArrayList alTemp = new ArrayList();
		try {
			//Added for FS Late Certification - vcl changes
			Timestamp tsRecertReviewDueDt = null;
			EdEligibilityCargo edEligCargo = null;
			EdCaseRecertDatesCargo[] arrEdCaseRecert = null;
			EligDetail aEligUnauthCurEdm = aEgDataHandler
					.getEligDetailUnAuthCurrEDM();
			if (aEligUnauthCurEdm != null) {
				edEligCargo = aEligUnauthCurEdm.getEdEligibilityCargo()[0];
				arrEdCaseRecert = aEligUnauthCurEdm.getEdCaseRecertDatesCargo();
			}

			//Added for FS Late Certification - vcl changes
			if (edEligCargo != null) {
				if (arrEdCaseRecert != null) {
					int iEdCaseRecertLength = arrEdCaseRecert.length;
					for (int i = 0; i < iEdCaseRecertLength; i++) {
						if (arrEdCaseRecert[i].getProgramCd().equalsIgnoreCase(
								edEligCargo.getProgramCd())) {
							if (arrEdCaseRecert[i].getRecertReviewDueDt() != null) {
								tsRecertReviewDueDt = arrEdCaseRecert[i]
										.getRecertReviewDueDt();
							}
						}
					}
				}
			}

			EdVerificationChecklistCargo edVCLTemp = null;
			if (aEgDataHandler.getEdVerificationChecklistModAppPgmBased() != null) {
				Iterator alIterator = aEgDataHandler
						.getEdVerificationChecklistModAppPgmBased().iterator();
				while (alIterator.hasNext()) {
					edVCLTemp = (EdVerificationChecklistCargo) alIterator
							.next();
					if (bNFModuleFlg == true) {
						if ((edVCLTemp.getVoidSw() == IEdEligCodes.VOID_SW_NO || edVCLTemp
								.getVoidSw() == IEdEligCodes.VOID_SW_P)
								&& (edVCLTemp.getValidSourceRcvDt() == null)
								&& ((edVCLTemp.getProgramCd().equals(sPgmCd)) || ((edVCLTemp
										.getProgramCd().equals("MA"))
										&& sPgmCd.equals("ME") || sPgmCd
										.equals("MC")))) {
							// modified for BRGUS00092096
							//alIterator.remove();
							alTemp.add(edVCLTemp);
						}
					} else {
						if ((edVCLTemp.getVoidSw() == IEdEligCodes.VOID_SW_NO || edVCLTemp
								.getVoidSw() == IEdEligCodes.VOID_SW_P)
								&& (edVCLTemp.getValidSourceRcvDt() == null || (edVCLTemp
										.getValidSourceRcvDt() != null && edVCLTemp
										.getDispositionDt() == null))
								&& ((edVCLTemp.getProgramCd().equals(sPgmCd)) || ((edVCLTemp
										.getProgramCd().equals("MA"))
										&& sPgmCd.equals("ME") || sPgmCd
										.equals("MC")))) {
							//modified for BRGUS00092096
							//alIterator.remove();
							alTemp.add(edVCLTemp);
						}
					}
				}
				aEgDataHandler
						.setAlEdVerificationChecklistFilteredPgmBased(alTemp);

			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MINOR, "EdUtil",
					"detEdVerificationChecklistFiltered", ex.getMessage());
		}

	}

	/**
	 * Method validRecordForPrevMth, determines whether it is valid record for
	 * previous (previous Payment Beg Date) month.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return EligDetail
	 * @throws EDBCException
	 */
	public EligDetail validRecordForPrevMth(EligDetail[] aArrEligDetailOutput,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		EligDetail eligDetailPrevMth = null;
		int iLength = 0;
		if (!aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("CD")) {
			Timestamp tsPayBegDtLastMth = DateComparisons.subMonths(
					aEdEligibilityCargo.getPaymentBegDt(), 1);
			iLength = aArrEligDetailOutput.length;
			for (int k = 0; k < iLength; k++) {
				if (aArrEligDetailOutput[k] != null) {
					if (aArrEligDetailOutput[k].getEdEligibilityCargo()[0]
							.getEdgNum() == aEdEligibilityCargo.getEdgNum()) {
						if (aArrEligDetailOutput[k].getEdEligibilityCargo()[0]
								.getPaymentBegDt().before(
										aEdEligibilityCargo.getPaymentBegDt())
								&& ((aArrEligDetailOutput[k]
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt() != null) && ((aArrEligDetailOutput[k]
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt().after(
												tsPayBegDtLastMth) || aArrEligDetailOutput[k]
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt().equals(
												tsPayBegDtLastMth))))) {
							eligDetailPrevMth = aArrEligDetailOutput[k];
							break;
						}
					}
				}
			}
		} else {// If program code is CD
			Timestamp tsPrevPayEndDate = DateComparisons.subDays(
					aEdEligibilityCargo.getPaymentBegDt(), 1);
			iLength = aArrEligDetailOutput.length;
			for (int k = 0; k < iLength; k++) {
				if (aArrEligDetailOutput[k] != null) {
					if (aArrEligDetailOutput[k].getEdEligibilityCargo()[0]
							.getEdgNum() == aEdEligibilityCargo.getEdgNum()) {
						if (aArrEligDetailOutput[k].getEdEligibilityCargo()[0]
								.getPaymentEndDt() != null) {
							if (DateComparisons.dateEqualsDateInTimestamp(
									aArrEligDetailOutput[k]
											.getEdEligibilityCargo()[0]
											.getPaymentEndDt(),
									tsPrevPayEndDate)) {
								eligDetailPrevMth = aArrEligDetailOutput[k];
								break;
							}
						}
					}
				}
			}
		}
		return eligDetailPrevMth;
	}


	/**This method is used to retrieve the previoius V record for 
	 * the current eligibility cargo.
	 * 
	 * @param edEligibilityVRecords contains all the previous V records
	 * @param aEdEligibilityCargo contains current EdEligibilityCargo
	 * @return contains the previous V record for current cargo
	 * @throws EDBCException
	 */
	
	public EdEligibilityCargo getPreviousVRecord(
			EdEligibilityCargo[] edEligibilityVRecords,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		EdEligibilityCargo edEligibilityCargoV = null;
		int iLength = 0;
		if (!aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("CD")) {
			Timestamp tsPayBegDtLastMth = DateComparisons.subMonths(
					aEdEligibilityCargo.getPaymentBegDt(), 1);
			if (edEligibilityVRecords != null) {
				iLength = edEligibilityVRecords.length;
			}
			for (int k = 0; k < iLength; k++) {
				if (edEligibilityVRecords[k] != null) {
					if (edEligibilityVRecords[k].getEdgNum() == aEdEligibilityCargo
							.getEdgNum()) {
						if (edEligibilityVRecords[k].getPaymentBegDt().before(
								aEdEligibilityCargo.getPaymentBegDt())
								&& ((edEligibilityVRecords[k].getPaymentEndDt() != null) && ((edEligibilityVRecords[k]
										.getPaymentEndDt().after(
												tsPayBegDtLastMth) || edEligibilityVRecords[k]
										.getPaymentEndDt().equals(
												tsPayBegDtLastMth))))) {
							edEligibilityCargoV = edEligibilityVRecords[k];
							break;
						}
					}
				}
			}
		} else {// If program code is CD
			Timestamp tsPrevPayEndDate = DateComparisons.subDays(
					aEdEligibilityCargo.getPaymentBegDt(), 1);
			if (edEligibilityVRecords != null) {
				iLength = edEligibilityVRecords.length;
			}
			for (int k = 0; k < iLength; k++) {
				if (edEligibilityVRecords[k] != null) {
					if (edEligibilityVRecords[k].getEdgNum() == aEdEligibilityCargo
							.getEdgNum()) {
						if (edEligibilityVRecords[k].getPaymentEndDt() != null) {
							if (DateComparisons.dateEqualsDateInTimestamp(
									edEligibilityVRecords[k].getPaymentEndDt(),
									tsPrevPayEndDate)) {
								edEligibilityCargoV = edEligibilityVRecords[k];
								break;
							}
						}
					}
				}
			}
		}
		return edEligibilityCargoV;
	}

	//BEGIN-BRGUS00208572-upadhyayulag-New method added
	/**This method is used to retrieve the EdIndvEligibility 
	 * records for the given eligibility cargo trace id.
	 * 
	 * @param edIndvEligibilityRecords contains the array of EdIndvEligibilityCargo
	 * @param edEligibilityCargo contains given EdEligibilityCargo
	 * @return contains the array of EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	
	public EdIndvEligibilityCargo[] getEdIndvEligibilityByTraceId(
			EdIndvEligibilityCargo[] edIndvEligibilityRecords,
			EdEligibilityCargo edEligibilityCargo) throws EDBCException {
		EdIndvEligibilityCargo[] edIndvEligibilityCargo = null;
		ArrayList edIndvEligibility = new ArrayList();
		int iLength = 0;
		if(edIndvEligibilityRecords != null && edIndvEligibilityRecords.length > 0){
			iLength = edIndvEligibilityRecords.length;
		}
		if (edEligibilityCargo != null) {
			for (int i = 0; i < iLength; i++) {
				if(edEligibilityCargo.getEdgTraceId() == edIndvEligibilityRecords[i].getEdgTraceId()){
					edIndvEligibility.add(edIndvEligibilityRecords[i]);
				}
			}
		}
		if(edIndvEligibility.size() > 0){
			int edIndvEligibilitySize = edIndvEligibility.size();
			edIndvEligibilityCargo = new EdIndvEligibilityCargo[edIndvEligibilitySize];
			for (int j = 0; j < edIndvEligibilitySize; j++) {
				edIndvEligibilityCargo[j] = (EdIndvEligibilityCargo)edIndvEligibility.get(j);
			}
		}
		return edIndvEligibilityCargo;
	}
	//END-BRGUS00208572
	
	/**
	 * Method adjustVerificationCheckList.
	 *
	 * @param aAlEdVerificationCheckListCargo
	 *            ArrayList
	 * @param aEligDetailOutput
	 *            EligDetail
	 * @throws EDBCException
	 */
	public void adjustVerificationCheckList(
			ArrayList aAlEdVerificationCheckListCargo,
			EligDetail aEligDetailOutput) throws EDBCException {
		boolean bVCLFoundFlag = false;
		int iLength = 0;
		iLength = aEligDetailOutput.getEdEligibilityCargo().length;
		Iterator itVCL = null;
		EdVerificationChecklistCargo edVCLTemp = null;
		Timestamp tsPayBegDtLastDayOfMth = null;
		for (int i = 0; i < iLength; i++) {
			itVCL = aAlEdVerificationCheckListCargo.iterator();
			while (itVCL.hasNext()) {
				edVCLTemp = (EdVerificationChecklistCargo) itVCL.next();
				if (aEligDetailOutput.getEdEligibilityCargo()[i].getEdgNum() == edVCLTemp
						.getEdgNum()) {
					//Column RiskLevelCd deleted
					//if
					// (aEligDetailOutput.getEdEligibilityCargo()[i].getRiskLevelCd()
					// == IEdEligCodes.RISK_LEVEL_LOW) {
					if (edVCLTemp.getVclRiskLevelCd() == IEdEligCodes.RISK_LEVEL_HIGH
							|| edVCLTemp.getVclRiskLevelCd() == IEdEligCodes.RISK_LEVEL_MEDIUM) {
						//Added for defect 111744
						if (!edVCLTemp.getVclDetailRef().startsWith(
								IEdEligCodes.CASE_PROFILE)) {
							edVCLTemp.setVoidSw(IEdEligCodes.VOID_SW_YES);
						}
					}
					//} else if
					// (aEligDetailOutput.getEdEligibilityCargo()[i].getRiskLevelCd()
					// == IEdEligCodes.RISK_LEVEL_MEDIUM) {
					if (edVCLTemp.getVclRiskLevelCd() == IEdEligCodes.RISK_LEVEL_HIGH) {
						edVCLTemp.setVoidSw(IEdEligCodes.VOID_SW_YES);
					}
					//}
				}
			}
			itVCL = aAlEdVerificationCheckListCargo.iterator();
			while (itVCL.hasNext()) {
				edVCLTemp = (EdVerificationChecklistCargo) itVCL.next();
				if (aEligDetailOutput.getEdEligibilityCargo()[i].getEdgNum() == edVCLTemp
						.getEdgNum()) {
					if (aEligDetailOutput.getEdEligibilityCargo()[i]
							.getVerificationStatusCd()
							.equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {   
						if (edVCLTemp.getVoidSw() == IEdEligCodes.VOID_SW_NO) {
							tsPayBegDtLastDayOfMth = DateComparisons
									.getLastDayOfDate(aEligDetailOutput
											.getEdEligibilityCargo()[i]
											.getPaymentBegDt());
							if (edVCLTemp.getDcRecBegDt().before(
									tsPayBegDtLastDayOfMth)
									|| edVCLTemp.getDcRecBegDt().equals(
											tsPayBegDtLastDayOfMth)) {
								if ((edVCLTemp.getDcRecEndDt() == null || (edVCLTemp
										.getDcRecEndDt()
										.after(
												aEligDetailOutput
														.getEdEligibilityCargo()[i]
														.getPaymentBegDt()) || edVCLTemp
										.getDcRecEndDt()
										.equals(
												aEligDetailOutput
														.getEdEligibilityCargo()[i]
														.getPaymentBegDt())))) {
									//added for defect 165959
									if (edVCLTemp.getValidSourceRcvDt() == null) {
										bVCLFoundFlag = true;
										break;
									}
								}
							}
						}
					}
				}
			}
			if (bVCLFoundFlag == false
					&& aEligDetailOutput.getEdEligibilityCargo()[i]
							.getVerificationStatusCd()
							.equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {
				aEligDetailOutput.getEdEligibilityCargo()[i]
						.setVerificationStatusCd(IEdEligCodes.VERIFICATION_STATUS_CD_PASS);
			}
		}
	}

	/**
	 * Method detRequestDtForProgCd.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aProgCd
	 *            String
	 * @throws EDBCException
	 */
	public void detRequestDtForProgCd(EgDataHandler aEgDataHandler,
			String aProgCd) throws EDBCException {
		int iLength = 0;
		iLength = aEgDataHandler.getDcCaseProgramCargo().length;
		for (int i = 0; i < iLength; i++) {
			if (aEgDataHandler.getDcCaseProgramCargo()[i].getProgCd().equals(
					aProgCd)) {
				/*
				 * NFUtil.tsRequestDt =
				 * aEgDataHandler.getDcCaseProgramCargo()[i].getRequestDt();
				 * ResourceUtil.tsRequestDt =
				 * aEgDataHandler.getDcCaseProgramCargo()[i].getRequestDt();
				 * FinUtil.tsRequestDt =
				 * aEgDataHandler.getDcCaseProgramCargo()[i].getRequestDt();
				 */
				aEgDataHandler.setRequestDt(aEgDataHandler
						.getDcCaseProgramCargo()[i].getRequestDt());
				break;
			}
		}
	}

	/**
	 * Method populateHMTPCodes.
	 *
	 * @return HashMap
	 */
	public HashMap populateHMTPCodes() {
		HashMap hmTemp = new HashMap();
		hmTemp.put(IEdEligCodes.TP31, IEdEligCodes.TP31);
		hmTemp.put(IEdEligCodes.TP32, IEdEligCodes.TP32);
		hmTemp.put(IEdEligCodes.TP33, IEdEligCodes.TP33);
		hmTemp.put(IEdEligCodes.TP34, IEdEligCodes.TP34);
		hmTemp.put(IEdEligCodes.TP35, IEdEligCodes.TP35);
		hmTemp.put(IEdEligCodes.TP36, IEdEligCodes.TP36);
		//Added for Defect # 00205978 on 12/10/2004
		hmTemp.put(IEdEligCodes.TP_30, IEdEligCodes.TP_30);
		// CCB 126975
		hmTemp.put(IEdEligCodes.TA31, IEdEligCodes.TA31);

		return hmTemp;
	}

	/**
	 * Method detPreStrikeDt, determine pre strike dates.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @param aArrDcEmploymentCargo
	 *            DcEmploymentCargo[]
	 * @return Timestamp
	 * @throws EDBCException
	 */
	public static Timestamp detPreStrikeDt(EligDetail aEligDetail,
			DcEmploymentCargo[] aArrDcEmploymentCargo) throws EDBCException {
		Timestamp tsPreStrikeDt = null;
		int iEmpLength = 0;
		if (aEligDetail.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)) {
			int iLength = 0;
			iLength = aEligDetail.getEdIndvEligibilityCargo().length;
			for (int i = 0; i < iLength; i++) {
				if (aEligDetail.getEdIndvEligibilityCargo()[i].getStrikerSw() == IEdEligCodes.STRIKER_SW_YES) {
					iEmpLength = 0;
					if (aArrDcEmploymentCargo != null) {
						iEmpLength = aArrDcEmploymentCargo.length;
					}
					for (int j = 0; j < iEmpLength; j++) {
						if (aEligDetail.getEdIndvEligibilityCargo()[i]
								.getIndvId() == aArrDcEmploymentCargo[j]
								.getIndvId()) {
							tsPreStrikeDt = DateComparisons
									.subDays(aArrDcEmploymentCargo[j]
											.getStrikeBeginDt(), 1);
							break;
						}
					}
					break;
				}
			}
		}
		return tsPreStrikeDt;
	}

	/**
	 * performEDBC method performs EDBC method used to call the Rules Engine
	 * based on the program selected.
	 *
	 * @param aMapRequest
	 *            java.util.Map[]
	 * @throws ApplicationException
	 * @throws FrameworkException
	 */

	public void rebuildEDG(java.util.Map aMapRequest)
			throws ApplicationException, FrameworkException {
		//call the EgManager
		IEgManager iEgMan = EgDriverFactory.getEDGDriver();
		String sessID = (String)aMapRequest.get(IEdEligCodes.SESSION_ID);
		//Timestamp[] tsInput = new Timestamp[2];
		try {
			FwTimer tg = new FwTimer();
			setTimer(tg,aMapRequest,sessID);
			iEgMan.execute(aMapRequest);
			String currentEdgRunCount = (String)aMapRequest.get(IEdEligCodes.RUN_EDG_MONTHS);
			String methodName = "performEDBCNRFV" + "_" + "Edg" + "(" + currentEdgRunCount + ")";
			String pageId = (String)aMapRequest.get(TIERSConstants.PAGE);
			if(sessID != null){
				reportTime(tg,pageId,methodName);
			}
		} catch (TIERSValidationException e) {
				EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			Debug.println("TiersValidationException = " + e);
			throw e;
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getMessage());
		}
	}

	/**
	 * Method performRM, perform Risk Module.
	 *
	 * @param aMap
	 *            Map
	 * @return boolean
	 * @throws ApplicationException
	 * @throws FrameworkException
	 * @throws SQLException
	 */
	public boolean performRM(Map aMap) throws ApplicationException,
			FrameworkException, SQLException {
		long aLCaseNum = ((Long) aMap.get(IEdEligCodes.REQUEST_CASE_NUM))
				.longValue();
		String aSUserId = (String) aMap.get(IEdEligCodes.SESSION_USER_ID);
		Connection conn = (Connection) aMap
				.get(IEdEligCodes.REQUEST_CONNECTION);

		Object obj = aMap.get("CaseModeCd");
		String sMode = "";
		if (obj != null) {
			sMode = (String) obj;
		}

		EgDataHandler egDataHandler = new EgDataHandler();
		try {
			egDataHandler.loadEligDetailForRM(aLCaseNum, conn);
			int iEdEligLength = 0;
			if (egDataHandler.getEligDetailForRM().getEdEligibilityCargo() != null) {
				iEdEligLength = egDataHandler.getEligDetailForRM()
						.getEdEligibilityCargo().length;
			}
			if (iEdEligLength == 0) {
				if (sMode.equalsIgnoreCase(EDGConstants.PROVIDER_PAYMENT)) {
					providerPaymentException();
				} else {
					ArrayList alError = new ArrayList();
					ArrayList alPlaces = new ArrayList();
					alError.add(IEdEligCodes.EC_NO_RECORDS_FOUND);
					throw new TIERSValidationException(alError, alPlaces);
				}
			}
			int iEdRiskLength = 0;
			int iVCLLength = 0;
			for (int j = 0; j < iEdEligLength; j++) {
				if ((egDataHandler.getEligDetailForRM().getEdEligibilityCargo()[j]
						.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS))
						|| (egDataHandler.getEligDetailForRM()
								.getEdEligibilityCargo()[j].getProgramCd()
								.equals(IEdEligCodes.PROGRAM_CD_TANF))) {
					iEdRiskLength = 0;
					/*
					 * //CQ 2037: Table deleted if
					 * (egDataHandler.getEligDetailForRM().getEdRiskScoreCargo() !=
					 * null) { iEdRiskLength =
					 * egDataHandler.getEligDetailForRM().getEdRiskScoreCargo().length; }
					 * for (int k = 0; k < iEdRiskLength; k++) { if
					 * (egDataHandler.getEligDetailForRM().getEdEligibilityCargo()[j].getEdgNum() ==
					 * egDataHandler.getEligDetailForRM().getEdRiskScoreCargo()[k].getEdgNum()) {
					 * if
					 * (egDataHandler.getEligDetailForRM().getEdRiskScoreCargo()[k].getOverrideRiskLevelCd() !=
					 * IEdEligCodes.CHAR_INIT_SPACE) {
					 * egDataHandler.getEligDetailForRM().getEdEligibilityCargo()[j].setRiskLevelCd(egDataHandler.getEligDetailForRM().getEdRiskScoreCargo()[k].getOverrideRiskLevelCd()); }
					 * else {
					 * egDataHandler.getEligDetailForRM().getEdEligibilityCargo()[j].setRiskLevelCd(egDataHandler.getEligDetailForRM().getEdRiskScoreCargo()[k].getRiskLevelCd()); } } }
					 */
					ArrayList alVCLForRM = new ArrayList();
					;
					iVCLLength = 0;
					if (egDataHandler.getEligDetailForRM()
							.getEdVerificationChecklistCargo() != null) {
						iVCLLength = egDataHandler.getEligDetailForRM()
								.getEdVerificationChecklistCargo().length;
					}
					for (int l = 0; l < iVCLLength; l++) {
						alVCLForRM.add(egDataHandler.getEligDetailForRM()
								.getEdVerificationChecklistCargo()[l]);
					}
					adjustVerificationCheckList(alVCLForRM, egDataHandler
							.getEligDetailForRM());
				}
			}

			int iLengthVCL = 0;
			if (egDataHandler.getEligDetailForRM()
					.getEdVerificationChecklistCargo() != null) {
				iLengthVCL = egDataHandler.getEligDetailForRM()
						.getEdVerificationChecklistCargo().length;
			}
			boolean bIssuedTrigger = false;
			// ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
			boolean vclType = false ;
			EdVerificationChecklistCargo cargo = null;
			for (int m = 0; m < iLengthVCL; m++) {
				cargo = egDataHandler.getEligDetailForRM()
						.getEdVerificationChecklistCargo()[m];
				//Modfied for defect 119517
				//		       		if (cargo.getVclDueDt() == null && cargo.getVoidSw() ==
				// IEdEligCodes.NO) {
				//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
				if(cargo.getVclTypeCd() != null && cargo.getVclTypeCd().equals("V515"))
				{
					vclType = true ;
				}
				if (cargo.getVclRequestDt() == null
						&& cargo.getVoidSw() == IEdEligCodes.NO
						&& cargo.getDeleteBySupervisorInd() == 'P') {
					bIssuedTrigger = true;
					//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
					issueCOTrigger(egDataHandler.getEligDetailForRM(),
							aSUserId,
							conn, bIssuedTrigger, egDataHandler
									.getDcCasesCargo(), aMap ,
									vclType);
					break;
				}
			}
			if (iLengthVCL > 0) {
				if (bIssuedTrigger == false) {
					//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
					issueCOTrigger(egDataHandler.getEligDetailForRM(), aSUserId,
							conn, bIssuedTrigger, egDataHandler
									.getDcCasesCargo(), aMap,
									vclType);
				}
			}

			//set the data using the datahandler
			egDataHandler.writeEligDetailForRM(egDataHandler, aSUserId, conn);
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		}
		return true;
	}

	/**
	 * Method performVCL, perform Verification Check List.
	 *
	 * @param eligDetailOutput
	 *            contains the output EligDetail
	 * @param eligDetailInput
	 *            contains the input EligDetail
	 * @param egDataHandler
	 *            contains the EgDataHandler
	 * @param finDataHandler
	 *            contains the FinDataHandler
	 * @param resDataHandler
	 *            contains the ResourceDataHandler
	 * @param nfDataHandler
	 *            contains the NFDataHandler
	 * @param serDataHandler
	 *            contains the SerDataHandler
	 * @param dssDataHandler
	 *            contains the DSSDataHandler
	 * @param arrEligDetailOutput
	 *            contains the output arry of EligDetail
	 * @param arrEligDetailInput
	 *            contains the input array of EligDetail
	 * @param conn connection object
	 * @param aMapRequest Map
	 * @throws EDBCException
	 * @throws RulesException
	 */
// BRGUS00224287 rampurkara passing connection object	
	//BRGUS00084723 - bhuvane - adding ed output tables in vcl parameter
	public void performVCL(EligDetail eligDetailOutput,
			EligDetail eligDetailInput, EgDataHandler egDataHandler,
			FinDataHandler finDataHandler, ResourceDataHandler resDataHandler,
			NFDataHandler nfDataHandler, SerDataHandler serDataHandler,
			DSSDataHandler dssDataHandler,EligDetail[] arrEligDetailOutput,EligDetail[] arrEligDetailInput, Connection conn,Map aMapRequest) throws EDBCException, RulesException {
		//		boolean bVCLChangedRecords = true;
// endof BRGUS00224287		
		boolean bVCLFilterFlag = true;
		VCLManager vclManagerObj;
		String rulesEngineVCL = FwPropertyLoader.getPropertyOf(GenericConstants.TIERS_PROPERTIES_NAME, GenericConstants.RULES_ENGINE_VCL);
		if(rulesEngineVCL != null && GenericConstants.CORTICON_RULES_ENGINE.equalsIgnoreCase(rulesEngineVCL)) {
			vclManagerObj = new CorticonVCLManager();
		}
		else {
			vclManagerObj = new VCLManager();
		} 
		Timestamp tsAuthDt = null;
		//		HashMap hmTPCodes = populateHMTPCodes();
		//Modified based on defect 76088 - Made it to false from true
		egDataHandler.setVCLChangeRecord(false);
		//Fs Late certification
		egDataHandler.setValidForVclSw(true);
		//		if
		// (!hmTPCodes.containsKey(eligDetailOutput.getEdEligibilityCargo()[0].getTypeOfAssistanceCd()))
		// {
		/*
		 * if
		 * (!(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getNfEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) &&
		 * !(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getRscEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) &&
		 * !(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getFinEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
		 */
		if (eligDetailOutput.getEdEligibilityCargo()[0].getActivityType()
				.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)
				|| eligDetailOutput.getEdEligibilityCargo()[0]
						.getActivityType().equals(
								IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
			//				bVCLChangedRecords = false;
			egDataHandler.setVCLChangeRecord(false);
			bVCLFilterFlag = false;
			//Added for defect 192029
			detEdVerificationChecklistFiltered(egDataHandler, eligDetailOutput
					.getEdEligibilityCargo()[0].getEdgNum(), bVCLFilterFlag,
					false);
			//Added in the VCL process ie moved from the general process to
			// here for defect 227929
			//Added for Defect 206710 on 5/23/2005
			detEdVerificationChecklistFiltered(egDataHandler, eligDetailOutput
					.getEdEligibilityCargo()[0].getProgramCd(), bVCLFilterFlag,
					false);
			//Commented due to FindBugs Analysis
			//eligDetailOutput = vclManagerObj.doProcess(eligDetailOutput,
			// eligDetailInput, nfDataHandler, resDataHandler, finDataHandler,
			// egDataHandler);
			//BRGUS00084723 - bhuvane - adding ed output tables in vcl parameter
			// BRGUS00224287 rampurkara passing connection object
			vclManagerObj.doProcess(eligDetailOutput, eligDetailInput,
					nfDataHandler, resDataHandler, finDataHandler,
					egDataHandler, serDataHandler, dssDataHandler,arrEligDetailOutput,arrEligDetailInput,conn,aMapRequest);
		} else {
			int iAuthLength = 0;
			if (eligDetailInput.getEdEligibilityCargo() != null) {
				iAuthLength = eligDetailInput.getEdEligibilityCargo().length;
			}
			for (int j = 0; j < iAuthLength; j++) {
				if (eligDetailInput.getEdEligibilityCargo()[j].getEdgNum() == eligDetailOutput
						.getEdEligibilityCargo()[0].getEdgNum()) {
					if (eligDetailInput.getEdEligibilityCargo()[j]
							.getRecEndDt() == null) {
						tsAuthDt = eligDetailInput.getEdEligibilityCargo()[j]
								.getEdbcRunDt();
					} else {
						if (eligDetailInput.getEdEligibilityCargo()[j]
								.getVerificationStatusCd() != null
								&& (!eligDetailInput.getEdEligibilityCargo()[j]
										.getVerificationStatusCd()
										.equals(
												IEdEligCodes.VERIFICATION_STATUS_CD_PENDING))) {
							tsAuthDt = eligDetailInput.getEdEligibilityCargo()[j]
									.getEdbcRunDt();
						}
					}
				}
			}
			egDataHandler.setAuthDt(tsAuthDt);
			if (tsAuthDt == null) {
				//bVCLChangedRecords = false;
				egDataHandler.setVCLChangeRecord(false);
			}
			//Added for defect 192029
			detEdVerificationChecklistFiltered(egDataHandler, eligDetailOutput
					.getEdEligibilityCargo()[0].getEdgNum(), bVCLFilterFlag,
					false);
			//Added in the VCL process ie moved from the general process to
			// here for defect 227929
			//Added for Defect 206710 on 5/23/2005
			detEdVerificationChecklistFiltered(egDataHandler, eligDetailOutput
					.getEdEligibilityCargo()[0].getProgramCd(), bVCLFilterFlag,
					false);
			//Commented due to FindBugs Analysis
			//eligDetailOutput =
			// vclManagerObj.doProcess(eligDetailOutput,eligDetailInput,
			// nfDataHandler, resDataHandler, finDataHandler, egDataHandler);
			//BRGUS00084723 - bhuvane - adding ed output tables in vcl parameter
// BRGUS00224287 rampurkara passing connection object			
			vclManagerObj.doProcess(eligDetailOutput, eligDetailInput,
					nfDataHandler, resDataHandler, finDataHandler,
					egDataHandler, serDataHandler, dssDataHandler,arrEligDetailOutput,arrEligDetailInput, conn,aMapRequest);
		}
// end of BRGUS00224287		
		//}
		if (egDataHandler.getAlEdVerificationChecklistFiltered() != null) {
			egDataHandler.getAlEdVerificationChecklistModApp().addAll(
					egDataHandler.getAlEdVerificationChecklistFiltered());
			egDataHandler.setAlEdVerificationChecklistFiltered(null);
		}
		//		}
		egDataHandler.setVCLChangeRecord(false);
		//Fs Late certification
		egDataHandler.setValidForVclSw(false);
	}

	/**
	 * Method performRMEDBC.
	 *
	 * @param aEligDetailOutput
	 *            EligDetail
	 * @param egDataHandler
	 *            EgDataHandler
	 * @param finDataHandler
	 *            FinDataHandler
	 * @param resDataHandler
	 *            ResourceDataHandler
	 * @param nfDataHandler
	 *            NFDataHandler
	 * @param rmDataHandler
	 *            RMDataHandler
	 * @throws EDBCException
	 * @throws RulesException
	 */
	public void performRMEDBC(EligDetail aEligDetailOutput,
			EgDataHandler egDataHandler, FinDataHandler finDataHandler,
			ResourceDataHandler resDataHandler, NFDataHandler nfDataHandler,
			RMDataHandler rmDataHandler) throws EDBCException, RulesException {
		if ((aEligDetailOutput.getEdEligibilityCargo()[0].getProgramCd()
				.equals(IEdEligCodes.PROGRAM_CD_FS))
				|| (aEligDetailOutput.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_TANF))) {
			if (aEligDetailOutput.getEdEligibilityCargo()[0].getActivityType()
					.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
				if (!aEligDetailOutput.getEdEligibilityCargo()[0]
						.getNfEligRsltCd().equals(
								IEdEligCodes.ELIG_RSLT_CD_FAIL)
						&& !aEligDetailOutput.getEdEligibilityCargo()[0]
								.getRscEligRsltCd().equals(
										IEdEligCodes.ELIG_RSLT_CD_FAIL)
						&& !aEligDetailOutput.getEdEligibilityCargo()[0]
								.getFinEligRsltCd().equals(
										IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (DateComparisons.getStringYYYYMM(
							aEligDetailOutput.getEdEligibilityCargo()[0]
									.getPaymentBegDt()).equals(
							DateComparisons
									.getStringYYYYMM(DateComparisons
											.addMonths(DateComparisons
													.getLocalesDate(), 1)))) {
						if (egDataHandler.getEligDetailPrevProc() != null
								&& (egDataHandler.getEligDetailPrevProc()
										.getEdEligibilityCargo()[0]
										.getNfEligRsltCd().equals(
												IEdEligCodes.ELIG_RSLT_CD_FAIL)
										|| egDataHandler
												.getEligDetailPrevProc()
												.getEdEligibilityCargo()[0]
												.getRscEligRsltCd()
												.equals(
														IEdEligCodes.ELIG_RSLT_CD_FAIL) || egDataHandler
										.getEligDetailPrevProc()
										.getEdEligibilityCargo()[0]
										.getFinEligRsltCd().equals(
												IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
							RMManager rmManagerObj = new RMManager();
							rmManagerObj.init();
							rmManagerObj.doProcess(aEligDetailOutput
									.getEdEligibilityCargo()[0],
									aEligDetailOutput, rmDataHandler,
									egDataHandler);
							egDataHandler.getRMUpdatedEdges().put(
									new Long(aEligDetailOutput
											.getEdEligibilityCargo()[0]
											.getEdgTraceId()),
									new Long(aEligDetailOutput
											.getEdEligibilityCargo()[0]
											.getEdgTraceId()));
							egDataHandler.setWriteRMSw(true);
						}
					} else if (DateComparisons.getStringYYYYMM(
							aEligDetailOutput.getEdEligibilityCargo()[0]
									.getPaymentBegDt()).equals(
							DateComparisons.getStringYYYYMM(DateComparisons
									.getLocalesDate()))) {
						if (!aEligDetailOutput.getEdEligibilityCargo()[0]
								.getNfEligRsltCd().equals(
										IEdEligCodes.ELIG_RSLT_CD_FAIL)
								&& !aEligDetailOutput.getEdEligibilityCargo()[0]
										.getRscEligRsltCd().equals(
												IEdEligCodes.ELIG_RSLT_CD_FAIL)
								&& !aEligDetailOutput.getEdEligibilityCargo()[0]
										.getFinEligRsltCd().equals(
												IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
							RMManager rmManagerObj = new RMManager();
							rmManagerObj.init();
							rmManagerObj.doProcess(aEligDetailOutput
									.getEdEligibilityCargo()[0],
									aEligDetailOutput, rmDataHandler,
									egDataHandler);
							egDataHandler.getRMUpdatedEdges().put(
									new Long(aEligDetailOutput
											.getEdEligibilityCargo()[0]
											.getEdgTraceId()),
									new Long(aEligDetailOutput
											.getEdEligibilityCargo()[0]
											.getEdgTraceId()));
							egDataHandler.setWriteRMSw(true);
						}
					}
				}
			} else if (aEligDetailOutput.getEdEligibilityCargo()[0]
					.getActivityType().equals(
							IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
				if ((aEligDetailOutput.getEdEligibilityCargo()[0]
						.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF) && DateComparisons
						.getStringYYYYMM(
								DateComparisons.addMonths(aEligDetailOutput
										.getEdCaseRecertDatesCargo()[0]
										.getRecertReviewStartDt(), 1)).equals(
								DateComparisons
										.getStringYYYYMM(aEligDetailOutput
												.getEdEligibilityCargo()[0]
												.getPaymentBegDt())))
						|| (aEligDetailOutput.getEdEligibilityCargo()[0]
								.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_FS) && DateComparisons
								.getStringYYYYMM(
										DateComparisons
												.addMonths(
														aEligDetailOutput
																.getEdCaseRecertDatesCargo()[0]
																.getRecertReviewDueDt(),
														1))
								.equals(
										DateComparisons
												.getStringYYYYMM(aEligDetailOutput
														.getEdEligibilityCargo()[0]
														.getPaymentBegDt())))) {
					if (!aEligDetailOutput.getEdEligibilityCargo()[0]
							.getNfEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_FAIL)
							&& !aEligDetailOutput.getEdEligibilityCargo()[0]
									.getRscEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_FAIL)
							&& !aEligDetailOutput.getEdEligibilityCargo()[0]
									.getFinEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
						RMManager rmManagerObj = new RMManager();
						rmManagerObj.init();
						rmManagerObj.doProcess(aEligDetailOutput
								.getEdEligibilityCargo()[0], aEligDetailOutput,
								rmDataHandler, egDataHandler);
						egDataHandler.getRMUpdatedEdges().put(
								new Long(aEligDetailOutput
										.getEdEligibilityCargo()[0]
										.getEdgTraceId()),
								new Long(aEligDetailOutput
										.getEdEligibilityCargo()[0]
										.getEdgTraceId()));
						egDataHandler.setWriteRMSw(true);
					}
				}
			}
		}
		//		if
		// (!(aEligDetailOutput.getEdEligibilityCargo()[0].getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))
		//		  &&
		// (!aEligDetailOutput.getEdEligibilityCargo()[0].getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)))
		// {
		/*
		 * //CQ 2037: Table deleted if (aEligDetailOutput.getEdRiskScoreCargo() !=
		 * null) { //
		 * aEligDetailOutput.getEdEligibilityCargo()[0].setRiskLevelCd(aEligDetailOutput.getEdRiskScoreCargo()[0].getRiskLevelCd());
		 * if
		 * (aEligDetailOutput.getEdRiskScoreCargo()[0].getOverrideRiskLevelCd() !=
		 * IEdEligCodes.CHAR_INIT_SPACE) {
		 * aEligDetailOutput.getEdEligibilityCargo()[0].setRiskLevelCd(aEligDetailOutput.getEdRiskScoreCargo()[0].getOverrideRiskLevelCd()); }
		 * else {
		 * aEligDetailOutput.getEdEligibilityCargo()[0].setRiskLevelCd(aEligDetailOutput.getEdRiskScoreCargo()[0].getRiskLevelCd()); }
		 * adjustVerificationCheckList(egDataHandler.getAlEdVerificationChecklistModApp(),
		 * aEligDetailOutput); }
		 */
		//		}
	}

	/**
	 * performSpendDownEDBC method performs EDBC end process for spend down.
	 *
	 * @param aEdEligibilityCargo
	 *            contains the current EdEligibilityCargo
	 * @param aMapRequest
	 *            contains the request map
	 * @throws ApplicationException
	 * @throws FrameworkException
	 * @throws SQLException
	 */
	
	public void performSpendDownEDBC(EdEligibilityCargo aEdEligibilityCargo,
			Map aMapRequest) throws ApplicationException, FrameworkException,
			SQLException {
		try {
			String aSUserId = (String) aMapRequest
					.get(IEdEligCodes.SESSION_USER_ID);
			Connection conn = (Connection) aMapRequest
					.get(IEdEligCodes.REQUEST_CONNECTION);
			EgDataHandler aEgDataHandler = null;
			boolean bAfterClone = false;
			if (aMapRequest.containsKey(IEdEligCodes.EG_DATA_HANDLER)
					&& aMapRequest.get(IEdEligCodes.EG_DATA_HANDLER) != null) {
				aEgDataHandler = (EgDataHandler) aMapRequest
						.get(IEdEligCodes.EG_DATA_HANDLER);
				bAfterClone = true;
			} else {
				aEgDataHandler = new EgDataHandler();
			}
			aEgDataHandler.loadEligDetailForSpendDown(aEdEligibilityCargo,
					conn, bAfterClone);
			detSpendDownCgEligRsltCd(aEdEligibilityCargo);
			detSpendDownCgStatusCd(aEdEligibilityCargo, aEgDataHandler
					.getEdEligibilityCargoAuthSpendDown());
			detSpendDownBenefitStatus(aEdEligibilityCargo);
			detSpendDownEdEligBegDt(aEdEligibilityCargo, aEgDataHandler
					.getEdEligibilityCargoAuthSpendDown());
			detSpendDownEdEligEndDt(aEdEligibilityCargo, aEgDataHandler
					.getEdEligibilityCargoAuthSpendDown());
			detSpendDownEstEligEndDt(aEdEligibilityCargo);
			EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = detSpendDownEligNoticeRsn(
					aEgDataHandler.getEdEligNoticeReasonsCargoSpendDown(),
					aEdEligibilityCargo);
			//Added for defect 178425
			//BRGUS00107001 – kesavanr – Change in method signature to pass previous month EDM.
			detEDBCActionCd(aEdEligibilityCargo, aEgDataHandler,null);
			int iLength = 0;
			iLength = aEgDataHandler.getEdIndvEligibilityCargoSpendDown().length;
			int iAuthIndvLength = 0;
			EdIndvEligibilityCargo edIndvEligibilityCargoAuth = null;
			for (int i = 0; i < iLength; i++) {
				detSpendDownIndvEligRsltCd(aEdEligibilityCargo, aEgDataHandler
						.getEdIndvEligibilityCargoSpendDown()[i]);
				iAuthIndvLength = 0;
				if (aEgDataHandler.getEdIndvEligibilityCargoAuthSpendDown() != null) {
					iAuthIndvLength = aEgDataHandler
							.getEdIndvEligibilityCargoAuthSpendDown().length;
				}
				edIndvEligibilityCargoAuth = null;
				for (int j = 0; j < iAuthIndvLength; j++) {
					if (aEgDataHandler.getEdIndvEligibilityCargoSpendDown()[i]
							.getIndvId() == aEgDataHandler
							.getEdIndvEligibilityCargoAuthSpendDown()[j]
							.getIndvId()) {
						edIndvEligibilityCargoAuth = aEgDataHandler
								.getEdIndvEligibilityCargoAuthSpendDown()[j];
						break;
					}
				}
				detSpendDownIndvEligBegDt(aEdEligibilityCargo, aEgDataHandler
						.getEdIndvEligibilityCargoSpendDown()[i],
						edIndvEligibilityCargoAuth);
				detSpendDownIndvEligEndDt(aEdEligibilityCargo, aEgDataHandler
						.getEdIndvEligibilityCargoSpendDown()[i],
						edIndvEligibilityCargoAuth);
			}
			detDeniedEdgForSpendDown(aEgDataHandler, aEdEligibilityCargo);
			if (aEgDataHandler.getEdVerificationChecklistCargoSpendDown() != null) {
				int iLengthVCL = aEgDataHandler
						.getEdVerificationChecklistCargoSpendDown().length;
				boolean bVCLDueDtNonVoidedRecordExists = false;
				// ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
				boolean vclType = false;
				for (int m = 0; m < iLengthVCL; m++) {
					//ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
					if (aEgDataHandler
							.getEdVerificationChecklistCargoSpendDown()[m]
							.getVclTypeCd() != null
							&& aEgDataHandler
									.getEdVerificationChecklistCargoSpendDown()[m]
									.getVclTypeCd().equals("V515")) {
						vclType = true;

					}
					//Modifed for defect 119517
					if (aEgDataHandler
							.getEdVerificationChecklistCargoSpendDown()[m]
							.getVclRequestDt() == null
							&& aEgDataHandler
									.getEdVerificationChecklistCargoSpendDown()[m]
									.getVoidSw() == IEdEligCodes.NO) {
						//		       		if
						// (aEgDataHandler.getEdVerificationChecklistCargoSpendDown()[m].getVclDueDt()
						// == null &&
						// aEgDataHandler.getEdVerificationChecklistCargoSpendDown()[m].getVoidSw()
						// == IEdEligCodes.NO) {
						bVCLDueDtNonVoidedRecordExists = true;
						break;
					}
				}
				if (bVCLDueDtNonVoidedRecordExists == false) {
					// ID : BRGUS00121879 -- changes for CR- 20974 generating the trigger based on the program code
					issueCOTrigger(aEdEligibilityCargo, aSUserId,
							conn, bVCLDueDtNonVoidedRecordExists,
							aEgDataHandler.getDcCasesCargo(), aMapRequest,vclType);
				}
			}
			if (bAfterClone == false) {
				if (edEligNoticeReasonsCargo != null) {
					aEgDataHandler.writeEligDetailForSpendDown(
							aEdEligibilityCargo, edEligNoticeReasonsCargo,
							aSUserId, conn, aEgDataHandler);
				} else {
					aEgDataHandler.writeEligDetailForSpendDown(
							aEdEligibilityCargo, null, aSUserId, conn,
							aEgDataHandler);
				}
			}
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		}
	}

	/**
	 * Method detDeniedEdgForSpendDown, determine denied EDG for spend down.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detDeniedEdgForSpendDown(EgDataHandler aEgDataHandler,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		int iLengthVCL = 0;
		if (aEgDataHandler.getEdVerificationChecklistCargoSpendDown() == null) {
			return;
		} else {
			iLengthVCL = aEgDataHandler
					.getEdVerificationChecklistCargoSpendDown().length;
		}
		int iLengthMonthsForEdges = 0;
		if (aEgDataHandler.getEdEligibilityCargoSpendDown() != null) {
			iLengthMonthsForEdges = aEgDataHandler
					.getEdEligibilityCargoSpendDown().length;
		}
		boolean bOtherEdgPending = false;
		for (int j = 0; j < iLengthMonthsForEdges; j++) {
			if (aEgDataHandler.getEdEligibilityCargoSpendDown()[j]
					.getEdgTraceId() != aEdEligibilityCargo.getEdgTraceId()) {
				if (aEgDataHandler.getEdEligibilityCargoSpendDown()[j]
						.getVerificationStatusCd().equals(
								IEdEligCodes.VERIFICATION_STATUS_CD_PENDING)) {
					bOtherEdgPending = true;
					break;
				}
			}
		}

		ArrayList alTemp = new ArrayList();
		for (int i = 0; i < iLengthVCL; i++) {
			if (aEdEligibilityCargo != null
					&& aEgDataHandler
							.getEdVerificationChecklistCargoSpendDown()[i]
							.getEdgNum() == aEdEligibilityCargo.getEdgNum()
					&& (aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_DENIED) || aEdEligibilityCargo
							.getCgStatusCd().equals(
									IEdEligCodes.STATUS_CD_TERMINATED))) {
				if (bOtherEdgPending == false) {
					aEgDataHandler.getEdVerificationChecklistCargoSpendDown()[i]
							.setVoidSw(IEdEligCodes.YES);
					alTemp.add(aEgDataHandler
							.getEdVerificationChecklistCargoSpendDown()[i]);
				}
			}
		}
		aEgDataHandler.setAlEdVCLModAfterSpendDown(alTemp);
	}

	/**
	 * Determines the SpendDown CgEligRsltCd.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownCgEligRsltCd(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getSpendDownInd() != IEdEligCodes.SPEND_DOWN_IND_YES) {
				aEdEligibilityCargo
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownCgEligRsltCd", ex);
		}
	}

	/**
	 * Determines the SpendDown CgStatusCd.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdEligibilityCargoLastAuth
	 *            EdEligibilityCargo[]
	 * @throws EDBCException
	 */
	public void detSpendDownCgStatusCd(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo[] aArrEdEligibilityCargoLastAuth)
			throws EDBCException {
		String sCgEligRsltCd = null;
		try {
			sCgEligRsltCd = aEdEligibilityCargo.getCgEligRsltCd();
			if (sCgEligRsltCd == null) {
				sCgEligRsltCd = "";
			}
			if (sCgEligRsltCd.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aArrEdEligibilityCargoLastAuth == null) {
					aEdEligibilityCargo
							.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
				} else {
					if (aArrEdEligibilityCargoLastAuth[0].getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_DENIED)) {
						aEdEligibilityCargo
								.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED);
					} else {
						if (aArrEdEligibilityCargoLastAuth[0].getCgStatusCd()
								.equals(IEdEligCodes.STATUS_CD_TERMINATED)
								|| aArrEdEligibilityCargoLastAuth[0]
										.getCgStatusCd()
										.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
							aEdEligibilityCargo
									.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED);
						}
					}
				}
				/*
				 * if ((aArrEdEligibilityCargoLastAuth != null) &&
				 * (aArrEdEligibilityCargoLastAuth[0].getCgStatusCd() == null ||
				 * aArrEdEligibilityCargoLastAuth[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED))) {
				 * aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_DENIED); }
				 * else { if ((aArrEdEligibilityCargoLastAuth != null) &&
				 * ((aArrEdEligibilityCargoLastAuth[0].getCgStatusCd() != null) &&
				 * (aArrEdEligibilityCargoLastAuth[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED) ||
				 * aArrEdEligibilityCargoLastAuth[0].getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)))) {
				 * aEdEligibilityCargo.setCgStatusCd(IEdEligCodes.STATUS_CD_TERMINATED); } }
				 */
			}
			//Added for defect 70311
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_DENIED)
					|| aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				detBenefitAmt(aEdEligibilityCargo);
			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownCgStatusCd", ex);
		}
	}

	/**
	 * Determines the SpendDown Benefit Status Cd.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownBenefitStatus(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getSpendDownInd() != IEdEligCodes.SPEND_DOWN_IND_YES) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownBenefitStatus", ex);
		}
	}

	/**
	 * Determines the SpendDown EdEligibility Begin Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdEligibilityCargoLastAuth
	 *            EdEligibilityCargo[]
	 * @throws EDBCException
	 */
	public void detSpendDownEdEligBegDt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo[] aArrEdEligibilityCargoLastAuth)
			throws EDBCException {
		try {
			if (aArrEdEligibilityCargoLastAuth != null
					&& aArrEdEligibilityCargoLastAuth[0].getEligibilityBegDt() != null) {
				if (aArrEdEligibilityCargoLastAuth[0].getEligibilityEndDt() == null) {
					aEdEligibilityCargo
							.setEligibilityBegDt(aArrEdEligibilityCargoLastAuth[0]
									.getEligibilityBegDt());
					//BRGUS00129025 - Bhuvane - To set this only first time
					/*aEdEligibilityCargo
							.setDispositionEligBegDt(aEdEligibilityCargo
									.getEdbcRunDt());*/
				}
			} else {
				if (aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_APPROVED)) {
					aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
							.getPaymentBegDt());
					//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
					if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
						aEdEligibilityCargo
								.setDispositionEligBegDt(aEdEligibilityCargo
										.getEdbcRunDt());
					}
					//END-BRGUS00159285
				} else {
					aEdEligibilityCargo.setEligibilityBegDt(null);
					//BRGUS00129025 - Bhuvane - To set this only first time
					/*aEdEligibilityCargo
							.setDispositionEligBegDt(aEdEligibilityCargo
									.getEdbcRunDt());*/
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownEdEligBegDt", ex);
		}
	}

	/**
	 * Determines the SpendDown EdEligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdEligibilityCargoLastAuth
	 *            EdEligibilityCargo[]
	 * @throws EDBCException
	 */
	public void detSpendDownEdEligEndDt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo[] aArrEdEligibilityCargoLastAuth)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_TERMINATED)
					&& aEdEligibilityCargo.getEligibilityEndDt() == null) {
				if (aArrEdEligibilityCargoLastAuth != null) {
					// Above if is added for QA defect for Null Check for Build
					// 49
					//if (aArrEdEligibilityCargoLastAuth != null &&
					// aArrEdEligibilityCargoLastAuth[0].getEligibilityEndDt()
					// == null) {
					if (aArrEdEligibilityCargoLastAuth[0].getEligibilityEndDt() == null) {
						aEdEligibilityCargo.setEligibilityEndDt(DateComparisons
								.getLastDayOfPreviousMonth(aEdEligibilityCargo
										.getPaymentBegDt()));
					} else {
						aEdEligibilityCargo
								.setEligibilityEndDt(aArrEdEligibilityCargoLastAuth[0]
										.getEligibilityEndDt());
					}
				}
			} else {
				aEdEligibilityCargo.setEligibilityEndDt(null);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownEdEligEndDt", ex);
		}
	}

	/**
	 * Determines the SpendDown Estimated Eligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownEstEligEndDt(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
					IEdEligCodes.TP_56)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_32)) {
				aEdEligibilityCargo.setEstimatedEligEndDt(aEdEligibilityCargo
						.getEligibilityEndDt());
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownEstEligEndDt", ex);
		}
	}

	/**
	 * Determines the SpendDown EligRsltCd in the EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownIndvEligRsltCd(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo)
			throws EDBCException {
		try {
			if (((aEdEligibilityCargo.getCgStatusCd() != null) && (aEdEligibilityCargo
					.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED)))
					|| ((aEdEligibilityCargo.getCgStatusCd() != null) && (aEdEligibilityCargo
							.getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_TERMINATED)))) {
				aEdIndvEligibilityCargo
						.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			} else {
				if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
						&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
								.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
					aEdIndvEligibilityCargo
							.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
				} else {
					if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
							&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
									.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
						aEdIndvEligibilityCargo
								.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
					} else {
						if ((aEdIndvEligibilityCargo.getNfEligRsltCd() != null)
								&& (aEdIndvEligibilityCargo.getNfEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
							aEdIndvEligibilityCargo
									.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						}
					}
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownIndvEligRsltCd", ex);
		}
	}

	/**
	 * Determines the SpendDown EdIndvEligibility Begin Date in the
	 * EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdIndvEligibilityCargoLastAuth
	 *            EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownIndvEligBegDt(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargoLastAuth)
			throws EDBCException {
		try {
			if (aEdIndvEligibilityCargoLastAuth == null
					|| aEdIndvEligibilityCargoLastAuth.getEligibilityBegDt() == null
					|| aEdIndvEligibilityCargoLastAuth.getEligibilityEndDt() != null) {
				if ((aEdIndvEligibilityCargo.getEligRsltCd() != null)
						&& (aEdIndvEligibilityCargo.getEligRsltCd()
								.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdEligibilityCargo
									.getPaymentBegDt());
				} else {
					aEdIndvEligibilityCargo.setEligibilityBegDt(null);
				}
			} else {
				if (aEdIndvEligibilityCargoLastAuth == null
						|| aEdIndvEligibilityCargoLastAuth
								.getEligibilityEndDt() == null) {
					aEdIndvEligibilityCargo
							.setEligibilityBegDt(aEdIndvEligibilityCargoLastAuth
									.getEligibilityBegDt());
				}
			}
			/*
			 * if (aEdIndvEligibilityCargoLastAuth != null) { if
			 * (aEdIndvEligibilityCargoLastAuth.getEligibilityBegDt() == null ||
			 * aEdIndvEligibilityCargo.getEligibilityBegDt().equals("")) { if
			 * ((aEdIndvEligibilityCargo.getEligRsltCd() != null) &&
			 * (aEdIndvEligibilityCargo.getEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
			 * aEdIndvEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt()); } }
			 * else { if (aEdIndvEligibilityCargoLastAuth.getEligibilityEndDt() ==
			 * null) {
			 * aEdIndvEligibilityCargo.setEligibilityBegDt(aEdIndvEligibilityCargoLastAuth.getEligibilityBegDt()); } } }
			 */
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownIndvEligBegDt", ex);
		}
	}

	/**
	 * Determines the SpendDown EdIndvEligibility End Date in the
	 * EdIndvEligibility.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdIndvEligibilityCargoLastAuth
	 *            EdIndvEligibilityCargo
	 * @throws EDBCException
	 */
	public void detSpendDownIndvEligEndDt(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargoLastAuth)
			throws EDBCException {
		try {
			if (((aEdIndvEligibilityCargo.getEligRsltCd() != null) && (aEdIndvEligibilityCargo
					.getEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)))
					&& (aEdIndvEligibilityCargo.getEligibilityBegDt() != null)
					&& (aEdIndvEligibilityCargo.getEligibilityEndDt() == null)) {
				if (aEdIndvEligibilityCargoLastAuth != null) {
					if (aEdIndvEligibilityCargoLastAuth.getEligibilityEndDt() != null) {
						aEdIndvEligibilityCargo
								.setEligibilityEndDt(aEdIndvEligibilityCargoLastAuth
										.getEligibilityEndDt());
					} else {
						if (aEdEligibilityCargo.getActivityType().equals(
								IEdEligCodes.ACTIVITY_TYPE_INTAKE)
								|| aEdEligibilityCargo.getCgStatusCd().equals(
										IEdEligCodes.STATUS_CD_TERMINATED)
								|| aEdEligibilityCargo.getPaymentBegDt() == null) {
							aEdIndvEligibilityCargo
									.setEligibilityEndDt(DateComparisons
											.getLastDayOfPreviousMonth(aEdEligibilityCargo
													.getPaymentBegDt()));
						}
					}
				} else {
					if (aEdEligibilityCargo.getActivityType().equals(
							IEdEligCodes.ACTIVITY_TYPE_INTAKE)
							|| aEdEligibilityCargo.getCgStatusCd().equals(
									IEdEligCodes.STATUS_CD_TERMINATED)
							|| aEdEligibilityCargo.getPaymentBegDt() == null) {
						aEdIndvEligibilityCargo
								.setEligibilityEndDt(DateComparisons
										.getLastDayOfPreviousMonth(aEdEligibilityCargo
												.getPaymentBegDt()));
					}
				}
			} else {
				aEdIndvEligibilityCargo.setEligibilityEndDt(null);
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownIndvEligEndDt", ex);
		}
	}

	/**
	 * Determines the SpendDown Notice Reason change.
	 *
	 * @param aArrEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo[]
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return EdEligNoticeReasonsCargo
	 * @throws EDBCException
	 */
	public EdEligNoticeReasonsCargo detSpendDownEligNoticeRsn(
			EdEligNoticeReasonsCargo[] aArrEdEligNoticeReasonsCargo,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		try {
			boolean bSetFailureRsnCd = false;
			EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = null;
			if (aArrEdEligNoticeReasonsCargo != null
					&& aArrEdEligNoticeReasonsCargo.length > 0) {
				int iStart = 0;
				String sTemp = aArrEdEligNoticeReasonsCargo[0]
						.getFailureReasonCode();
				//Added for defect 178425
				String[] sArr = { IEdEligCodes.FAILURE_REASON_CODE_EL5001,
						IEdEligCodes.FAILURE_REASON_CODE_EL5003,
						IEdEligCodes.FAILURE_REASON_CODE_EL5004,
						IEdEligCodes.FAILURE_REASON_CODE_EL5005 };
				int iLength = sArr.length;
				for (int i = 0; i < iLength; i++) {
					iStart = sTemp.indexOf(sArr[i]);
					if (iStart != -1) {
						break;
					}
				}
				StringBuffer sbTemp = new StringBuffer(
						aArrEdEligNoticeReasonsCargo[0].getFailureReasonCode());
				if (iStart >= 0) {
					sbTemp.replace(iStart, iStart + 6,
							IEdEligCodes.FAILURE_REASON_CODE_EL5065);
					aArrEdEligNoticeReasonsCargo[0].setFailureReasonCode(sbTemp
							.toString());
					//Added for defect 178425
					aArrEdEligNoticeReasonsCargo[0]
							.setActionCode(aEdEligibilityCargo.getCgStatusCd()
									.charAt(0));
				} else {
					sbTemp.append(IEdEligCodes.FAILURE_REASON_CODE_EL5065);
					aArrEdEligNoticeReasonsCargo[0].setFailureReasonCode(sbTemp
							.toString());
					//Added for defect 178425
					aArrEdEligNoticeReasonsCargo[0]
							.setActionCode(aEdEligibilityCargo.getCgStatusCd()
									.charAt(0));
				}
			} else {
				edEligNoticeReasonsCargo = new EdEligNoticeReasonsCargo();
				edEligNoticeReasonsCargo.setEdgTraceId(aEdEligibilityCargo
						.getEdgTraceId());
				edEligNoticeReasonsCargo
						.setFailureReasonCode(IEdEligCodes.FAILURE_REASON_CODE_EL5065);
				edEligNoticeReasonsCargo.setActionCode(aEdEligibilityCargo
						.getCgStatusCd().charAt(0));
			}
			return edEligNoticeReasonsCargo;
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detSpendDownEligNoticeRsn", ex);
		}
	}

	/**
	 * Method issueCOTrigger, issues Correspondence trigger .
	 *
	 * @param aLCaseNum
	 *            long
	 * @param aSUserId
	 *            String
	 * @param aConn
	 *            Connection
	 * @param aBIssuedTrigger
	 *            boolean
	 * @param aArrDcCasesCargo
	 *            DcCasesCargo[]
	 * @param aMapRequest
	 *            Map
	 * @throws FrameworkException
	 * @throws ApplicationException
	 * @throws EDBCException
	 * @throws SQLException
	 */
	public static void issueCOTrigger(long aLCaseNum, String aSUserId,
			Connection aConn, boolean aBIssuedTrigger,
			DcCasesCargo[] aArrDcCasesCargo, Map aMapRequest)
			throws FrameworkException, ApplicationException, EDBCException,
			SQLException {

		COCorrespondence coReqObj = new COCorrespondence();
		coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
		coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
		coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
		coReqObj.setGenerateDate(DateComparisons
				.getTimestamp(new java.util.Date()));
		coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
		coReqObj.setRequestUserId(aSUserId);
		User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
		// Added for defect 129055 for correspondence requirement
		coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
		if (aBIssuedTrigger == false) {
			coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

		}

		int rtnCode = 0;

		if (aConn == null) {//online
			coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
			coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
					.longValue());
			ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
					.create(ICoOnline.class);
			rtnCode = onlineCo.initiateCorrespondence(coReqObj);
		}
		if (aConn != null) {//batch

			ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
					.create(ICoBatch.class);
			String asofdate = DateComparisons.getStringDate(DateComparisons
					.getRunDate());
			coReqObj.setEmpId(0);
			coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
			rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

		}

		if (rtnCode != 0) {
			//do error processing
			Debug
					.println("Return Code after triggering CO in EDBC for 1020 is :"
							+ rtnCode);
			FrameworkException ex = new FrameworkException(
					"Error While Triggering Correspondence in EDBC for 1020 and RETURN CODE is "
							+ rtnCode);
			throw ex;

		}
		return;
	}

	//BEGIN-BRGUS00136484-upadhyayulag-New method to pass the verification checklist cargo also
	//to check the VCL request date and delete by supervisor indicator for SER program
	/**
	 * Method issueCOTrigger, issues Correspondence trigger .
	 * ID : BRGUS00121879 -- changes for CR-20974--Triggering DHS -3503 for SER trigger.
	 * @param cargo EdVerificationChecklistCargo
	 * @param eligDetail  EligDetail[]
	 * @param aSUserId String
	 * @param aConn Connection
	 * @param aBIssuedTrigger boolean
	 * @param aArrDcCasesCargo DcCasesCargo[]
	 * @param aMapRequest  Map
	 * @param vclType boolean
	 * @throws FrameworkException
	 * @throws ApplicationException
	 * @throws EDBCException
	 * @throws SQLException
	 */
	public static void issueCOTrigger(EdVerificationChecklistCargo cargo, EligDetail[] eligDetail, String aSUserId,
			Connection aConn, boolean aBIssuedTrigger,
			DcCasesCargo[] aArrDcCasesCargo, Map aMapRequest,
			boolean vclType)
			throws FrameworkException, ApplicationException, EDBCException,
			SQLException {
		int iLength = eligDetail.length;
		boolean isSER = false;
		boolean isCDC = false;
		EdEligibilityCargo edEligibilityCargo = null;
		boolean isNonSer = false;
		long aLCaseNum = eligDetail[0].getEdEligibilityCargo()[0].getCaseNum();
		int rtnCode = 0;
		//ASPEN00042777 -  Send vcl cargo as an object
		EdVerificationChecklistCargo[] vclCargo = null;
		//ew EdVerificationChecklistCargo()[];
		if(eligDetail[0].getEdVerificationChecklistCargo() != null  
				&& eligDetail[0].getEdVerificationChecklistCargo().length > 0){
			vclCargo = eligDetail[0].getEdVerificationChecklistCargo();
		}
		//ASPEN00042777 -  end
//BRGUS00224271 rampurkara changes for chipra 

		boolean chipraSW = false;
		 if(aMapRequest.get("ChipraSw") != null)
		{
		 	chipraSW =((Boolean) aMapRequest.get("ChipraSw")).booleanValue();
		}
		
		boolean nonMACitzIdSW = true;
		if(chipraSW)
		{
			if(aMapRequest.get("nonMACitzIdSw") != null)
			{
			 	nonMACitzIdSW =((Boolean) aMapRequest.get("nonMACitzIdSw")).booleanValue();
			}				
		}
			 
			 
					
		for(int i = 0 ; i < iLength ; i++)
		{
			edEligibilityCargo = eligDetail[i].getEdEligibilityCargo()[0];
			if(!isSER && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				//Check to see if VCL request date is null && delete by supervisor indicator is "P"
				if (cargo.getVclRequestDt() == null
						&& cargo.getDeleteBySupervisorInd() == 'P') {
					isSER = true;
				}
			}
			else if (!isCDC && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC))
			{
				isCDC = true;
			}
			else if (!isNonSer && !edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC)&&
					!edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				isNonSer = true;
			}
		}
		if(isSER)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			/*ASPEN00022958 - DOC_ID_FXX032 need to be set for LIHEAP
			 */
				//coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX069);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			//ASPEN00022958 - End

			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}
		}
		if(isCDC && vclType)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX019);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		if(chipraSW)
		{			
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			//ASPEN00028825 - ASPEN uses DOC_ID_FXX032 for medicaid HUMAD
			//coReqObj.setDocId("FXX380");
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) 
			{
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);
			}
			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);
			}

		}		
		if(isNonSer && nonMACitzIdSW)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}
			//ASPEN00042777 -  Send vcl cargo as an object
			if(vclCargo !=null){
				coReqObj.setMiscObject(vclCargo);
				
			}
			//ASPEN00042777 - End
			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());				
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		if(isCDC && !isNonSer)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}


		if (rtnCode != 0) {
			//do error processing
			Debug
					.println("Return Code after triggering CO in EDBC for 1020 is :"
							+ rtnCode);
			FrameworkException ex = new FrameworkException(
					"Error While Triggering Correspondence in EDBC for 1020 and RETURN CODE is "
							+ rtnCode);
			throw ex;

		}
		return;
	}
	//END-BRGUS00136484

	/**
	 * Method issueCOTrigger, issues Correspondence trigger .
	 * ID : BRGUS00121879 -- changes for CR-20974--Triggering DHS -3503 for SER trigger.
	 * @param eligDetail  EligDetail[]
	 * @param aSUserId String
	 * @param aConn Connection
	 * @param aBIssuedTrigger boolean
	 * @param aArrDcCasesCargo DcCasesCargo[]
	 * @param aMapRequest  Map
	 * @param vclType boolean
	 * @throws FrameworkException
	 * @throws ApplicationException
	 * @throws EDBCException
	 * @throws SQLException
	 */
	public static void issueCOTrigger(EligDetail[] eligDetail, String aSUserId,
			Connection aConn, boolean aBIssuedTrigger,
			DcCasesCargo[] aArrDcCasesCargo, Map aMapRequest,
			boolean vclType)
			throws FrameworkException, ApplicationException, EDBCException,
			SQLException {
		int iLength = eligDetail.length;
		boolean isSER = false;
		boolean isCDC = false;
		EdEligibilityCargo edEligibilityCargo = null;
		boolean isNonSer = false;
		long aLCaseNum = eligDetail[0].getEdEligibilityCargo()[0].getCaseNum();
		int rtnCode = 0;
		//ASPEN00042777 -  Send vcl cargo as an object
		EdVerificationChecklistCargo[] vclCargo = null;
		// ew EdVerificationChecklistCargo()[];
		if (eligDetail[0].getEdVerificationChecklistCargo() != null
				&& eligDetail[0].getEdVerificationChecklistCargo().length > 0) {
			vclCargo = eligDetail[0].getEdVerificationChecklistCargo();
		}
		// ASPEN00042777 - end

		boolean chipraSW = false;
		 if(aMapRequest.get("ChipraSw") != null)
		 {
		 	chipraSW =((Boolean) aMapRequest.get("ChipraSw")).booleanValue();
		 }
		
		boolean nonMACitzIdSW = true;
		if(chipraSW)
		{
			if(aMapRequest.get("nonMACitzIdSw") != null)
			{
			 	nonMACitzIdSW =((Boolean) aMapRequest.get("nonMACitzIdSw")).booleanValue();
			}				
		}
			 			 					
		for(int i = 0 ; i < iLength ; i++)
		{
			edEligibilityCargo = eligDetail[i].getEdEligibilityCargo()[0];
			if(!isSER && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				isSER = true;
			}
			else if (!isCDC && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC))
			{
				isCDC = true;
			}
			else if (!isNonSer && !edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC)&&
					!edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				isNonSer = true;
			}
		}
		if(isSER)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			/*ASPEN00022958 - DOC_ID_FXX032 need to be set for LIHEAP
			 */
				//coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX069);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			//ASPEN00022958 - End

			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}
		}
		if(isCDC && vclType)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX019);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		if(chipraSW)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId("FXX380");
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}

			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);
			}
		}
		if(isNonSer && nonMACitzIdSW)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}
			//ASPEN00042777 -  Send vcl cargo as an object
			if(vclCargo !=null){
				coReqObj.setMiscObject(vclCargo);
				
			}
			//ASPEN00042777 - End

			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate); 

			}

		}
		if(isCDC && !isNonSer)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}


		if (rtnCode != 0) {
			//do error processing
			Debug
					.println("Return Code after triggering CO in EDBC for 1020 is :"
							+ rtnCode);
			FrameworkException ex = new FrameworkException(
					"Error While Triggering Correspondence in EDBC for 1020 and RETURN CODE is "
							+ rtnCode);
			throw ex;

		}
		return;
	}
// end of changes for chipra cr
	/**
	 * Method issueCOTrigger, issues Correspondence trigger .
	 * ID : BRGUS00121879 -- changes for CR-20974--Triggering DHS -3503 for SER trigger.
	 * @param eligDetail  EligDetail
	 * @param aSUserId String
	 * @param aConn Connection
	 * @param aBIssuedTrigger boolean
	 * @param aArrDcCasesCargo DcCasesCargo[]
	 * @param aMapRequest  Map
	 * @param vclType boolean
	 * @throws FrameworkException
	 * @throws ApplicationException
	 * @throws EDBCException
	 * @throws SQLException
	 */
	public static void issueCOTrigger(EligDetail eligDetail, String aSUserId,
			Connection aConn, boolean aBIssuedTrigger,
			DcCasesCargo[] aArrDcCasesCargo, Map aMapRequest,
			boolean vclType)
			throws FrameworkException, ApplicationException, EDBCException,
			SQLException {
		int iLength = eligDetail.getEdEligibilityCargo().length;
		boolean isSER = false;
		boolean isCDC = false;
		EdEligibilityCargo edEligibilityCargo = null;
		boolean isNonSer = false;
		long aLCaseNum = eligDetail.getEdEligibilityCargo()[0].getCaseNum();
		int rtnCode = 0;
		for(int i = 0 ; i < iLength ; i++)
		{
			edEligibilityCargo = eligDetail.getEdEligibilityCargo()[i];
			if(!isSER && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				isSER = true;
			}
			else if (!isCDC && edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC))
			{
				isCDC = true;
			}
			else if (!isNonSer && !edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC)&&
					!edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER))
			{
				isNonSer = true;
			}
		}
		if(isSER)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			/*ASPEN00022958 - DOC_ID_FXX032 need to be set for LIHEAP
			 */
				//coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX069);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			//ASPEN00022958 - End

			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}
		}
		if(isCDC && vclType)
		{

			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX019);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		if(isNonSer)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		if(isCDC && !isNonSer)
		{
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
			coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}



			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}


		if (rtnCode != 0) {
			//do error processing
			Debug
					.println("Return Code after triggering CO in EDBC for 1020 is :"
							+ rtnCode);
			FrameworkException ex = new FrameworkException(
					"Error While Triggering Correspondence in EDBC for 1020 and RETURN CODE is "
							+ rtnCode);
			throw ex;

		}
		return;
	}

	/**
	 * Method issueCOTrigger, issues Correspondence trigger .
	 * ID : BRGUS00121879 -- changes for CR-20974--Triggering DHS -3503 for SER trigger.
	 * @param edEligibilityCargo  EdEligibilityCargo
	 * @param aSUserId String
	 * @param aConn Connection
	 * @param aBIssuedTrigger boolean
	 * @param aArrDcCasesCargo DcCasesCargo[]
	 * @param aMapRequest  Map
	 * @param vclType boolean
	 * @throws FrameworkException
	 * @throws ApplicationException
	 * @throws EDBCException
	 * @throws SQLException
	 */
	public static void issueCOTrigger(EdEligibilityCargo edEligibilityCargo, String aSUserId,
			Connection aConn, boolean aBIssuedTrigger,
			DcCasesCargo[] aArrDcCasesCargo, Map aMapRequest,
			boolean vclType)
			throws FrameworkException, ApplicationException, EDBCException,
			SQLException {
		long aLCaseNum = edEligibilityCargo.getCaseNum();
		int rtnCode = 0;
		if(edEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC) && vclType)
		{
			String progCode = edEligibilityCargo.getProgramCd();
			COCorrespondence coReqObj = new COCorrespondence();
			coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
			coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);

				coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX019);

			coReqObj.setGenerateDate(DateComparisons
					.getTimestamp(new java.util.Date()));
			coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
			coReqObj.setRequestUserId(aSUserId);
			User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
			// Added for defect 129055 for correspondence requirement
			coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
			if (aBIssuedTrigger == false) {
				coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

			}
			if (aConn == null) {//online
				coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
				coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
						.longValue());
				ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
						.create(ICoOnline.class);
				rtnCode = onlineCo.initiateCorrespondence(coReqObj);
			}
			if (aConn != null) {//batch

				ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
						.create(ICoBatch.class);
				String asofdate = DateComparisons.getStringDate(DateComparisons
						.getRunDate());
				coReqObj.setEmpId(0);
				coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
				rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

			}

		}
		COCorrespondence coReqObj = new COCorrespondence();
		coReqObj.setCaseAppNumber(String.valueOf(aLCaseNum));
		coReqObj.setCaseAppFlag(IEdEligCodes.CASE_APP_FLAG_C);
		coReqObj.setDocId(IEdEligCodes.DOC_ID_FXX032);
		coReqObj.setGenerateDate(DateComparisons
				.getTimestamp(new java.util.Date()));
		coReqObj.setPrintMode(IEdEligCodes.PRINT_MODE_B);
		coReqObj.setRequestUserId(aSUserId);
		User userInfo = (User) aMapRequest.get(IEdEligCodes.USER_INFO);
		// Added for defect 129055 for correspondence requirement
		coReqObj.setReasonCdList(aArrDcCasesCargo[0].getCaseModeCd());
		if (aBIssuedTrigger == false) {
			coReqObj.setActionCode(IEdEligCodes.CO_ACTION_CODE_C);

		}
		if (aConn == null) {//online
			coReqObj.setOfficeNumber(userInfo.getLoggedInOffice());
			coReqObj.setEmpId(((Long) aMapRequest.get(IEdEligCodes.EMP_ID))
					.longValue());
			ICoOnline onlineCo = (ICoOnline) CoServiceFactory.getInstance()
					.create(ICoOnline.class);
			rtnCode = onlineCo.initiateCorrespondence(coReqObj);
		}
		if (aConn != null) {//batch

			ICoBatch batchCo = (ICoBatch) CoServiceFactory.getInstance()
					.create(ICoBatch.class);
			String asofdate = DateComparisons.getStringDate(DateComparisons
					.getRunDate());
			coReqObj.setEmpId(0);
			coReqObj.setOfficeNumber(aArrDcCasesCargo[0].getOfficeNum());
			rtnCode = batchCo.initiateCorrespondence(coReqObj, aConn, asofdate);

		}

		if (rtnCode != 0) {
			//do error processing
			Debug
					.println("Return Code after triggering CO in EDBC for 1020 is :"
							+ rtnCode);
			FrameworkException ex = new FrameworkException(
					"Error While Triggering Correspondence in EDBC for 1020 and RETURN CODE is "
							+ rtnCode);
			throw ex;

		}
		return;
	}
	/**
	 * Method createEdIndvDateSpecificCargo.
	 *
	 * @param aAlRecordForIndvDateSpecific
	 *            ArrayList
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	/*
	 * CQ 1277: Table Deprecated public static void
	 * createEdIndvDateSpecificCargo(ArrayList aAlRecordForIndvDateSpecific,
	 * EdIndvEligibilityCargo aEdIndvEligibilityCargo, EdEligibilityCargo
	 * aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
	 * Iterator itTemp = aAlRecordForIndvDateSpecific.iterator(); ArrayList
	 * alIndvDateSpecific = new ArrayList(); DcAlienEmergencyMedCargo
	 * dcAlienEmergencyMedCargo = null; while (itTemp.hasNext()) {
	 * dcAlienEmergencyMedCargo = (DcAlienEmergencyMedCargo)itTemp.next();
	 * EdIndvDateSpecificCargo edIndvDateSpecificCargo = new
	 * EdIndvDateSpecificCargo();
	 * edIndvDateSpecificCargo.setCaseNum(aEdIndvEligibilityCargo.getCaseNum());
	 * edIndvDateSpecificCargo.setEdgTraceId(aEdIndvEligibilityCargo.getEdgTraceId());
	 * edIndvDateSpecificCargo.setIndvId(aEdIndvEligibilityCargo.getIndvId());
	 * if
	 * (dcAlienEmergencyMedCargo.getEmergecyBeginDt().before(aEdEligibilityCargo.getPaymentBegDt())) {
	 * edIndvDateSpecificCargo.setEligibilityBegDt(aEdEligibilityCargo.getPaymentBegDt()); }
	 * else {
	 * edIndvDateSpecificCargo.setEligibilityBegDt(dcAlienEmergencyMedCargo.getEmergecyBeginDt()); }
	 * if (dcAlienEmergencyMedCargo.getEmergecyEndDt() == null) {
	 * edIndvDateSpecificCargo.setEligibilityEndDt(DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt())); }
	 * else { //Modified for defect 118148 if
	 * (dcAlienEmergencyMedCargo.getEmergecyEndDt().after(DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt()))) {
	 * edIndvDateSpecificCargo.setEligibilityEndDt(DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getPaymentBegDt())); }
	 * else {
	 * edIndvDateSpecificCargo.setEligibilityEndDt(dcAlienEmergencyMedCargo.getEmergecyEndDt()); } }
	 * aEgDataHandler.getAlEdIndvDateSpecificCargo().add(edIndvDateSpecificCargo); } }
	 */
	/**
	 * Method detBenefitAmt, sets benefit amount.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	private void detBenefitAmt(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		try {
			aEdEligibilityCargo.setBenefitAmt(0);
			aEdEligibilityCargo.setPenaltyAmt(0);
			aEdEligibilityCargo.setRecoupmentAmt(0);
			aEdEligibilityCargo.setSupplementAmt(0);
			aEdEligibilityCargo.setNetBenefitAmt(0);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detBenefitAmt", ex);
		}
	}

	//Modified for defect 86792
	/**
	 * Method resetEdEligBegDt, resets Elig Beg Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 */
	public void resetEdEligBegDt(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo) {
		int iLengthIndv = aArrEdIndvEligibilityCargo.length;
		Timestamp tsLowestIndvEligBegDt = null;
		;
		for (int i = 0; i < iLengthIndv; i++) {
			if (aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
				if (tsLowestIndvEligBegDt == null) {
					tsLowestIndvEligBegDt = aArrEdIndvEligibilityCargo[i]
							.getEligibilityBegDt();
				} else {
					if (aArrEdIndvEligibilityCargo[i].getEligibilityBegDt()
							.before(tsLowestIndvEligBegDt)) {
						tsLowestIndvEligBegDt = aArrEdIndvEligibilityCargo[i]
								.getEligibilityBegDt();
					}
				}
			}
		}
		if (tsLowestIndvEligBegDt != null
				&& aEdEligibilityCargo.getPaymentBegDt().after(
						tsLowestIndvEligBegDt)) {
			aEdEligibilityCargo.setEligibilityBegDt(aEdEligibilityCargo
					.getPaymentBegDt());
			//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
			if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
				aEdEligibilityCargo.setDispositionEligBegDt(aEdEligibilityCargo
						.getEdbcRunDt());
			}
			//END-BRGUS00159285
		} else {
			if (tsLowestIndvEligBegDt != null
					&& aEdEligibilityCargo.getPaymentBegDt().before(
							tsLowestIndvEligBegDt)) {
				aEdEligibilityCargo.setEligibilityBegDt(tsLowestIndvEligBegDt);
				//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
				if(aEdEligibilityCargo.getDispositionEligBegDt() == null){
					aEdEligibilityCargo.setDispositionEligBegDt(aEdEligibilityCargo
							.getEdbcRunDt());
				}
				//END-BRGUS00159285
			}
		}
	}

	/**
	 * Method detDatesForPRFail, determine dates for Complete Review Failure.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aArrEdCaseRecertDatesCargo
	 *            EdCaseRecertDatesCargo[]
	 * @throws EDBCException
	 */
	public void detDatesForPRFail(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EgDataHandler aEgDataHandler,
			EdCaseRecertDatesCargo[] aArrEdCaseRecertDatesCargo)
			throws EDBCException {
		try {
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aEdEligibilityCargo.getActivityType().equals(
						IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
					//					if
					// (DateComparisons.getStringYYYYMM(aEdEligibilityCargo.getPaymentBegDt()).equals(DateComparisons.getStringYYYYMM(DateComparisons.getTimestamp(DateComparisons.addMonths(aArrEdCaseRecertDatesCargo[0].getRecertReviewStartDt(),
					// 1))))) {
					if (aEdEligibilityCargoPrevMth == null
							|| aEdEligibilityCargoPrevMth.getActivityType() == null
							|| !aEdEligibilityCargoPrevMth
									.getActivityType()
									.equals(
											IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
						if (aEgDataHandler.getEligDetailLastAuth() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligibilityCargo() != null
								&& aEgDataHandler.getEligDetailLastAuth()
										.getEdEligibilityCargo().length > 0) {
							aEdEligibilityCargo
									.setEligibilityBegDt(aEgDataHandler
											.getEligDetailLastAuth()
											.getEdEligibilityCargo()[0]
											.getEligibilityBegDt());
							//BRGUS00129025 - Bhuvane - To set this only first time
							/*aEdEligibilityCargo
									.setDispositionEligBegDt(aEdEligibilityCargo
											.getEdbcRunDt());*/

							//For CMA TOAs - pre-populate the estimated elig
							// end date only if CgStatus is Approved or Pending
							if (aEdEligibilityCargo.getTypeOfAssistanceCd()
									.equals(IEdEligCodes.TP_43)
									|| aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_44)
									|| aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_47)
									|| aEdEligibilityCargo
											.getTypeOfAssistanceCd().equals(
													IEdEligCodes.TP_48)) {
								if (aEgDataHandler.getEligDetailLastAuth()
										.getEdEligibilityCargo()[0]
										.getCgStatusCd().equals("AP")
										|| aEgDataHandler
												.getEligDetailLastAuth()
												.getEdEligibilityCargo()[0]
												.getCgStatusCd().equals("PE")) {
									//If condition added for Defect # 00207607
									if (aEdEligibilityCargo
											.getPaymentBegDt()
											.before(
													aEgDataHandler
															.getEligDetailLastAuth()
															.getEdEligibilityCargo()[0]
															.getEstimatedEligEndDt())) {
										aEdEligibilityCargo
												.setEstimatedEligEndDt(aEgDataHandler
														.getEligDetailLastAuth()
														.getEdEligibilityCargo()[0]
														.getEstimatedEligEndDt());
									}
								}
							} else {
								aEdEligibilityCargo
										.setEstimatedEligEndDt(aEgDataHandler
												.getEligDetailLastAuth()
												.getEdEligibilityCargo()[0]
												.getEstimatedEligEndDt());
							}
						}
						int iLengthIndv = aArrEdIndvEligibilityCargo.length;
						int iLengthIndvAuth = 0;
						for (int i = 0; i < iLengthIndv; i++) {
							iLengthIndvAuth = 0;
							if (aEgDataHandler.getEligDetailLastAuth() != null
									&& aEgDataHandler.getEligDetailLastAuth()
											.getEdIndvEligibilityCargo() != null
									&& aEgDataHandler.getEligDetailLastAuth()
											.getEdIndvEligibilityCargo().length > 0) {
								iLengthIndvAuth = aEgDataHandler
										.getEligDetailLastAuth()
										.getEdIndvEligibilityCargo().length;
							}
							for (int j = 0; j < iLengthIndvAuth; j++) {
								if (aArrEdIndvEligibilityCargo[i].getIndvId() == aEgDataHandler
										.getEligDetailLastAuth()
										.getEdIndvEligibilityCargo()[j]
										.getIndvId()) {
									if (aEgDataHandler.getEligDetailLastAuth()
											.getEdIndvEligibilityCargo()[j]
											.getEligibilityBegDt() != null
											&& aEgDataHandler
													.getEligDetailLastAuth()
													.getEdIndvEligibilityCargo()[j]
													.getEligibilityEndDt() == null) {
										aArrEdIndvEligibilityCargo[i]
												.setEligibilityBegDt(aEgDataHandler
														.getEligDetailLastAuth()
														.getEdIndvEligibilityCargo()[j]
														.getEligibilityBegDt());
									}
								}
							}
						}
					}
					//
				}
			}

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detDatesForPRFail", ex);
		}
	}

	//Added for defect 99144,99147
	/**
	 * Method detValidityForProgMth, determine validity for program month.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean detValidityForProgMth(EligDetail[] aArrEligDetailOutput,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		int iLength = 0;
		if (aArrEligDetailOutput != null) {
			if (aArrEligDetailOutput.length > 0) {
				iLength = aArrEligDetailOutput.length;
			}
		}
		Timestamp tsLastMthPaymentBegDt = null;
		Timestamp tsPrevPrevLastMthPaymentBegDt = null;
		tsLastMthPaymentBegDt = DateComparisons.subMonths(aEdEligibilityCargo
				.getPaymentBegDt(), 1);
		tsPrevPrevLastMthPaymentBegDt = DateComparisons.subMonths(
				aEdEligibilityCargo.getPaymentBegDt(), 2);
		boolean bIsPrevAnyPassPend = false;
		boolean bIsPrevPrevAnyPassPend = false;
		int iCountPrev = 0;
		for (int i = 0; i < iLength; i++) {
			if (aArrEligDetailOutput[i] != null) {
				if (aArrEligDetailOutput[i].getEdEligibilityCargo() != null) {
					if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0] != null) {
						if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getPriorMedicalCd() != null
								&& !(aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getPriorMedicalCd().equals(
												IEdEligCodes.PRIOR_MED_CD_1)
										|| aArrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getPriorMedicalCd()
												.equals(
														IEdEligCodes.PRIOR_MED_CD_2) || aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getPriorMedicalCd().equals(
												IEdEligCodes.PRIOR_MED_CD_3))) {
							if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getProgramCd() != null
									&& aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getProgramCd().equals(
													aEdEligibilityCargo
															.getProgramCd())) {
								//Added for defect 134132
								if (aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0].getEdgNum() == aEdEligibilityCargo
										.getEdgNum()) {
									if ((aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getPaymentBegDt() != null && aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getPaymentBegDt().before(
													aEdEligibilityCargo
															.getPaymentBegDt()))
											&& ((aArrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPaymentEndDt() == null) || (aArrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPaymentEndDt()
													.after(
															tsLastMthPaymentBegDt) || aArrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPaymentEndDt()
													.equals(
															tsLastMthPaymentBegDt)))) {
										iCountPrev = iCountPrev + 1;
										if (aArrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getCgEligRsltCd() != null
												&& (aArrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getCgEligRsltCd()
														.equals(
																IEdEligCodes.ELIG_RSLT_CD_PASS) || aArrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getCgEligRsltCd()
														.equals(
																IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
											bIsPrevAnyPassPend = true;
											break;
										}
									}
								}
							}
						}
					}
				}
			}
		}
		int iCountPrevPrev = 0;
		if (bIsPrevAnyPassPend == false) {
			for (int i = 0; i < iLength; i++) {
				if (aArrEligDetailOutput[i] != null) {
					if (aArrEligDetailOutput[i].getEdEligibilityCargo() != null) {
						if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0] != null) {
							if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getPriorMedicalCd() != null
									&& !(aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getPriorMedicalCd()
											.equals(IEdEligCodes.PRIOR_MED_CD_1)
											|| aArrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getPriorMedicalCd()
													.equals(
															IEdEligCodes.PRIOR_MED_CD_2) || aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getPriorMedicalCd()
											.equals(IEdEligCodes.PRIOR_MED_CD_3))) {
								if (aArrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getProgramCd() != null
										&& aArrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getProgramCd()
												.equals(
														aEdEligibilityCargo
																.getProgramCd())) {
									//Added for defect 134132
									if (aArrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getEdgNum() == aEdEligibilityCargo
											.getEdgNum()) {
										if ((aArrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getPaymentBegDt() != null && aArrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getPaymentBegDt().before(
														tsLastMthPaymentBegDt))
												&& ((aArrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getPaymentEndDt() == null) || (aArrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getPaymentEndDt()
														.after(
																tsPrevPrevLastMthPaymentBegDt) || aArrEligDetailOutput[i]
														.getEdEligibilityCargo()[0]
														.getPaymentEndDt()
														.equals(
																tsPrevPrevLastMthPaymentBegDt)))) {
											iCountPrevPrev = iCountPrevPrev + 1;
											if (aArrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getCgEligRsltCd() != null
													&& (aArrEligDetailOutput[i]
															.getEdEligibilityCargo()[0]
															.getCgEligRsltCd()
															.equals(
																	IEdEligCodes.ELIG_RSLT_CD_PASS) || aArrEligDetailOutput[i]
															.getEdEligibilityCargo()[0]
															.getCgEligRsltCd()
															.equals(
																	IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
												bIsPrevPrevAnyPassPend = true;
												break;
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		//Modifed for defect 99842
		if (iCountPrev > 0 && iCountPrevPrev > 0) {
			return bIsPrevPrevAnyPassPend;
		} else {
			return true;
		}
	}

	/**
	 * Determines the Minimum & Maximum Eligibility Determination Month for
	 * display purposes.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aMapRequest
	 *            Map
	 * @throws EDBCException
	 */
	public void detMimMaxEDMForDisplay(EgDataHandler aEgDataHandler,
			Map aMapRequest) throws EDBCException {
		//Added for defect 99266 to find the min, max of processed records not
		// picked up EDBC but still needs to be displayed after running edbc
		int iLength = 0;
		if (aEgDataHandler.getEdEligibilityCargoProcessed() != null) {
			iLength = aEgDataHandler.getEdEligibilityCargoProcessed().length;
		}
		Timestamp tsMaxEDMForDisplay = (Timestamp) aMapRequest
				.get(IEdEligCodes.REQUEST_EDBC_MAX_DATE);
		Timestamp tsMinEDMForDisplay = (Timestamp) aMapRequest
				.get(IEdEligCodes.REQUEST_EDBC_MIN_DATE);
		for (int i = 0; i < iLength; i++) {
			if (aEgDataHandler.getEdEligibilityCargoProcessed()[i]
					.getPaymentBegDt().after(tsMaxEDMForDisplay)) {
				tsMaxEDMForDisplay = aEgDataHandler
						.getEdEligibilityCargoProcessed()[i].getPaymentBegDt();
			}
		}
		for (int i = 0; i < iLength; i++) {
			if (aEgDataHandler.getEdEligibilityCargoProcessed()[i]
					.getPaymentBegDt().before(tsMinEDMForDisplay)) {
				tsMinEDMForDisplay = aEgDataHandler
						.getEdEligibilityCargoProcessed()[i].getPaymentBegDt();
			}
		}
		aMapRequest.put(IEdEligCodes.REQUEST_EDBC_MAX_DATE, DateComparisons
				.getLastDayOfDate(tsMaxEDMForDisplay));
		aMapRequest.put(IEdEligCodes.REQUEST_EDBC_MIN_DATE, tsMinEDMForDisplay);
	}

	/**
	 * Method detProgramCd, determine program code.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @return HashMap
	 * @throws EDBCException
	 */
	public HashMap detProgramCd(EligDetail aEligDetail) throws EDBCException {
		HashMap hmTemp = new HashMap();
		try {
			int iLength = aEligDetail.getEdEligibilityCargo().length;
			for (int i = 0; i < iLength; i++) {
				if (!hmTemp.containsKey(aEligDetail.getEdEligibilityCargo()[i]
						.getProgramCd())) {
					hmTemp.put(aEligDetail.getEdEligibilityCargo()[i]
							.getProgramCd(), aEligDetail
							.getEdEligibilityCargo()[i].getProgramCd());
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detProgramCd", ex);
		}
		return hmTemp;
	}

	/**
	 * Method detEdgList.
	 *
	 * @param arrEdgNums
	 *            Long[]
	 * @return String
	 * @throws EDBCException
	 */
	public static String detEdgList(Long[] arrEdgNums) throws EDBCException {
		int iLength = 0;
		if (arrEdgNums != null) {
			iLength = arrEdgNums.length;
		}
		StringBuffer sb = new StringBuffer();
		for (int j = 0; j < iLength; j++) {
			sb.append(String.valueOf(arrEdgNums[j].longValue()));
			if (j < (iLength - 1)) {
				sb.append(",");
			}
		}
		return sb.toString();
	}

	/**
	 * Method detEdIndvServDtlsEndProcess.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @throws EDBCException
	 */
	public void detEdIndvServDtlsEndProcess(EligDetail aEligDetail)
			throws EDBCException {
		int iLengthServDtls = 0;
		if (aEligDetail.getEdIndvServiceDtlsCargo() != null) {
			iLengthServDtls = aEligDetail.getEdIndvServiceDtlsCargo().length;
		}
		for (int i = 0; i < iLengthServDtls; i++) {
			if (aEligDetail.getEdEligibilityCargo()[0].getEdgNum() == aEligDetail
					.getEdIndvServiceDtlsCargo()[i].getEdgNum()) {
				if (aEligDetail.getEdEligibilityCargo()[0].getCgStatusCd()
						.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
					if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEdbcStatusCd() != null
							&& aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEdbcStatusCd().equals(
											IEdEligCodes.STATUS_CD_PENDING)) {
						aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.setEdbcStatusCd(aEligDetail
										.getEdEligibilityCargo()[0]
										.getCgStatusCd());
					}
				} else if (aEligDetail.getEdEligibilityCargo()[0]
						.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_DENIED)) {
					if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEdbcStatusCd() != null
							&& aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEdbcStatusCd().equals(
											IEdEligCodes.STATUS_CD_PENDING)) {
						aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.setEdbcStatusCd(aEligDetail
										.getEdEligibilityCargo()[0]
										.getCgStatusCd());
					}
				} else if (aEligDetail.getEdEligibilityCargo()[0]
						.getCgStatusCd().equals(
								IEdEligCodes.STATUS_CD_TERMINATED)) {
					if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEdbcStatusCd() != null
							&& aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEdbcStatusCd().equals(
											IEdEligCodes.STATUS_CD_PENDING)) {
						aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.setEdbcStatusCd(IEdEligCodes.STATUS_CD_DENIED);
					} else if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEdbcStatusCd() != null
							&& aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEdbcStatusCd().equals(
											IEdEligCodes.STATUS_CD_APPROVED)) {
						if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.getEndDt() == null
								|| DateComparisons
										.dateGTDateInTimestamp(aEligDetail
												.getEdIndvServiceDtlsCargo()[i]
												.getEndDt(), aEligDetail
												.getEdEligibilityCargo()[0]
												.getEligibilityEndDt())) {
							aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.setEndDt(aEligDetail
											.getEdEligibilityCargo()[0]
											.getEligibilityEndDt());
						}
					}
				}

				if (aEligDetail.getEdEligibilityCargo()[0].getCgEligRsltCd()
						.equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEligRsltCd() == null
							|| aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
						aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.setEligRsltCd(aEligDetail
										.getEdEligibilityCargo()[0]
										.getCgEligRsltCd());
					}
				} else if (aEligDetail.getEdEligibilityCargo()[0]
						.getCgEligRsltCd().equals(
								IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (aEligDetail.getEdIndvServiceDtlsCargo()[i]
							.getEligRsltCd() == null
							|| aEligDetail.getEdIndvServiceDtlsCargo()[i]
									.getEligRsltCd().equals(
											IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
						aEligDetail.getEdIndvServiceDtlsCargo()[i]
								.setEligRsltCd(aEligDetail
										.getEdEligibilityCargo()[0]
										.getCgEligRsltCd());
					}
				}
			}
		}
	}

	/**
	 * Method detEdLtcEligDatesEndProcess, determines EdLtcEligDatesEndProcess.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public void detEdLtcEligDatesEndProcess(EgDataHandler aEgDataHandler)
			throws EDBCException {
		try {
			if (aEgDataHandler.getAlEdLtcEligDates() != null) {
				EdEligibilityCargo edEligCargo = aEgDataHandler
						.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0];
				Timestamp tsMonthEndPaymentBegDt = DateComparisons
						.getLastDayOfDate(edEligCargo.getPaymentBegDt());
				Iterator it = aEgDataHandler.getAlEdLtcEligDates().iterator();
				ArrayList alTemp = new ArrayList();
				EdLtcEligDatesCargo cargo = null;
				EdLtcEligDatesCargo ltcCargo = null;
				while (it.hasNext()) {
					cargo = (EdLtcEligDatesCargo) it.next();
					if (cargo.getEdgNum() == edEligCargo.getEdgNum()) {
						if ((cargo.getEligibilityBeginDt().before(
								tsMonthEndPaymentBegDt) || cargo
								.getEligibilityBeginDt().equals(
										tsMonthEndPaymentBegDt))
								&& ((cargo.getEligibilityEndDt() == null) || (cargo
										.getEligibilityEndDt().after(
												edEligCargo.getPaymentBegDt()) || cargo
										.getEligibilityEndDt().equals(
												edEligCargo.getPaymentBegDt())))) {
							if (cargo.getEdbcStatusCd().equals(
									IEdEligCodes.STATUS_CD_PENDING)) {
								if (edEligCargo.getCgStatusCd().equals(
										IEdEligCodes.STATUS_CD_APPROVED)) {
									if (edEligCargo
											.getEligibilityBegDt()
											.after(
													cargo
															.getEligibilityBeginDt())) {
										cargo.setEligibilityBeginDt(edEligCargo
												.getEligibilityBegDt());
										cargo
												.setEdbcStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
									} else {
										cargo
												.setEdbcStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
									}
									cargo.setDiCompletedSw(IEdEligCodes.NO);
								}
							} else {
								if (cargo.getEdbcStatusCd().equals(
										IEdEligCodes.STATUS_CD_APPROVED)) {
									if (edEligCargo.getCgStatusCd().equals(
											IEdEligCodes.STATUS_CD_TERMINATED)) {
										if (cargo.getDiCompletedSw() == IEdEligCodes.NO) {
											if (cargo.getEligibilityEndDt() != null
													&& cargo
															.getEligibilityEndDt()
															.before(
																	edEligCargo
																			.getEligibilityEndDt())) {
											} else {
												cargo
														.setEligibilityEndDt(edEligCargo
																.getEligibilityEndDt());
											}
										} else {
											ltcCargo = (EdLtcEligDatesCargo) cargo
													.clone();
											ltcCargo.setLtcHistorySeq(0);
											if (ltcCargo.getEligibilityEndDt() != null
													&& ltcCargo
															.getEligibilityEndDt()
															.before(
																	edEligCargo
																			.getEligibilityEndDt())) {
											} else {
												ltcCargo
														.setEligibilityEndDt(edEligCargo
																.getEligibilityEndDt());
											}
											ltcCargo
													.setDiCompletedSw(IEdEligCodes.NO);
											alTemp.add(ltcCargo);
										}
									}
								}
							}
						}
					}
				}
				if (alTemp.size() > 0) {
					aEgDataHandler.getAlEdLtcEligDates().addAll(alTemp);
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detEdLtcEligDatesEndProcess", ex);
		}
	}

	/**
	 * Method voidDeniedMCEdg, void denied MC Edg's.
	 *
	 * @param aArrEligDetailProcessed
	 *            EligDetail[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public void voidDeniedMCEdg(EligDetail[] aArrEligDetailProcessed,
			EgDataHandler aEgDataHandler) throws EDBCException {
		try {
			DcCaseProgramCargo[] arrDcCaseProgramCargo = aEgDataHandler
					.getDcCaseProgramCargo();
			int iDcCaseProgramLength = 0;
			if (arrDcCaseProgramCargo != null) {
				iDcCaseProgramLength = arrDcCaseProgramCargo.length;
			}
			boolean bMCRequestFound = false;
			for (int j = 0; j < iDcCaseProgramLength; j++) {
				if (arrDcCaseProgramCargo[j].getProgCd().equals(
						IEdEligCodes.PROGRAM_CD_MC)) {
					bMCRequestFound = true;
					break;
				}
			}
			int iLength = aArrEligDetailProcessed.length;
			boolean bEdgReprocessSw = false;
			for (int j = 0; j < iLength; j++) {
				if (aArrEligDetailProcessed[j].getEdEligibilityCargo()[0]
						.getEdgReprocessSw() == IEdEligCodes.YES) {
					bEdgReprocessSw = true;
				}
			}
			if (bEdgReprocessSw == false) {
				for (int i = 0; i < iLength; i++) {
					if (bMCRequestFound == false) {
						if (aArrEligDetailProcessed[i].getEdEligibilityCargo()[0]
								.getProgramCd().equals(
										IEdEligCodes.PROGRAM_CD_MC)) {
							if (aArrEligDetailProcessed[i]
									.getEdEligibilityCargo()[0].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_DENIED)) {
								aArrEligDetailProcessed[i]
										.getEdEligibilityCargo()[0]
										.setDeleteSw(IEdEligCodes.YES);
							}
						}
					}
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"voidDeniedCCEdg", ex);
		}
	}

	/**
	 * Method setEdgReprocessSw, set Edg Reprocess Switch.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param aMapRequest
	 *            Map
	 */
	public void setEdgReprocessSw(EligDetail[] aArrEligDetailOutput,
			Map aMapRequest) {
		boolean bEdgReprocessSw = false;
		int iLength = aArrEligDetailOutput.length;
		for (int i = 0; i < iLength; i++) {

			if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0]
					.getEdgReprocessSw() == IEdEligCodes.YES) {
				bEdgReprocessSw = true;
				break;
			}
		}
		if (bEdgReprocessSw == true) {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW, new
			// Boolean(true));
			aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW, Boolean
					.valueOf(true));
		} else {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW, new
			// Boolean(false));
			aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW, Boolean
					.valueOf(false));
		}
	}

	//BEGIN-BRGUS00156670-upadhyayulag-New method added
	/**
	 * Method setMaOrAllEdgReprocessSw is used to set REQUEST_MAONLY_EDG_REPROCESS_SW to true if Medicaid
	 * only needs to be rebuilt. Otherwise, If all the programs are to be rebuilt it will be set to false
	 *
	 * @param aArrEligDetailOutput EligDetail[]
	 * @param aMapRequest contains the request Map
	 * @param runMode contains the mode of EDBC run
	 */
	public void setMaOnlyEdgReprocessSw(EligDetail[] aArrEligDetailOutput,
			Map aMapRequest, String runMode) throws Exception{
		boolean bMedicaidEdgReprocessSw = false;
		boolean bAllEdgReprocessSw = false;
		int iLength = aArrEligDetailOutput.length;
		for (int i = 0; i < iLength; i++) {
			if (aArrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgReprocessSw() == IEdEligCodes.YES) {
				if(aArrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().
						equals(IEdEligCodes.PROGRAM_CD_FMA) ||
						aArrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().
						equals(IEdEligCodes.PROGRAM_CD_ME) ||
						aArrEligDetailOutput[i].getEdEligibilityCargo()[0].getProgramCd().
						equals(IEdEligCodes.PROGRAM_CD_MC)){
					bMedicaidEdgReprocessSw = true;
				}else{
					bAllEdgReprocessSw = true;//Rebuild all the EDGs
					bMedicaidEdgReprocessSw = false;//Make medicaid rebuild alone to false
					break;
				}
			}
		}
		
		if (bMedicaidEdgReprocessSw == true) {
			//aMapRequest.put(IEdEligCodes.REQUEST_MAONLY_EDG_REPROCESS_SW, Boolean.valueOf(true));
		}
		if(bAllEdgReprocessSw) {
			//aMapRequest.put(IEdEligCodes.REQUEST_MAONLY_EDG_REPROCESS_SW, Boolean.valueOf(false));
		}
	}
	//END-BRGUS00156670
	
	//BEGIN-BRGUS00153284-upadhyayulag-New method added
	/**
	 * Method isDCHBusinessFunctionsUser is used to find if a user is 
	 * having DCH business function
	 *
	 * @param aMapRequest Map
	 * @return boolean
	 */
	
	public boolean isDCHBusinessFunctionsUser(User userInfo) throws Exception{
		
		boolean isDCHBusinessFunctionsUser = false;
		if(userInfo != null){
			try {
				ISecurityFunctions securityBO = 
					(ISecurityFunctions)FwServiceFactory.getInstance().create(ISecurityFunctions.class);
				isDCHBusinessFunctionsUser = securityBO.isUserAuthorized(new Long(4861).longValue(),userInfo);
			} catch (Exception e) {
				throw new TIERSRunTimeException(
						"Error in isDCHBusinessFunctionsUser from EdUtil"
								+ e.getMessage());
			}
		}
		return isDCHBusinessFunctionsUser;
	}
	//END-BRGUS00153284
	
	/**
	 * Method setMapRequest, to be used after processing main EDBC modules.
	 *
	 * @param aArrEligDetailOutput
	 *            EligDetail[]
	 * @param aMapRequest
	 *            Map
	 */
	public void setMapRequest(EligDetail[] aArrEligDetailOutput, Map aMapRequest) {

		boolean bEligResultNotTested = false;
		boolean bTp13Ta22MeExists = false;

		int iLength = aArrEligDetailOutput.length;
		EdEligibilityCargo edElig = null;
		for (int i = 0; i < iLength; i++) {

			edElig = aArrEligDetailOutput[i].getEdEligibilityCargo()[0];
			if (edElig.getRscEligRsltCd() != null) {
				//If condition modified for Defect #196302
				if ((edElig.getRscEligRsltCd()
						.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_NT))
						|| ((edElig.getFinEligRsltCd() != null) && (edElig
								.getFinEligRsltCd()
								.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_NT)))) {
					bEligResultNotTested = true;
				}
			}
			if ((edElig.getTypeOfAssistanceCd()
					.equalsIgnoreCase(IEdEligCodes.TP_13))
					|| (edElig.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.TA_22))) {
				bTp13Ta22MeExists = true;
			}
		}

		if (bEligResultNotTested == true) {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_ELIG_RESULT_NT_SW, new
			// Boolean(true));
			aMapRequest.put(IEdEligCodes.REQUEST_ELIG_RESULT_NT_SW, Boolean
					.valueOf(true));
		} else {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_ELIG_RESULT_NT_SW, new
			// Boolean(false));
			aMapRequest.put(IEdEligCodes.REQUEST_ELIG_RESULT_NT_SW, Boolean
					.valueOf(false));
		}

		if (bTp13Ta22MeExists == true) {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_ME_SSI_SW, new
			// Boolean(true));
			aMapRequest.put(IEdEligCodes.REQUEST_ME_SSI_SW, Boolean
					.valueOf(true));
		} else {
			//Commented due to FindBugs Analysis
			//aMapRequest.put(IEdEligCodes.REQUEST_ME_SSI_SW, new
			// Boolean(false));
			aMapRequest.put(IEdEligCodes.REQUEST_ME_SSI_SW, Boolean
					.valueOf(false));
		}

	}

	/**
	 * Method populateWaiverHMTPCodes, populates and return hashmap with Waiver
	 * TP Codes..
	 *
	 * @return contains the HashMap of waiver TOA codes
	 */
	
	public HashMap populateWaiverHMTPCodes() {
		HashMap hmTemp = new HashMap();
		String[] sTpCodes = IEdEligCodes.CC_WAIVER_TP_CODES;
		int iLength = sTpCodes.length;
		for (int i = 0; i < iLength; i++) {
			hmTemp.put(sTpCodes[i], sTpCodes[i]);
		}
		return hmTemp;
	}

	/**
	 * Method performWaiverAdjustments, perform waiver adjustments, if TA11
	 * fails in current EDG then fail TP14 if it is approved earliar, similarly
	 * if Medicaid Waiver is failed in current Edg then fail TA10 if already
	 * approved.
	 *
	 * @param sMonth
	 *            contains the current month String
	 * @param aArrEligDetailInput
	 *            contains the input array of EligDetail
	 * @param aArrEligDetailPrevProc
	 *            contains the previous processed array of EligDetail
	 * @param aDcCaseProgramCargo
	 *            contains the DcCaseProgramCargo of current record
	 * @param aEgDataHandler
	 *            contains the EgDataHandler
	 * @param aNfDataHandler
	 *            contains the NFDataHandler
	 * @param aHmWaiverTpCodes
	 *            contains the HashMap of waiver TOA codes
	 * @param aSReqModSw
	 *            contains the ReqModSw
	 * @param aSUserId
	 *            contains the user id
	 * @param conn
	 *            contains the Connection object
	 * 
	 * @throws EDBCException
	 * @throws TIERSValidationException
	 * @throws RulesException
	 * @throws ApplicationException
	 * @throws RecoveryException
	 * @throws Exception
	 */
	
	//BRGUS00113495 – kesavanr – Adding ApplicationException,RecoveryException in the method signature.
	public void performWaiverAdjustments(String sMonth,
			EligDetail[] aArrEligDetailInput,
			EligDetail[] aArrEligDetailPrevProc,
			DcCaseProgramCargo aDcCaseProgramCargo,
			EgDataHandler aEgDataHandler, NFDataHandler aNfDataHandler,
			HashMap aHmWaiverTpCodes, String aSReqModSw, String aSUserId, Connection conn) throws EDBCException,
			TIERSValidationException, RulesException,ApplicationException, RecoveryException, Exception {
		int iLengthPrevProc = aArrEligDetailPrevProc.length;
		ArrayList alRecords = new ArrayList();
		//Added for defect 219444
		EligDetail aEligDetailTA11 = null;
		EligDetail aEligDetailCCWaiverTp = null;
		boolean bFoundTA11 = false;
		boolean bFoundCCWaiverTP = false;
		for (int i = 0; i < iLengthPrevProc; i++) {
			if (aArrEligDetailPrevProc[i] != null) {
				if (DateComparisons.getStringMMYYYY(
						aArrEligDetailPrevProc[i].getEdEligibilityCargo()[0]
								.getPaymentBegDt()).equals(sMonth)) {
					//Added for defect 219444
					if (!bFoundTA11) {
						if (aArrEligDetailPrevProc[i].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TA_11)) {
							aEligDetailTA11 = aArrEligDetailPrevProc[i];
							bFoundTA11 = true;
						}
					}
					if (!bFoundCCWaiverTP) {
						if (aHmWaiverTpCodes
								.containsKey(aArrEligDetailPrevProc[i]
										.getEdEligibilityCargo()[0]
										.getTypeOfAssistanceCd())) {
							aEligDetailCCWaiverTp = aArrEligDetailPrevProc[i];
							bFoundCCWaiverTP = true;
						}
					}
					alRecords.add(aArrEligDetailPrevProc[i]);
				}
			}
		}
		Iterator it = alRecords.iterator();
		int iMonth = 0;
		EligDetail aEligDetail = null;
		boolean bFound = false;
		int iLenTemp = 0;
		int iLen = 0;
		int iLengthIndv = 0;
		int iCgSize = 0;
		HashMap hmTemp = null;
		while (it.hasNext()) {
			aEligDetail = (EligDetail) it.next();
			if (aEligDetail.getEdEligibilityCargo()[0].getTypeOfAssistanceCd()
					.equals(IEdEligCodes.TP_MEDICAID_WAIVERS)
					|| aEligDetail.getEdEligibilityCargo()[0]
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_14)) {
				bFound = false;
				// Following else if condition is added by Sai on 7/20/2004 for
				// Def# 00182666, to pend TA10
				// If condition modified to check TP14 approved or pending for
				// defect# 193427
				// Modified to use eligdetailta11 instead eligdetailcurredm for
				// defect 219444
				if (aEligDetail.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_14)) {
					if ((aEligDetail.getEdEligibilityCargo()[0].getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_APPROVED) || (aEligDetail
							.getEdEligibilityCargo()[0].getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_PENDING)))
							&& (aEligDetailTA11 != null && aEligDetailTA11
									.getEdEligibilityCargo()[0].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_PENDING))) {
						bFound = pendWaiverAdjustments(aEligDetail,
								aEgDataHandler);
					}
				} else if (aEligDetail.getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_MEDICAID_WAIVERS)) {
					//					Modified to use aEligDetailCCWaiverTp instead
					// eligdetailcurredm for defect 219444
					if ((aEligDetail.getEdEligibilityCargo()[0].getCgStatusCd()
							.equals(IEdEligCodes.STATUS_CD_APPROVED) || aEligDetail
							.getEdEligibilityCargo()[0].getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_PENDING))
							&& (aEligDetailCCWaiverTp != null && aEligDetailCCWaiverTp
									.getEdEligibilityCargo()[0].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_PENDING))) {
						bFound = pendWaiverAdjustments(aEligDetail,
								aEgDataHandler);
					}

				}

				if (!bFound) {
					iLengthIndv = aEligDetail.getEdIndvEligibilityCargo().length;
					for (int j = 0; j < iLengthIndv; j++) {
						if (aEligDetail.getEdIndvEligibilityCargo()[j]
								.getPartStatusCd().startsWith("E")) {
							if (detEligibleInCC(aEligDetail
									.getEdEligibilityCargo()[0], aEligDetail
									.getEdIndvEligibilityCargo()[j],
									(EligDetail[]) alRecords
											.toArray(new EligDetail[alRecords
													.size()]), aHmWaiverTpCodes) == false) {
								performIndvCleanUp(aEligDetail
										.getEdIndvEligibilityCargo()[j],
										aEligDetail.getEdEligibilityCargo()[0]);
							}
						}
					}
					iCgSize = 0;
					iLengthIndv = aEligDetail.getEdIndvEligibilityCargo().length;
					for (int j = 0; j < iLengthIndv; j++) {
						//Defect Tiers00201850
						if (aEligDetail.getEdIndvEligibilityCargo()[j]
								.getGroupInd() == IEdEligCodes.GROUP_IND_C
								&& (aEligDetail.getEdIndvEligibilityCargo()[j]
										.getEligRsltCd().equals(
												IEdEligCodes.ELIG_RSLT_CD_PASS) || aEligDetail
										.getEdIndvEligibilityCargo()[j]
										.getEligRsltCd()
										.equals(
												IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
							iCgSize = iCgSize + 1;
						}
					}
					//set notice reasons
					//Added for defect 219486
					//Modified for defect # 230433 , 0n 6/28/2005
					// Added the termination condition for defect 241507
					if ((aEligDetailTA11 != null
							&& (aEligDetailTA11.getEdEligibilityCargo()[0]
									.getCgStatusCd().equals(
											IEdEligCodes.STATUS_CD_DENIED) || aEligDetailTA11
									.getEdEligibilityCargo()[0].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_TERMINATED)) && aEligDetail
							.getEdEligibilityCargo()[0].getTypeOfAssistanceCd()
							.equals(IEdEligCodes.TP_14))
							|| (aEligDetailCCWaiverTp != null
									&& (aEligDetailCCWaiverTp
											.getEdEligibilityCargo()[0]
											.getCgStatusCd()
											.equals(
													IEdEligCodes.STATUS_CD_DENIED) || aEligDetailCCWaiverTp
											.getEdEligibilityCargo()[0]
											.getCgStatusCd()
											.equals(
													IEdEligCodes.STATUS_CD_TERMINATED)) && aEligDetail
									.getEdEligibilityCargo()[0]
									.getTypeOfAssistanceCd().equals(
											IEdEligCodes.TP_MEDICAID_WAIVERS))) {
						aEligDetail.getEdEligNoticeReasonsCargo()[0]
								.setFailureReasonCode(aEligDetail
										.getEdEligNoticeReasonsCargo()[0]
										.getFailureReasonCode()
										.concat(
												IEdEligCodes.FAILURE_REASON_CODE_EL5202));
					}

					if (iCgSize == 0) {
						aEligDetail.getEdEligibilityCargo()[0]
								.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
						//Added condition based on defect 156460
						if (aEligDetail.getEdEligibilityCargo()[0]
								.getActivityType().equals(
										IEdEligCodes.ACTIVITY_TYPE_INTAKE)) {
							if (aEligDetail.getEdEligibilityCargo()[0]
									.getEligibilityBegDt() != null
									&& aEligDetail.getEdEligibilityCargo()[0]
											.getEligibilityBegDt()
											.equals(
													aEligDetail
															.getEdEligibilityCargo()[0]
															.getPaymentBegDt())) {
								aEligDetail.getEdEligibilityCargo()[0]
										.setEligibilityBegDt(null);
								//BRGUS00129025 - Bhuvane - To set this only first time
								/*aEligDetail.getEdEligibilityCargo()[0]
										.setDispositionEligBegDt(aEligDetail
												.getEdEligibilityCargo()[0]
												.getEdbcRunDt());*/
								aEligDetail.getEdEligibilityCargo()[0]
										.setEligibilityEndDt(null);
								aEligDetail.getEdEligibilityCargo()[0]
										.setEstimatedEligEndDt(null);
							}
						}
					}
				}

				//Commented based on defect 156460
				//				aEligDetail.getEdEligibilityCargo()[0].setCgSize(iCgSize);
				// Moved out of the if bFound check for defect 219444
				hmTemp = detParamsForEDBCEndProcess(aArrEligDetailPrevProc,
						aEligDetail);
				hmTemp
						.put(IEdEligCodes.ELIG_DETAIL_ALL_DB,
								aArrEligDetailInput);
				hmTemp.put(IEdEligCodes.DC_CASE_PROGRAM_CARGO,
						aDcCaseProgramCargo);
				hmTemp.put(IEdEligCodes.EG_DATA_HANDLER, aEgDataHandler);
				hmTemp.put(IEdEligCodes.NF_DATA_HANDLER, aNfDataHandler);
				hmTemp.put(IEdEligCodes.MODULE_SWITCH_FROM_REQUEST, aSReqModSw);

				if (((EdEligibilityCargo) hmTemp
						.get(IEdEligCodes.ED_ELIG_PREV_MTH_OTHER_EDM))
						.getCaseNum() != 0) {
					//Commented due to FindBugs Analysis
					//hmTemp.put(IEdEligCodes.FIRST_MONTH_FLAG, new
					// Boolean(false));
					hmTemp.put(IEdEligCodes.FIRST_MONTH_FLAG, Boolean
							.valueOf(false));
				} else {
					//Commented due to FindBugs Analysis
					//hmTemp.put(IEdEligCodes.FIRST_MONTH_FLAG, new
					// Boolean(true));
					hmTemp.put(IEdEligCodes.FIRST_MONTH_FLAG, Boolean
							.valueOf(true));
				}
				iMonth = iMonth + 1;
				hmTemp.put("CONNECTION", conn);
				hmTemp.put("USER_ID", aSUserId);
				determineEdDetails(hmTemp, null, null);
			}
		}
	}

	/**
	 * Method detEligibleInCC, find if the individual is eligible in CC.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aArrEligDetailPrevProc
	 *            EligDetail[]
	 * @param aHmWaiverTpCodes
	 *            HashMap
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean detEligibleInCC(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EligDetail[] aArrEligDetailPrevProc, HashMap aHmWaiverTpCodes)
			throws EDBCException {
		int iLength = aArrEligDetailPrevProc.length;
		boolean bFoundEligible = false;
		int iLengthIndv = 0;
		for (int i = 0; i < iLength; i++) {
			if (aArrEligDetailPrevProc[i] != null) {
				if ((aHmWaiverTpCodes.containsKey(aArrEligDetailPrevProc[i]
						.getEdEligibilityCargo()[0].getTypeOfAssistanceCd()) && aEdEligibilityCargo
						.getTypeOfAssistanceCd().equals(
								IEdEligCodes.TP_MEDICAID_WAIVERS))
						|| (aArrEligDetailPrevProc[i].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TA_11) && aEdEligibilityCargo
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_14))) {
					if (aArrEligDetailPrevProc[i] != null) {
						iLengthIndv = aArrEligDetailPrevProc[i]
								.getEdIndvEligibilityCargo().length;
						for (int j = 0; j < iLengthIndv; j++) {
							if (aEdIndvEligibilityCargo.getIndvId() == aArrEligDetailPrevProc[i]
									.getEdIndvEligibilityCargo()[j].getIndvId()) {
								if (aArrEligDetailPrevProc[i]
										.getEdIndvEligibilityCargo()[j]
										.getPartStatusCd().startsWith("E")
										&& aArrEligDetailPrevProc[i]
												.getEdIndvEligibilityCargo()[j]
												.getTargetSw() == IEdEligCodes.YES) {
									bFoundEligible = true;
									break;
								}
							}
						}
					}
				}
			}
		}
		return bFoundEligible;
	}

	/**
	 * Method performIndvCleanUp, set Part Status code and set Indv Elig Beg and
	 * End Date to null .
	 *
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException
	 */
	private void performIndvCleanUp(
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargo) throws EDBCException {
		aEdIndvEligibilityCargo.setGroupInd(IEdEligCodes.GROUP_IND_E);
		if (aEdIndvEligibilityCargo.getPartStatusCd().endsWith("A")) {
			aEdIndvEligibilityCargo
					.setPartStatusCd(IEdEligCodes.PART_STATUS_CD_OTHER_ADULT);
		} else if (aEdIndvEligibilityCargo.getPartStatusCd().endsWith("C")) {
			aEdIndvEligibilityCargo
					.setPartStatusCd(IEdEligCodes.PART_STATUS_CD_OTHER_CHILD);
		}
		aEdIndvEligibilityCargo.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
		aEdIndvEligibilityCargo.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
		if (aEdIndvEligibilityCargo.getEligibilityBegDt() != null
				&& aEdIndvEligibilityCargo.getEligibilityBegDt().equals(
						aEdEligibilityCargo.getPaymentBegDt())) {
			aEdIndvEligibilityCargo.setEligibilityBegDt(null);
			aEdIndvEligibilityCargo.setEligibilityEndDt(null);
		}
	}

	/*
	 * private void detSsnReqStatusCd(EdIndvEligibilityCargo
	 * aEdIndvEligibilityCargo, EdIndvEligibilityCargo
	 * aPrevEdIndvEligibilityCargo) throws EDBCException { try { //Modifed for
	 * defect 107287 if (aPrevEdIndvEligibilityCargo != null &&
	 * aPrevEdIndvEligibilityCargo.getSsnReqStatusCd() != null) {
	 * aEdIndvEligibilityCargo.setSsnReqStatusCd(aPrevEdIndvEligibilityCargo.getSsnReqStatusCd()); } }
	 * catch (Exception ex) { throw new EDBCException(EDBCException.MAJOR
	 * ,"EdUtil", "detSsnReqStatusCd", ex); }
	 *
	 *  }
	 */

	/**
	 * Method detPrevMthEstEligEndDt, determine previous month Estimated
	 * eligibility End Date.
	 *
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return Timestamp
	 */
	public static Timestamp detPrevMthEstEligEndDt(
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdEligibilityCargo aEdEligibilityCargo) {
		Timestamp tsToBeUsed = null;
		if (aEdEligibilityCargoPrevMth != null
				&& aEdEligibilityCargoPrevMth.getEstimatedEligEndDt() != null) {
			/*
			 * For CMA TOAs - pre-populate the estimated elig end date only if
			 * CgStatus is Approved or Pending
			 */
			if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
					IEdEligCodes.TP_43)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_44)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_47)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_48)) {
				if (aEdEligibilityCargoPrevMth.getCgStatusCd().equals("PE")
						|| aEdEligibilityCargoPrevMth.getCgStatusCd().equals(
								"AP")) {
					tsToBeUsed = aEdEligibilityCargoPrevMth
							.getEstimatedEligEndDt();
				}
			} else {
				tsToBeUsed = aEdEligibilityCargoPrevMth.getEstimatedEligEndDt();
			}
			// Added the TP86 for defect 228869
			/*
			 * Begin - beniwala - ASPEN00039327 - do not copy estimatedEligEndtDt for TANF from previous month
			 * if current month is in PR mode and previous month is not in PR mode
			 */			
			/*if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_43)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_44)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_47)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_48)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_86)) {*/
			if (IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
					|| IEdEligCodes.TP_43.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_44.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_47.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_48.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_86.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
				// End - beniwala - ASPEN00039327 
				if (aEdEligibilityCargo.getActivityType().equals(
						IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
					if (!aEdEligibilityCargo.getActivityType().equals(
							aEdEligibilityCargoPrevMth.getActivityType())) {
						tsToBeUsed = null;
					}
				}
			}
		}

		return tsToBeUsed;
	}

	//Added for issue with FS dropping for PR

	/**
	 * Method detPrevMthBegDt, determines previous month begin date.
	 *
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return Timestamp
	 */
	private Timestamp detPrevMthBegDt(
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdEligibilityCargo aEdEligibilityCargo) {
		// beniwala - ASPEN00031274 - fix findbugs issue
		Timestamp tsToBeUsed = null;
		if(aEdEligibilityCargoPrevMth != null) {
			tsToBeUsed = aEdEligibilityCargoPrevMth.getEligibilityBegDt();
			if (aEdEligibilityCargo != null && IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(
					aEdEligibilityCargo.getProgramCd())) {
				if (IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())) {
					if (!aEdEligibilityCargo.getActivityType().equals(
							aEdEligibilityCargoPrevMth.getActivityType())) {
						tsToBeUsed = aEdEligibilityCargo.getPaymentBegDt();
					}
				}
			}
		}
		
		return tsToBeUsed;
	}

	/*
	 * private Timestamp detPrevMthIndvBegDt(EdIndvEligibilityCargo
	 * aEdIndvEligibilityCargoPrevMth, EdEligibilityCargo
	 * aEdEligibilityCargoPrevMth, EdIndvEligibilityCargo
	 * aEdIndvEligibilityCargo, EdEligibilityCargo aEdEligibilityCargo) {
	 * Timestamp tsToBeUsed =
	 * aEdIndvEligibilityCargoPrevMth.getEligibilityBegDt(); if
	 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)) {
	 * if
	 * (aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
	 * if
	 * (!aEdEligibilityCargo.getActivityType().equals(aEdEligibilityCargoPrevMth.getActivityType())) {
	 * if
	 * (aEdIndvEligibilityCargo.getEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
	 * tsToBeUsed = aEdEligibilityCargo.getPaymentBegDt(); } else { tsToBeUsed =
	 * null; } } } } return tsToBeUsed; }
	 */

	//private Timestamp detPrevMthIndvBegDtForMM(EdIndvEligibilityCargo
	// aEdIndvEligibilityCargoPrevMth, EdEligibilityCargo
	// aEdEligibilityCargoPrevMth, EdIndvEligibilityCargo
	// aEdIndvEligibilityCargo, EdEligibilityCargo aEdEligibilityCargo,
	// EgDataHandler aEgDataHandler) throws EDBCException {
	/**
	 * Method adjustPrevMthIndvBegDtForMM, adjust previous month Indv Beg dat
	 * based on IndvDate Specific or Potentil Elig begin date.
	 *
	 * @param aEdIndvEligibilityCargoPrevMth
	 *            EdIndvEligibilityCargo
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean adjustPrevMthIndvBegDtForMM(
			EdIndvEligibilityCargo aEdIndvEligibilityCargoPrevMth,
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler)
			throws EDBCException {
		Timestamp tsToBeUsed = null;
		EdIndvDateSpecificCargo[] arrEdIndvDateSpecificCargo = null;
		try {
			if (aEdIndvEligibilityCargoPrevMth.getEligibilityBegDt() != null) {
				tsToBeUsed = aEdIndvEligibilityCargoPrevMth
						.getEligibilityBegDt();
			}
			if ((aEdIndvEligibilityCargoPrevMth.getGroupInd() == IEdEligCodes.GROUP_IND_C)
					&& (aEdIndvEligibilityCargoPrevMth.getEligRsltCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
				if (aEdIndvEligibilityCargoPrevMth.getMultiEligRecSw() == IEdEligCodes.YES) {
					Timestamp tsDtSpecificBegDt = DateComparisons
							.getDate(IEdEligCodes.LOW_DATE);
					boolean bDtFound = false;
					int iIndvDtSpecificLength = 0;
					if (aEgDataHandler.getEligDetailPrevProc() != null) {
						if (aEgDataHandler.getEligDetailPrevProc()
								.getEdIndvDateSpecificCargo() != null) {
							iIndvDtSpecificLength = aEgDataHandler
									.getEligDetailPrevProc()
									.getEdIndvDateSpecificCargo().length;
							arrEdIndvDateSpecificCargo = aEgDataHandler
									.getEligDetailPrevProc()
									.getEdIndvDateSpecificCargo();
						}
					}
					// Loop thru
					for (int i = 0; i < iIndvDtSpecificLength; i++) {
						if (arrEdIndvDateSpecificCargo[i].getIndvId() == aEdIndvEligibilityCargo
								.getIndvId()) {
							if (arrEdIndvDateSpecificCargo[i]
									.getEligibilityBegDt().after(
											tsDtSpecificBegDt)) {
								tsDtSpecificBegDt = arrEdIndvDateSpecificCargo[i]
										.getEligibilityBegDt();
								bDtFound = true;
							}
						}
					}
					if (bDtFound) {
						tsToBeUsed = tsDtSpecificBegDt;
					}

				} else if (aEdIndvEligibilityCargoPrevMth
						.getPotentialEligBegDt() != null) {
					tsToBeUsed = aEdIndvEligibilityCargoPrevMth
							.getPotentialEligBegDt();
				}
			}else{
				//BEGIN-BRGUS00208572-upadhyayulag-Check if there is a previous month V record. 
				//If it exists and eligibility begin date is present copy from that record
				if(aEdIndvEligibilityCargoPrevMth.getIndvId() == 0){
					EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
							aEgDataHandler.getEdEligibilityCargoVrecords(),
							aEdEligibilityCargo);
					if(edEligibilityCargoV != null){
						EdIndvEligibilityCargo[] edIndvEligibilityCargoV = getEdIndvEligibilityByTraceId(
								aEgDataHandler.getEdIndvEligibilityCargoVrecords(),	edEligibilityCargoV);
						if(edIndvEligibilityCargoV != null && edIndvEligibilityCargoV.length > 0){
							int edIndvEligibilityCargoVLen = edIndvEligibilityCargoV.length;
							for (int i = 0; i < edIndvEligibilityCargoVLen; i++) {
								if(edIndvEligibilityCargoV[i].getIndvId() == aEdIndvEligibilityCargo.getIndvId() 
										&& edIndvEligibilityCargoV[i].getEligibilityBegDt() != null){
									aEdIndvEligibilityCargo.setEligibilityBegDt(
											edIndvEligibilityCargoV[i].getEligibilityBegDt());
									break;
								}
							}
						}
					}
				}
				//END-BRGUS00208572
			}
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detPrevMthIndvBegDtForMM", e);
		}
		if (tsToBeUsed != null) {
			aEdIndvEligibilityCargo.setEligibilityBegDt(tsToBeUsed);
			return true;
		} else {
			return false;
		}
	}

	/**
	 * Method detEligOrPaymentBegDt, determine Eligibility or Payment Beg date
	 * to be used in determining Estimated Eligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return Timestamp
	 */
	public static Timestamp detEligOrPaymentBegDt(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) {
		EdEligibilityCargo edEligibilityCargoPrevMth = null;
		if (((Boolean) aEgDataHandler.getHmParamForEndProcess().get(
				IEdEligCodes.FIRST_MONTH_FLAG)).booleanValue() == true) {
			edEligibilityCargoPrevMth = (EdEligibilityCargo) aEgDataHandler
					.getHmParamForEndProcess().get(
							IEdEligCodes.ED_ELIG_PREV_MTH_FIRST_EDM);
		} else {
			edEligibilityCargoPrevMth = (EdEligibilityCargo) aEgDataHandler
					.getHmParamForEndProcess().get(
							IEdEligCodes.ED_ELIG_PREV_MTH_OTHER_EDM);
		}
		Timestamp tsDateToBeUsed = null;
		if (aEdEligibilityCargo.getActivityType().equals(
				IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
			if (edEligibilityCargoPrevMth != null
					&& edEligibilityCargoPrevMth.getActivityType() != null
					&& !aEdEligibilityCargo.getActivityType().equals(
							edEligibilityCargoPrevMth.getActivityType())) {
				tsDateToBeUsed = aEdEligibilityCargo.getPaymentBegDt();
			} else {
				// 				Modified for CMA Changes
				//				tsDateToBeUsed = aEdEligibilityCargo.getEligibilityBegDt();
				tsDateToBeUsed = aEdEligibilityCargo.getCertBegDt();
			}
		} else {
			//			Modified for CMA Changes
			//			tsDateToBeUsed = aEdEligibilityCargo.getEligibilityBegDt();
			tsDateToBeUsed = aEdEligibilityCargo.getCertBegDt();
		}
		return tsDateToBeUsed;
	}

	//Added for Prod Benefit Status to Reprocess change using code change
	// 113645
	/**
	 * Determines the Supplement & Recoupment Switches to Y if Benefit Status is
	 * Ceritify.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 */
	private static void detSuppAndRecoupSw(
			EdEligibilityCargo aEdEligibilityCargo) {

		if ((aEdEligibilityCargo.getBenefitStatus() != null)
				&& (aEdEligibilityCargo.getBenefitStatus()
						.equals(IEdEligCodes.BENEFIT_STATUS_CERTIFY))) {
			aEdEligibilityCargo.setSupplementAdviceSw(IEdEligCodes.YES);
			aEdEligibilityCargo.setRecoupmentAdviceSw(IEdEligCodes.YES);
		}
	}

	//	Added for CMA Changes

	/**
	 * Method detCMACertificationPeriod, determine Child Medical Assistance
	 * Certification period.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @param aNfDataHandler
	 *            NFDataHandler
	 * @throws EDBCException
	 */
	public static void detCMACertificationPeriod(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EgDataHandler aEgDataHandler, NFDataHandler aNfDataHandler)
			throws EDBCException {
		EdEligibilityCargo aEdEligibilityCargoPrevMth = null;
		if (((Boolean) aEgDataHandler.getHmParamForEndProcess().get(
				IEdEligCodes.FIRST_MONTH_FLAG)).booleanValue() == true) {
			aEdEligibilityCargoPrevMth = (EdEligibilityCargo) aEgDataHandler
					.getHmParamForEndProcess().get(
							IEdEligCodes.ED_ELIG_PREV_MTH_FIRST_EDM);
		} else {
			aEdEligibilityCargoPrevMth = (EdEligibilityCargo) aEgDataHandler
					.getHmParamForEndProcess().get(
							IEdEligCodes.ED_ELIG_PREV_MTH_OTHER_EDM);
		}
		EligDetail[] aArrEligDetailPrevProc = (EligDetail[]) aEgDataHandler
				.getHmParamForEndProcess().get(
						IEdEligCodes.ELID_DETAIL_ALL_PROCCESSED);
		EligDetail aEligDetailLastAuth = ((EligDetail[]) aEgDataHandler
				.getHmParamForEndProcess().get(IEdEligCodes.ELIG_DETAIL_ALL_DB))[1];

		//Timestamp tsTempEstEligEndDt = null;
		//Modified for defect 191588
		//ID : BRGUS00117682 -- KesireddV -- cert end date is request date + 11 months if activity type is intake for OHK
		if(aEdEligibilityCargo.getActivityType().equals(
				IEdEligCodes.ACTIVITY_TYPE_INTAKE))
				{
			if (aEdEligibilityCargo.getCertEndDt() == null) {
				if (aEdEligibilityCargoPrevMth.getCertEndDt() == null
						|| (aEdEligibilityCargoPrevMth.getCertEndDt() != null && !aEdEligibilityCargoPrevMth
								.getActivityType().equals(
										aEdEligibilityCargo.getActivityType()))) {
					if (aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_APPROVED)) {
						Timestamp tsTempCertEndDt = DateComparisons.getLastDayOfDate(DateComparisons
								.addMonths(aEdEligibilityCargo.getRequestDt(), 11));
						aEdEligibilityCargo.setCertEndDt(tsTempCertEndDt);
						aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo.getPaymentBegDt());
						aEdEligibilityCargo.setDispositionCertBegDt(aEdEligibilityCargo
								.getEdbcRunDt());
					}
				} else {
					aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargoPrevMth
							.getCertEndDt());
					aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargoPrevMth
							.getCertBegDt());
					//New Code
					if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FMA)
							&& aEdEligibilityCargo.getPriorMedicalCd().equals(
									"P0") == false) {
						aEdEligibilityCargo.setCertBegDt(null);
					}
					aEdEligibilityCargo
							.setDispositionCertBegDt(aEdEligibilityCargo
									.getEdbcRunDt());
				}
			}

				}
		else if (aEdEligibilityCargo.getActivityType().equals(
				IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)
				) {
			if (aEdEligibilityCargo.getCertEndDt() == null) {
				if (aEdEligibilityCargoPrevMth.getCertEndDt() == null
						|| (aEdEligibilityCargoPrevMth.getCertEndDt() != null && !aEdEligibilityCargoPrevMth
								.getActivityType().equals(
										aEdEligibilityCargo.getActivityType()))) {
					if (aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_APPROVED)) {
						detCertBegEndDt(aEdEligibilityCargo,
								aEdEligibilityCargoPrevMth,
								aArrEdIndvEligibilityCargo, aEgDataHandler,
								aNfDataHandler);
					}
				} else {
					aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargoPrevMth
							.getCertEndDt());
					aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargoPrevMth
							.getCertBegDt());
					//New Code
					if (aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_FMA)
							&& aEdEligibilityCargo.getPriorMedicalCd().equals(
									"P0") == false) {
						aEdEligibilityCargo.setCertBegDt(null);
					}
					aEdEligibilityCargo
							.setDispositionCertBegDt(aEdEligibilityCargo
									.getEdbcRunDt());
				}
			}
		}
		//ID : BRGUS00117682 -- KesireddV -- cert end date is Max review due dat of EdCaseRecertDatesCargo if activity type is IR or OG
		else if (aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_CHANGE_ACTION) ||
				aEdEligibilityCargo.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_ONGOING))
		{

			if (aEdEligibilityCargoPrevMth.getCertEndDt() == null) {
				if (aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_APPROVED)) {


					int iLengthEdIndv = 0;
					int jLengthCvEdMci = 0;
					int kLengthEdCaseRecert = 0;
					EligDetail eligDetail = aEgDataHandler.getEligDetailUnAuthCurrEDM();
					EdCaseRecertDatesCargo[] edCaseRecertDatesCargos = eligDetail.getEdCaseRecertDatesCargo();
					CvEdMciEdgIndividualCargo [] cvEdMciEdgIndividualCargo =
						aEgDataHandler.getCvEdMciEdgIndividualCargo();
						Timestamp recertReviewDt = null;
						Timestamp tempRecertReviewDt = null;
						int counter = 0;
					if(aArrEdIndvEligibilityCargo != null )
					{
						iLengthEdIndv = aArrEdIndvEligibilityCargo.length;
					}
					if(cvEdMciEdgIndividualCargo != null )
					{
						jLengthCvEdMci = cvEdMciEdgIndividualCargo.length;
					}
					if(edCaseRecertDatesCargos != null )
					{
						kLengthEdCaseRecert = edCaseRecertDatesCargos.length;
					}

					for (int i = 0; i < iLengthEdIndv; i++) {
						if (aArrEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE
								&& aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
								long edIndvId = aArrEdIndvEligibilityCargo[i].getIndvId();
								for(int j = 0; j < jLengthCvEdMci; j++)
								{
									long cvIndvId =	cvEdMciEdgIndividualCargo[j].getIndvId();
									if(cvIndvId == edIndvId)
									{
										if(cvEdMciEdgIndividualCargo[j].getEligEffEndDt() == null)
										{
											for(int k = 0 ;k < kLengthEdCaseRecert ; k++)
											{
												if(cvEdMciEdgIndividualCargo[j].getEdgNum() == edCaseRecertDatesCargos[k].getEdgNum())
												{
													if(edCaseRecertDatesCargos[k].getEffEndDt() == null){

														if( counter == 0){
															recertReviewDt = edCaseRecertDatesCargos[k].getRecertReviewDueDt();
															tempRecertReviewDt = recertReviewDt;
															counter++;
														} else {
															tempRecertReviewDt = edCaseRecertDatesCargos[k].getRecertReviewDueDt();
															if(DateComparisons.dateGTDateInTimestamp(tempRecertReviewDt,recertReviewDt)){
																recertReviewDt = tempRecertReviewDt;
															}
														}
													}
												}
											}
										}
									}
								}

							}
					}

					aEdEligibilityCargo.setCertEndDt(recertReviewDt);
					aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo.getPaymentBegDt());
					aEdEligibilityCargo.setDispositionCertBegDt(aEdEligibilityCargo
							.getEdbcRunDt());
				}
			} else {
				aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargoPrevMth
						.getCertEndDt());
				aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargoPrevMth
						.getCertBegDt());
				if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FMA)
						&& aEdEligibilityCargo.getPriorMedicalCd().equals("P0") == false) {
					aEdEligibilityCargo.setCertBegDt(null);
				}
				aEdEligibilityCargo.setDispositionCertBegDt(aEdEligibilityCargo
						.getEdbcRunDt());
			}

		}
		else {
			if (aEdEligibilityCargoPrevMth.getCertEndDt() == null) {
				if (aEdEligibilityCargo.getCgStatusCd().equals(
						IEdEligCodes.STATUS_CD_APPROVED)) {
					Timestamp[] tsPrevProcLastAuthEstEligEndDtCertBegDt = detPrevProcLastAuthEstEligEndDt(
							aEdEligibilityCargo, aArrEdIndvEligibilityCargo,
							aArrEligDetailPrevProc, aEligDetailLastAuth);
					if (tsPrevProcLastAuthEstEligEndDtCertBegDt[0] != null
							&& tsPrevProcLastAuthEstEligEndDtCertBegDt[0]
									.after(aEdEligibilityCargo.getEdbcRunDt())) {
						aEdEligibilityCargo
								.setCertEndDt(tsPrevProcLastAuthEstEligEndDtCertBegDt[0]);
						aEdEligibilityCargo
								.setCertBegDt(tsPrevProcLastAuthEstEligEndDtCertBegDt[1]);
						if (aEdEligibilityCargo.getProgramCd().equals(
								IEdEligCodes.PROGRAM_CD_FMA)
								&& aEdEligibilityCargo.getPriorMedicalCd()
										.equals("P0") == false) {
							aEdEligibilityCargo.setCertBegDt(null);
						}
						aEdEligibilityCargo
								.setDispositionCertBegDt(aEdEligibilityCargo
										.getEdbcRunDt());
					} else {
						detCertBegEndDt(aEdEligibilityCargo,
								aEdEligibilityCargoPrevMth,
								aArrEdIndvEligibilityCargo, aEgDataHandler,
								aNfDataHandler);
					}
				}
			} else {
				aEdEligibilityCargo.setCertEndDt(aEdEligibilityCargoPrevMth
						.getCertEndDt());
				aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargoPrevMth
						.getCertBegDt());
				if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FMA)
						&& aEdEligibilityCargo.getPriorMedicalCd().equals("P0") == false) {
					aEdEligibilityCargo.setCertBegDt(null);
				}
				aEdEligibilityCargo.setDispositionCertBegDt(aEdEligibilityCargo
						.getEdbcRunDt());
			}
		}
	}

	//	Added for CMA Changes
	//private static void detCertBegEndDt(EdEligibilityCargo
	// aEdEligibilityCargo, EdEligibilityCargo aEdEligibilityCargoPrevMth,
	// EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo, EgDataHandler
	// egDataHandler, NFDataHandler nfDataHandler) throws EDBCException {

	/**
	 * Method detCertBegEndDt, determine Cert Begin Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param egDataHandler
	 *            EgDataHandler
	 * @param nfDataHandler
	 *            NFDataHandler
	 * @throws EDBCException
	 */
	private static void detCertBegEndDt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EgDataHandler egDataHandler, NFDataHandler nfDataHandler)
			throws EDBCException {
		Timestamp tsTempCertEndDt = null;
		/*
		 * Defect ID : BRGUS00097583 Added By : kesavanr Date : 02/15/2008
		 * Change : Setting cert begin date and cert end date same as TP43 and
		 * TP44.
		 *
		 */
		if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
				IEdEligCodes.TP_43)
				|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
						IEdEligCodes.TP_44)
				|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
						IEdEligCodes.HKEM)) {
			tsTempCertEndDt = DateComparisons.getLastDayOfDate(DateComparisons
					.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 11));
			// following line added to set EstimatedEligEndDt for TP_43 for a
			// defect with code change activity = BRGUS00016614
			aEdEligibilityCargo.setCertEndDt(tsTempCertEndDt);
		} else {
			/*
			 * Commented for Estimated Eligibility Begin Date if
			 * (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_45)) {
			 * tsTempEstEligEndDt =
			 * DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(),
			 * 12)); }
			 */
		}
		if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
				IEdEligCodes.TP_44)) {
			int iLengthEdIndv = 0;
			iLengthEdIndv = aArrEdIndvEligibilityCargo.length;
			Timestamp tsLowest19BirthDt = DateComparisons
					.getDate(IEdEligCodes.LOW_DATE);
			HashMap hmDcIdnv = null;
			for (int i = 0; i < iLengthEdIndv; i++) {
				if (aArrEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE
						&& aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
					//Following method is modified to use EdDcUtil instead of
					// NFUtil - Sai 12/9/2004
					hmDcIdnv = NFUtil.detDcIndvInfoMonthlyHM(egDataHandler,
							nfDataHandler);
					//hmDcIdnv =
					// edDcUtil.detDcIndvInfoMonthlyHM(egDataHandler);
					if (hmDcIdnv.containsKey(new Long(
							aArrEdIndvEligibilityCargo[i].getIndvId()))) {
						if (((DcIndvCargo) hmDcIdnv.get(new Long(
								aArrEdIndvEligibilityCargo[i].getIndvId())))
								.getDobDt() != null) {
							if (DateComparisons
									.getLastDayOfDate(
											DateComparisons
													.addYears(
															((DcIndvCargo) hmDcIdnv
																	.get(new Long(
																			aArrEdIndvEligibilityCargo[i]
																					.getIndvId())))
																	.getDobDt(),
															19)).after(
											tsLowest19BirthDt)) {
								tsLowest19BirthDt = DateComparisons
										.getLastDayOfDate(DateComparisons
												.addYears(
														((DcIndvCargo) hmDcIdnv
																.get(new Long(
																		aArrEdIndvEligibilityCargo[i]
																				.getIndvId())))
																.getDobDt(), 19));
							}
						}
					}
				}
			}
			if (tsLowest19BirthDt.after(tsTempCertEndDt)) {
				tsLowest19BirthDt = tsTempCertEndDt;
			}
			/*
			 * int iLengthEdIndv = 0; iLengthEdIndv =
			 * aArrEdIndvEligibilityCargo.length; Timestamp tsLowest19BirthDt =
			 * tsTempEstEligEndDt; boolean bLowest19BirthDtSet = false; for (int
			 * i = 0; i < iLengthEdIndv; i++) { if
			 * (aArrEdIndvEligibilityCargo[i].getGroupInd() !=
			 * IEdEligCodes.CHAR_INIT_SPACE &&
			 * aArrEdIndvEligibilityCargo[i].getGroupInd() ==
			 * IEdEligCodes.GROUP_IND_C) { HashMap hmDcIdnv =
			 * NFUtil.detDcIndvInfoMonthlyHM(egDataHandler, nfDataHandler); if
			 * (hmDcIdnv.containsKey(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))) { if
			 * (((DcIndvCargo) hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt() !=
			 * null) { if (bLowest19BirthDtSet) { if
			 * (DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
			 * hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
			 * 19)))).after(tsLowest19BirthDt)) { if
			 * (DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
			 * hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
			 * 19)))).before(tsTempEstEligEndDt)) { tsLowest19BirthDt =
			 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
			 * hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
			 * 19)))); } } } else { if
			 * (DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
			 * hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
			 * 19)))).before(tsLowest19BirthDt)) { bLowest19BirthDtSet = true;
			 * tsLowest19BirthDt =
			 * DateComparisons.getTimestamp(DateComparisons.getLastDayOfDate(DateComparisons.getTimestamp(DateComparisons.addYears(((DcIndvCargo)
			 * hmDcIdnv.get(new
			 * Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getDobDt(),
			 * 19)))); } } } } } }
			 */
			aEdEligibilityCargo.setCertEndDt(tsLowest19BirthDt);
		}

		aEdEligibilityCargo.setCertBegDt(aEdEligibilityCargo.getPaymentBegDt());
		//New Code
		if (aEdEligibilityCargo.getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FMA)
				&& aEdEligibilityCargo.getPriorMedicalCd().equals("P0") == false) {
			aEdEligibilityCargo.setCertBegDt(null);
		}
		aEdEligibilityCargo.setDispositionCertBegDt(aEdEligibilityCargo
				.getEdbcRunDt());
	}

	//	Added for CMA Changes

	/**
	 * Method detPrevProcLastAuthEstEligEndDt, determine previous processed last
	 * Authorized, Est Eligibility End Date.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param aArrEligDetailPrevProc
	 *            EligDetail[]
	 * @param aEligDetailLastAuth
	 *            EligDetail
	 * @return Timestamp[]
	 * @throws EDBCException
	 */
	private static Timestamp[] detPrevProcLastAuthEstEligEndDt(
			EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			EligDetail[] aArrEligDetailPrevProc, EligDetail aEligDetailLastAuth)
			throws EDBCException {
		Timestamp[] tsPrevProcLastAuthEstEligEndDtCertBegDt = new Timestamp[2];
		Timestamp tsPrevProcLastAuthEstEligEndDt = null;
		Timestamp tsPrevProcLastAuthCertBegDt = null;
		int iLengthPrevProc = 0;
		if (aArrEligDetailPrevProc != null) {
			iLengthPrevProc = aArrEligDetailPrevProc.length;
		}
		int iLengthCurrentIndv = 0;
		int iLengthPrevProcIndv = 0;
		int iLengthLastAuthIndv = 0;
		for (int i = 0; i < iLengthPrevProc; i++) {
			if (aArrEligDetailPrevProc[i] != null) {
				if (aArrEligDetailPrevProc[i].getEdEligibilityCargo() != null
						&& aArrEligDetailPrevProc[i].getEdEligibilityCargo().length > 0) {
					if (aArrEligDetailPrevProc[i].getEdEligibilityCargo()[0]
							.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)) {
						if (aArrEligDetailPrevProc[i].getEdEligibilityCargo()[0]
								.getPaymentBegDt().before(
										aEdEligibilityCargo.getPaymentBegDt())
								&& ((aArrEligDetailPrevProc[i]
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt() == null)
										|| (aArrEligDetailPrevProc[i]
												.getEdEligibilityCargo()[0]
												.getPaymentEndDt()
												.after(DateComparisons
														.subMonths(
																aEdEligibilityCargo
																		.getPaymentBegDt(),
																1))) || aArrEligDetailPrevProc[i]
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt()
										.equals(
												DateComparisons
														.subMonths(
																aEdEligibilityCargo
																		.getPaymentBegDt(),
																1)))) {
							if (aArrEligDetailPrevProc[i]
									.getEdEligibilityCargo()[0]
									.getPriorMedicalCd().equals(
											IEdEligCodes.PRIOR_MED_CD_0)) {
								if (aArrEligDetailPrevProc[i]
										.getEdEligibilityCargo()[0]
										.getTypeOfAssistanceCd().equals(
												IEdEligCodes.TP_43)
										|| aArrEligDetailPrevProc[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_44)
										|| aArrEligDetailPrevProc[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_47)
										|| aArrEligDetailPrevProc[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_48)) {
									//Defect 146419,148216,148370
									if (aArrEligDetailPrevProc[i]
											.getEdEligibilityCargo()[0]
											.getCertEndDt() != null
											&& aArrEligDetailPrevProc[i]
													.getEdEligibilityCargo()[0]
													.getCertEndDt()
													.after(
															aEdEligibilityCargo
																	.getPaymentBegDt())) {
										if (aArrEligDetailPrevProc[i]
												.getEdEligibilityCargo()[0]
												.getCgStatusCd()
												.equals(
														IEdEligCodes.STATUS_CD_APPROVED)) {
											iLengthCurrentIndv = aArrEdIndvEligibilityCargo.length;
											for (int j = 0; j < iLengthCurrentIndv; j++) {
												if (aArrEdIndvEligibilityCargo[j]
														.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
													iLengthPrevProcIndv = aArrEligDetailPrevProc[i]
															.getEdIndvEligibilityCargo().length;
													for (int k = 0; k < iLengthPrevProcIndv; k++) {
														if (aArrEdIndvEligibilityCargo[j]
																.getIndvId() == aArrEligDetailPrevProc[i]
																.getEdIndvEligibilityCargo()[k]
																.getIndvId()) {
															if (aArrEligDetailPrevProc[i]
																	.getEdIndvEligibilityCargo()[k]
																	.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
																tsPrevProcLastAuthEstEligEndDt = aArrEligDetailPrevProc[i]
																		.getEdEligibilityCargo()[0]
																		.getCertEndDt();
																tsPrevProcLastAuthCertBegDt = aArrEligDetailPrevProc[i]
																		.getEdEligibilityCargo()[0]
																		.getCertBegDt();
																break;
															}
														}
													}
												}
												if (tsPrevProcLastAuthEstEligEndDt != null) {
													break;
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
			if (tsPrevProcLastAuthEstEligEndDt != null) {
				break;
			}
		}

		if (tsPrevProcLastAuthEstEligEndDt == null) {
			int iLengthLastAuth = 0;
			if (aEligDetailLastAuth != null
					&& aEligDetailLastAuth.getEdEligibilityCargo() != null) {
				iLengthLastAuth = aEligDetailLastAuth.getEdEligibilityCargo().length;
			}
			for (int i = 0; i < iLengthLastAuth; i++) {
				if (aEligDetailLastAuth.getEdEligibilityCargo()[i] != null) {
					if (aEligDetailLastAuth.getEdEligibilityCargo()[i]
							.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)) {
						if (aEligDetailLastAuth.getEdEligibilityCargo()[i]
								.getPaymentBegDt().before(
										aEdEligibilityCargo.getPaymentBegDt())
								&& ((aEligDetailLastAuth
										.getEdEligibilityCargo()[i]
										.getPaymentEndDt() == null)
										|| (aEligDetailLastAuth
												.getEdEligibilityCargo()[i]
												.getPaymentEndDt()
												.after(DateComparisons
														.subMonths(
																aEdEligibilityCargo
																		.getPaymentBegDt(),
																1))) || aEligDetailLastAuth
										.getEdEligibilityCargo()[i]
										.getPaymentEndDt()
										.equals(
												DateComparisons
														.subMonths(
																aEdEligibilityCargo
																		.getPaymentBegDt(),
																1)))) {
							if (aEligDetailLastAuth.getEdEligibilityCargo()[i]
									.getPriorMedicalCd().equals(
											IEdEligCodes.PRIOR_MED_CD_0)) {
								if (aEligDetailLastAuth.getEdEligibilityCargo()[i]
										.getTypeOfAssistanceCd().equals(
												IEdEligCodes.TP_43)
										|| aEligDetailLastAuth
												.getEdEligibilityCargo()[i]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_44)
										|| aEligDetailLastAuth
												.getEdEligibilityCargo()[i]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_47)
										|| aEligDetailLastAuth
												.getEdEligibilityCargo()[i]
												.getTypeOfAssistanceCd()
												.equals(IEdEligCodes.TP_48)) {
									//Defect 146419,148216,148370
									if (aEligDetailLastAuth
											.getEdEligibilityCargo()[i]
											.getCertEndDt() != null
											&& aEligDetailLastAuth
													.getEdEligibilityCargo()[i]
													.getCertEndDt()
													.after(
															aEdEligibilityCargo
																	.getPaymentBegDt())) {
										if (aEligDetailLastAuth
												.getEdEligibilityCargo()[i]
												.getCgStatusCd()
												.equals(
														IEdEligCodes.STATUS_CD_APPROVED)) {
											iLengthCurrentIndv = aArrEdIndvEligibilityCargo.length;
											for (int j = 0; j < iLengthCurrentIndv; j++) {
												if (aArrEdIndvEligibilityCargo[j]
														.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
													iLengthLastAuthIndv = aEligDetailLastAuth
															.getEdIndvEligibilityCargo().length;
													for (int k = 0; k < iLengthLastAuthIndv; k++) {
														if (aArrEdIndvEligibilityCargo[j]
																.getIndvId() == aEligDetailLastAuth
																.getEdIndvEligibilityCargo()[k]
																.getIndvId()) {
															if (aEligDetailLastAuth
																	.getEdEligibilityCargo()[i]
																	.getEdgTraceId() == aEligDetailLastAuth
																	.getEdIndvEligibilityCargo()[k]
																	.getEdgTraceId()) {
																if (aEligDetailLastAuth
																		.getEdIndvEligibilityCargo()[k]
																		.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
																	tsPrevProcLastAuthEstEligEndDt = aEligDetailLastAuth
																			.getEdEligibilityCargo()[i]
																			.getCertEndDt();
																	tsPrevProcLastAuthCertBegDt = aEligDetailLastAuth
																			.getEdEligibilityCargo()[i]
																			.getCertBegDt();
																	break;
																}
															}
														}
													}
												}
												if (tsPrevProcLastAuthEstEligEndDt != null) {
													break;
												}
											}
										}
									}
								}
							}
						}
					}
				}
				if (tsPrevProcLastAuthEstEligEndDt != null) {
					break;
				}
			}
		}
		tsPrevProcLastAuthEstEligEndDtCertBegDt[0] = tsPrevProcLastAuthEstEligEndDt;
		tsPrevProcLastAuthEstEligEndDtCertBegDt[1] = tsPrevProcLastAuthCertBegDt;
		return tsPrevProcLastAuthEstEligEndDtCertBegDt;
	}

	//	Added for CMA Changes

	/**
	 * Method detPrevMthCertBegDt, determine previous month cert begin date.
	 *
	 * @param aEdEligibilityCargoPrevMth
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return Timestamp
	 */
	public static Timestamp detPrevMthCertBegDt(
			EdEligibilityCargo aEdEligibilityCargoPrevMth,
			EdEligibilityCargo aEdEligibilityCargo) {
		Timestamp tsToBeUsed = null;
		if (aEdEligibilityCargoPrevMth != null
				&& aEdEligibilityCargoPrevMth.getCertBegDt() != null) {
			tsToBeUsed = aEdEligibilityCargoPrevMth.getCertBegDt();
			/*
			 * Begin - beniwala - ASPEN00039327 - do not copy certBegDt from previous month
			 * if previous month is not in PR mode and current months is in PR mode
			 */
			/*if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_43)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_44)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_47)
					|| aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							IEdEligCodes.TP_48)) {*/
			if (IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
					|| IEdEligCodes.TP_43.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_44.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_47.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.TP_48.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
					|| IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
				// End  - beniwala - ASPEN00039327
				if (aEdEligibilityCargo.getActivityType().equals(
						IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
					if (!aEdEligibilityCargo.getActivityType().equals(
							aEdEligibilityCargoPrevMth.getActivityType())) {
						tsToBeUsed = null;
					}
				}
			}
		}
		return tsToBeUsed;
	}

	/**
	 * This is a wrapper method which calls the corresponding method provided by
	 * the AL subsystem to trigger alerts in case of second party review of an
	 * EDG has been requested/determined. Called in online mode only.
	 *
	 * @param caseNum
	 *            long contains case number
	 * @param caseMode
	 *            String contains case mode
	 * @param alertId
	 *            long contains alert id
	 * @param pageId
	 *            String contains page id
	 * @param empId
	 *            long contains employee id
	 * @param user
	 *            String contains user id
	 * @param runDt
	 *            Timestamp contains EDBC run date
	 * @param conn
	 *            Connection contains connection object
	 * @param isOnlineEdbc
	 *            boolean contains the variable to identify online EDBC
	 * @return contains the hashmap of alert parameters
	 * @throws FrameworkException
	 * @throws ApplicationException
	 */
	
	public static HashMap issueALTrigger(long caseNum, String caseMode,
			long alertId, String pageId, long empId, String user,
			Timestamp runDt, Connection conn, boolean isOnlineEdbc) throws FrameworkException, ApplicationException {

		HashMap params = new HashMap();
		params.put("CASE_NUM", new Long(caseNum));
		params.put("ALERT_ID", new Long(alertId));
		params.put("CASE_MODE", caseMode);
		params.put("CALLINGPG_ID", pageId);
		params.put("CREATE_USER", user);
		params.put("CURRENT_DATE", runDt);
		params.put("EMP_ID", new Long(empId));
		if(isOnlineEdbc){
		params.put(AlConstants.CONNECTION, conn);
		}
		return params;
	}

	/**
	 * Method log, used to log messages.
	 *
	 * @param category
	 *            String
	 * @param mode
	 *            int
	 * @param message
	 *            String
	 */
	private static void log(String category, int mode, String message) {
		logger.log(category, mode, message);
	}

	/**
	 * Method isRebuildDone, finds whether rebuild is required or not.
	 *
	 * @param aArrEligDetailEDBCProcessed
	 *            EligDetail[]
	 * @return boolean
	 */
	private static boolean isRebuildDone(
			EligDetail[] aArrEligDetailEDBCProcessed) {
		boolean bEdgReprocessSwYesFound = false;
		int iLength = aArrEligDetailEDBCProcessed.length;
		for (int i = 0; i < iLength; i++) {
			if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getEdgReprocessSw() == IEdEligCodes.YES) {
				bEdgReprocessSwYesFound = true;
				break;
			}
		}
		return bEdgReprocessSwYesFound;
	}

	/**
	 * Method mapAlertIds, maps alert ids for Each Program type and for some
	 * specific TOA.
	 *
	 * @return HashMap
	 */
	public static HashMap mapAlertIds() {
		HashMap hmTemp = new HashMap();
		hmTemp.put(IEdEligCodes.PROGRAM_CD_FS, new Long(
				IEdEligCodes.ALERT_ID_256));
		hmTemp.put(IEdEligCodes.PROGRAM_CD_FMA, new Long(
				IEdEligCodes.ALERT_ID_257));
		hmTemp.put(IEdEligCodes.PROGRAM_CD_TANF, new Long(
				IEdEligCodes.ALERT_ID_258));
		hmTemp.put(IEdEligCodes.TP_CBA, new Long(IEdEligCodes.ALERT_ID_421));
		hmTemp.put(IEdEligCodes.TP_CLASS, new Long(IEdEligCodes.ALERT_ID_423));
		hmTemp.put(IEdEligCodes.DBMD, new Long(IEdEligCodes.ALERT_ID_424));
		hmTemp.put(IEdEligCodes.TP_86, new Long(IEdEligCodes.ALERT_ID_427));
		hmTemp.put(IEdEligCodes.MDCP, new Long(IEdEligCodes.ALERT_ID_428));
		hmTemp.put(IEdEligCodes.TP_PACE, new Long(IEdEligCodes.ALERT_ID_430));
		//hmTemp.put(IEdEligCodes.PROGRAM_CD_MC, new
		// Long(IEdEligCodes.ALERT_ID_429));
		hmTemp.put(IEdEligCodes.PROGRAM_CD_MC, new Long(
				IEdEligCodes.ALERT_ID_666));
		hmTemp.put(IEdEligCodes.PROGRAM_CD_ME, new Long(
				IEdEligCodes.ALERT_ID_429));
		hmTemp.put(IEdEligCodes.TA_13, new Long(IEdEligCodes.ALERT_ID_422));
		hmTemp.put(IEdEligCodes.TP_05, new Long(IEdEligCodes.ALERT_ID_422));
		hmTemp.put(IEdEligCodes.HCS, new Long(IEdEligCodes.ALERT_ID_422));
		hmTemp.put(IEdEligCodes.HCSO, new Long(IEdEligCodes.ALERT_ID_422));
		hmTemp.put(IEdEligCodes.TP_69, new Long(IEdEligCodes.ALERT_ID_422));
		hmTemp.put(IEdEligCodes.OTHER, new Long(IEdEligCodes.ALERT_ID_422));
		return hmTemp;
	}

	/**
	 * Method mapEdgesForAlerts, maps EDG's or program code for each Unique
	 * Alert ID , identified for current EDBC results.
	 *
	 * @param aArrEligDetailEDBCProcessed
	 *            EligDetail[]
	 * @param hmAlertIds
	 *            HashMap
	 * @return Map
	 */
	private static Map mapEdgesForAlerts(
			EligDetail[] aArrEligDetailEDBCProcessed, HashMap hmAlertIds) {
		//This method is modified extensiviely for Defect#: 211181 on 3/1/2005
		HashMap hmTemp = new HashMap();
		int iLength = aArrEligDetailEDBCProcessed.length;
		for (int i = 0; i < iLength; i++) {
			// If the Edg is pending then don't send Alert.Defect# 00213253
			if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getCgStatusCd().equalsIgnoreCase(
							IEdEligCodes.STATUS_CD_PENDING)) {
				continue;
			}
			if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)) {
				if (!hmTemp.containsKey(hmAlertIds
						.get(IEdEligCodes.PROGRAM_CD_FS))) {
					HashMap hmFS = new HashMap();
					hmFS.put(IEdEligCodes.KEY_EDG_NUM, new Long(
							aArrEligDetailEDBCProcessed[i]
									.getEdEligibilityCargo()[0].getEdgNum()));
					hmFS
							.put(IEdEligCodes.KEY_PGMCD,
									IEdEligCodes.PROGRAM_CD_FS);
					hmTemp.put((Long) hmAlertIds
							.get(IEdEligCodes.PROGRAM_CD_FS), hmFS);
				}
			} else if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) {
				if (!hmTemp.containsKey(hmAlertIds
						.get(IEdEligCodes.PROGRAM_CD_TANF))) {
					HashMap hmTF = new HashMap();
					hmTF.put(IEdEligCodes.KEY_EDG_NUM, new Long(
							aArrEligDetailEDBCProcessed[i]
									.getEdEligibilityCargo()[0].getEdgNum()));
					hmTF.put(IEdEligCodes.KEY_PGMCD,
							IEdEligCodes.PROGRAM_CD_TANF);
					hmTemp.put((Long) hmAlertIds
							.get(IEdEligCodes.PROGRAM_CD_TANF), hmTF);
				}
			} else if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA)) {
				if (!hmTemp.containsKey(hmAlertIds
						.get(IEdEligCodes.PROGRAM_CD_FMA))) {
					HashMap hmFMA = new HashMap();
					hmFMA.put(IEdEligCodes.KEY_EDG_NUM, new Long(
							aArrEligDetailEDBCProcessed[i]
									.getEdEligibilityCargo()[0].getEdgNum()));
					hmFMA.put(IEdEligCodes.KEY_PGMCD,
							IEdEligCodes.PROGRAM_CD_FMA);
					hmTemp.put((Long) hmAlertIds
							.get(IEdEligCodes.PROGRAM_CD_FMA), hmFMA);
				}
			} else if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME)) {
				if (!aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_13)
						|| !aArrEligDetailEDBCProcessed[i]
								.getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_22)
						|| !aArrEligDetailEDBCProcessed[i]
								.getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_19)) {
					if (!hmTemp.containsKey(hmAlertIds
							.get(IEdEligCodes.PROGRAM_CD_ME))) {
						HashMap hmME = new HashMap();
						hmME
								.put(IEdEligCodes.KEY_EDG_NUM, new Long(
										aArrEligDetailEDBCProcessed[i]
												.getEdEligibilityCargo()[0]
												.getEdgNum()));
						hmME.put(IEdEligCodes.KEY_PGMCD,
								IEdEligCodes.PROGRAM_CD_ME);
						hmTemp.put((Long) hmAlertIds
								.get(IEdEligCodes.PROGRAM_CD_ME), hmME);
					}
				}
			} else if (aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
					.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_MC)) {
				if (!hmTemp.containsKey(hmAlertIds
						.get(IEdEligCodes.PROGRAM_CD_MC))) {
					HashMap hmMC = new HashMap();
					hmMC.put(IEdEligCodes.KEY_EDG_NUM, new Long(
							aArrEligDetailEDBCProcessed[i]
									.getEdEligibilityCargo()[0].getEdgNum()));
					hmMC
							.put(IEdEligCodes.KEY_PGMCD,
									IEdEligCodes.PROGRAM_CD_MC);
					hmTemp.put((Long) hmAlertIds
							.get(IEdEligCodes.PROGRAM_CD_MC), hmMC);
				}
			} else {
				if (!hmTemp.containsKey(hmAlertIds
						.get(aArrEligDetailEDBCProcessed[i]
								.getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd()))) {
					HashMap hmOther = new HashMap();
					if (hmAlertIds
							.get(aArrEligDetailEDBCProcessed[i]
									.getEdEligibilityCargo()[0]
									.getTypeOfAssistanceCd()) == null) {
						//hmTemp.put((Long)hmAlertIds.get(IEdEligCodes.OTHER),
						// new
						// Long(aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0].getEdgNum()));
						hmOther
								.put(IEdEligCodes.KEY_EDG_NUM, new Long(
										aArrEligDetailEDBCProcessed[i]
												.getEdEligibilityCargo()[0]
												.getEdgNum()));
						hmOther.put(IEdEligCodes.KEY_PGMCD,
								(aArrEligDetailEDBCProcessed[i]
										.getEdEligibilityCargo()[0]
										.getProgramCd()));
						hmTemp.put((Long) hmAlertIds.get(IEdEligCodes.OTHER),
								hmOther);
					} else {
						//hmTemp.put((Long)hmAlertIds.get(aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0].getTypeOfAssistanceCd()),
						// new
						// Long(aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0].getEdgNum()));
						hmOther
								.put(IEdEligCodes.KEY_EDG_NUM, new Long(
										aArrEligDetailEDBCProcessed[i]
												.getEdEligibilityCargo()[0]
												.getEdgNum()));
						hmOther.put(IEdEligCodes.KEY_PGMCD,
								(aArrEligDetailEDBCProcessed[i]
										.getEdEligibilityCargo()[0]
										.getProgramCd()));
						hmTemp.put((Long) hmAlertIds
								.get(aArrEligDetailEDBCProcessed[i]
										.getEdEligibilityCargo()[0]
										.getTypeOfAssistanceCd()), hmOther);

					}
				}
			}
		}
		return hmTemp;
	}

	//Added for defect 111585
	/**
	 * Method makeEdgArrays, makes EDG arrays.
	 *
	 * @param aArrEligDetailEDBCProcessed
	 *            EligDetail[]
	 * @param aSProgramCd
	 *            String
	 * @return Long[]
	 */
	public Long[] makeEdgArrays(EligDetail[] aArrEligDetailEDBCProcessed,
			String aSProgramCd) {
		ArrayList alTemp = new ArrayList();
		int iLength = 0;
		if (aArrEligDetailEDBCProcessed != null) {
			iLength = aArrEligDetailEDBCProcessed.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (aArrEligDetailEDBCProcessed[i] != null
					&& aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo() != null
					&& aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
							.getProgramCd() != null
					&& aArrEligDetailEDBCProcessed[i].getEdEligibilityCargo()[0]
							.getProgramCd().equals(aSProgramCd)) {
				if (!alTemp.contains(new Long(aArrEligDetailEDBCProcessed[i]
						.getEdEligibilityCargo()[0].getEdgNum()))) {
					alTemp.add(new Long(aArrEligDetailEDBCProcessed[i]
							.getEdEligibilityCargo()[0].getEdgNum()));
				}
			}
		}
		return (Long[]) alTemp.toArray(new Long[alTemp.size()]);
	}

	/**
	 * Method mapEmpIdToEdges, maps Emp Ids for Edg's to be used to send Alerts.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return HashMap
	 */
	private HashMap mapEmpIdToEdges(EgDataHandler aEgDataHandler) {
		HashMap hmTemp = new HashMap();
		int iLength = 0;
		if (aEgDataHandler.getMoEmployeeCasesCargo() != null) {
			iLength = aEgDataHandler.getMoEmployeeCasesCargo().length;
		}
		for (int i = 0; i < iLength; i++) {
			//hmTemp.put(new
			// Long(aEgDataHandler.getMoEmployeeCasesCargo()[i].getEmpId()), new
			// Long(aEgDataHandler.getMoEmployeeCasesCargo()[i].getEdgNum()));
			//manoj - 04-07-2004
			if (aEgDataHandler.getMoEmployeeCasesCargo()[i].getEdgNum() == 0) {
				//Added for Defect#: 211181
				hmTemp.put(aEgDataHandler.getMoEmployeeCasesCargo()[i]
						.getProgramCd(), new Long(aEgDataHandler
						.getMoEmployeeCasesCargo()[i].getEmpId()));
			} else {
				hmTemp.put(new Long(aEgDataHandler.getMoEmployeeCasesCargo()[i]
						.getEdgNum()), new Long(aEgDataHandler
						.getMoEmployeeCasesCargo()[i].getEmpId()));
			}
		}
		return hmTemp;
	}

	//Added for defect 145483
	/**
	 * Method lookForEL5Series, look notice reason containing 'EL5' wild.
	 *
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 * @param sNewFailureReasonCode
	 *            String
	 * @return String
	 */
	private String lookForEL5Series(
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo,
			String sNewFailureReasonCode) {
		String sTemp = aEdEligNoticeReasonsCargo.getFailureReasonCode();

		int iStart = 0;
		String sOrigFailureReasonCode = null;
		Set se = null;
		Iterator it = null;

		//Following code to populate EL Notice Reason is replaced with
		// optimised function getELNoticeReasons()
		// Once stablised it can be removed (7/28/2004)
		/*
		 * HashMap hmTemp = new HashMap(); String[] sELNoticeReasons =
		 * IEdEligCodes.EL_NOTICE_REASONS; int iLength =
		 * sELNoticeReasons.length; for (int i = 0; i < iLength; i++) {
		 * hmTemp.put(sELNoticeReasons[i], sELNoticeReasons[i]); }
		 */
		HashMap hmTemp = getELNoticeReasons();

		iStart = 0;
		sOrigFailureReasonCode = null;
		se = hmTemp.keySet();
		it = se.iterator();
		/*
		 * while (it.hasNext()) { sOrigFailureReasonCode = (String)it.next();
		 * iStart = sTemp.indexOf(sOrigFailureReasonCode); break; }
		 */
		//Modified above while by Sai on 7/28/2004 for Defect # 187416
		while (it.hasNext()) {
			sOrigFailureReasonCode = (String) it.next();
			iStart = sTemp.indexOf(sOrigFailureReasonCode);
			if (iStart >= 0)
				break;
		}
		//Follwoing line is commented on 28/7/2204, need to remove the
		// duplicate which is done above.
		StringBuffer sbTemp = new StringBuffer(aEdEligNoticeReasonsCargo
				.getFailureReasonCode());
		if (iStart >= 0) {
			sbTemp.replace(iStart, iStart + sOrigFailureReasonCode.length(),
					sNewFailureReasonCode);
		} else {
			sbTemp.append(sNewFailureReasonCode);
		}
		return sbTemp.toString();
	}

	/**
	 * Method detEDBCActionCd, determine EDBC action code.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	//BRGUS00107001 – kesavanr – Change in method signature to pass previous month EDM.
	private void detEDBCActionCd(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler,EdEligibilityCargo edEligibilityCargoPrevEDM) throws EDBCException,
			TIERSValidationException {
		//Initialize
		aEdEligibilityCargo.setEdbcActionCd(null);

		if ((aEdEligibilityCargo.getRscEligRsltCd().equals(
				IEdEligCodes.ELIG_RSLT_CD_NT) || aEdEligibilityCargo
				.getFinEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_NT))
				&& (aEdEligibilityCargo.getCgEligRsltCd()
						.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
			aEdEligibilityCargo
					.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING_DATA);
			return;
		}
		// beniwala - ASPEN00031274 - set EdbcActionCd for LIHEAP if there exists authroized record
		boolean isEdbcActionCdSet = detEdbcActionCdLiheap(aEdEligibilityCargo, aEgDataHandler);
		if(isEdbcActionCdSet) {
			return;
		}
		/*
		 * BRGUS00053958 For SER closer segment EdbcActionCd was set to 99 This
		 * issue is fixing with def # BRGUS00053958
		 */
		if (aEdEligibilityCargo.getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_SER)
				|| aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_DS)) {
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_PENDING)) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);
			} else if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_APPROVED)) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
			} else if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_TERMINATED)) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
			} else if (aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_DENIED)) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
			}
			return;

		}
		//End
		if (isHistorical(aEdEligibilityCargo, aEgDataHandler)) {
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)
					|| aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_TANF)
					|| aEdEligibilityCargo.getProgramCd().equals(
							IEdEligCodes.PROGRAM_CD_CDC)) {
				detEDBCActionCdForHistorical(aEdEligibilityCargo,
						edEligibilityCargoPrevEDM,aEgDataHandler);
			} else {
				detEDBCActionCdForHistoricalForOthers(aEdEligibilityCargo,
						aEgDataHandler);
			}
		} else {
			//Commented due to FindBugs Analysis
			//if
			// (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)
			// ||
			// aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF))
			// {
			// beniwala - ASPEN00034263 - egDataHandler is needed by function to access Notice Reasons
			detEDBCActionCdForNonHistorical(aEdEligibilityCargo, aEgDataHandler);
			//	} else {
			//	detEDBCActionCdForNonHistorical(aEdEligibilityCargo);
			//	}
		}

		//BRGUS00167644-upadhyayulag-If the last authorized record's spend down amount is '0',
		//then set the EDBC action code to OP-Referral if payment begin month is less than
		//or equal to EDBC run month for G2 EDGs & certified group size is 0
		if(aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2") 
				&& aEdEligibilityCargo.getCgSize() == 0 
				&& DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),
				DateComparisons.getLastDayOfDate(aEdEligibilityCargo.getEdbcRunDt()))){
			if(aEdEligibilityCargo.getReferenceEdgTraceId() == aEdEligibilityCargo.getEdgTraceId()
					&& aEgDataHandler.getEligDetailLastAuth() != null 
					&& aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null 
					&& (aEdEligibilityCargo.getEdgNum() == 
						aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getEdgNum())
					&& aEgDataHandler.getEligDetailLastAuth().
					getEdEligibilityCargo()[0].getSpendDownAmt() == 0){
				//BEGIN-BRGUS00195119-upadhyayulag-Do not come up with OP-Referral. It should be
				//NO OP-Referral or 'No Issuance Change'
				//aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
				//END-BRGUS00195119
			}
		}
		//END-BRGUS00167644
		/* Begin BRGUS00107001 – kesavanr
		 * Determining edbc action code for spend down TOAs based on the previous month cgstatuscd if it is denied.
		 */
		//<BRGUS00249379><kucherlapatis><11/29/2010>
		//<Per Adithya - Java fix to prevent EDBC from resetting edbc action code for G2
		if (aEdEligibilityCargo.getTypeOfAssistanceCd().startsWith("G2")
				&& aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
						IEdEligCodes.STATUS_CD_DENIED)
				&& (aEdEligibilityCargo.getEdbcActionCd() != null && !(aEdEligibilityCargo
						.getEdbcActionCd().equalsIgnoreCase(
								IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL)))) {
			if (edEligibilityCargoPrevEDM.getCgStatusCd() != null
					&& (edEligibilityCargoPrevEDM.getCgStatusCd()
							.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED) || edEligibilityCargoPrevEDM
							.getCgStatusCd().equalsIgnoreCase(
									IEdEligCodes.STATUS_CD_TERMINATED))) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
			}
			/* Begin BRGUS00115055 – kesavanr
			 * Setting edbc action code to terminated if last authorized is either approved or terminated else denied.
			 */
			else if(aEgDataHandler.getEligDetailLastAuth() != null && aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null &&
					aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length > 0 &&
					aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd() != null &&
					(aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED) ||
					aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0].getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED))) {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
			}
			//End BRGUS00115055
			else{
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
			}
			return;
		}
		//End BRGUS00107001


		if (aEdEligibilityCargo.getEdbcActionCd() == null) {
			/*
			 * ArrayList alError = new ArrayList(); ArrayList alPlaces = new
			 * ArrayList(); alPlaces.add("Unable to determine EDBC Action Cd,
			 * Please check data. "+"EDG Num:
			 * "+aEdEligibilityCargo.getEdgNum()+" PaymentBeginDate:
			 * "+aEdEligibilityCargo.getPaymentBegDt());
			 * logger.log(DIConstants.LOGGING_CATEGORY_EDBC,ILog.DEBUG, "Unable
			 * to determine EDBC Action Cd, Please check data. "+"EDG Num:
			 * "+aEdEligibilityCargo.getEdgNum()+" PaymentBeginDate:
			 * "+aEdEligibilityCargo.getPaymentBegDt()); throw new
			 * TIERSValidationException(alError, alPlaces);
			 */

			aEdEligibilityCargo.setEdbcActionCd("99");
			/*
			 * throw new EDBCException(EDBCException.MAJOR, "EdUtil",
			 * "detEDBCActionCd" , "Unable to determine EDBC Action Cd, Please
			 * check data. "+"EDG Num: "+aEdEligibilityCargo.getEdgNum()+"
			 * PaymentBeginDate: "+aEdEligibilityCargo.getPaymentBegDt() );
			 */
		}
		//Code moved for the system defect BRGUS00035334
		if (aEdEligibilityCargo.getEdbcActionCd().equals(
				IEdEligCodes.EDBC_ACTION_CD_APPROVED)
				|| aEdEligibilityCargo.getEdbcActionCd().equals(
						IEdEligCodes.EDBC_ACTION_CD_SUPPLEMENT)
				|| aEdEligibilityCargo.getEdbcActionCd().equals(
						IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL)
				|| aEdEligibilityCargo.getEdbcActionCd().equals(
						IEdEligCodes.EDBC_ACTION_CD_NO_CHANGE)) {

			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_PENDING)) {
				// Added to identify potential V records when it is pending for
				// defect 211356
				// Commented again to revert back for defect 221140
				//			checkandsetifpotentialV(aEdEligibilityCargo, aEgDataHandler);
				if (aEdEligibilityCargo.getEdbcActionCd() == null) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);
				}
				return;
			}
		}
		// ID : BRGUS00113495 --- KesireddyV --- set no op referal if edbc action is op referal and Advance Notice Req SW is Y
		if(aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC)&&aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt())) {
			if(aEdEligibilityCargo.getAdverseActionAllowedSw() == 'N' && aEdEligibilityCargo.getAdvanceNoticeReqSw() == 'Y' &&
					aEdEligibilityCargo.getEdbcActionCd().equalsIgnoreCase(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL)){
				aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
			}
		}

	}

	/**
	 * Method detEDBCActionCdForSerCdc is used to determine EDBC action code
	 * for SER & CDC programs
	 *
	 * @param eligDetailCurrEDM
	 *            EligDetail
	 * @throws EDBCException
	 */
	private void detEDBCActionCdForSerCdc(EligDetail eligDetailCurrEDM)
			throws EDBCException {

		if(eligDetailCurrEDM != null && eligDetailCurrEDM.getEdEligibilityCargo() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo().length > 0 && eligDetailCurrEDM.getEdEligibilityCargo()[0] != null) {
			/*
			 * For SER and CDC closer Service determination doesn’t require. Hence
			 * currentEDM - EdEligSerServiceAuth & EdIndvCdcServiceAuth would be
			 * null. This issue is fixing with def # BRGUS00053958
			 */
			int serCargoLen = 0;
			int cdcCargoLen = 0;

			if (eligDetailCurrEDM.getEdEligSerServiceAuth() != null) {
				serCargoLen = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
			}

			if (eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null) {
				cdcCargoLen = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length;
			}
			//End
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
					.equals(IEdEligCodes.STATUS_CD_PENDING)) {
				/*  
				 * beniwala - ASPEN00031274 - if EDBC ActionCd is set as Denied/Terminated/NoIssuanceChange
				 * then do not change it
				 */
				String edbcActionCd = eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdbcActionCd();
				if (IEdEligCodes.PROGRAM_CD_SER.equalsIgnoreCase(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd())
						&& (!IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL.equalsIgnoreCase(edbcActionCd)
								&& !IEdEligCodes.EDBC_ACTION_CD_DENIED.equalsIgnoreCase(edbcActionCd)
								&& !IEdEligCodes.EDBC_ACTION_CD_TERMINATED.equalsIgnoreCase(edbcActionCd))) {
					for (int i = 0; i < serCargoLen; i++) {
						eligDetailCurrEDM.getEdEligSerServiceAuth()[i]
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);
					}
				}

				if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd()
						.equals(IEdEligCodes.PROGRAM_CD_CDC)) {
					for (int i = 0; i < cdcCargoLen; i++) {
						eligDetailCurrEDM.getEdIndvCdcServiceAuth()[i]
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);
					}
				}
			}
		}
		
	}

	/**
	 * Method detEDBCActionCdForHistorical, determine EDBC Action code for
	 * historical.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 */
	//BRGUS00108966 – kesavanr – Putting EDBCException in the throws clause of method signature.
	private void detEDBCActionCdForHistorical(
			EdEligibilityCargo aEdEligibilityCargo, 
			EdEligibilityCargo edEligibilityCargoPrevEDM, EgDataHandler aEgDataHandler) throws EDBCException{

		//Setting edbc action code to no op refferal if FS is expedited.
		// BRGUS00084792
		if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase("FS")
				&& (aEdEligibilityCargo.getFsExpeditedSw() == 'Y' || aEdEligibilityCargo
						.getCombinedPaymentSw() == 'Y')) {
			if (aEdEligibilityCargo.getBenefitStatus().equalsIgnoreCase(
					IEdEligCodes.BENEFIT_STATUS_DECREASE)
					|| aEdEligibilityCargo.getBenefitStatus().equalsIgnoreCase(
							IEdEligCodes.BENEFIT_STATUS_DENY)) {
				//BRGUS00105561 - Bhuvane - not to recoup expedited FAP verification failure
				String verfStatusCd = null;
				verfStatusCd = aEdEligibilityCargo.getVerificationStatusCd();
				if (verfStatusCd!= null
						&& !verfStatusCd.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)){
				// modified for BRGUS00061594
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					return;
				}
			}else if (verfStatusCd != null && verfStatusCd.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)){
				aEdEligibilityCargo
				.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
		              return;
			}
		}
		// end BRGUS00105561
		}

		//Added for changes related to defect 175735 and 8000_120 forfiet
		// related errors
		if (isLastAuthIndvFailCurr(aEdEligibilityCargo, aEgDataHandler)) {
			if (aEdEligibilityCargo.getBenefitStatus().equals(
					IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
				} else {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
				}
			}
			/* Begin BRGUS00147700 – kesavanr
			 * Permit historical change only for the future months.
			 */
			else if (aEdEligibilityCargo.getBenefitStatus().equals(
					IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
				//BEGIN-BRGUS00176283-upadhyayulag-If last authorized individual is failed in the
				//current run, allow supplements for the past months also.
				//if(DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),
						//aEdEligibilityCargo.getEdbcRunDt())) {
					if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.YES) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_SUPPLEMENT);
					} else {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT);
					}
				//}
				//END-BRGUS00176283
			}
			//End BRGID
			else {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
			}
		} else {
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_SUSTAIN)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_CHANGE);
					} else if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
						if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT);
						} else if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.YES) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_SUPPLEMENT);
						}
					}
				}
			}
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)
					|| aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
						if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO
								|| aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.YES) {
							if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
							} else if (aEdEligibilityCargo
									.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
							}
						}
					}
				} else if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DENY)
							|| aEdEligibilityCargo.getBenefitStatus().equals(
									IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
						//Modifed for defect 163736 for unexpected result of
						// suppl Y and recoupment no
						if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO
								&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						} else if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.YES
								&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
						} else if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO
								&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
						} else if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.YES
								&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						}
					} else {
						//Added for defect 222363
						if (aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_SUSTAIN)) {
							if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO
									&& aEdEligibilityCargo
											.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
							} else if (aEdEligibilityCargo
									.getSupplementAdviceSw() == IEdEligCodes.YES
									&& aEdEligibilityCargo
											.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
							} else if (aEdEligibilityCargo
									.getSupplementAdviceSw() == IEdEligCodes.NO
									&& aEdEligibilityCargo
											.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
							} else if (aEdEligibilityCargo
									.getSupplementAdviceSw() == IEdEligCodes.YES
									&& aEdEligibilityCargo
											.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
								aEdEligibilityCargo
										.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
							}
						}
					}
				}
			}
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_DENIED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DENY)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
					}
				}
			}
		}
		/*
		 * Begin BRGUS00100065 – kesavanr Setting benefit status if cgsize is 0
		 * based and recoupment and adverse action allowed sw.
		 */
		//BRGUS00095532 – kesavanr – Perform the below logic not for cdc program.
		//BEGIN-BRGUS00160058-upadhyayulag-Add condition to check if the payment begin date is greater
		//than the EDBC run date		
		if (!aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC) &&
				aEdEligibilityCargo.getCgSize() == 0 && aEdEligibilityCargo.getBenefitStatus().equalsIgnoreCase(
						IEdEligCodes.BENEFIT_STATUS_DECREASE)
				&& aEdEligibilityCargo.getRecoupmentAdviceSw() == 'Y'
					&& aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt())) {
			// BRGUS00112829 - Bhuvane - added to check adequate notice
			/*
			 * Begin - beniwala - ASPEN00042218 - if adverseAction is allowed OR adequateNotice is Required OR
			 * all target individuals are disqualified, then set O/P Referral. Else set No Issuance Change
			 */
			if ((aEdEligibilityCargo.getAdverseActionAllowedSw() == 'Y') ||
					(aEdEligibilityCargo.getAdequateNoticeReqSw() != IEdEligCodes.CHAR_INIT_SPACE 
							&& aEdEligibilityCargo.getAdequateNoticeReqSw() =='Y')
							|| areAllTargetIndivsDisqualified(aEdEligibilityCargo, aEgDataHandler)
							// beniwala - ASPEN00042705 - set O/P referral if Cash EDG has third level penalty
							|| hasThirdLevelSanction(aEdEligibilityCargo, aEgDataHandler)) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
			} else {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
				if(edEligibilityCargoPrevEDM != null 
						&& edEligibilityCargoPrevEDM.getEdbcActionCd() != null
						&& edEligibilityCargoPrevEDM.getEdbcActionCd().equals
						(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL)){
					aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
				}
			}
		}
		
		//END-BRGUS00160058
		/* Begin BRGUS00108966 – kesavanr
		 * Set edbcaction to approved for future months edgs for FIP/FAP if edbcaction is supplement
		 */
		if(aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS) ||
		   aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_TANF) ||
		   //BRGUS00099289 – kesavanr – Perform the same logic for CDC program as well.
		   aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)) {
			if(DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),aEdEligibilityCargo.getEdbcRunDt()) &&
			   aEdEligibilityCargo.getEdbcActionCd() != null && aEdEligibilityCargo.getEdbcActionCd().equalsIgnoreCase(IEdEligCodes.EDBC_ACTION_CD_SUPPLEMENT)) {
				 aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
			}
		}
		//End BRGUS00108966
		//End BRGUS00100065

		/* Begin BRGUS00112829 – kesavanr
		 * Set edbc action code to terminated if cgstatuscd is terminated.
		 */
		if(aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED)) {
				aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
	    }
		/* Begin BRGUS00084723 – kesavanr
		 * set edbc action code to approve if benefit decreases,adequate switch is 'Y' and
		 * edg is for future month.
		 *
		 */
		if(aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt()) &&
				   aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED) &&
				   aEdEligibilityCargo.getCgEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS) &&
				   aEdEligibilityCargo.getBenefitStatus().equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_DECREASE) &&
				   aEdEligibilityCargo.getAdequateNoticeReqSw() == 'Y') {
				   aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
				   //BEGIN-BRGUS00217436-upadhyayulag-Reset the EDG Reprocess Switch for approved records
				   aEdEligibilityCargo.setEdgReprocessSw('N');
				   //END-BRGUS00217436
		}
		//End BRGUS00084723
		//End BRGUS00112829
	}

	/**
	 * Method detEDBCActionCdForNonHistorical, determine EDBC Action code for
	 * non-historical.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @throws EDBCException 
	 */
	// beniwala - ASPEN00034263 - EgDataHandler is needed by function to access NoticeReasons
	public void detEDBCActionCdForNonHistorical(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
		if (aEdEligibilityCargo.getCgStatusCd().equals(
				IEdEligCodes.STATUS_CD_APPROVED)) {
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_PASS)) {
				if (/* beniwala - ASPEN00033945 - logic to handle BenefitStatus DECREASE written in separate else-if block
				aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_DECREASE)
						||*/ aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_INCREASE)
						|| aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_SUSTAIN)
						|| aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_CERTIFY)) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
				} /*
				   * Begin - beniwala - ASPEN00033945 - for Simplified Reporting, ongoing month should have No Issuance Change
				   * if recoupment advice switch is false
				   */
				else if (aEdEligibilityCargo.getBenefitStatus().equals(IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
					/*
					 * Begin - beniwala - set EDBC ActionCd to No Issuance Change only for case change
					 * Also, for Transtional Bonus, set it to Approved
					 */
					/*if ("SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())
							&& (IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()) 
									|| IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()))) {*/
					if ("SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())
							&& (IEdEligCodes.TP_09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
									|| (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
											&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES)
									 || (IEdEligCodes.ENWP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
													&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES)
									 || (IEdEligCodes.WASU.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
													&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES))//ASPEN00062743 - WageSubsidy closes before SR- Change in EDBC
											// beniwala - ASPEN00043823 - check if No Issuance Change can be set for Ongoing mode also
							&& (IEdEligCodes.ACTIVITY_TYPE_CHANGE_ACTION.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())
									|| IEdEligCodes.ACTIVITY_TYPE_ONGOING.equalsIgnoreCase(aEdEligibilityCargo.getActivityType()))) {
						/*if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
							aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
						} else {
							aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						}*/
						/*
						 * Begin - beniwala - ASPEN00034263 - set EDBCActionCd as Approved if individual is not valid applicant
						 * OR deceased or voluntarily withdrawn
						 */
						if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
							/*
							 * beniwala - ASPEN00044903 - set Approved if no individual is disqualified and individual is not valid applicant
							 * OR deceased or voluntarily withdrawn
							 */
						
							 if(detNoIssuanceChangeEDBCActionCd(aEdEligibilityCargo, aEgDataHandler) && !isIndivDisqualified(aEdEligibilityCargo, aEgDataHandler)) {
								// beniwala - ASPEN00040523 - if the cumulative effect is that recoupment should not be done, then only set NoIssuanceChange
								if(aEgDataHandler != null && aEgDataHandler.isHasNonHistoricaMonthChangeForRecoup() == false) {
									
									//ASPEN00053431 ARRA changes bypass SR rules - nsandru
									String eDTriggerCode = (String) requestMap
											.get(IEdEligCodes.ED_TRIGGER_CODE);
									boolean pgmInCVMode = false;
									
									if (aEgDataHandler != null) {
										DcCaseProgramCargo[] dcCasePgmCargo = aEgDataHandler
												.getDcCaseProgramCargo();
										if (dcCasePgmCargo != null) {
											for (int pgmCargos = 0; pgmCargos < dcCasePgmCargo.length; pgmCargos++) {
												if ((dcCasePgmCargo[pgmCargos] != null
														&& dcCasePgmCargo[pgmCargos].getProgCd().equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
														&& dcCasePgmCargo[pgmCargos].getEffEndDt() == null
														&& dcCasePgmCargo[pgmCargos].getCvModeSw() == 'Y'
														&& dcCasePgmCargo[pgmCargos].getProgCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS))
														||((eDTriggerCode!=null) && (eDTriggerCode.equalsIgnoreCase(IEdEligCodes.SPECIAL_TRIGGER_ED_ED006)
																|| (eDTriggerCode.equalsIgnoreCase(IEdEligCodes.SPECIAL_TRIGGER_IN007))     // ASPEN00057426- Parma - to bypass the COLA by using SR Rules
																|| (eDTriggerCode.equalsIgnoreCase(IEdEligCodes.SPECIAL_TRIGGER_IN005)))	// ASPEN00059683  - Parma - to bypass the COLA by using SR Rules	
														&& dcCasePgmCargo[pgmCargos].getProgCd().equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FS))) {
													pgmInCVMode = true;
													break;
												}

											}
										}
									}
									
									
									if(pgmInCVMode){
										aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
									}
									else{								
									
									aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
									}
								}
								else {
									aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
								}
							}
							else {
								aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
							}
						} else {
							aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
						}
					} else {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
					}
				}
				// End - beniwala - ASPEN00033945
			}
			else if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == 'Y') {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
				} else {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
				}
			}
		} else if (aEdEligibilityCargo.getCgStatusCd().equals(
				IEdEligCodes.STATUS_CD_TERMINATED)) {
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_DENY)) {
					// Begin - beniwala - ASPEN00042620
					detEDBCActionCdForRecoup(aEdEligibilityCargo, aEgDataHandler, IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
					/*aEdEligibilityCargo
					.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);*/
					// End - beniwala - ASPEN00042620
				}
			}
		} else if (aEdEligibilityCargo.getCgStatusCd().equals(
				IEdEligCodes.STATUS_CD_DENIED)) {
			if (aEdEligibilityCargo.getCgEligRsltCd().equals(
					IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				if (aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_DENY)) {
					// Begin - beniwala - ASPEN00042620
					detEDBCActionCdForRecoup(aEdEligibilityCargo, aEgDataHandler, IEdEligCodes.EDBC_ACTION_CD_DENIED);
					/*aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);*/
					// End - beniwala - ASPEN00042620
				}
			}
		} else if (aEdEligibilityCargo.getCgStatusCd().equals(
				IEdEligCodes.STATUS_CD_PENDING)) {

			aEdEligibilityCargo
					.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);

		}
	}

	/**
	 * Method isHistorical, determines whether the EDG is historical, to be used
	 * to find EDBC action Code.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean isHistorical(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) throws EDBCException {
		boolean bIsHistorical = false;
		boolean bIsHistoricalFlagSet = false;
		Timestamp tsBiCutOffDate = getBiCutOffDate(aEdEligibilityCargo);
		if (aEgDataHandler.getEligDetailLastAuth() == null) {
			bIsHistorical = false;
			bIsHistoricalFlagSet = true;
		} else if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.YES) {
			//Added for changes related to defect 175735 and 8000_120 forfiet
			// related errors
			bIsHistorical = false;
			bIsHistoricalFlagSet = true;
		} else {
			if (aEdEligibilityCargo.getProgramCd().equals(
					IEdEligCodes.PROGRAM_CD_FS)) {
				if ((aEdEligibilityCargo.getActivityType().equals(
						IEdEligCodes.ACTIVITY_TYPE_INTAKE) || aEdEligibilityCargo
						.getActivityType().equals(
								IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW))
						|| (aEdEligibilityCargo.getBenefitStatus()
								.equals(IEdEligCodes.BENEFIT_STATUS_CERTIFY))) {
					bIsHistorical = false;
					bIsHistoricalFlagSet = true;
				} else {
					bIsHistorical = isHistoricalFromDates(aEdEligibilityCargo,
							tsBiCutOffDate);
					bIsHistoricalFlagSet = true;
				}
			} else {
				if (aEdEligibilityCargo.getActivityType().equals(
						IEdEligCodes.ACTIVITY_TYPE_INTAKE)
						|| aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_CERTIFY)) {
					bIsHistorical = false;
					bIsHistoricalFlagSet = true;
				} else {
					bIsHistorical = isHistoricalFromDates(aEdEligibilityCargo,
							tsBiCutOffDate);
					bIsHistoricalFlagSet = true;
				}
			}
		}
		if (bIsHistoricalFlagSet == false) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"isHistorical",
					"Unable to determine Historical, Please check data");
		} else {
			if (bIsHistorical == true) {
				aEdEligibilityCargo.setHistoricalSw(IEdEligCodes.YES);
			} else {
				aEdEligibilityCargo.setHistoricalSw(IEdEligCodes.NO);
			}
		}
		return bIsHistorical;
	}

	/**
	 * Method returns the Benfit issuance CutOffDate.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @return Timestamp
	 * @throws EDBCException
	 */

	private Timestamp getBiCutOffDate(EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {
		String code = null;
		String refData = null;
		try {
			code = DateComparisons.getStringYYYYMM(aEdEligibilityCargo
					.getEdbcRunDt());
			refData = ReferenceTableManager.getValueByColumn(true,
					"BICUTOFFDATE", code, "Description");
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"Reference Table : " + "BICUTOFFDATE" + "/" + code + "/"
							+ "Description",
					"Exception reading reading the table", e);
		}
		if (refData.equals("")) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"Reference Table : " + "BICUTOFFDATE" + "/" + code + "/"
							+ "Description", "Missing Value");
		}
		return DateComparisons.getTimestamp(refData);

	}

	/**
	 * Method isHistoricalFromDates, determines whether historical w.r.t
	 * BiCutOff Date .
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param tsBiCutOffDate
	 *            Timestamp
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean isHistoricalFromDates(
			EdEligibilityCargo aEdEligibilityCargo, Timestamp tsBiCutOffDate)
			throws EDBCException {
		// Modified the Boolean Object to Primitive boolean
		//	Boolean bIsHistoricalFromDates = null;
		boolean bIsHistoricalFromDates = false;
		boolean bIsHistoricalFlagSet = false;
		int iEDMYear = DateComparisons.getYYYY(aEdEligibilityCargo
				.getPaymentBegDt());
		int iEDMMth = DateComparisons.getMM(aEdEligibilityCargo
				.getPaymentBegDt());
		int iRunYear = DateComparisons.getYYYY(aEdEligibilityCargo
				.getEdbcRunDt());
		int iRunMth = DateComparisons.getMM(aEdEligibilityCargo.getEdbcRunDt());
		boolean bLess = false;
		boolean b13Day = false;
		/* Begin - beniwala - ASPEN00042308 - use adverseActionDate from Reference table instead of 13 day logic
		 * Timestamp ts13Days = DateComparisons.subDays(DateComparisons
				.getLastDayOfDate(aEdEligibilityCargo.getEdbcRunDt()), 13);
		if (aEdEligibilityCargo.getEdbcRunDt().after(ts13Days)) {
			b13Day = true;
		}*/
		Timestamp ts13Days = getAdverseActionDate(aEdEligibilityCargo);
		if (aEdEligibilityCargo.getEdbcRunDt().after(ts13Days)) {
			b13Day = true;
		}
		// End - beniwala - ASPEN00042308
		if (iEDMYear < iRunYear) {
			bLess = true;
		} else if (iEDMYear == iRunYear && iEDMMth < iRunMth) {
			bLess = true;
		}
		if (bLess
				|| DateComparisons.getStringMMYYYY(
						aEdEligibilityCargo.getPaymentBegDt()).equals(
						DateComparisons.getStringMMYYYY(aEdEligibilityCargo
								.getEdbcRunDt()))) {
			//bIsHistoricalFromDates = new Boolean(true);
			bIsHistoricalFromDates = true;
			bIsHistoricalFlagSet = true;
		} else {
			if (aEdEligibilityCargo.getEdbcRunDt().after(tsBiCutOffDate)
					|| b13Day) {
				if (DateComparisons.getStringMMYYYY(
						aEdEligibilityCargo.getPaymentBegDt()).equals(
						DateComparisons.getStringMMYYYY(DateComparisons
								.addMonths(tsBiCutOffDate, 1)))) {
					//bIsHistoricalFromDates = new Boolean(true);
					bIsHistoricalFromDates = true;
					bIsHistoricalFlagSet = true;
				} else {
					int iEDMYr = DateComparisons.getYYYY(aEdEligibilityCargo
							.getPaymentBegDt());
					int iEDMMh = DateComparisons.getMM(aEdEligibilityCargo
							.getPaymentBegDt());
					int iBiYear = DateComparisons.getYYYY(DateComparisons
							.addMonths(tsBiCutOffDate, 1));
					int iBiMth = DateComparisons.getMM(DateComparisons
							.addMonths(tsBiCutOffDate, 1));
					boolean bGreat = false;
					if (iEDMYr > iBiYear) {
						bGreat = true;
					} else if (iEDMYr == iBiYear && iEDMMh > iBiMth) {
						bGreat = true;
					}
					if (bGreat) {
						//bIsHistoricalFromDates = new Boolean(false);
						bIsHistoricalFromDates = false;
						bIsHistoricalFlagSet = true;
					}
				}
			} else {
				if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FS)
						&& aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO
						&& aEdEligibilityCargo.getCombinedPaymentSw() == IEdEligCodes.YES) {
					//if
					// (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)
					// && aEdEligibilityCargo.getAdverseActionAllowedSw() ==
					// IEdEligCodes.NO) {
					//bIsHistoricalFromDates = new Boolean(true);
					bIsHistoricalFromDates = true;
					bIsHistoricalFlagSet = true;
				} else {
					if (aEdEligibilityCargo.getPaymentBegDt().after(
							aEdEligibilityCargo.getEdbcRunDt())) {
						//bIsHistoricalFromDates = new Boolean(false);
						bIsHistoricalFromDates = false;
						bIsHistoricalFlagSet = true;
					}
				}
			}
		}
		//if (bIsHistoricalFromDates == null) {
		if (bIsHistoricalFlagSet == false) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"isHistoricalFromDates",
					"Unable to determine Historical, Please check data");
		}
		return bIsHistoricalFromDates;
	}

	/**
	 * Method detPaymentAmt, determine Payment Amount.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligibilityCargoConfirmed
	 *            EdEligibilityCargo[]
	 */
	private void detPaymentAmt(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo[] aEdEligibilityCargoConfirmed) {
		double dNetBenefitAmtUnConfirmed = 0;
		dNetBenefitAmtUnConfirmed = aEdEligibilityCargo.getNetBenefitAmt();
		int iLength = 0;
		if (aEdEligibilityCargoConfirmed != null) {
			iLength = aEdEligibilityCargoConfirmed.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (aEdEligibilityCargoConfirmed[i].getEdgNum() == aEdEligibilityCargo
					.getEdgNum()) {
				if ((aEdEligibilityCargoConfirmed[i].getRecBeginDt().before(
						aEdEligibilityCargo.getPaymentBegDt()) || aEdEligibilityCargoConfirmed[i]
						.getRecBeginDt().equals(
								aEdEligibilityCargo.getPaymentBegDt()))
						&& (((aEdEligibilityCargoConfirmed[i].getRecEndDt() == null) || (aEdEligibilityCargoConfirmed[i]
								.getRecEndDt().after(
										aEdEligibilityCargo.getPaymentBegDt()) || aEdEligibilityCargoConfirmed[i]
								.getRecEndDt().equals(
										aEdEligibilityCargo.getPaymentBegDt()))))) {
					if (dNetBenefitAmtUnConfirmed < aEdEligibilityCargoConfirmed[i]
							.getNetBenefitAmt()) {
						aEdEligibilityCargo
								.setPaymentAmt(aEdEligibilityCargoConfirmed[i]
										.getNetBenefitAmt()
										- dNetBenefitAmtUnConfirmed);
					} else if (dNetBenefitAmtUnConfirmed > aEdEligibilityCargoConfirmed[i]
							.getNetBenefitAmt()) {
						aEdEligibilityCargo
								.setPaymentAmt(dNetBenefitAmtUnConfirmed
										- aEdEligibilityCargoConfirmed[i]
												.getNetBenefitAmt());
					}
					break;
				}
			}
		}
	}

	/**
	 * Method appendEligDetailProcessed, append the processed EDG's EligDetail.
	 *
	 * @param aArrEligDetail
	 *            EligDetail
	 * @param egDataHandler
	 *            EgDataHandler
	 */
	public void appendEligDetailProcessed(EligDetail aArrEligDetail,
			EgDataHandler egDataHandler) {
		ArrayList alEligDetailProcessed = new ArrayList();
		int iLengthEligDetailProcessed = 0;
		if (egDataHandler.getEdIndvInfo().getEligDetailAllProcessed() != null) {
			iLengthEligDetailProcessed = egDataHandler.getEdIndvInfo()
					.getEligDetailAllProcessed().length;
		}
		for (int p = 0; p < iLengthEligDetailProcessed; p++) {
			alEligDetailProcessed.add(egDataHandler.getEdIndvInfo()
					.getEligDetailAllProcessed()[p]);
		}
		alEligDetailProcessed.add(aArrEligDetail);
		egDataHandler.getEdIndvInfo().setEligDetailAllProcessed(
				(EligDetail[]) alEligDetailProcessed
						.toArray(new EligDetail[alEligDetailProcessed.size()]));
	}

	/**
	 * Method detEDBCActionCdForHistoricalForOthers determines EDBC action Code.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 */
	private void detEDBCActionCdForHistoricalForOthers(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException{
		//		Added for changes related to defect 175735 and 8000_120 forfiet
		// related errors
		// Modified following if condition to allow all programs for defect
		// #00216837 on 3/4/2005 by Sai
		//Modified if condition to add ME also for Defect # 00220046 0n
		// 6/10/2005
		if ((aEdEligibilityCargo.getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FMA)
				|| aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_MC)
				|| aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_CC) || aEdEligibilityCargo
				.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_ME))
				&& isLastAuthIndvFailCurr(aEdEligibilityCargo, aEgDataHandler)) {
			//if (isLastAuthIndvFailCurr(aEdEligibilityCargo, aEgDataHandler))
			// {
			//		 	Changes for building TMA from next month of LIF failure
			// ID : -- Kesireddyv -- Set edg reprocess sw is Y if tma group require sw is Y and Fin is fail
			//ASPEN00022108--- Should not create a new group for the month that has already Approved MA group
			/*if (aEdEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(
					"TP08")
					&& aEdEligibilityCargo.getTmaGrpReqSw() == 'Y'
					&& !IEdEligCodes.FAIL.equals(aEdEligibilityCargo.getNfEligRsltCd())
					&& !IEdEligCodes.FAIL.equals(aEdEligibilityCargo.getRscEligRsltCd())) {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
				aEdEligibilityCargo.setEdgReprocessSw('Y');
				return;
			}*/
			/* Begin BRGUS00118564 – kesavanr
			 * If last auth indv failed current there should not be O/P Referral
			 * for medicaid programs.
			 */
			aEdEligibilityCargo
			.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);

			/*if (aEdEligibilityCargo.getBenefitStatus().equals(
					IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.YES) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
				} else {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
				}
			} else {
				aEdEligibilityCargo
						.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
			}*/
			//End BRGUS00118564
		}
		/*
		 * Following is commented for CCB: (# will be known later ) on 1/10/2005
		 * //Follwing else if added for CCB: 00155757 else if
		 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FMA) &&
		 * isIndvAdded(aEdEligibilityCargo, aEgDataHandler)) { if
		 * (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO) {
		 * aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT);
		 * aEdEligibilityCargo.setEdgReprocessSw(IEdEligCodes.YES ); } else {
		 * aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_SUPPLEMENT); } }
		 */
		else {
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_SUSTAIN)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_CHANGE);
					} else if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
					} /*
					   * Following else if added for defect # 00217192 on
					   * 3/8/2005 by Sai
					   */
					else if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DECREASE)
							&&
							// Defect BRGUS00050586
							((aEdEligibilityCargo.getProgramCd()
									.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_ME)) || (aEdEligibilityCargo
									.getProgramCd()
									.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_FMA)))) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					}
				}
			}
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DENY)) {
						if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						} else {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
						}
					} else if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_SUSTAIN)) {
						//Changes for building TMA from next month of LIF
						// failure
						if (aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase("TP08")
								&& aEdEligibilityCargo.getTmaGrpReqSw() == 'Y') {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
							aEdEligibilityCargo.setEdgReprocessSw('Y');
							return;
						}

						if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO) {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						} else {
							aEdEligibilityCargo
									.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL);
						}
					}
				} else if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_PASS)) {
					// Defect 241936 - If EIDSW is set for a hist period with
					// adv act not allowed, set NOOP.
					if (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(
							EDGConstants.TP08)
							&& aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO
							&& aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO
							&& aEdEligibilityCargo.getEidEligSw() == IEdEligCodes.YES
							&& aEdEligibilityCargo.getEidChangeSw() == IEdEligCodes.YES
							&& !isIndvAdded(aEdEligibilityCargo, aEgDataHandler)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					}
				}
			}
			if (aEdEligibilityCargo.getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_DENIED)
					|| aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED)) {
				if (aEdEligibilityCargo.getCgEligRsltCd().equals(
						IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					if (aEdEligibilityCargo.getBenefitStatus().equals(
							IEdEligCodes.BENEFIT_STATUS_DENY)) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
					}
				}
			}
		}
		/* Begin BRGUS00084723 – kesavanr
		 * Set edbc action code to TN if cgstatuscd to 'TN'
		 * set edbc action code to approve if benefit decreases,adequate switch is 'Y' and
		 * edg is for future month.
		 *
		 */
		if(aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED)) {
			aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
		}
		if(aEdEligibilityCargo.getPaymentBegDt().after(aEdEligibilityCargo.getEdbcRunDt()) &&
		   aEdEligibilityCargo.getCgStatusCd().equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED) &&
		   aEdEligibilityCargo.getCgEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS) &&
		   aEdEligibilityCargo.getBenefitStatus().equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_DECREASE) &&
		   aEdEligibilityCargo.getAdequateNoticeReqSw() == 'Y') {
			aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
		}
		//End BRGUS00084723
	}

	//Added for defect 154641
	/**
	 * Method lookForELTestSeries, looks into the Notice reason whether 'EL'
	 * series notice reason and removes it .
	 *
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 * @return String
	 */
	private String lookForELTestSeries(
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo) {
		String sTemp = aEdEligNoticeReasonsCargo.getFailureReasonCode();
		HashMap hmTemp = new HashMap();
		String[] sELNoticeReasons = IEdEligCodes.EL_TEST_NOTICE_REASONS;
		int iLength = sELNoticeReasons.length;
		for (int i = 0; i < iLength; i++) {
			hmTemp.put(sELNoticeReasons[i], sELNoticeReasons[i]);
		}
		StringBuffer sbTemp = new StringBuffer(aEdEligNoticeReasonsCargo
				.getFailureReasonCode());
		int iStart = 0;
		String sOrigFailureReasonCode = null;
		Set se = hmTemp.keySet();
		Iterator it = se.iterator();
		while (it.hasNext()) {
			sOrigFailureReasonCode = (String) it.next();
			iStart = sTemp.indexOf(sOrigFailureReasonCode);
			if (iStart >= 0) {
				sbTemp.replace(iStart,
						iStart + sOrigFailureReasonCode.length(), "");
			}
			iStart = 0;
			sTemp = sbTemp.toString();
		}
		return sbTemp.toString();
	}

	/**
	 * Method performAllSpendDown, performs spenddown EDBC .
	 *
	 * @param aArrEdEligibilityCargo
	 *            EdEligibilityCargo[]
	 * @param aMapRequest
	 *            Map
	 * @throws ApplicationException
	 * @throws FrameworkException
	 * @throws SQLException
	 */
	public void performAllSpendDown(
			EdEligibilityCargo[] aArrEdEligibilityCargo, Map aMapRequest)
			throws ApplicationException, FrameworkException, SQLException {
		int iLengthEdElig = 0;
		if (aArrEdEligibilityCargo != null) {
			iLengthEdElig = aArrEdEligibilityCargo.length;
		}
		for (int k = 0; k < iLengthEdElig; k++) {
			performSpendDownEDBC(aArrEdEligibilityCargo[k], aMapRequest);
		}
	}

	/**
	 * Method createLtcPendingReason, creates LTC pending reason and sets it for
	 * given IndvId.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @param aEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo
	 * @return EligDetail
	 */
	public EligDetail createLtcPendingReason(EligDetail aEligDetail,
			EdIndvEligibilityCargo aEdIndvEligibilityCargo) {
		int iLength = 0;
		if (aEligDetail.getEdIndvLtcPendingReasonCargo() != null) {
			iLength = aEligDetail.getEdIndvLtcPendingReasonCargo().length;
		}
		boolean bFound = false;
		for (int i = 0; i < iLength; i++) {
			if (aEligDetail.getEdIndvLtcPendingReasonCargo()[i].getIndvId() == aEdIndvEligibilityCargo
					.getIndvId()) {
				if (aEligDetail.getEdIndvLtcPendingReasonCargo()[i]
						.getPendingReasonCd().equalsIgnoreCase(
								IEdEligCodes.LTC_PEND_1016)) {
					bFound = true;
					break;
				}
			}
		}
		if (!bFound) {
			ArrayList alTemp = new ArrayList();
			for (int i = 0; i < iLength; i++) {
				alTemp.add(aEligDetail.getEdIndvLtcPendingReasonCargo()[i]);
			}
			EdIndvLtcPendingReasonCargo newEdIndvLtcPendingReasonCargo = new EdIndvLtcPendingReasonCargo();
			newEdIndvLtcPendingReasonCargo.setCaseNum(aEligDetail
					.getEdEligibilityCargo()[0].getCaseNum());
			newEdIndvLtcPendingReasonCargo.setEdgTraceId(aEligDetail
					.getEdEligibilityCargo()[0].getEdgTraceId());
			newEdIndvLtcPendingReasonCargo.setIndvId(aEdIndvEligibilityCargo
					.getIndvId());
			newEdIndvLtcPendingReasonCargo
					.setPendingReasonCd(IEdEligCodes.LTC_PEND_1016);
			// Modified void_sw to delete_sw for CCB: 183778
			newEdIndvLtcPendingReasonCargo.setDeleteSw(IEdEligCodes.NO);
			alTemp.add(newEdIndvLtcPendingReasonCargo);
			aEligDetail
					.setEdIndvLtcPendingReasonCargo((EdIndvLtcPendingReasonCargo[]) alTemp
							.toArray(new EdIndvLtcPendingReasonCargo[alTemp
									.size()]));
		}
		return aEligDetail;
	}

	/**
	 * Method isLastAuthIndvFailCurr, determines whether the last auth
	 * individual is failed now.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 */
	public boolean isLastAuthIndvFailCurr(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) {
		boolean bFail = false;
		int iLength = 0;
		//Modified for defect 181530
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			iLength = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo().length;
		}
		if (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0]
				.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)) {
			// ID:BRGUS00131255 --KesireddyV --- check for approved or pending records to find out LastAuthIndvFailCurr
			if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdEligibilityCargo()[0].getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)
					|| aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdEligibilityCargo()[0].getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_PENDING)) {
				int iLengthLocal = 0;
				boolean bIndvFound = false;
				for (int i = 0; i < iLength; i++) {
					if (aEgDataHandler.getEligDetailLastAuth()
							.getEdIndvEligibilityCargo()[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
						iLengthLocal = aEgDataHandler
								.getEligDetailUnAuthCurrEDM()
								.getEdIndvEligibilityCargo().length;
						bIndvFound = false;
						for (int j = 0; j < iLengthLocal; j++) {
							if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
									.getEdIndvEligibilityCargo()[j].getIndvId() == aEgDataHandler
									.getEligDetailLastAuth()
									.getEdIndvEligibilityCargo()[i].getIndvId()) {
								bIndvFound = true;
								if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
										.getEdIndvEligibilityCargo()[j]
										.getGroupInd() != IEdEligCodes.GROUP_IND_C
										|| aEgDataHandler
												.getEligDetailUnAuthCurrEDM()
												.getEdEligibilityCargo()[0]
												.getCgEligRsltCd()
												.equalsIgnoreCase("FL")) {
									// Following if condition added for CCB :
									// 127585(MM) Scenario-1, else pre existed
									// Modified second part of ic condition for
									// Defect # : 00190295
									if ((aEgDataHandler
											.getEligDetailUnAuthCurrEDM()
											.getEdIndvEligibilityCargo()[j]
											.getAdverseActionAllowedSw() == IEdEligCodes.YES)
											&& ((aEgDataHandler
													.getEligDetailUnAuthCurrEDM()
													.getEdIndvEligibilityCargo()[j]
													.getPotentialEligEndDt() == null) || (aEgDataHandler
													.getEligDetailUnAuthCurrEDM()
													.getEdEligibilityCargo()[0]
													.getPaymentBegDt()
													.after(aEgDataHandler
															.getEligDetailUnAuthCurrEDM()
															.getEdIndvEligibilityCargo()[j]
															.getPotentialEligEndDt())))) {
										bFail = false;
										break;
									} else {
										bFail = true;
										break;
									}
								}
							}
						}
						if (bIndvFound == false) {
							bFail = true;
							break;
						}
						if (bFail == true) {
							break;
						}
					}
				}
			} else {
				bFail = true;
			}
		}
		return bFail;
	}

	// Added for CCB: 00150756
	/**
	 * Method alignCMACertificationPeriod, align CMA Certification, to the
	 * latest date availlabe.
	 *
	 * @param arrEligDetailOutput
	 *            EligDetail[]
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	public static void alignCMACertificationPeriod(
			EligDetail[] arrEligDetailOutput, EgDataHandler aEgDataHandler)
			throws EDBCException {

		int iLength = 0;
		int iEligDetOutLength = arrEligDetailOutput.length;
		HashMap hmCMA_Codes = null;
		HashMap hmCMA_Group = new HashMap();
		HashMap hmEdgRecertDt = new HashMap();
		//Added by Sai : 9/21
		HashMap hmCMA_EDG = new HashMap();
		ArrayList arrayList = null;
		long lCMA_Grp_Num = 0;
		boolean bCMA_AlienRequired = false;

		Timestamp tsCertifiedNoChangeEDGsMinCertEndDate = null;
		Timestamp tsCompleteReviewEDGsMinCertEndDate = null;
		Timestamp tsChangeActionEDGsMinCertEndDate = null;
		hmCMA_Codes = getCMATPCodes();

		// Following local Inner class used for handling the CMA_Group details
		class CMAStruct {
			EdEligibilityCargo aEdEligibilityCargo;

			Timestamp tsEdCaseRecertReviewDate;

			boolean bCMA_Cert_End_Dt_Alien_Sw = false;
		}
		CMAStruct cmaStruct = null;

		// Keep all the EdCaseRecertDates of the EDG's seperatley in HM with
		// EDG_NUM as key.
		EdCaseRecertDatesCargo[] arrEdCaseRecertDatesCargo = aEgDataHandler
				.getEligDetail()[0].getEdCaseRecertDatesCargo();
		if (arrEdCaseRecertDatesCargo != null) {
			iLength = arrEdCaseRecertDatesCargo.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (arrEdCaseRecertDatesCargo[i] != null) {
				hmEdgRecertDt.put(new Long(arrEdCaseRecertDatesCargo[i]
						.getEdgNum()), arrEdCaseRecertDatesCargo[i]
						.getRecertReviewDueDt());
			}
		}

		//Traverse the loop and store all the relevant EdEligibilityCargo
		// group-wise based on CMA_Group_Num
		for (int i = 0; i < iEligDetOutLength; i++) {
			if (arrEligDetailOutput[i] == null) {
				continue;
			}
			if ((!hmCMA_Codes.containsKey(arrEligDetailOutput[i]
					.getEdEligibilityCargo()[0].getTypeOfAssistanceCd()))) {
				continue;
			}
			/*
			 * // Loop thru open ended record if(
			 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getPaymentEndDt() ==
			 * null) { lCMA_Grp_Num =
			 * arrEligDetailOutput[i].getEdEligibilityCargo()[0].getCmaGroupNum() ;
			 *
			 * if (!hmCMA_Group.containsKey(new Long (lCMA_Grp_Num))) {
			 * arrayList = new ArrayList(); cmaStruct = new CMAStruct();
			 * cmaStruct.aEdEligibilityCargo =
			 * arrEligDetailOutput[i].getEdEligibilityCargo()[0];
			 * cmaStruct.tsEdCaseRecertReviewDate = (Timestamp
			 * )hmEdgRecertDt.get(new Long
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgNum()));
			 * if
			 * ((arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEstimatedEligEndDt() ==
			 * null ) ||
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEstimatedEligEndDt().equals(cmaStruct.tsEdCaseRecertReviewDate))) {
			 * cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = false ; } else if
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getCertBegDt() !=
			 * null) { cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = true ; // Flag to
			 * indicate to Align CMACertEndDate or not bCMA_AlienRequired = true ; }
			 * arrayList.add(cmaStruct); hmCMA_Group.put(new Long
			 * (lCMA_Grp_Num),arrayList); } else { arrayList = null ; arrayList =
			 * (ArrayList) hmCMA_Group.get(new Long (lCMA_Grp_Num)); cmaStruct =
			 * new CMAStruct(); cmaStruct.aEdEligibilityCargo =
			 * arrEligDetailOutput[i].getEdEligibilityCargo()[0];
			 * cmaStruct.tsEdCaseRecertReviewDate = (Timestamp
			 * )hmEdgRecertDt.get(new Long
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgNum()));
			 * if
			 * ((arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEstimatedEligEndDt() ==
			 * null ) ||
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEstimatedEligEndDt().equals(cmaStruct.tsEdCaseRecertReviewDate))) {
			 * cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = false ; } else if
			 * (arrEligDetailOutput[i].getEdEligibilityCargo()[0].getCertBegDt() !=
			 * null) { cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = true ; // Flag to
			 * indicate to Align CMACertEndDate or not bCMA_AlienRequired = true ; }
			 * arrayList.add(cmaStruct); hmCMA_Group.put(new Long
			 * (lCMA_Grp_Num),arrayList);
			 *  }
			 *
			 * }// end of 'if' check for open ended record
			 */
			if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
					.getPaymentEndDt() == null)
					|| (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getActivityType()
							.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW))) {
				lCMA_Grp_Num = arrEligDetailOutput[i].getEdEligibilityCargo()[0]
						.getCmaGroupNum();

				if (!hmCMA_Group.containsKey(new Long(lCMA_Grp_Num))) {
					arrayList = new ArrayList();
					cmaStruct = new CMAStruct();
					hmCMA_EDG.put(new Long(arrEligDetailOutput[i]
							.getEdEligibilityCargo()[0].getEdgNum()), new Long(
							arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getEdgNum()));
					cmaStruct.aEdEligibilityCargo = arrEligDetailOutput[i]
							.getEdEligibilityCargo()[0];
					cmaStruct.tsEdCaseRecertReviewDate = (Timestamp) hmEdgRecertDt
							.get(new Long(arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0].getEdgNum()));
					if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getEstimatedEligEndDt() == null)
							|| (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
									.getEstimatedEligEndDt()
									.equals(cmaStruct.tsEdCaseRecertReviewDate))) {
						cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = false;
					} else if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getCertBegDt() != null) {
						cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = true;
						// Flag to indicate to Align CMACertEndDate or not
						bCMA_AlienRequired = true;
					}
					arrayList.add(cmaStruct);
					hmCMA_Group.put(new Long(lCMA_Grp_Num), arrayList);
				} else {
					if (!hmCMA_EDG.containsKey(new Long(arrEligDetailOutput[i]
							.getEdEligibilityCargo()[0].getEdgNum()))) {
						arrayList = null;
						arrayList = (ArrayList) hmCMA_Group.get(new Long(
								lCMA_Grp_Num));
						cmaStruct = new CMAStruct();
						hmCMA_EDG
								.put(
										new Long(arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getEdgNum()),
										new Long(arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getEdgNum()));
						cmaStruct.aEdEligibilityCargo = arrEligDetailOutput[i]
								.getEdEligibilityCargo()[0];
						cmaStruct.tsEdCaseRecertReviewDate = (Timestamp) hmEdgRecertDt
								.get(new Long(arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0].getEdgNum()));
						if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getEstimatedEligEndDt() == null)
								|| (arrEligDetailOutput[i]
										.getEdEligibilityCargo()[0]
										.getEstimatedEligEndDt()
										.equals(cmaStruct.tsEdCaseRecertReviewDate))) {
							cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = false;
						} else if (arrEligDetailOutput[i]
								.getEdEligibilityCargo()[0].getCertBegDt() != null) {
							cmaStruct.bCMA_Cert_End_Dt_Alien_Sw = true;
							// Flag to indicate to Align CMACertEndDate or not
							bCMA_AlienRequired = true;
						}
						arrayList.add(cmaStruct);
						hmCMA_Group.put(new Long(lCMA_Grp_Num), arrayList);
					}

				}

			}// end of 'if' check for open ended record

		}// end of for

		if (bCMA_AlienRequired == false) {
			// All groups are already Aligned
			return;
		}
		;

		Iterator it = hmCMA_Group.keySet().iterator();
		Iterator itCMAStruct = null;
		boolean bCertifiedMinDateAvail = false;
		//Commented unnecessary variable
		//boolean bCRMinDate = false ;
		boolean bCompleteReviewAvail = false;
		//Added a new variable for the change action
		boolean bChangeActionDateAvail = false;
		Timestamp tsCurrMonth = DateComparisons
				.getTimestamp(new java.util.Date());

		while (it.hasNext()) {
			bCertifiedMinDateAvail = false;
			//Commented unnecessary variable
			//bCRMinDate = false ;
			bCompleteReviewAvail = false;
			bChangeActionDateAvail = false;
			arrayList = null;
			arrayList = (ArrayList) hmCMA_Group.get(it.next());

			tsCertifiedNoChangeEDGsMinCertEndDate = DateComparisons
					.getDate(IEdEligCodes.HIGH_DATE);
			tsCompleteReviewEDGsMinCertEndDate = DateComparisons
					.getDate(IEdEligCodes.HIGH_DATE);
			tsChangeActionEDGsMinCertEndDate = DateComparisons
					.getDate(IEdEligCodes.HIGH_DATE);
			itCMAStruct = arrayList.iterator();
			Timestamp tsAdjustTimestamp = null;
			// Find the minimal date in the group
			while (itCMAStruct.hasNext()) {
				cmaStruct = (CMAStruct) itCMAStruct.next();

				// To Find Certified Minimum Cert End Date
				// Note if Align switch is 'false' then it implies
				// CertEndDt(EstEligEndDt) and EdCaseRecertReviewDt are same .
				if (((cmaStruct.aEdEligibilityCargo.getCgStatusCd())
						.equals(IEdEligCodes.STATUS_CD_APPROVED))
						&& (cmaStruct.bCMA_Cert_End_Dt_Alien_Sw == false)) {
					if (cmaStruct.tsEdCaseRecertReviewDate != null) { //defect
																	  // Tiers00201750
						if ((tsCertifiedNoChangeEDGsMinCertEndDate == null)
								|| ((cmaStruct.tsEdCaseRecertReviewDate)
										.before(tsCertifiedNoChangeEDGsMinCertEndDate))) {
							tsCertifiedNoChangeEDGsMinCertEndDate = cmaStruct.tsEdCaseRecertReviewDate;
							bCertifiedMinDateAvail = true;
						}
					}
				}
				// To Find Complete Review Minimum Cert End Date
				if ((cmaStruct.aEdEligibilityCargo.getActivityType())
						.equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)) {
					//Added the approved check to not use the esteligendt from
					// terminated segment for defect 193135
					if ((cmaStruct.aEdEligibilityCargo.getCgStatusCd())
							.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
						//Moved the variable inside the if
						//bCompleteReviewAvail = true ;
						if ((cmaStruct.aEdEligibilityCargo
								.getEstimatedEligEndDt() != null)
								&& ((cmaStruct.aEdEligibilityCargo
										.getEstimatedEligEndDt())
										.before(tsCompleteReviewEDGsMinCertEndDate))) {
							tsCompleteReviewEDGsMinCertEndDate = cmaStruct.aEdEligibilityCargo
									.getEstimatedEligEndDt();
							bCompleteReviewAvail = true;
							//Commented unnecessary variable
							//bCRMinDate = true ;
						}
					}
				}
				// To Find Change Action Minimum Cert End Date
				if (cmaStruct.aEdEligibilityCargo.getEstimatedEligEndDt() != null) {
					//Added the approved check to not use the esteligendt from
					// terminated segment for defect 193135
					if ((cmaStruct.aEdEligibilityCargo.getCgStatusCd())
							.equals(IEdEligCodes.STATUS_CD_APPROVED)) {
						if ((cmaStruct.aEdEligibilityCargo
								.getEstimatedEligEndDt().after(tsCurrMonth))
								|| (cmaStruct.aEdEligibilityCargo
										.getEstimatedEligEndDt()
										.equals(tsCurrMonth))) {
							if ((cmaStruct.aEdEligibilityCargo
									.getEstimatedEligEndDt())
									.before(tsChangeActionEDGsMinCertEndDate)) {
								tsChangeActionEDGsMinCertEndDate = cmaStruct.aEdEligibilityCargo
										.getEstimatedEligEndDt();
								//Added a new variable for the change action
								bChangeActionDateAvail = true;
							}
						}
					}
				}

			}// End of inner while 1

			if (bCompleteReviewAvail) {
				tsAdjustTimestamp = null;

				if (bCertifiedMinDateAvail) {
					tsAdjustTimestamp = tsCertifiedNoChangeEDGsMinCertEndDate;
				} else {
					tsAdjustTimestamp = tsCompleteReviewEDGsMinCertEndDate;
				}
				itCMAStruct = arrayList.iterator();

				while (itCMAStruct.hasNext()) {
					cmaStruct = (CMAStruct) itCMAStruct.next();
					if (cmaStruct.bCMA_Cert_End_Dt_Alien_Sw == true) {
						adjustCMACertificationPeriod(arrEligDetailOutput,
								cmaStruct.aEdEligibilityCargo.getEdgNum(),
								cmaStruct.aEdEligibilityCargo.getCertBegDt(),
								tsAdjustTimestamp);
					}
				} // End of inner while 2.1

			} else {
				tsAdjustTimestamp = null;

				if (bCertifiedMinDateAvail) {
					tsAdjustTimestamp = tsCertifiedNoChangeEDGsMinCertEndDate;
				} else {
					//Added a new variable for the change action
					if (bChangeActionDateAvail) {
						tsAdjustTimestamp = tsChangeActionEDGsMinCertEndDate;
					}
				}
				//Added the check to make sure not to do alignment if no date
				// is found
				if (tsAdjustTimestamp != null) {
					itCMAStruct = arrayList.iterator();
					while (itCMAStruct.hasNext()) {
						cmaStruct = (CMAStruct) itCMAStruct.next();
						if (cmaStruct.aEdEligibilityCargo
								.getEstimatedEligEndDt() != null) {
							if ((cmaStruct.bCMA_Cert_End_Dt_Alien_Sw == true)
									&& ((cmaStruct.aEdEligibilityCargo
											.getEstimatedEligEndDt()
											.after(tsCurrMonth)) || (cmaStruct.aEdEligibilityCargo
											.getEstimatedEligEndDt()
											.equals(tsCurrMonth)))) {
								adjustCMACertificationPeriod(
										arrEligDetailOutput,
										cmaStruct.aEdEligibilityCargo
												.getEdgNum(),
										cmaStruct.aEdEligibilityCargo
												.getCertBegDt(),
										tsAdjustTimestamp);
							}
						}
					} // End of inner while 2.2
				}
			}

		}// End of outer while

	}

	// Added for CCB: 00150756

	/**
	 * Method adjustCMACertificationPeriod, adjust to latest cert beg date.
	 *
	 * @param arrEligDetailOutput
	 *            EligDetail[]
	 * @param lEdgNum
	 *            long
	 * @param tsCertBegDate
	 *            Timestamp
	 * @param tsAdjsutDate
	 *            Timestamp
	 * @throws EDBCException
	 */
	public static void adjustCMACertificationPeriod(
			EligDetail[] arrEligDetailOutput, long lEdgNum,
			Timestamp tsCertBegDate, Timestamp tsAdjsutDate)
			throws EDBCException {
		int iEligDetOutLength = arrEligDetailOutput.length;
		for (int i = 0; i < iEligDetOutLength; i++) {
			if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgNum() == lEdgNum)
					&& (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getCertBegDt() != null)
					&& ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getCertBegDt()).equals(tsCertBegDate))) {
				arrEligDetailOutput[i].getEdEligibilityCargo()[0]
						.setEstimatedEligEndDt(tsAdjsutDate);

				if ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
						.getPaymentBegDt() != null)
						&& ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getPaymentBegDt()).after(tsAdjsutDate))
						&& ((arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getCgStatusCd())
								.equals(IEdEligCodes.STATUS_CD_APPROVED))) {
					// Do Reprocess Logic
					arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.setEdgReprocessSw(IEdEligCodes.EDG_REPROCESS_SW_YES);
				}
			}
		}

	}

	// Added for CCB: 00127585
	/**
	 * Method checkForMMProcessing, check whether it is a mid month scenario
	 * basedon NOOP and AdverseAction .
	 *
	 * @param eligDetail
	 *            EligDetail
	 * @return boolean
	 * @throws EDBCException
	 */
	public static boolean checkForMMProcessing(EligDetail eligDetail)
			throws EDBCException {
		boolean bResult = false;
		int iIndvLength = 0;
		if (eligDetail.getEdEligibilityCargo()[0] == null) {
			return bResult;
		}
		if (eligDetail.getEdEligibilityCargo()[0].getEdbcActionCd() != null
				&& eligDetail.getEdEligibilityCargo()[0].getEdbcActionCd()
						.equals(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL)) {
			iIndvLength = eligDetail.getEdIndvEligibilityCargo().length;
			for (int i = 0; i < iIndvLength; i++) {
				if (eligDetail.getEdIndvEligibilityCargo()[i]
						.getAdverseActionAllowedSw() == IEdEligCodes.YES) {
					// Added the refedgtraceid check to make sure if it is a
					// midmonth because deathdt scenario could also come in this
					// path for defect 242518
					if (eligDetail.getEdIndvEligibilityCargo()[i]
							.getRefEdgTraceId() > 0) {
						bResult = true;
						break;
					}
				}
			}
		}
		return bResult;
	}

	// Added for CCB: 00127585
	/**
	 * Method performEDGCopyProcess, generic method used to copy EDG, used in
	 * MidMonth and PFP scenario's .
	 *
	 * @param aMapRequest
	 *            HashMap
	 * @return EligDetail
	 * @throws ApplicationException
	 * @throws FrameworkException
	 */
	public EligDetail performEDGCopyProcess(HashMap aMapRequest)
			throws ApplicationException, FrameworkException {

		IEgManager iEgMan = EgDriverFactory.getEDGDriver();
		try {
			iEgMan.execute(aMapRequest);
		} catch (TIERSValidationException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw e;
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getMessage());
		}
		EligDetail eligDetail = null;
		eligDetail = (EligDetail) (aMapRequest
				.get(EDGConstants.EDG_COPY_ELIG_DETAIL));
		return eligDetail;
	}

	// Added for CCB: 00127585
	/**
	 * Method performDriverMMProcess.
	 *
	 * @param edgMMCopiedEligDetail
	 *            EligDetail
	 * @param eligDetailLastAuth
	 *            EligDetail
	 * @return EligDetail
	 * @throws EDBCException
	 */
	public EligDetail performDriverMMProcess(EligDetail edgMMCopiedEligDetail,
			EligDetail eligDetailLastAuth) throws EDBCException {
		EligDetail eligDetail = edgMMCopiedEligDetail;
		long lTraceId = edgMMCopiedEligDetail.getEdEligibilityCargo()[0]
				.getEdgTraceId();
		//Following Cargos copy from EDG MM Copy: EdEligibility, EdIndvCargos,
		// EdIndvNoticeReasons, EdEligNoticeReasons, EdIndvDateSpecific
		/*
		 * if (edgMMCopiedEligDetail.getEdEligibilityCargo() != null) {
		 * eligDetail.cloneSetEdEligibilityCargo(edgMMCopiedEligDetail.getEdEligibilityCargo(),lTraceId); }
		 * if (edgMMCopiedEligDetail.getEdIndvEligibilityCargo() != null) {
		 * eligDetail.cloneSetEdIndvEligibilityCargo(edgMMCopiedEligDetail.getEdIndvEligibilityCargo(),lTraceId); }
		 * if (edgMMCopiedEligDetail.getEdIndvNoticeReasonsCargo() != null) {
		 * eligDetail.cloneSetEdIndvNoticeReasonsCargo(edgMMCopiedEligDetail.getEdIndvNoticeReasonsCargo(),lTraceId); }
		 * if (edgMMCopiedEligDetail.getEdIndvDateSpecificCargo() != null) {
		 * eligDetail.cloneSetEdIndvDateSpecificCargo(edgMMCopiedEligDetail.getEdIndvDateSpecificCargo(),lTraceId); }
		 * if (edgMMCopiedEligDetail.getEdEligNoticeReasonsCargo() != null) {
		 * eligDetail.cloneSetEdEligNoticeReasonsCargo(edgMMCopiedEligDetail.getEdEligNoticeReasonsCargo(),lTraceId); }
		 */
		// Others copy from LastAuth


		//BRGUS00135020-upadhyayulag-START-Do not clone the budget cargos if the elig results code is "NA"
		if (eligDetailLastAuth.getEdEligRscBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getRscEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligRscBudgetCargo(eligDetailLastAuth
					.getEdEligRscBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligRscBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdIndvRscBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getRscEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvRscBudgetCargo(eligDetailLastAuth
					.getEdIndvRscBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvRscBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdIndvRscDtlsCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getRscEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvRscDtlsCargo(eligDetailLastAuth
					.getEdIndvRscDtlsCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvRscDtlsCargo(null);
		}
		//BRGUS00135020-END

		if (eligDetailLastAuth.getEdIndvPenaltiesCargo() != null) {
			eligDetail.cloneSetEdIndvPenaltiesCargo(eligDetailLastAuth
					.getEdIndvPenaltiesCargo(), lTraceId);
		}
		//CR-20442 Start
		if (eligDetailLastAuth.getEdEdgPenaltyDetailsCargo() != null) {
			eligDetail.cloneSetEdEdgPenaltiesCargo(eligDetailLastAuth
					.getEdEdgPenaltyDetailsCargo(), lTraceId);
		}
		//End


		//BRGUS00135020-upadhyayulag-START-Do not clone the budget cargos if the elig results code is "NA"
		if (eligDetailLastAuth.getEdIndvApplIncBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvApplIncBudgetCargo(eligDetailLastAuth
					.getEdIndvApplIncBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvApplIncBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdEligTanfBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligTanfBudgetCargo(eligDetailLastAuth
					.getEdEligTanfBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligTanfBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdIndvTanfBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvTanfBudgetCargo(eligDetailLastAuth
					.getEdIndvTanfBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvTanfBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdEligFmaBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligFmaBudgetCargo(eligDetailLastAuth
					.getEdEligFmaBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligFmaBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdIndvFmaBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvFmaBudgetCargo(eligDetailLastAuth
					.getEdIndvFmaBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvFmaBudgetCargo(null);
		}
		/*
		 * CQ 2017: Table deleted if
		 * (eligDetailLastAuth.getEdEligCcadBudgetCargo() != null) {
		 * eligDetail.cloneSetEdEligCcadBudgetCargo(eligDetailLastAuth.getEdEligCcadBudgetCargo(),lTraceId); }
		 */
		/*
		 * CQ 2023: Table deleted if
		 * (eligDetailLastAuth.getEdEligCmpasBudgetCargo() != null) {
		 * eligDetail.cloneSetEdEligCmpasBudgetCargo(eligDetailLastAuth.getEdEligCmpasBudgetCargo(),lTraceId); }
		 */

		/*//BRGUS00135020-upadhyayulag-These tables are not used in BRIDGES
		if (eligDetailLastAuth.getEdEligIhfsBudgetCargo() != null) {
			eligDetail.cloneSetEdEligIhfsBudgetCargo(eligDetailLastAuth
					.getEdEligIhfsBudgetCargo(), lTraceId);
		}
		if (eligDetailLastAuth.getEdEligTlcBudgetCargo() != null) {
			eligDetail.cloneSetEdEligTlcBudgetCargo(eligDetailLastAuth
					.getEdEligTlcBudgetCargo(), lTraceId);
		}
		//END-BRGUS00135020*/
		if (eligDetailLastAuth.getEdEligMeBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligMeBudgetCargo(eligDetailLastAuth
					.getEdEligMeBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligMeBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdEligUnIncDtlsCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligUnIncDtlsCargo(eligDetailLastAuth
					.getEdEligUnIncDtlsCargo(), lTraceId);
		}else{
			eligDetail.setEdEligUnIncDtlsCargo(null);
		}
		if (eligDetailLastAuth.getEdEligLtcAllowanceCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligLtcAllowanceCargo(eligDetailLastAuth
					.getEdEligLtcAllowanceCargo(), lTraceId);
		}else{
			eligDetail.setEdEligLtcAllowanceCargo(null);
		}
		if (eligDetailLastAuth.getEdEligLtcCopayBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligLtcCopayBudgetCargo(eligDetailLastAuth
					.getEdEligLtcCopayBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligLtcCopayBudgetCargo(null);
		}
		if (eligDetailLastAuth.getEdEligLtcDeemedBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdEligLtcDeemedBudgetCargo(eligDetailLastAuth
					.getEdEligLtcDeemedBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdEligLtcDeemedBudgetCargo(null);
		}
		/*
		 * CQ 2036: Table deleted if
		 * (eligDetailLastAuth.getEdIndvCcadBudgetCargo() != null) {
		 * eligDetail.cloneSetEdIndvCcadBudgetCargo(eligDetailLastAuth.getEdIndvCcadBudgetCargo(),lTraceId); }
		 */
		if (eligDetailLastAuth.getEdIndvMeBudgetCargo() != null &&
				!eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd().equals("NA")) {
			eligDetail.cloneSetEdIndvMeBudgetCargo(eligDetailLastAuth
					.getEdIndvMeBudgetCargo(), lTraceId);
		}else{
			eligDetail.setEdIndvMeBudgetCargo(null);
		}
		//BRGUS00135020-END


		if (eligDetailLastAuth.getEdIndvLtcPendingReasonCargo() != null) {
			eligDetail.cloneSetEdIndvLtcPendingReasonCargo(eligDetailLastAuth
					.getEdIndvLtcPendingReasonCargo(), lTraceId);
		}
		if (eligDetailLastAuth.getEdIndvPnaDtlsCargo() != null) {
			eligDetail.cloneSetEdIndvPnaDtlsCargo(eligDetailLastAuth
					.getEdIndvPnaDtlsCargo(), lTraceId);
		}

		return eligDetail;
	}

	// Added for CCB: 00129329
	/**
	 * Method performPFPCopyProcess.
	 *
	 * @param currEligDetail contains the current EligDetail structure
	 * @param newEligDetail contains the new EligDetail structure
	 * @param eligDetailLastAuth
	 *            contains the authorized EligDetail structure
	 * @param aLCaseNum contains the case number
	 * @param conn contains the Connection object
	 * @return contains the EligDetail structure
	 * @throws EDBCException
	 */
	
	public EligDetail performPFPCopyProcess(EligDetail currEligDetail,
			EligDetail newEligDetail, EligDetail eligDetailLastAuth,
			long aLCaseNum, Connection conn) throws EDBCException {
		EligDetail eligDetailSrc = newEligDetail;
		EligDetail eligDetailDes[] = null;
		ArrayList alEdElig = new ArrayList();
		EdCopyUtil edCopyUtil = new EdCopyUtil();
		long lNewEligEdgTraceId = newEligDetail.getEdEligibilityCargo()[0]
				.getEdgTraceId();
		newEligDetail.getEdEligibilityCargo()[0]
				.setReferenceEdgTraceId(eligDetailLastAuth
						.getEdEligibilityCargo()[0].getEdgTraceId());
		edCopyUtil.setEdCopyUtil(aLCaseNum, DateComparisons.getLocalesDate(),
				conn);
		alEdElig.add(eligDetailSrc.getEdEligibilityCargo()[0]);
		eligDetailDes = (EligDetail[]) edCopyUtil.cloneCopyEligDetail(alEdElig);

		int iCurrIndvLen = newEligDetail.getEdIndvEligibilityCargo().length;
		int iLastAuthIndvLen = eligDetailLastAuth.getEdIndvEligibilityCargo().length;
		EdIndvEligibilityCargo[] edCurrIndv = null;
		EdIndvEligibilityCargo[] edLastAuthIndv = null;

		//Following code added for the Defect #: 234953 on 8/25/2005
		edCurrIndv = currEligDetail.getEdIndvEligibilityCargo();
		edLastAuthIndv = eligDetailLastAuth.getEdIndvEligibilityCargo();
		boolean bNewIndvFound = true;
		ArrayList alNewIndv = new ArrayList();
		try {
			for (int i = 0; i < iCurrIndvLen; i++) {
				bNewIndvFound = true;
				for (int j = 0; j < iLastAuthIndvLen; j++) {
					if (edCurrIndv[i].getIndvId() == edLastAuthIndv[j]
							.getIndvId()) {
						bNewIndvFound = false;
						break;
					}
				}//inner for
				if (bNewIndvFound == true) {
					EdIndvEligibilityCargo newIndvCargo = new EdIndvEligibilityCargo();
					newIndvCargo = (EdIndvEligibilityCargo) edCurrIndv[i]
							.clone();
					newIndvCargo.setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
					if (newIndvCargo.getEligibilityEndDt() == null
							&& newIndvCargo.getEligibilityBegDt() != null) {
						newIndvCargo
								.setEligibilityEndDt(DateComparisons
										.subDays(currEligDetail
												.getEdEligibilityCargo()[0]
												.getPaymentBegDt(), 1));
					}
					alNewIndv.add(newIndvCargo);
					eligDetailDes[0] = copyPFPBudgets(eligDetailDes[0],
							currEligDetail, newIndvCargo.getIndvId());
				}
			}// outer for
		} catch (CloneNotSupportedException ce) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ce);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"Clone-performPFPCopyProcess", ce);
		}

		//If we have new individuals then copy
		//EdIndvTanfBudget, EdIndvRscBudget, EdIndvForfeitDetails,
		// EdIndvCounters, EdIndvApplIncBudget
		if (alNewIndv.size() > 0) {
			int iLen = eligDetailDes[0].getEdIndvEligibilityCargo().length;
			EdIndvEligibilityCargo[] copiedIndvCargo = null;
			copiedIndvCargo = eligDetailDes[0].getEdIndvEligibilityCargo();
			for (int i = 0; i < iLen; i++) {
				alNewIndv.add(copiedIndvCargo[i]);
			}
			eligDetailDes[0]
					.setEdIndvEligibilityCargo((EdIndvEligibilityCargo[]) alNewIndv
							.toArray(new EdIndvEligibilityCargo[alNewIndv
									.size()]));

		}
		return eligDetailDes[0];
	}

	/**
	 * Method copyPFPBudgets is used to copy the budget records for PFP
	 * @param eligDetailDes EligDetail
	 * @param currEligDetail EligDetail
	 * @param lIndvId long
	 * @return EligDetail
	 * @throws EDBCException
	 */
	private EligDetail copyPFPBudgets(EligDetail eligDetailDes,
			EligDetail currEligDetail, long lIndvId) throws EDBCException {

		int i = 0;
		int iLen = 0;
		int iCargoLen = 0;
		ArrayList alNew = null;
		try {
			long lNewEligEdgTraceId = eligDetailDes.getEdEligibilityCargo()[0]
					.getEdgTraceId();
			EdIndvTanfBudgetCargo[] newIndvCargo1 = currEligDetail
					.getEdIndvTanfBudgetCargo();
			if (newIndvCargo1 != null) {
				iCargoLen = newIndvCargo1.length;
			}
			alNew = new ArrayList();
			EdIndvTanfBudgetCargo newCargo = null;
			for (i = 0; i < iCargoLen; i++) {
				if (newIndvCargo1[i].getIndvId() == lIndvId) {
					alNew.add((EdIndvTanfBudgetCargo) newIndvCargo1[i].clone());
				}
			}
			iLen = 0;
			if (eligDetailDes.getEdIndvTanfBudgetCargo() != null) {
				iLen = eligDetailDes.getEdIndvTanfBudgetCargo().length;
			}
			EdIndvTanfBudgetCargo[] arrCopiedIndvCargo1 = null;
			arrCopiedIndvCargo1 = eligDetailDes.getEdIndvTanfBudgetCargo();
			for (i = 0; i < iLen; i++) {
				alNew.add(arrCopiedIndvCargo1[i]);
			}
			if (alNew.size() > 0) {
				eligDetailDes
						.cloneSetEdIndvTanfBudgetCargo(
								((EdIndvTanfBudgetCargo[]) alNew
										.toArray(new EdIndvTanfBudgetCargo[alNew
												.size()])), lNewEligEdgTraceId);
			}
			//eligDetailDes.setEdIndvTanfBudgetCargo((EdIndvTanfBudgetCargo[])alNew.toArray(new
			// EdIndvTanfBudgetCargo[alNew.size()]));
			/*
			 * EdIndvForfeitDetailCargo[] newIndvCargo1 =
			 * currEligDetail.getEdIndvForfeitDetailsCargo(); iCargoLen =
			 * newIndvCargo1.length; alNew = new ArrayList(); for (i=0; i <
			 * iCargoLen ; i++){ if (newIndvCargo1[i].getIndvId() == lIndvId){
			 * alNew.add((EdIndvForfeitDetailsCargo)newIndvCargo1[i].clone()); } }
			 * iLen = eligDetailDes.getEdIndvForfeitDetailsCargo().length ;
			 * EdIndvForfeitDetailsCargo[] arrCopiedIndvCargo = null;
			 * arrCopiedIndvCargo =
			 * eligDetailDes.getEdIndvForfeitDetailsCargo(); for (i=0; i < iLen ;
			 * i++){ alNew.add(arrCopiedIndvCargo[i]); }
			 *
			 * eligDetailDes.setEdIndvForfeitDetailsCargo((EdIndvForfeitDetailsCargo[])alNew.toArray(new
			 * EdIndvForfeitDetailsCargo[alNew.size()]));
			 */

			EdIndvRscBudgetCargo[] newIndvCargo2 = currEligDetail
					.getEdIndvRscBudgetCargo();
			iCargoLen = 0;
			if (newIndvCargo2 != null) {
				iCargoLen = newIndvCargo2.length;
			}
			alNew = new ArrayList();
			for (i = 0; i < iCargoLen; i++) {
				if (newIndvCargo2[i].getIndvId() == lIndvId) {
					alNew.add((EdIndvRscBudgetCargo) newIndvCargo2[i].clone());
				}
			}
			iLen = 0;
			if (eligDetailDes.getEdIndvRscBudgetCargo() != null) {
				iLen = eligDetailDes.getEdIndvRscBudgetCargo().length;
			}

			EdIndvRscBudgetCargo[] arrCopiedIndvCargo2 = null;
			arrCopiedIndvCargo2 = eligDetailDes.getEdIndvRscBudgetCargo();
			for (i = 0; i < iLen; i++) {
				// Modified to use correct variable for defect 243307
				alNew.add(arrCopiedIndvCargo2[i]);
			}
			if (alNew.size() > 0) {
				eligDetailDes
						.cloneSetEdIndvRscBudgetCargo(
								((EdIndvRscBudgetCargo[]) alNew
										.toArray(new EdIndvRscBudgetCargo[alNew
												.size()])), lNewEligEdgTraceId);
			}
			//eligDetailDes.setEdIndvRscBudgetCargo((EdIndvRscBudgetCargo[])alNew.toArray(new
			// EdIndvRscBudgetCargo[alNew.size()]));

			EdIndvCountersCargo[] newIndvCargo3 = currEligDetail
					.getEdIndvCountersCargo();
			iCargoLen = 0;
			if (newIndvCargo3 != null) {
				iCargoLen = newIndvCargo3.length;
			}
			alNew = new ArrayList();
			for (i = 0; i < iCargoLen; i++) {
				if (newIndvCargo3[i].getIndvId() == lIndvId) {
					alNew.add((EdIndvCountersCargo) newIndvCargo3[i].clone());
				}
			}
			iLen = 0;
			if (eligDetailDes.getEdIndvCountersCargo() != null) {
				iLen = eligDetailDes.getEdIndvCountersCargo().length;
			}

			EdIndvCountersCargo[] arrCopiedIndvCargo3 = null;
			arrCopiedIndvCargo3 = eligDetailDes.getEdIndvCountersCargo();
			for (i = 0; i < iLen; i++) {
				// Modified to use correct variable for defect 243307
				alNew.add(arrCopiedIndvCargo3[i]);
			}

			if (alNew.size() > 0) {
				eligDetailDes
						.cloneSetEdIndvCountersCargo(
								((EdIndvCountersCargo[]) alNew
										.toArray(new EdIndvCountersCargo[alNew
												.size()])), lNewEligEdgTraceId);
			}
			//eligDetailDes.setEdIndvCountersCargo((EdIndvCountersCargo[])alNew.toArray(new
			// EdIndvCountersCargo[alNew.size()]));

			EdIndvApplIncBudgetCargo[] newIndvCargo4 = currEligDetail
					.getEdIndvApplIncBudgetCargo();
			iCargoLen = 0;
			if (newIndvCargo4 != null) {
				iCargoLen = newIndvCargo4.length;
			}
			alNew = new ArrayList();
			for (i = 0; i < iCargoLen; i++) {
				if (newIndvCargo4[i].getIndvId() == lIndvId) {
					alNew.add((EdIndvApplIncBudgetCargo) newIndvCargo4[i]
							.clone());
				}
			}
			iLen = 0;
			if (eligDetailDes.getEdIndvApplIncBudgetCargo() != null) {
				iLen = eligDetailDes.getEdIndvApplIncBudgetCargo().length;
			}

			EdIndvApplIncBudgetCargo[] arrCopiedIndvCargo4 = null;
			arrCopiedIndvCargo4 = eligDetailDes.getEdIndvApplIncBudgetCargo();
			for (i = 0; i < iLen; i++) {
				// Modified to use correct variable for defect 243307
				alNew.add(arrCopiedIndvCargo4[i]);
			}
			if (alNew.size() > 0) {
				eligDetailDes.cloneSetEdIndvApplIncBudgetCargo(
						((EdIndvApplIncBudgetCargo[]) alNew
								.toArray(new EdIndvApplIncBudgetCargo[alNew
										.size()])), lNewEligEdgTraceId);
			}
			//eligDetailDes.setEdIndvApplIncBudgetCargo((EdIndvApplIncBudgetCargo[])alNew.toArray(new
			// EdIndvApplIncBudgetCargo[alNew.size()]));

		} catch (CloneNotSupportedException ce) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ce);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"copyPFPBudgets", ce);
		}

		return eligDetailDes;
	}

	/**
	 * Get a new unique trace id.
	 *
	 * @param conn
	 *            Connection
	 * @return long
	 */
	public long getNewTraceId(Connection conn) {

		long traceId = 0;
		//Commented due to FindBugs Analysis
		//Object[] objLst = null;

		EdEligibilityCollection coll = null;
		EdEligibilityCargo[] cargos = null;

		try {
			coll = new EdEligibilityCollection(conn);
			cargos = (EdEligibilityCargo[]) coll.select("findByNextTraceId",
					null);
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new DataException(DataException.MAJOR,
					"EdSpendDownDataReader", "getNewTraceId",
					"Some java.lang.Exception from coll.select(..)", e);
		}

		if (cargos != null && cargos.length > 0) {
			traceId = cargos[0].getEdgTraceId();
		}
		return traceId;
	}

	/**
	 * Method performEDGProcess.
	 *
	 * @param aMapRequest
	 *            Map
	 * @return boolean
	 * @throws ApplicationException
	 * @throws FrameworkException
	 */
	public boolean performEDGProcess(Map aMapRequest)
			throws ApplicationException, FrameworkException {
		IEgManager iEgMan = EgDriverFactory.getEDGDriver();
		//Commented due to FindBugs Analysis
		//Timestamp[] tsInput = new Timestamp[2];
		try {
			iEgMan.execute(aMapRequest);
		} catch (TIERSValidationException tve) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
			throw tve;
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());

		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getMessage());

		}
		//set the data in the request to be forwarded by Controller
		return true;
	}

	/**
	 * Method adjustEligEndDateForMM, adjust Elig End date for MM EDG's.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @throws EDBCException
	 */
	public void adjustEligEndDateForMM(EligDetail aEligDetail)
			throws EDBCException {
		EligDetail eligDetailCurrEDM = aEligDetail;
		boolean bDateSetFlag = false;
		Timestamp tsMaxIndvEligEndDt = DateComparisons
				.getDate(IEdEligCodes.LOW_DATE);
		try {
			int iLength = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
			for (int i = 0; i < iLength; i++) {
				//If there is atleast one individual in CG with elig end dt as
				// null then skip the process
				if ((eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
						.getEligibilityEndDt() == null)
						&& (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
								.getGroupInd() == IEdEligCodes.GROUP_IND_C)) {
					bDateSetFlag = false;
					break;
				} else if ((eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
						.getEligibilityEndDt() != null)
						&& (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
								.getEligibilityEndDt()
								.after(tsMaxIndvEligEndDt))) {
					tsMaxIndvEligEndDt = eligDetailCurrEDM
							.getEdIndvEligibilityCargo()[i]
							.getEligibilityEndDt();
					bDateSetFlag = true;
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"adjustEligEndDateForMM", ex);
		}
		if (bDateSetFlag) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setEligibilityEndDt(tsMaxIndvEligEndDt);
		}
		return;

	}

	/**
	 * Method adjustEligBegDateForMM adjust Elig Beg date for MM EDG's.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @throws EDBCException
	 */
	public void adjustEligBegDateForMM(EligDetail aEligDetail)
			throws EDBCException {
		EligDetail eligDetailCurrEDM = aEligDetail;
		boolean bDateSetFlag = false;
		Timestamp tsMinIndvEligBegDt = null;

		try {
			if ((eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.getEligibilityBegDt() != null)
					&& (DateComparisons.getStringMMYYYY(eligDetailCurrEDM
							.getEdEligibilityCargo()[0].getEligibilityBegDt())
							.equals(DateComparisons
									.getStringMMYYYY(eligDetailCurrEDM
											.getEdEligibilityCargo()[0]
											.getPaymentBegDt())))) {
				tsMinIndvEligBegDt = DateComparisons
						.getDate(IEdEligCodes.HIGH_DATE);
				int iLength = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
				for (int i = 0; i < iLength; i++) {
					if ((eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
							.getEligibilityBegDt() != null)
							&& (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
									.getEligibilityBegDt()
									.before(tsMinIndvEligBegDt))) {
						tsMinIndvEligBegDt = eligDetailCurrEDM
								.getEdIndvEligibilityCargo()[i]
								.getEligibilityBegDt();
						bDateSetFlag = true;
					}
				}// end of for

				//if ((bDateSetFlag) &&
				// (DateComparisons.getStringMMYYYY(tsMinIndvEligBegDt).equals(DateComparisons.getStringMMYYYY(eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentBegDt()))))
				// {
				//Checking of MMYYYY is not required here. Above line is
				// commented for Defect #00216569 on 3/2/2005
				if (bDateSetFlag) {
					if (!eligDetailCurrEDM.getEdEligibilityCargo()[0]
							.getEligibilityBegDt().equals(tsMinIndvEligBegDt)) {
						eligDetailCurrEDM.getEdEligibilityCargo()[0]
								.setEligibilityBegDt(tsMinIndvEligBegDt);
						//BEGIN-BRGUS00159285-upadhyayulag-Set disposition elig begin date only if it is null
						if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getDispositionEligBegDt() == null){
							eligDetailCurrEDM.getEdEligibilityCargo()[0]
									.setDispositionEligBegDt(eligDetailCurrEDM
											.getEdEligibilityCargo()[0]
											.getEdbcRunDt());
						}
						//END-BRGUS00159285
					}
				}

			}
		}// end of try
		catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"adjustEligBegDateForMM", ex);
		}
		return;

	}

	/**
	 * Method getELNoticeReasons.
	 *
	 * @return HashMap
	 */
	private HashMap getELNoticeReasons() {
		if (hmELNoticeReason == null) {
			//Just Populate once per instance
			hmELNoticeReason = new HashMap();
			String[] sELNoticeReasons = IEdEligCodes.EL_NOTICE_REASONS;
			int iLength = sELNoticeReasons.length;
			for (int i = 0; i < iLength; i++) {
				hmELNoticeReason.put(sELNoticeReasons[i], sELNoticeReasons[i]);
			}
		}
		return hmELNoticeReason;

	}

	/**
	 * Method getCMATPCodes.
	 *
	 * @return HashMap
	 */
	public static HashMap getCMATPCodes() {
		if (hmCMA_TPCodes == null) {
			//Just Populate once per instance
			hmCMA_TPCodes = new HashMap();
			hmCMA_TPCodes.put(IEdEligCodes.TP_43, IEdEligCodes.TP_43);
			hmCMA_TPCodes.put(IEdEligCodes.TP_44, IEdEligCodes.TP_44);
			hmCMA_TPCodes.put(IEdEligCodes.TP_47, IEdEligCodes.TP_47);
			hmCMA_TPCodes.put(IEdEligCodes.TP_48, IEdEligCodes.TP_48);			
		}
		return hmCMA_TPCodes;
	}

	/**
	 * Method setIfColaNoticeReasonAvail.
	 *
	 * @param egDataHandler
	 *            EgDataHandler
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEdEligNoticeReasonsCargo
	 *            EdEligNoticeReasonsCargo
	 * @param aUserId
	 *            String
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean setIfColaNoticeReasonAvail(EgDataHandler egDataHandler,
			EdEligibilityCargo aEdEligibilityCargo,
			EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo, String aUserId)
			throws EDBCException {
		boolean bResult = false;
		EdColaChangesCargo[] arrEdColaChangesCargo = null;
		EdColaChangesCargo aEdColaChangesCargo = null;

		arrEdColaChangesCargo = egDataHandler.getEdIndvInfo()
				.getEdColaChangesCargo();

		// Set ColaNotice Reason only for FS,TANF, TP08
		/*
		 * if ((aEdEligibilityCargo.getProgramCd() == IEdEligCodes.PROGRAM_CD_FS ) ||
		 * (aEdEligibilityCargo.getProgramCd() == IEdEligCodes.PROGRAM_CD_TANF ) ||
		 * (aEdEligibilityCargo.getTypeOfAssistanceCd() == IEdEligCodes.TP_08)) {
		 */
		// Commented for CCBTiers00187555 - November 2004 COLA Updates
		/*
		 * if
		 * ((aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS)) ||
		 * (aEdEligibilityCargo.getProgramCd().equals(IEdEligCodes.PROGRAM_CD_TANF)) ||
		 * (aEdEligibilityCargo.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_08))) {
		 */
		if (arrEdColaChangesCargo != null) {
			int iLength = arrEdColaChangesCargo.length;
			String sMMYYColaMonth = null;
			String sMMYYPayBegDt = null;
			for (int i = 0; i < iLength; i++) {
				aEdColaChangesCargo = arrEdColaChangesCargo[i];
				sMMYYColaMonth = DateComparisons
						.getStringMMYYYY(aEdColaChangesCargo.getColaMonth());
				sMMYYPayBegDt = DateComparisons
						.getStringMMYYYY(aEdEligibilityCargo.getPaymentBegDt());
				// And Edg Num filter added
				//if
				// ((DateComparisons.getMM(aEdColaChangesCargo.getColaMonth())
				// ==
				// DateComparisons.getMM(aEdEligibilityCargo.getPaymentBegDt()))
				if ((sMMYYColaMonth.equals(sMMYYPayBegDt))
						&& (aEdColaChangesCargo.getEdgNum() == aEdEligibilityCargo
								.getEdgNum())) {

					if (aEdEligibilityCargo.getBenefitStatus() != null
							&& aEdEligibilityCargo.getBenefitStatus().equals(
									IEdEligCodes.BENEFIT_STATUS_INCREASE)) {

						if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
							aEdEligNoticeReasonsCargo
									.setFailureReasonCode(lookForEL5Series(
											aEdEligNoticeReasonsCargo,
											aEdColaChangesCargo
													.getNoticeReason()));
						} else {
							aEdEligNoticeReasonsCargo
									.setFailureReasonCode(aEdColaChangesCargo
											.getNoticeReason());
						}
						bResult = true;
						aEdColaChangesCargo.setEdNoticeSetSw(IEdEligCodes.YES);
						//aEdColaChangesCargo.setEdgTraceId(aEdEligibilityCargo.getEdgTraceId());
						//Added for cola run
						aEdColaChangesCargo.setEdbcRunDt(aEdEligibilityCargo
								.getEdbcRunDt());
						aEdColaChangesCargo.setUpdateUserId(aUserId);
						aEdColaChangesCargo.setUpdateDt(DateComparisons
								.getTimestamp(new java.util.Date()));

					} else if (aEdEligibilityCargo.getBenefitStatus() != null
							&& aEdEligibilityCargo.getBenefitStatus().equals(
									IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
						if (aEdEligNoticeReasonsCargo.getFailureReasonCode() != null) {
							aEdEligNoticeReasonsCargo
									.setFailureReasonCode(lookForEL5Series(
											aEdEligNoticeReasonsCargo,
											aEdColaChangesCargo
													.getNoticeReason()));
						} else {
							aEdEligNoticeReasonsCargo
									.setFailureReasonCode(aEdColaChangesCargo
											.getNoticeReason());
						}
						bResult = true;
						aEdColaChangesCargo.setEdNoticeSetSw(IEdEligCodes.YES);
						//aEdColaChangesCargo.setEdgTraceId(aEdEligibilityCargo.getEdgTraceId());
						//Added for cola run
						aEdColaChangesCargo.setEdbcRunDt(aEdEligibilityCargo
								.getEdbcRunDt());
						aEdColaChangesCargo.setUpdateUserId(aUserId);
						aEdColaChangesCargo.setUpdateDt(DateComparisons
								.getTimestamp(new java.util.Date()));
					} else if (aEdEligibilityCargo.getBenefitStatus() != null
							&& aEdEligibilityCargo.getBenefitStatus().equals(
									IEdEligCodes.BENEFIT_STATUS_DENY)) {
						if ((aEdEligibilityCargo.getCgStatusCd()
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))
								&& (aEdEligibilityCargo.getFinEligRsltCd()
										.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL))) {
							if (aEdEligNoticeReasonsCargo
									.getFailureReasonCode() != null) {
								aEdEligNoticeReasonsCargo
										.setFailureReasonCode(lookForEL5Series(
												aEdEligNoticeReasonsCargo,
												aEdColaChangesCargo
														.getNoticeReason()));
							} else {
								aEdEligNoticeReasonsCargo
										.setFailureReasonCode(aEdColaChangesCargo
												.getNoticeReason());
							}
							bResult = true;
							aEdColaChangesCargo
									.setEdNoticeSetSw(IEdEligCodes.YES);
							//aEdColaChangesCargo.setEdgTraceId(aEdEligibilityCargo.getEdgTraceId());
							//Added for cola run
							aEdColaChangesCargo
									.setEdbcRunDt(aEdEligibilityCargo
											.getEdbcRunDt());
							aEdColaChangesCargo.setUpdateUserId(aUserId);
							aEdColaChangesCargo.setUpdateDt(DateComparisons
									.getTimestamp(new java.util.Date()));
						} else {
							aEdColaChangesCargo
									.setEdNoticeSetSw(IEdEligCodes.NO);
						}
					} else {
						aEdColaChangesCargo.setEdNoticeSetSw(IEdEligCodes.NO);
					}
					break;
				}
				// Come out of loop if the current array index ColaMonth is
				// greater than current EDM
				else if (DateComparisons.getMM(aEdColaChangesCargo
						.getColaMonth()) > DateComparisons
						.getMM(aEdEligibilityCargo.getPaymentBegDt())) {
					break;
				}
				//Move to next month
				else {
					continue;
				}

			}// End of for

		}// End of if - arrEdColaChangesCargo != null
		//		}// End of if - FS,TANF,TP08

		return bResult;
	}

	//Added for defect 193914
	/**
	 * Method detAnotherTP08Exists.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 */
	private boolean detAnotherTP08Exists(EgDataHandler aEgDataHandler) {
		boolean bAnotherTP08Exists = false;
		int iLength = 0;
		iLength = aEgDataHandler.getEligDetail()[0].getEdEligibilityCargo().length;
		if (aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0]
				.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_08)) {
			for (int i = 0; i < iLength; i++) {
				//Defect Tiers00201695
				if (aEgDataHandler.getEligDetail()[0].getEdEligibilityCargo()[i]
						.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_08)) {
					if (aEgDataHandler.getEligDetail()[0]
							.getEdEligibilityCargo()[i].getEdgNum() != aEgDataHandler
							.getEligDetailUnAuthCurrEDM()
							.getEdEligibilityCargo()[0].getEdgNum()) {
						bAnotherTP08Exists = true;
						break;
					}
				}
			}
		}
		return bAnotherTP08Exists;
	}

	//Added for defect 195388
	/**
	 * Method detBenefitStatusFromLastAuth.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 */
	public void detBenefitStatusFromLastAuth(EgDataHandler aEgDataHandler) {
		double dBenefitAmtUnConfirmed = 0;
		double dBenefitAmtConfirmed = 0;
		//changed for defect Tiers00201122
		//		if (aEgDataHandler.getEligDetailLastAuth() != null &&
		// aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() !=
		// null &&
		// aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length
		// > 0) {
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdEligibilityCargo() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdEligibilityCargo().length > 0
				&& (aEgDataHandler.getEligDetailLastAuth()
						.getEdEligibilityCargo()[0].getBenefitStatus()
						.equals(IEdEligCodes.STATUS_CD_APPROVED))) {
			dBenefitAmtUnConfirmed = aEgDataHandler
					.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0]
					.getBenefitAmt();
			dBenefitAmtConfirmed = aEgDataHandler.getEligDetailLastAuth()
					.getEdEligibilityCargo()[0].getBenefitAmt();
			EdEligibilityCargo aEdEligibilityCargo = aEgDataHandler
					.getEligDetailUnAuthCurrEDM().getEdEligibilityCargo()[0];
			if (dBenefitAmtUnConfirmed < dBenefitAmtConfirmed) {
				if (!((aEdEligibilityCargo.getTypeOfAssistanceCd()
						.equalsIgnoreCase(IEdEligCodes.TP_56)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2PM)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2SM)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2UM) || aEdEligibilityCargo
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.G2CM)) || (aEdEligibilityCargo
						.getTypeOfAssistanceCd()
						.equalsIgnoreCase(IEdEligCodes.TP_32)))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
				} else {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
				}
			} else if (dBenefitAmtUnConfirmed == dBenefitAmtConfirmed) {
				if (aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_CC)
						|| aEdEligibilityCargo.getProgramCd().equals(
								IEdEligCodes.PROGRAM_CD_MC)) {
					if (aEdEligibilityCargo.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_APPROVED)
							&& !aEdEligibilityCargo.getCgEligRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_PASS)) {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DENY);
					} else {
						aEdEligibilityCargo
								.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
					}
				} else {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
				}
			} else if (dBenefitAmtUnConfirmed > dBenefitAmtConfirmed) {
				if (!((aEdEligibilityCargo.getTypeOfAssistanceCd()
						.equalsIgnoreCase(IEdEligCodes.TP_56)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2PM)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2SM)
						|| aEdEligibilityCargo.getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.G2UM) || aEdEligibilityCargo
						.getTypeOfAssistanceCd().equalsIgnoreCase(
								IEdEligCodes.G2CM)) || (aEdEligibilityCargo
						.getTypeOfAssistanceCd()
						.equalsIgnoreCase(IEdEligCodes.TP_32)))) {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
				} else {
					aEdEligibilityCargo
							.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
				}
			}
		}
	}

	/**
	 * Method isIndvAdded.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 */
	public boolean isIndvAdded(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) {
		boolean bIndvAdded = false;
		int iLength = 0;

		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			iLength = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo().length;
		}

		int iIndvLengthCurrEDM = aEgDataHandler.getEligDetailUnAuthCurrEDM()
				.getEdIndvEligibilityCargo().length;

		if (aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0]
				.getCgStatusCd().equals(IEdEligCodes.STATUS_CD_APPROVED)) {
			if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdEligibilityCargo()[0].getCgStatusCd().equals(
					IEdEligCodes.STATUS_CD_APPROVED)) {
				for (int i = 0; i < iIndvLengthCurrEDM; i++) {
					if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
							.getEdIndvEligibilityCargo()[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {
						boolean bIndvFound = false;
						for (int j = 0; j < iLength; j++) {
							if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
									.getEdIndvEligibilityCargo()[i].getIndvId() == aEgDataHandler
									.getEligDetailLastAuth()
									.getEdIndvEligibilityCargo()[j].getIndvId()) {
								if (aEgDataHandler.getEligDetailLastAuth()
										.getEdIndvEligibilityCargo()[j]
										.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
									bIndvFound = true;
									break;
								}
							}
						}// end of inner for
						if (bIndvFound == false) {
							bIndvAdded = true;
							break;
						}
					}
				}// End of outer for
			}
		}
		return bIndvAdded;
	}

	/**
	 * Method getMeCcCoPayTpCodes.
	 *
	 * @return HashMap
	 */
	public static HashMap getMeCcCoPayTpCodes() {

		if (hmCoPayTpCodes == null) {
			//Just Populate once per instance
			hmCoPayTpCodes = new HashMap();
			String[] sCoPayTpCodes = IEdEligCodes.COPAY_TP_CODES;
			int iLength = sCoPayTpCodes.length;
			for (int i = 0; i < iLength; i++) {
				hmCoPayTpCodes.put(sCoPayTpCodes[i], sCoPayTpCodes[i]);
			}		
		}

		return hmCoPayTpCodes;
	}

	// Function added to simplify performWaiverAdjustments , refer Defect
	// #193427 on 11-2-2004
	/**
	 * Method pendWaiverAdjustments.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 * @throws EDBCException
	 */
	public boolean pendWaiverAdjustments(EligDetail aEligDetail,
			EgDataHandler aEgDataHandler) throws EDBCException {
		int iLenTemp = 0;
		boolean bFound = false;
		try {
			int iLen = aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdIndvEligibilityCargo().length;
			for (int i = 0; i < iLen; i++) {
				if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
						.getEdIndvEligibilityCargo()[i].getTargetSw() == IEdEligCodes.YES) {
					iLenTemp = aEligDetail.getEdIndvEligibilityCargo().length;
					for (int j = 0; j < iLenTemp; j++) {
						if (aEligDetail.getEdIndvEligibilityCargo()[j]
								.getIndvId() == aEgDataHandler
								.getEligDetailUnAuthCurrEDM()
								.getEdIndvEligibilityCargo()[i].getIndvId()) {
							//Added for defect 219444
							aEligDetail.getEdEligibilityCargo()[0]
									.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
							aEligDetail.getEdEligibilityCargo()[0]
									.setCgStatusCd(IEdEligCodes.STATUS_CD_PENDING);
							aEligDetail = createLtcPendingReason(aEligDetail,
									aEligDetail.getEdIndvEligibilityCargo()[j]);
							bFound = true;
							break;
						}
					}
					if (bFound) {
						break;
					}
				}
			}// End of for

		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"pendWaiverAdjustments", ex);
		}
		return bFound;
	}

	/**
	 * Method providerPaymentException.
	 *
	 * @throws TIERSValidationException
	 */
	public void providerPaymentException() throws TIERSValidationException {
		ArrayList alError = new ArrayList();
		ArrayList alPlaces = new ArrayList();
		alError.add(EDGConstants.MSG_SV_CHANGED_ELIG);
		throw new TIERSValidationException(alError, alPlaces);
	}

	// Added to identify potential V records when it is pending for defect
	// 211356
	/**
	 * Method checkandsetifpotentialV, Added to identify potential V records
	 * when it is pending.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	private void checkandsetifpotentialV(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler)
			throws EDBCException {
		if (aEdEligibilityCargo.getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FS)
				|| aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_TANF)) {
			if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO) {
				if (aEdEligibilityCargo.getSupplementAdviceSw() == IEdEligCodes.NO
						&& aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_SUPPLEMENT);
					return;
				}
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO
						&& (aEdEligibilityCargo.getBenefitStatus().equals(
								IEdEligCodes.BENEFIT_STATUS_DECREASE) || aEdEligibilityCargo
								.getBenefitStatus().equals(
										IEdEligCodes.BENEFIT_STATUS_DENY))) {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					return;
				}
			}
		} else if (aEdEligibilityCargo.getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_FMA)
				|| aEdEligibilityCargo.getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_ME)) {
			if (aEdEligibilityCargo.getAdverseActionAllowedSw() == IEdEligCodes.NO) {
				if (aEdEligibilityCargo.getBenefitStatus().equals(
						IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
					if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
						aEdEligibilityCargo
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					}
				} else {
					aEdEligibilityCargo
							.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
				}
			}
		}
	}

	/**
	 * Method mapEdgesToTps, maps edg's to TpCodes.
	 *
	 * @param arrEligDetail
	 *            contains the array of EligDetail structure
	 * @return contains the HashMap of EDG numbers & corresponding TOA codes
	 */
	
	// Added for defect 219122 to map edges to tpcodes
	public HashMap mapEdgesToTps(EligDetail[] arrEligDetail) {
		HashMap hmTemp = new HashMap();
		int iLength = 0;
		if (arrEligDetail != null) {
			iLength = arrEligDetail.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (!hmTemp.containsKey(new Long(arrEligDetail[i]
					.getEdEligibilityCargo()[0].getEdgNum()))) {
				hmTemp.put(new Long(arrEligDetail[i].getEdEligibilityCargo()[0]
						.getEdgNum()),
						arrEligDetail[i].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd());
			}
		}
		return hmTemp;
	}

	/**
	 * Method performForfeitAdjustments, performs forfeit adjustments for
	 * current EDM.
	 *
	 * @param eligDetailCurrEDM
	 *            EligDetail
	 */
	private void performForfeitAdjustments(EligDetail eligDetailCurrEDM) {
		//CCB:129329: Scenario-2
		if ((eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgStatusCd()
				.equals(IEdEligCodes.STATUS_CD_PENDING))
				&& (eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getVerificationStatusCd()
						.equals(IEdEligCodes.STATUS_CD_PENDING))) {
			//Column ForfeitMthDt deleted
			//(eligDetailCurrEDM.getEdEligibilityCargo()[0].getForfeitMthDt()!=
			// null)){
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgEligRsltCd(IEdEligCodes.PASS);
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APP_FF_MTH_PENDING);
		}
	}

	/**
	 * Method checkForPFPProcessing, chechs if there is any need PFP copy
	 * processing
	 *
	 * @param eligDetailOut
	 *            EligDetail
	 * @param edh
	 *            EgDataHandler
	 * @param hEdgDetails
	 *            HashMap
	 * @param alarrEdIndvPenToBeImposedCargo
	 *            ArrayList
	 * @return boolean
	 */
	private boolean checkForPFPProcessing(EligDetail eligDetailOut,
			EgDataHandler edh, HashMap hEdgDetails,
			ArrayList alarrEdIndvPenToBeImposedCargo) {
		boolean bResult = false;
		//Commented due to Find Bugs Analysis
		//EdIndvPenToBeImposedCargo edIndvPenToBeImposedCargo = null;
		try {
			//Added FS to if condition for Defect # 227184 on 6/23/2005
			if (((eligDetailOut.getEdEligibilityCargo()[0]
					.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01))
					|| (eligDetailOut.getEdEligibilityCargo()[0]
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_61)) || (eligDetailOut
					.getEdEligibilityCargo()[0].getProgramCd()
					.equals(IEdEligCodes.PROGRAM_CD_FS)))
					&& (eligDetailOut.getEdEligibilityCargo()[0]
							.getPaymentBegDt().equals((Timestamp) hEdgDetails
							.get(new Long(
									eligDetailOut.getEdEligibilityCargo()[0]
											.getEdgNum()))))) {
				if ((edh.getEligDetailOpenAuth() != null)
						&& (edh.getEligDetailOpenAuth().getEdEligibilityCargo()[0]
								.getPaymentEndDt() == null)
						&& (edh.getEligDetailOpenAuth().getEdEligibilityCargo()[0]
								.getCgStatusCd()
								.equals(IEdEligCodes.STATUS_CD_TERMINATED))) {
					if (DateComparisons.getStringMMYYYY(
							eligDetailOut.getEdEligibilityCargo()[0]
									.getPaymentBegDt()).equals(
							DateComparisons.getStringMMYYYY(edh
									.getEligDetailOpenAuth()
									.getEdEligibilityCargo()[0]
									.getEligibilityEndDt()))) {
						int length = 0;
						if (eligDetailOut.getEdIndvPenToBeImposedCargo() != null) {
							length = eligDetailOut
									.getEdIndvPenToBeImposedCargo().length;
							for (int i = 0; i < length; i++) {
								if (eligDetailOut
										.getEdIndvPenToBeImposedCargo()[i]
										.getEdgTraceId() == eligDetailOut
										.getEdEligibilityCargo()[0]
										.getEdgTraceId()) {
									//if (alarrEdIndvPenToBeImposedCargo ==
									// null){
									//	alarrEdIndvPenToBeImposedCargo = new
									// ArrayList();
									//}
									//Commented due to FindBugs Analysis
									//edIndvPenToBeImposedCargo = new
									// EdIndvPenToBeImposedCargo();
									//edIndvPenToBeImposedCargo =
									// eligDetailOut.getEdIndvPenToBeImposedCargo()[i];
									//alarrEdIndvPenToBeImposedCargo.add(edIndvPenToBeImposedCargo);
									alarrEdIndvPenToBeImposedCargo
											.add(eligDetailOut
													.getEdIndvPenToBeImposedCargo()[i]);
									bResult = true;
								}
							}
						} else {
							bResult = false;
						}
					}
				}
			}

		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			//throw new EDBCException(EDBCException.MAJOR ,"EdUtil",
			// "checkForPFPProcessing", ex);
		}
		return bResult;
	}

	/**
	 * Method checkIfAlreadyPFPProcessed, checks if already PFPcopy process is
	 * done.
	 *
	 * @param eligDetailOut
	 *            EligDetail
	 * @param edh
	 *            EgDataHandler
	 * @return boolean
	 */
	private boolean checkIfAlreadyPFPProcessed(EligDetail eligDetailOut,
			EgDataHandler edh) {
		boolean bResult = false;
		try {
			Timestamp tsCurrEdmPayBegDt = eligDetailOut.getEdEligibilityCargo()[0]
					.getPaymentBegDt();
			Timestamp tsPFPCopiedEligEndDt = null;
			long lCurrEdgNum = eligDetailOut.getEdEligibilityCargo()[0]
					.getEdgNum();
			EdEligibilityCargo[] arrPFPCopiedCargo = edh
					.getEdEligibilityCargoPFPCopiedRecords();
			if (arrPFPCopiedCargo != null) {
				int iLen = arrPFPCopiedCargo.length;
				for (int i = 0; i < iLen; i++) {
					tsPFPCopiedEligEndDt = arrPFPCopiedCargo[i]
							.getEligibilityEndDt();
					if ((arrPFPCopiedCargo[i].getEdgNum() == lCurrEdgNum)
							&& (arrPFPCopiedCargo[i].getPaymentEndDt() == null)
							&& (arrPFPCopiedCargo[i].getCgStatusCd()
									.equals(IEdEligCodes.STATUS_CD_TERMINATED))
							&& (tsPFPCopiedEligEndDt != null)
							&& (DateComparisons
									.getStringMMYYYY(tsPFPCopiedEligEndDt)
									.equals(DateComparisons
											.getStringMMYYYY(tsCurrEdmPayBegDt)))) {
						bResult = true;
						break;
					}
				}
			}

		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			//throw new EDBCException(EDBCException.MAJOR ,"EdUtil",
			// "checkIfAlreadyPFPProcessed", ex);
		}
		return bResult;

	}

	/**
	 * Method isIndvEIDSwChanged, checks whether the Eid Sw is changed at
	 * Individual level w.r.t to auth segment.
	 *
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @return boolean
	 */
	public boolean isIndvEIDSwChanged(EgDataHandler aEgDataHandler) {
		boolean bEIDSwChanged = false;
		int iLength = 0;

		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			iLength = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo().length;
		}
		char authEIDSw = 0;
		long authIndvId = 0;
		int iIndvLengthCurrEDM = 0;

		for (int i = 0; i < iLength; i++) {

			authIndvId = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo()[i].getIndvId();
			authEIDSw = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo()[i].getEidEligSw();

			iIndvLengthCurrEDM = aEgDataHandler.getEligDetailUnAuthCurrEDM()
					.getEdIndvEligibilityCargo().length;
			for (int j = 0; j < iIndvLengthCurrEDM; j++) {
				if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
						.getEdIndvEligibilityCargo()[j].getIndvId() == authIndvId) {
					if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
							.getEdIndvEligibilityCargo()[j].getEidEligSw() != authEIDSw) {
						bEIDSwChanged = true;
						break;
					}
				}
			}// end of inner for

			if (bEIDSwChanged == true) {
				break;
			}
		}// End of outer for

		return bEIDSwChanged;
	}

	/**
	 * Determines the resetFSExpSw.
	 *
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aEgDataHandler
	 *            EgDataHandler
	 * @throws EDBCException
	 */
	void resetFSExpSw(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) throws EDBCException {
		EdEligibilityCargo edEligibilityCargoLastAuth = null;
		boolean bPendForSameReason = false;
		EdVerificationChecklistCargo[] prevVCLExp = aEgDataHandler
				.getVCLCargoForFSExp();
		if (prevVCLExp == null) {
			return;
		}
		if (aEgDataHandler.getEligDetailLastAuth() != null) {
			edEligibilityCargoLastAuth = aEgDataHandler.getEligDetailLastAuth()
					.getEdEligibilityCargo()[0];
		}
		if ((aEdEligibilityCargo.getFsExpeditedSw() == IEdEligCodes.YES)
				&& (aEdEligibilityCargo.getActivityType()
						.equals(IEdEligCodes.ACTIVITY_TYPE_INTAKE))
				&& (aEdEligibilityCargo.getVerificationStatusCd()
						.equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING))) {
			if ((edEligibilityCargoLastAuth != null)
					&& (edEligibilityCargoLastAuth.getCgStatusCd().equals(
							IEdEligCodes.STATUS_CD_TERMINATED) && (edEligibilityCargoLastAuth
							.getVerificationStatusCd()
							.equals(IEdEligCodes.VERIFICATION_STATUS_CD_FAIL)))) {
				//Identify the Eligibility End Date
				Timestamp tsLAEligEndDt = edEligibilityCargoLastAuth
						.getEligibilityEndDt();
				//Find Last Authorized FS record for the month of the above
				// found EligEnd date
				int nLen = aEgDataHandler.getEligDetailAllAuth()
						.getEdEligibilityCargo().length;
				if (nLen > 0) {
					EdEligibilityCargo[] edEligibilityAllAuth = aEgDataHandler
							.getEligDetailAllAuth().getEdEligibilityCargo();
					for (int i = 0; i < nLen; i++) {
						if ((edEligibilityAllAuth[i].getProgramCd()
								.equals(IEdEligCodes.PROGRAM_CD_FS))
								&& (DateComparisons
										.getStringMMYYYY(edEligibilityAllAuth[i]
												.getRecBeginDt())
										.equals(DateComparisons
												.getStringMMYYYY(tsLAEligEndDt)))) {
							//	if (((edEligibilityAllAuth[i].getFsExpeditedSw()
							// == IEdEligCodes.YES) ||
							//     (edEligibilityAllAuth[i].getCombinedPaymentSw()
							// == IEdEligCodes.YES)) &&
							if (((edEligibilityAllAuth[i].getFsExpeditedSw() == IEdEligCodes.YES) || (edEligibilityAllAuth[i]
									.getCombinedPaymentSw() == IEdEligCodes.YES))
									&& (aEdEligibilityCargo
											.getVerificationStatusCd()
											.equals(IEdEligCodes.VERIFICATION_STATUS_CD_PENDING))) {

								//Yes we finaly found it...
								//Now see whether the pending reason are same
								// then and now ....
								bPendForSameReason = isPendReasonSame(
										aEdEligibilityCargo, prevVCLExp,
										aEgDataHandler);

								//Reset the FS Exp Sw for Curr EDM
								if (bPendForSameReason == true) {
									aEdEligibilityCargo.setFsExpeditedSw(IEdEligCodes.NO);
									//Begin BRGUS00049924 – kesavanr – Set CgEligRsltCd to Pending if FsExpeditedSw is reset to 'N'
									aEdEligibilityCargo.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
								}//if

								break;
							}//if
						}//if
					}//for
				}//if
			}//if
		}//if
	}

	/**
	 * Determines whether the pend reason is same in previous and Curr VCL
	 * record.
	 *
	 * @param aEdEligibilityCargo
	 *            contains current EdEligibilityCargo
	 * @param prevVCLExp
	 *            contains array of EdVerificationChecklistCargos
	 * @param aEgDataHandler
	 *            contains the EgDataHandler
	 * @return contains the boolean variable to check same pending reasons
	 */

	public boolean isPendReasonSame(EdEligibilityCargo aEdEligibilityCargo,
			EdVerificationChecklistCargo[] prevVCLExp,
			EgDataHandler aEgDataHandler) {
		boolean bPendForSameReason = false;
		EdVerificationChecklistCargo currVCL = null;
		if (aEgDataHandler.getAlEdVerificationChecklistModApp() != null) {
			Iterator itAlVCL = aEgDataHandler
					.getAlEdVerificationChecklistModApp().iterator();
			EdVerificationChecklistCargo cargo = null;
			int j = 0;
			int jLen = 0;
			while (itAlVCL.hasNext()) {
				currVCL = (EdVerificationChecklistCargo) itAlVCL.next();
				//Identify valid VCL records for current EDG based on Edg# and
				// Program Cd
				if ((aEdEligibilityCargo.getEdgNum() == currVCL.getEdgNum())
						&& (currVCL.getVoidSw() != IEdEligCodes.YES && currVCL
								.getVoidSw() != 'P')) {
					jLen = prevVCLExp.length;
					for (j = 0; j < jLen; j++) {
						if ((prevVCLExp[j].getEdgNum() == currVCL.getEdgNum())
								&& (prevVCLExp[j].getVclTypeCd().equals(currVCL
										.getVclTypeCd()))
								&& (prevVCLExp[j].getIndvId() == currVCL
										.getIndvId())
								&& (prevVCLExp[j].getValidSourceRcvDt() == null)
								&& (prevVCLExp[j].getVclRequestDt() != null)) {
							bPendForSameReason = true;
							break;//Inner break
						}
					}//End of for
					if (bPendForSameReason == true) {
						break;//Outer break
					}
				}
			}//End of while

		}
		return bPendForSameReason;
	}

	/*
	 * Begin BRGUS00103967 – kesavanr Change in hearing override logic to update
	 * overriden cargos together instead updating separetly.
	 */
	/**
	 * Determining hearing override for an edg and calling disposition to mark
	 * as overriden.
	 *
	 * @param EgDataHandler
	 *            egDataHandler
	 * @param long
	 *            aLCaseNum
	 * @param Connection
	 *            conn
	 * @param Map
	 *            aMapRequest
	 * @param String
	 *            aSUserId
	 * @throws ApplicationException,FrameworkException
	 */
	private void detHearingOverrides(EgDataHandler egDataHandler,
			long aLCaseNum, Connection conn, Map aMapRequest, String aSUserId)
			throws ApplicationException, FrameworkException {

		try {
			// EDOverrides_FsEligibility parameter is checked here in order to
			// avoid the determination of hearing overrides again.
			// if added for defect # BRGUS00056336
			if (aMapRequest.get("EDOverrides_FsEligibility") != null
					&& aMapRequest.get("EDOverrides_FsEligibility").equals("Y")) {
				return;
			}
			// beniwala - ASPEN00015918 - fix findbugs issue
			if(egDataHandler != null) {
				//BEGIN-BRGUS00148880-upadhyayulag-Loading the hearing details can be
				//commented later since it is being loaded early in "performEDBCNRFV"
				egDataHandler.loadHearingOverrides(aLCaseNum, conn);
				//END-BRGUS00148880
				HeRestoreBenefitsCargo[] heRestoreBenefitsCargo = egDataHandler
						.getPendingHearingOverrides();
				HashMap overrideData = new HashMap();
				boolean bHearingOverride = false;
				boolean ignoreHearingOverride = false;
				EligDetail eligDetailAuth = egDataHandler.getEligDetail()[1];
				EligDetail eligDetailAuthCancel = egDataHandler.getEligDetail()[2];
				EdEligibilityCargo[] edEligibilityCargoAuth = eligDetailAuth
						.getEdEligibilityCargo();
				int iLengthAuth = 0;
				if (edEligibilityCargoAuth != null) {
					iLengthAuth = edEligibilityCargoAuth.length;
				}

				if (heRestoreBenefitsCargo != null) {
					/* Begin BRGUS00104696 – kesavanr
					 * Code changes to determine hearing override for the protested month
					 * and months after the protested month.
					 */
					EligDetail unAuthProcessedEligDetail = 
						egDataHandler.retrieveUnAuthProcessedEligDetail(aLCaseNum, conn);
					EdEligibilityCargo[] edEligibilityCargo = unAuthProcessedEligDetail
							.getEdEligibilityCargo();
					EdIndvEligibilityCargo[] arrEdIndvEligibilityCargo = 
						unAuthProcessedEligDetail.getEdIndvEligibilityCargo();
					
					//BEGIN-BRGUS00193485-upadhyayulag-Retrieve the notice reasons
					EdEligNoticeReasonsCargo[] edEligNoticeReasonsCargo = unAuthProcessedEligDetail
					.getEdEligNoticeReasonsCargo();
					//END-BRGUS00193485
					EdEligibilityCargo edEligibilityOrg = null;
					EdEligibilityCargo edEligibilityUpdated = null;
					ArrayList edEligibilityOrgList = new ArrayList();
					ArrayList edEligibilityUpdList = new ArrayList();
					ArrayList indvOverridenList = new ArrayList();
					HashMap overrideReasonTextArea = new HashMap();
					//BRGUS00110964 – kesavanr – Variable to store the overriden amount.
					double overridenAmount = 0;
					//BEGIN-BRGUS00191867-upadhyayulag-If client notice sent date is before conversion, Take 
					//the conversion loaded ongoing record to restore benefits. Also, reinitialize hearing switch
					Map eligDetailAuthAppProtestedMonthMap = new HashMap();  
					for (int i = 0; i < heRestoreBenefitsCargo.length; i++) {

						/* Begin BRGUS00110964 – kesavanr
						 * Consider CaseDataChgOvrdBenAmt as overriden amount if it is greater than 0 otherwise
						 * benefit amount will be the overriden amount.
						 */
						EligDetail eligDetailAuthAppProtestedMonth =
						getEligDetailAuthAppProtestedmonth(egDataHandler.getEligDetail()[1],
								                              heRestoreBenefitsCargo[i],egDataHandler,
															  eligDetailAuthCancel);
						ignoreHearingOverride = false;
						Timestamp noticeDate = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
						if(heRestoreBenefitsCargo[i].getNoticeDt() != null){
							noticeDate = heRestoreBenefitsCargo[i].getNoticeDt();
						}
						boolean isNoticeDtBeforeConversion = false;
						Timestamp conversionDate = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
						if(egDataHandler != null 
								&& egDataHandler.getDcCasesCargo() != null 
								&& egDataHandler.getDcCasesCargo()[0].getConversionDt() != null){
							conversionDate = egDataHandler.getDcCasesCargo()[0].getConversionDt();
						}
						if(DateComparisons.dateLTDateInTimestamp(noticeDate,conversionDate)){
							isNoticeDtBeforeConversion = true;
						}
						if(eligDetailAuthAppProtestedMonth != null){
							eligDetailAuthAppProtestedMonthMap.put
							(new Long(heRestoreBenefitsCargo[i].getEdgNum()),eligDetailAuthAppProtestedMonth);
						}
						//END-BRGUS00191867
						for (int j = 0; j < edEligibilityCargo.length; j++) {
							if (heRestoreBenefitsCargo[i].getCaseNum() == edEligibilityCargo[j]
									.getCaseNum()
									&& heRestoreBenefitsCargo[i].getEdgNum() == edEligibilityCargo[j]
											.getEdgNum()) {

								String paymentBeginDtMMYYYY = "" + DateComparisons.getMM(edEligibilityCargo[j].getPaymentBegDt()) + DateComparisons.getYYYY(edEligibilityCargo[j].getPaymentBegDt());
						   	    String protestedDtMMYYYY = "" + DateComparisons.getMM(heRestoreBenefitsCargo[i].getProtestedMonthDt()) + DateComparisons.getYYYY(heRestoreBenefitsCargo[i].getProtestedMonthDt());
								if(DateComparisons.dateGTDateInTimestamp(edEligibilityCargo[j].getPaymentBegDt(),
															heRestoreBenefitsCargo[i].getProtestedMonthDt()) ||
								        paymentBeginDtMMYYYY.equalsIgnoreCase(protestedDtMMYYYY)) {
										overridenAmount = 0;
										if(isNoticeDtBeforeConversion){
											if(eligDetailAuthAppProtestedMonth != null 
													&& eligDetailAuthAppProtestedMonth.getEdEligibilityCargo() != null){
												overridenAmount = 
													eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].
													getBenefitAmt();
											}else{
												if(heRestoreBenefitsCargo[i].getCaseDataChgOvrdBenAmt() > 0 ) {
													overridenAmount = 
														heRestoreBenefitsCargo[i].getCaseDataChgOvrdBenAmt();
												}
												else {
													overridenAmount = heRestoreBenefitsCargo[i].getBenefitAmt();
												}
											}
										}else{
											if(heRestoreBenefitsCargo[i].getCaseDataChgOvrdBenAmt() > 0 ) {
												overridenAmount = heRestoreBenefitsCargo[i].getCaseDataChgOvrdBenAmt();
											}
											else {
												overridenAmount = heRestoreBenefitsCargo[i].getBenefitAmt();
											}
										}
										//End BRGUS00110964
										//BEGIN-BRGUS00193485-upadhyayulag-If FAP is terminated & notice reason 
										//EL0045 (Certification Period Ended) is set, then ignore hearing
										if(edEligibilityCargo[j].getActivityType().equals(
												IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)){
											if((edEligibilityCargo[j].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_FS) 
													|| (edEligibilityCargo[j].getProgramCd().equals(
															IEdEligCodes.PROGRAM_CD_TANF) 
															&& edEligibilityCargo[j].getEfipEligSw() == 'Y'))
													&& edEligibilityCargo[j].getCgStatusCd().equals(
															IEdEligCodes.STATUS_CD_TERMINATED)){
												if(edEligNoticeReasonsCargo != null 
														&& edEligNoticeReasonsCargo.length > 0){
													for (int k = 0; k < edEligNoticeReasonsCargo.length; k++) {
														if(edEligibilityCargo[j].getEdgTraceId() == 
															edEligNoticeReasonsCargo[k].getEdgTraceId()){
															if(edEligNoticeReasonsCargo[k].
																	getFailureReasonCode() != null 
																	&& edEligNoticeReasonsCargo[k].
																	getFailureReasonCode().indexOf("EL0045") != -1){
																ignoreHearingOverride = true;
															}
															break;
														}
													}
												}
											}
										}
										//END-BRGUS00193485
										//BEGIN-BRGUS00222361-upadhyayulag-Ignore hearing for FAP for the
										//payment begin months later than estimated eligibility end date
										if(edEligibilityCargo[j].getProgramCd().equals(
												IEdEligCodes.PROGRAM_CD_FS)){
											if(edEligibilityCargo[j].getEstimatedEligEndDt() != null 
													&& (DateComparisons.dateGTDateInTimestamp(
															edEligibilityCargo[j].getPaymentBegDt(),
															edEligibilityCargo[j].getEstimatedEligEndDt()))){
												ignoreHearingOverride = true;
											}
										}
										//END-BRGUS00222361
										//To avoid running hearing override after ReBuild
										// EDG
										if (edEligibilityCargo[j].getHearingOverrideSw() == 'Y') {
											ignoreHearingOverride = true;
										}
										if(eligDetailAuthAppProtestedMonth == null){
											ignoreHearingOverride = true;
										}
										for (int k = 0; k < iLengthAuth; k++) {
											if (edEligibilityCargo[j].getEdgNum() == edEligibilityCargoAuth[k]
													.getEdgNum()
													&& DateComparisons
															.getStringMMYYYY(
																	edEligibilityCargo[j]
																			.getPaymentBegDt())
															.equalsIgnoreCase(
																	DateComparisons
																			.getStringMMYYYY(edEligibilityCargoAuth[k]
																					.getPaymentBegDt()))) {
												if (edEligibilityCargoAuth[k]
														.getHearingOverrideSw() == 'Y'
			                                            //BRGUS00104696 – kesavanr – Ignore hearing override if EdgOverrideSw is 'Y'.
														|| edEligibilityCargoAuth[k]
																.getEdgOverrideSw() == 'Y') {
													//BRGUS00110964 – kesavanr – Change in variable name.
													if (edEligibilityCargo[j]
															.getBenefitAmt() > overridenAmount) {
														ignoreHearingOverride = true;
													}
												}
											}
										}
										if (!ignoreHearingOverride) {
											edEligibilityOrg = edEligibilityCargo[j];
											edEligibilityUpdated = (EdEligibilityCargo) edEligibilityOrg
													.clone();
											//If the group was denied prior to hearing
											// override, change the group status to
											//approved after the hearing override
											/*if (edEligibilityOrg.getCgStatusCd().equals("DN") ||
												edEligibilityOrg.getCgStatusCd().equals("TN") ||
												edEligibilityOrg.getCgStatusCd().equals("PE")) {*/
												//egDataHandler.detEligDetailLastAuth(egDataHandler
													//	.getEligDetail()[1], edEligibilityOrg);
												/* Begin BRGUS00104696 – kesavanr
												 * Setting eligibility results to Pass and status to Approved.
												 */
											//ID : BRGUS00117357 -- KesireddyV -- set the Benefit status based on the following conditions
											egDataHandler.detEligDetailLastAuth(egDataHandler
													.getEligDetail()[1], edEligibilityOrg);
											EligDetail eligDetailLastAuth = egDataHandler.getEligDetailLastAuth();
											//BEGIN-BRGUS00137513-upadhyayulag-Do null check for eligDetailLastAuth
											double eligDetailLastAuthBenefitAmt = 0;
											if(eligDetailLastAuth != null){
												eligDetailLastAuthBenefitAmt = eligDetailLastAuth.getEdEligibilityCargo()[0].getBenefitAmt();
											}
											if(overridenAmount > eligDetailLastAuthBenefitAmt){
												edEligibilityUpdated.setBenefitStatus("IN");
											}else if(overridenAmount < eligDetailLastAuthBenefitAmt){
												edEligibilityUpdated.setBenefitStatus("DE");
											}else if(overridenAmount == eligDetailLastAuthBenefitAmt){
												edEligibilityUpdated.setBenefitStatus("SU");
											}
											/*
											if(overridenAmount >
													eligDetailLastAuth.getEdEligibilityCargo()[0].getBenefitAmt())
											{
												edEligibilityUpdated.setBenefitStatus("IN");
											}
											else if(overridenAmount <
													eligDetailLastAuth.getEdEligibilityCargo()[0].getBenefitAmt())
											{
												edEligibilityUpdated.setBenefitStatus("DE");
											}
											else if(overridenAmount ==
												eligDetailLastAuth.getEdEligibilityCargo()[0].getBenefitAmt())

											{
												edEligibilityUpdated.setBenefitStatus("SU");
											}
											*/
											//END-BRGUS00137513
												edEligibilityUpdated.setNfEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												edEligibilityUpdated.setFinEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												edEligibilityUpdated.setRscEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												edEligibilityUpdated.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												edEligibilityUpdated.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
												edEligibilityUpdated.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
												edEligibilityUpdated.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
												edEligibilityUpdated.setEdgReprocessSw('N');
												// ID : BRGUS00112453 --- KesireddyV --- run eligibility looping Issue.
												if(((Boolean)aMapRequest.get(IEdEligCodes.REQUEST_EDG_REPROCESS_SW)).booleanValue()==true)
												aMapRequest.put(IEdEligCodes.REQUEST_EDG_REPROCESS_SW, Boolean
														.valueOf(false));
												/* Begin BRGUS00110964 – kesavanr
												 * Setting EstimatedEligEndDt,CertBegDt,CertEndDt and MidCertEndDt in the overriden cargo
												 * from the last authorized approved cargo
												 */
												if(eligDetailAuthAppProtestedMonth != null && eligDetailAuthAppProtestedMonth.getEdEligibilityCargo() != null &&
														eligDetailAuthAppProtestedMonth.getEdEligibilityCargo().length > 0) {
													edEligibilityUpdated.setCgSize(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getCgSize());
													edEligibilityUpdated.setEdgSize(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEdgSize());
													edEligibilityUpdated.setEligibilityBegDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEligibilityBegDt());
													edEligibilityUpdated.setEligibilityEndDt(null);
													//BEGIN-BRGUS00137513-upadhyayulag-If the activity type is "PR", carry forward the EDBC calculated values
													//for estimated eligibility end date, certification begin date, certification end date & mid certification end date
													if(!edEligibilityUpdated.getActivityType().equals(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW)){
														/* Begin BRGUS00155568 BRGUS00161192 –hps
														 * Setting EstimatedEligEndDt to the protested month value if it
														 * greater than the updated estimated eligibility value
														 */
														if (edEligibilityUpdated !=null && edEligibilityUpdated.getCertEndDt() != null &&
															eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getCertEndDt() != null){
																	if(DateComparisons.dateEqualsDateInTimestamp(edEligibilityUpdated.getCertEndDt(),
																			eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getCertEndDt())){
																		if(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEstimatedEligEndDt() != null &&
																				edEligibilityUpdated.getEstimatedEligEndDt() != null &&
																				DateComparisons.dateGTDateInTimestamp(
																						eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEstimatedEligEndDt(),
																						edEligibilityUpdated.getEstimatedEligEndDt())){
																			edEligibilityUpdated.setEstimatedEligEndDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEstimatedEligEndDt());
																		}
																	}
														}else{
															edEligibilityUpdated.setEstimatedEligEndDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getEstimatedEligEndDt());
														}
														//END BRGUS00155568  -hps
														edEligibilityUpdated.setCertBegDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getCertBegDt());
														edEligibilityUpdated.setCertEndDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getCertEndDt());
														edEligibilityUpdated.setMidCertEndDt(eligDetailAuthAppProtestedMonth.getEdEligibilityCargo()[0].getMidCertEndDt());
													}
													//END-BRGUS00137513
													//End BRGUS00110964
												}
												/*EligDetail eligDetailLastAuth = egDataHandler.getEligDetailLastAuth();
												if(eligDetailLastAuth != null && eligDetailLastAuth.getEdEligibilityCargo() != null &&
												   eligDetailLastAuth.getEdEligibilityCargo().length > 0 ) {
													 EdEligibilityCargo edEligibilityCargoLastAuth = eligDetailLastAuth.getEdEligibilityCargo()[0];
													 edEligibilityUpdated.setCgSize(edEligibilityCargoLastAuth.getCgSize());
													 edEligibilityUpdated.setEdgSize(edEligibilityCargoLastAuth.getEdgSize());
												}*/
											//}
	                                        //End BRGUS00104696
	                                        //BRGUS00110964 – kesavanr – Update benefit amount with the overriden amount.
											edEligibilityUpdated
													.setBenefitAmt(overridenAmount);
											edEligibilityOrgList.add(edEligibilityOrg);
											edEligibilityUpdList.add(edEligibilityUpdated);
											EdIndvEligibilityCargo[] arrEdIndvEligibilityOverriden =
												getOverridenEdIndvEligibilityCargo(arrEdIndvEligibilityCargo,edEligibilityUpdated);
											if(arrEdIndvEligibilityOverriden != null && arrEdIndvEligibilityOverriden.length >0) {
												int mLength = arrEdIndvEligibilityOverriden.length;
												for(int m=0; m<mLength; m++) {
													indvOverridenList.add(arrEdIndvEligibilityOverriden[m]);
												}
											}
											//End BRGUS00104696
											String appeal = "PENDING HEARING APPEAL";
											overrideReasonTextArea.put(String
													.valueOf(edEligibilityUpdated
															.getEdgTraceId()), appeal);
											overrideData.put(
													DIConstants.OVERRIDE_REASONS_LTC,
													overrideReasonTextArea);
											User userInfo = (User) aMapRequest
													.get(IEdEligCodes.USER_INFO);
											overrideData.put(DIConstants.USER_ID, aSUserId);
											overrideData.put(DIConstants.EMP_ID, new Long(
													userInfo.getEmpId()));
											overrideData.put(DIConstants.USER_INFO,
													userInfo);
											bHearingOverride = true;
											overrideData.put(DIConstants.HEARING_OVERRIDES,
													Boolean.valueOf(bHearingOverride));
											/**
										        * Hearing Override for Medicaid & CDC - Last Auth record data 
										        * will be copied to the Current EdIndvEligibilityCargo 
										        * Begin BrgId:BRGUS00129499
										        * UserId: SINGHALR
										        * Date: 09/08/2009 
										       */		
											//overrideData.put(IEdEligCodes.ED_ELIG_AUTH_PROTESTED_MONTH, 
													//eligDetailAuthAppProtestedMonth);
										}
										//END-BRGUS00129499
									}
							}
						}
						overrideData.put(IEdEligCodes.ED_ELIG_AUTH_PROTESTED_MONTH, 
								eligDetailAuthAppProtestedMonthMap);
					}
					//END-BRGUS00191867
					/* Begin BRGUS00104783 – kesavanr
					 * Not to call DI if overriden cargos size is 0
					 */
					if(edEligibilityOrgList != null && edEligibilityOrgList.size() > 0 &&
					   edEligibilityUpdList != null && edEligibilityUpdList.size() > 0) {
						EdEligibilityCargo[] edOrg = (EdEligibilityCargo[]) edEligibilityOrgList
								.toArray(new EdEligibilityCargo[edEligibilityOrgList
										.size()]);
						EdEligibilityCargo[] edUpd = (EdEligibilityCargo[]) edEligibilityUpdList
								.toArray(new EdEligibilityCargo[edEligibilityUpdList
										.size()]);
						//BRGUS00104696 – kesavanr – Converting indv overriden arraylist to EdIndvEligibilityCargo array.
						EdIndvEligibilityCargo[] arrIndvOverriden = (EdIndvEligibilityCargo[]) indvOverridenList
						.toArray(new EdIndvEligibilityCargo[indvOverridenList.size()]);
						overrideData.put(DIConstants.ED_ELIG_SYS_CARGO, edOrg);
						overrideData.put(DIConstants.ED_ELIG_OVERRIDDEN_CARGO, edUpd);
						//BRGUS00104696 – kesavanr – Passing overriden EdIndvEligibilityCargo to disposition.
						overrideData.put(DIConstants.ED_INDV_OVERRIDEN_CARGO,arrIndvOverriden);
						overrideData.put(DIConstants.CONNECTION, conn);
						//BEGIN-BRGUS00180485-upadhyayulag-Load the hearing records
						overrideData.put(DIConstants.HEARING_CARGOS, heRestoreBenefitsCargo);
						//END-BRGUS00180485
	// BRGUS00252915 rampurkara send additional info to BV for onlineEDBC
						
						boolean isOnlineEbdcProcess = false;
						boolean isAuthorizedRecSpecialist = false;
						if(aMapRequest.get("ONLINEBATCHREQUIRED") != null &&
								((Boolean)aMapRequest.get("ONLINEBATCHREQUIRED")).booleanValue())
						{
							isOnlineEbdcProcess = true;
						}
						if(aMapRequest.get("isAuthorizedRecSpecialist") != null &&
								((Boolean)aMapRequest.get("isAuthorizedRecSpecialist")).booleanValue())
						{
							isAuthorizedRecSpecialist = true;						
						}
						overrideData.put("isOnlineEbdcProcess",Boolean.valueOf(isOnlineEbdcProcess));
						overrideData.put("isAuthorizedRecSpecialist",Boolean.valueOf(isAuthorizedRecSpecialist));
	// end BRGUS00252915					
						
						
						IOverride iOverride = DIOverrideBO.getInstance();
						iOverride.overrideResults(overrideData);
					}
					//End BRGUS00104783

				}
			}			
		} catch (TIERSValidationException tve) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
			throw tve;
		} catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getErrorProfile());
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			throw new FrameworkException(e.getMessage());
		}
		//End BRGUS00103967
	}

	/*
	 * private void performSerCdcServices(EgDataHandler egDataHandler, long
	 * aLCaseNum, Connection conn ) throws ApplicationException,
	 * FrameworkException , SQLException{
	 *
	 * try { boolean bSerFlag = false; boolean bCdcFlag = false;
	 *
	 * EligDetail[] arrEligDetailInput = egDataHandler.getEligDetail();
	 *
	 * EdEligibilityCargo[] arrEdEligibilityCargo = null; arrEdEligibilityCargo =
	 * arrEligDetailInput[0].getEdEligibilityCargo(); int iLength = 0; iLength =
	 * arrEdEligibilityCargo.length;
	 *
	 * for(int k=0; k <iLength; k++) {
	 * if(egDataHandler.getEligDetail()[0].getEdEligibilityCargo()[k].getCurrentEligInd() !=
	 * IEdEligCodes.CURRENT_ELIG_INDICATOR_P) {
	 * if(egDataHandler.getEligDetail()[0].getEdEligibilityCargo()[k].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_SER)) {
	 * bSerFlag = true; } else
	 * if(egDataHandler.getEligDetail()[0].getEdEligibilityCargo()[k].getProgramCd().equals(IEdEligCodes.PROGRAM_CD_CDC)) {
	 * bCdcFlag = true;
	 *  } } }
	 *
	 *
	 * if(bSerFlag) { SERManager serManager = new SERManager(conn);
	 * serManager.executeSerServices(aLCaseNum); }
	 *
	 * if(bCdcFlag) { CDCManager cdcManager = new CDCManager();
	 * cdcManager.executeCdcService(aLCaseNum); } }
	 *
	 * catch (TIERSValidationException tve) { throw tve; } catch (EDBCException
	 * e) { e.printStackTrace(); throw new
	 * FrameworkException(e.getErrorProfile()); } catch (DataException e) {
	 * e.printStackTrace(); throw new FrameworkException(e.getErrorProfile()); }
	 * catch (RulesException e) { e.printStackTrace(); throw new
	 * FrameworkException(e.getMessage()); } catch (Exception e) {
	 * e.printStackTrace(); throw new FrameworkException(e.getMessage()); } }
	 */

	/**
	 * Method sortFailureReasonCode is used to sort the notice reasons
	 * @param edEligNoticeReasonsCargo EdEligNoticeReasonsCargo[]
	 * @throws EDBCException
	 */
	private void sortFailureReasonCode(
			EdEligNoticeReasonsCargo[] edEligNoticeReasonsCargo)
			throws EDBCException {

		String failureReasonCode = null;
		String rtColName = null;
		String hierarchy = null;
		Long[] hierarchyArray = null;
		ArrayList failureReasonCodeList = new ArrayList();
		ArrayList hierarchyList = new ArrayList();
		HashMap tempMap = new HashMap();

		try {

			for (int i = 0; i < edEligNoticeReasonsCargo.length; i++) {
				String failureReasonCodes = edEligNoticeReasonsCargo[i]
						.getFailureReasonCode();
				if (failureReasonCodes != null) {
					for (int j = 0; j < failureReasonCodes.length(); j++) {
						failureReasonCode = failureReasonCodes.substring(j,
								j + 6);
						failureReasonCodeList.add(failureReasonCode);
						RefTableData rtd = ReferenceTableManager
								.getValuesForCode("EDREASONCD",
										failureReasonCode, DateComparisons
												.getRunDate());
						if (rtd != null) {
							Iterator addi = rtd.refrTableAddiData.keySet()
									.iterator();
							while (addi.hasNext()) {
								rtColName = (String) addi.next();
								if (rtColName
										.equalsIgnoreCase("REASONHIERARCHY")) {
									hierarchy = (String) rtd.refrTableAddiData
											.get(rtColName);
									if (hierarchy != null) {
										hierarchyList.add(new Long(hierarchy));
										tempMap.put(failureReasonCode,
												hierarchy);
									}
								}

							}
						}
						if (tempMap.get(failureReasonCode) == null) {
							hierarchyList.add(new Long("0"));
						}
						j = j + 5;
					}
					hierarchyArray = (Long[]) hierarchyList
							.toArray(new Long[hierarchyList.size()]);
					java.util.Arrays.sort(hierarchyArray);
					int p = 0;
					StringBuffer strBuf = new StringBuffer();
					String temp = null;

					for (int k = 0; k < hierarchyArray.length; k++) {
						if (!hierarchyArray[k].equals(new Long("0"))) {
							strBuf = strBuf
									.append((String) failureReasonCodeList
											.get(hierarchyList
													.indexOf(hierarchyArray[k])));
						}
					}
					Iterator reasonIt = failureReasonCodeList.iterator();
					String reasonCode = null;
					String tempString = strBuf.toString();

					while (reasonIt.hasNext()) {
						reasonCode = (String) reasonIt.next();
						if (tempString.indexOf(reasonCode) == -1) {
							strBuf = strBuf.append(reasonCode);
						}
					}
					edEligNoticeReasonsCargo[i].setFailureReasonCode(strBuf
							.toString());
				}
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"sortFailureReasonCode", ex);
		}
	}

	/**
	 * Method detCgEligRsltCdForCdcServices is used to determine the CG_ELIG_RSLT_CD
	 * for CDC record
	 * @param eligDetailCurrEDM EligDetail
	 */
	private void detCgEligRsltCdForCdcServices(EligDetail eligDetailCurrEDM) {

		EdIndvCdcServiceAuthCargo[] edIndvCdcServiceAuthCargo = eligDetailCurrEDM
				.getEdIndvCdcServiceAuth();
		boolean bAllServiceRsltFail = false;
		boolean bEligRsltPass = false;
		int iLength = 0;
		if (edIndvCdcServiceAuthCargo != null) {
			iLength = edIndvCdcServiceAuthCargo.length;
		}

		/* Begin BRGUS00108302 – kesavanr
		 * Code commented to set all services to fail if group verification is failed.
		 */
		/*
		 * Begin BRGUS00102667 – kesavanr If verification for a service failed
		 * then set the status of the service to fail and append service failure
		 * reason codes in the service.
		 */
		/*StringBuffer serviceFailureRsnCd = new StringBuffer();
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
				.getVerificationStatusCd().equalsIgnoreCase("FL")) {
			for (int j = 0; j < iLength; j++) {
				if (eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j]
						.getServiceRsltCd().equalsIgnoreCase("PS")) {
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j]
							.setServiceRsltCd("FL");
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4012") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4012");
					}
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4003") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4003");
					}
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j]
							.setServiceFailureRsn(serviceFailureRsnCd
									.toString());
				}
			}
		}*/
		//End BRGUS00102667
		//End BRGUS00108302

		/* Begin BRGUS00108302 – kesavanr
		 * Set group eligibility status to pass if verification is pass for atleast one service.
		 * If verification is fail for one service set service result to fail for that service.
		 */
		if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL) &&
		   (eligDetailCurrEDM.getEdEligibilityCargo()[0].getNfEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS) ||
		   eligDetailCurrEDM.getEdEligibilityCargo()[0].getNfEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_NA)) &&
		   (eligDetailCurrEDM.getEdEligibilityCargo()[0].getFinEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS) ||
		   eligDetailCurrEDM.getEdEligibilityCargo()[0].getFinEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_NA)) &&
		   (eligDetailCurrEDM.getEdEligibilityCargo()[0].getRscEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS) ||
		   eligDetailCurrEDM.getEdEligibilityCargo()[0].getRscEligRsltCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_NA)) &&
		   eligDetailCurrEDM.getEdEligibilityCargo()[0].getVerificationStatusCd().equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
			for (int j = 0; j < iLength; j++) {
				if (eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getVerificationStatusCd() != null &&
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getVerificationStatusCd().equalsIgnoreCase("PS")) {
					eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
				}
				else if (eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getVerificationStatusCd() != null &&
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getVerificationStatusCd().equalsIgnoreCase("FL")) {
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setServiceRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
					//BRGUS00110298 – kesavanr – Set auth hours to zero if service result code is fail.
					eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setAuthHours(0);
				}
			}
		}
		//End BRGUS00108302

		for (int i = 0; i < iLength; i++) {
			if (edIndvCdcServiceAuthCargo[i].getServiceRsltCd() != null
					&& edIndvCdcServiceAuthCargo[i].getServiceRsltCd().equals(
							IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				bAllServiceRsltFail = true;
			} else if (edIndvCdcServiceAuthCargo[i].getServiceRsltCd() != null
					&& (edIndvCdcServiceAuthCargo[i].getServiceRsltCd().equals(
							IEdEligCodes.ELIG_RSLT_CD_PASS) || edIndvCdcServiceAuthCargo[i]
							.getServiceRsltCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
				bAllServiceRsltFail = false;
				break;
			}
		}
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgEligRsltCd().equalsIgnoreCase("PS")
				&& bAllServiceRsltFail) {
			if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo() != null) {
				EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = eligDetailCurrEDM
						.getEdEligNoticeReasonsCargo()[0];
				String failureReasonCd = edEligNoticeReasonsCargo
						.getFailureReasonCode();
				if (failureReasonCd == null) {
					failureReasonCd = "";
				}
				failureReasonCd = failureReasonCd
						+ IEdEligCodes.FAILURE_REASON_CODE_EL6017;
				eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
						.setFailureReasonCode(failureReasonCd);

			}
		}
		if (bAllServiceRsltFail) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
		}
		for (int i = 0; i < iLength; i++) {
			if (edIndvCdcServiceAuthCargo[i].getServiceRsltCd() != null
					&& edIndvCdcServiceAuthCargo[i].getServiceRsltCd().equals(
							IEdEligCodes.ELIG_RSLT_CD_PASS)) {
				bEligRsltPass = true;
				break;
			}
		}

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgEligRsltCd().equalsIgnoreCase("FL")
				&& bEligRsltPass) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
		}

		for (int j = 0; j < iLength; j++) {
			if (edIndvCdcServiceAuthCargo[j].getVerificationStatusCd() != null
					&& edIndvCdcServiceAuthCargo[j].getVerificationStatusCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
				break;
			}
		}

		/*
		 * for(int k=0; k <iLength; k++) {
		 * if(edIndvCdcServiceAuthCargo[k].getVerificationStatusCd() != null &&
		 * !edIndvCdcServiceAuthCargo[k].getVerificationStatusCd().equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
		 * if(edIndvCdcServiceAuthCargo[k].getServiceRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
		 * bEligRsltPass = true; } else { bEligRsltPass = false; break; } } else {
		 * bEligRsltPass = false; break; } }
		 */

	}

	/**
	 * Method detCgEligRsltCdForSerServices is used to determine the CG_ELIG_RSLT_CD
	 * for SER record
	 * @param eligDetailCurrEDM EligDetail
	 * @param edEligibilityPrevMonth EdEligibilityCargo
	 */
	private void detCgEligRsltCdForSerServices(EligDetail eligDetailCurrEDM,
			EdEligibilityCargo edEligibilityPrevMonth) {

		EdEligSerServiceAuthCargo[] edEligSerServiceAuthCargo = eligDetailCurrEDM
				.getEdEligSerServiceAuth();
		boolean bAllServiceRsltFail = false;
		boolean bEligRsltPass = false;
		int iLength = 0;
		if (edEligSerServiceAuthCargo != null) {
			iLength = edEligSerServiceAuthCargo.length;
		}

		/*
		 * Begin BRGUS00102667 – kesavanr If verification for a service failed
		 * then set the status of the service to fail and append service failure
		 * reason codes in the service.
		 */
		StringBuffer serviceFailureRsnCd = new StringBuffer();
		//BRGUS00113124 – kesavanr – Putting null check before checking verification status code.
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
			.getVerificationStatusCd() != null && eligDetailCurrEDM.getEdEligibilityCargo()[0]
				.getVerificationStatusCd().equalsIgnoreCase("FL")) {
			for (int j = 0; j < iLength; j++) {
				if (eligDetailCurrEDM.getEdEligSerServiceAuth()[j]
						.getServiceResultCd().equalsIgnoreCase("PS")) {
					eligDetailCurrEDM.getEdEligSerServiceAuth()[j]
							.setServiceResultCd("FL");
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4012") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4012");
					}
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4003") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4003");
					}
					eligDetailCurrEDM.getEdEligSerServiceAuth()[j]
							.setNoticeReasonCd(serviceFailureRsnCd.toString());
				}
			}
		}
		//End BRGUS00102667

		for (int i = 0; i < iLength; i++) {
			if (edEligSerServiceAuthCargo[i].getCurEligInd() != 'Q') {
				if (edEligSerServiceAuthCargo[i].getServiceResultCd() != null
						&& edEligSerServiceAuthCargo[i].getServiceResultCd()
								.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
					bAllServiceRsltFail = true;
				} else if (edEligSerServiceAuthCargo[i].getServiceResultCd() != null
						&& (edEligSerServiceAuthCargo[i].getServiceResultCd()
								.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))) {
					bAllServiceRsltFail = false;
					break;
				}
			}
		}
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgEligRsltCd().equalsIgnoreCase("PS")
				&& bAllServiceRsltFail) {
			if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo() != null) {
				EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = eligDetailCurrEDM
						.getEdEligNoticeReasonsCargo()[0];
				String failureReasonCd = edEligNoticeReasonsCargo
						.getFailureReasonCode();
				if (failureReasonCd == null) {
					failureReasonCd = "";
				}
				failureReasonCd = failureReasonCd
						+ IEdEligCodes.FAILURE_REASON_CODE_EL6017;
				eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
						.setFailureReasonCode(failureReasonCd);

			}
		}
		if (bAllServiceRsltFail) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
		}
		//BRGUS00127619 - Bhuvane - setting the service result based on verification status
    	/*for (int j = 0; j < iLength; j++) {
			if (edEligSerServiceAuthCargo[j].getVerificationStsCd() != null
					&& edEligSerServiceAuthCargo[j].getVerificationStsCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
				break;
			}
		}*/
		for (int j = 0; j < iLength; j++) {
			if (edEligSerServiceAuthCargo[j].getVerificationStsCd() != null
					&& edEligSerServiceAuthCargo[j].getVerificationStsCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				if(edEligSerServiceAuthCargo[j].getServiceResultCd()!= null &&
						!edEligSerServiceAuthCargo[j].getServiceResultCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)){
					edEligSerServiceAuthCargo[j].setServiceResultCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
				}
			}
			}
		//BRGUS00127619 - End

		//commented vide defect BRGUS00051454
		/*
		 * for(int k=0; k <iLength; k++) {
		 * if(edEligSerServiceAuthCargo[k].getVerificationStsCd() != null &&
		 * !edEligSerServiceAuthCargo[k].getVerificationStsCd().equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
		 * if(edEligSerServiceAuthCargo[k].getServiceResultCd().equals(IEdEligCodes.ELIG_RSLT_CD_PASS)) {
		 * bEligRsltPass = true; } else { bEligRsltPass = false; break; } } else {
		 * bEligRsltPass = false; break; } }
		 */
		/*
		 * if(bEligRsltPass) {
		 * eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS); }
		 */

		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null) {
			if (edEligibilityPrevMonth != null
					&& edEligibilityPrevMonth.getCgStatusCd() != null
					&& edEligibilityPrevMonth.getCgStatusCd().equalsIgnoreCase(
							"PE")) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setCgEligRsltCd("PE");
			} else {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
			}
		}

	}

	//	DSS Defect #BRGUS00066726
	/**
	 * Method detCgEligRsltCdForSerServices is used to determine the CG_ELIG_RSLT_CD
	 * for DSS record
	 * @param eligDetailCurrEDM EligDetail
	 */
	private void detCgEligRsltCdForDssServices(EligDetail eligDetailCurrEDM) {

		EdIndvDssServiceAuthCargo[] edIndvDssServiceAuthCargo = eligDetailCurrEDM
				.getEdIndvDssServiceAuthCargo();
		boolean bAllServiceRsltFail = false;
		boolean bEligRsltPass = false;
		int iLength = 0;
		if (edIndvDssServiceAuthCargo != null) {
			iLength = edIndvDssServiceAuthCargo.length;
		}

		/*
		 * Begin BRGUS00102667 – kesavanr If verification for a service failed
		 * then set the status of the service to fail and append service failure
		 * reason codes in the service.
		 */
		StringBuffer serviceFailureRsnCd = new StringBuffer();
		;
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0]
				.getVerificationStatusCd().equalsIgnoreCase("FL")) {
			for (int j = 0; j < iLength; j++) {
				if (eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j]
						.getServiceResultCd().equalsIgnoreCase("PS")) {
					eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j]
							.setServiceResultCd("FL");
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4012") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4012");
					}
					if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
							.getFailureReasonCode().indexOf("DI4003") != -1) {
						serviceFailureRsnCd = serviceFailureRsnCd
								.append("DI4003");
					}
					eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j]
							.setServiceNoticeReasonCode(serviceFailureRsnCd
									.toString());
				}
			}
		}
		//End BRGUS00102667

		for (int i = 0; i < iLength; i++) {
			if (edIndvDssServiceAuthCargo[i].getServiceResultCd() != null
					&& edIndvDssServiceAuthCargo[i].getServiceResultCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
				bAllServiceRsltFail = true;
			} else if (edIndvDssServiceAuthCargo[i].getServiceResultCd() != null
					&& (edIndvDssServiceAuthCargo[i].getServiceResultCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PASS) || edIndvDssServiceAuthCargo[i]
							.getServiceStatusCd().equals(
									IEdEligCodes.ELIG_RSLT_CD_PENDING))) {
				bAllServiceRsltFail = false;
				break;
			}
		}
		if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.getCgEligRsltCd().equalsIgnoreCase("PS")
				&& bAllServiceRsltFail) {
			if (eligDetailCurrEDM.getEdEligNoticeReasonsCargo() != null) {
				EdEligNoticeReasonsCargo edEligNoticeReasonsCargo = eligDetailCurrEDM
						.getEdEligNoticeReasonsCargo()[0];
				String failureReasonCd = edEligNoticeReasonsCargo
						.getFailureReasonCode();
				if (failureReasonCd == null) {
					failureReasonCd = "";
				}
				failureReasonCd = failureReasonCd
						+ IEdEligCodes.FAILURE_REASON_CODE_EL6017;
				eligDetailCurrEDM.getEdEligNoticeReasonsCargo()[0]
						.setFailureReasonCode(failureReasonCd);

			}
		}
		if (bAllServiceRsltFail) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_FAIL);
		}
		for (int j = 0; j < iLength; j++) {
			if (!eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgEligRsltCd()
					.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)
					&& edIndvDssServiceAuthCargo[j].getServiceResultCd() != null
					&& edIndvDssServiceAuthCargo[j].getServiceResultCd()
							.equals(IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				eligDetailCurrEDM.getEdEligibilityCargo()[0]
						.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PENDING);
				break;
			}
		}

		/*
		 * if (bEligRsltPass) { eligDetailCurrEDM.getEdEligibilityCargo()[0]
		 * .setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS); }
		 */

	}

	/** Method to build STFS records
	 * @param arrEligDetailOutput EligDetail[]
	 * @param conn Connection
	 * @return EligDetail[]
	 * @throws EDBCException
	 */
	private EligDetail[] buildSTFSRecords(EligDetail[] arrEligDetailOutput,
			Connection conn) throws EDBCException {

		int iLength = 0;
		ArrayList edEligibilityList = new ArrayList();
		ArrayList edIndvEligibilityList = new ArrayList();
		EligDetail[] eligDetailEDG = null;
		Timestamp appDt = null;
		boolean isTP71Present = false;

		try {
			if (arrEligDetailOutput != null) {
				iLength = arrEligDetailOutput.length;
			}
			for (int i = 0; i < iLength; i++) {
				EligDetail eligDetail = arrEligDetailOutput[i];
				for (int j = 0; j < eligDetail.getEdEligibilityCargo().length; j++) {
					if (eligDetail.getEdEligibilityCargo()[j]
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01)
							|| eligDetail.getEdEligibilityCargo()[j]
									.getTypeOfAssistanceCd().equals(
											IEdEligCodes.TP_71)) {

						if (eligDetail.getEdEligibilityCargo()[j]
								.getTypeOfAssistanceCd().equals(
										IEdEligCodes.TP_71)
								&& eligDetail.getEdEligibilityCargo()[j]
										.getCgStatusCd()
										.equals(IEdEligCodes.STATUS_CD_APPROVED)
								&& eligDetail.getEdEligibilityCargo()[j]
										.getStfsEligRsltCd().equals(
												IEdEligCodes.PASS)
								&& eligDetail.getEdEligibilityCargo()[j]
										.getCreatorInd() != 'C') {
							isTP71Present = true;
						}
						edEligibilityList.add(eligDetail
								.getEdEligibilityCargo()[j]);
						for (int k = 0; k < eligDetail
								.getEdIndvEligibilityCargo().length; k++) {
							if (eligDetail.getEdIndvEligibilityCargo()[k]
									.getEdgTraceId() == eligDetail
									.getEdEligibilityCargo()[j].getEdgTraceId()) {
								edIndvEligibilityList.add(eligDetail
										.getEdIndvEligibilityCargo()[k]);
							}
						}

					}
				}
			}
			IEgManager iEgManager = EgDriverFactory.getEDGDriver();

			if (isTP71Present && edEligibilityList.size() > 0
					&& edIndvEligibilityList.size() > 0) {
				eligDetailEDG = new EligDetail[1];
				// added appdt to pass STFS application date for EDG :
				// BRGUS00049886
				for (int i = 0; i < iLength; i++) {
					EligDetail eligDetail = arrEligDetailOutput[i];
					for (int j = 0; j < eligDetail.getEdEligibilityCargo().length; j++) {
						appDt = eligDetail.getEdEligibilityCargo()[j]
								.getApplicationDt();
					}
				}

				eligDetailEDG[0] = iEgManager
						.createSTFSCloneRecords(
								(EdEligibilityCargo[]) edEligibilityList
										.toArray(new EdEligibilityCargo[edEligibilityList
												.size()]),
								(EdIndvEligibilityCargo[]) edIndvEligibilityList
										.toArray(new EdIndvEligibilityCargo[edEligibilityList
												.size()]), conn, appDt);
			}
		} catch (Exception ex) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"buildSTFSRecords", ex);
		}
		return eligDetailEDG;
	}

	//	Setting potential stfs elig sw
	/** Method to set potential stfs elig sw
	 * @param arrEligDetailOutput EligDetail[]
	 */
	private void setStfsPotentialEligSw(EligDetail[] arrEligDetailOutput) {

		boolean passFailSw = false;
		boolean pendSw = false;
		for (int m = 0; m < arrEligDetailOutput.length; m++) {
			if (arrEligDetailOutput[m].getEdEligibilityCargo()[0]
					.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
					|| arrEligDetailOutput[m].getEdEligibilityCargo()[0]
							.getTypeOfAssistanceCd().equalsIgnoreCase("TP71")) {

				if (arrEligDetailOutput[m].getEdEligibilityCargo()[0]
						.getStfsEligRsltCd() != null) {
					if (arrEligDetailOutput[m].getEdEligibilityCargo()[0]
							.getStfsEligRsltCd().equalsIgnoreCase("PS")
							|| arrEligDetailOutput[m].getEdEligibilityCargo()[0]
									.getStfsEligRsltCd().equalsIgnoreCase("FL")) {
						passFailSw = true;
						break;
					} else if (arrEligDetailOutput[m].getEdEligibilityCargo()[0]
							.getStfsEligRsltCd().equalsIgnoreCase("PE")
							|| arrEligDetailOutput[m].getEdEligibilityCargo()[0]
									.getStfsPotentialEligSw() == 'Y') {
						pendSw = true;
					}
				}
			}
		}
		if (passFailSw) {
			for (int n = 0; n < arrEligDetailOutput.length; n++) {
				if (arrEligDetailOutput[n].getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
						|| arrEligDetailOutput[n].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equalsIgnoreCase(
										"TP71")) {

					arrEligDetailOutput[n].getEdEligibilityCargo()[0]
							.setStfsPotentialEligSw('N');

				}
			}
		}

		else if (pendSw) {
			for (int p = 0; p < arrEligDetailOutput.length; p++) {
				if (arrEligDetailOutput[p].getEdEligibilityCargo()[0]
						.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
						|| arrEligDetailOutput[p].getEdEligibilityCargo()[0]
								.getTypeOfAssistanceCd().equalsIgnoreCase(
										"TP71")) {

					arrEligDetailOutput[p].getEdEligibilityCargo()[0]
							.setStfsPotentialEligSw('Y');

				}
			}
		}
	}

	/**
	 * This method sets the eligibility end date if the case has only deseased
	 * individual.
	 *
	 * @param aEligDetail
	 *            EligDetail
	 * @throws EDBCException
	 */
	public void adjustEligEndDateForSingleDeseasedIndv(EligDetail aEligDetail)
			throws EDBCException {
		EligDetail eligDetailCurrEDM = aEligDetail;
		boolean bOnlyOneindv = true;
		Timestamp tsMaxDeseasedIndvEligEndDt = DateComparisons
				.getDate(IEdEligCodes.LOW_DATE);
		try {
			int iLength = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
			for (int i = 0; i < iLength; i++) {
				if ((eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
						.getEligibilityEndDt() == null)
						&& (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
								.getGroupInd() == IEdEligCodes.GROUP_IND_C)) {
					bOnlyOneindv = false;
					break;
				} else if ((eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
						.getEligibilityEndDt() != null)
						&& (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
								.getEligibilityEndDt()
								.after(tsMaxDeseasedIndvEligEndDt))) {
					if (iLength >= i + 2) {
						if (eligDetailCurrEDM.getEdIndvEligibilityCargo()[i]
								.getIndvId() != eligDetailCurrEDM
								.getEdIndvEligibilityCargo()[i + 1].getIndvId()) {
							bOnlyOneindv = false;
							break;
						} else {
							bOnlyOneindv = true;
							tsMaxDeseasedIndvEligEndDt = eligDetailCurrEDM
									.getEdIndvEligibilityCargo()[i]
									.getEligibilityEndDt();
						}

					}

				}
			}
			if (iLength == 1) {
				bOnlyOneindv = true;
				tsMaxDeseasedIndvEligEndDt = eligDetailCurrEDM
						.getEdIndvEligibilityCargo()[0].getEligibilityEndDt();
			}
			// added for defect BRGUS00053766
			else {
				bOnlyOneindv = false;
			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"adjustEligEndDateForSingleDeseasedIndv", ex);
		}
		if (bOnlyOneindv) {
			eligDetailCurrEDM.getEdEligibilityCargo()[0]
					.setEligibilityEndDt(tsMaxDeseasedIndvEligEndDt);
		}
		return;
	}

	/**
	 * This method determines whether all programs in the case are in Conversion
	 * Mode
	 *
	 * @param aEgDataHandler
	 * @return boolean
	 */
	private boolean allPgmsInCvMode(EgDataHandler aEgDataHandler) {
		DcCaseProgramCargo[] arrDcCaseProgramCargo = aEgDataHandler
				.getDcCaseProgramCargo();
		boolean caseConverted = true;
		int iDcCaseProgramLength = arrDcCaseProgramCargo.length;
		for (int j = 0; j < iDcCaseProgramLength; j++) {
			if (arrDcCaseProgramCargo[j].getCvModeSw() != 'Y') {
				return false;
			}
		}
		return caseConverted;
	}

	/**
	 * Method checkEdgTraceIds is used to check if a given edg trace id is
	 * existing in a given list of edg trace ids
	 * @param edgTraceIds[] long[]
	 * @param edgTraceId long
	 * @return boolean
	 */
	private boolean checkEdgTraceIds(long edgTraceIds[], long edgTraceId) {
		int iLength = 0;
		boolean recordExists = false;
		if (edgTraceIds != null) {
			iLength = edgTraceIds.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (edgTraceIds[i] == edgTraceId) {
				recordExists = true;
				break;
			}
		}
		return recordExists;
	}

	/**
	 * Method checkEdgTraceIdIndvIds is used to check if a given individual and
	 * edg trace id is existing in a given list of individuals & edg trace ids
	 * @param edgTraceIds[] long[]
	 * @param indvIds[] long[]
	 * @param edgTraceId long
	 * @param indvId long
	 * @return boolean
	 */
	private boolean checkEdgTraceIdIndvIds(long edgTraceIds[], long indvIds[],
			long edgTraceId, long indvId) {
		int iLength = 0;
		boolean recordExists = false;
		if (edgTraceIds != null) {
			iLength = edgTraceIds.length;
		}
		for (int i = 0; i < iLength; i++) {
			if (edgTraceIds[i] == edgTraceId && indvIds[i] == indvId) {
				recordExists = true;
				break;
			}
		}
		return recordExists;
	}

	// Method modifies the data for STFS
	/**
	 * Method modifyDataForSTFS is used to redetermine eligibility once STFS information is captured.
	 *
	 * @param caseNum long
	 * @param conn Connection
	 * @param userinfo User
	 * @param sessID String 
	 * 
	 * @throws EDBCException
	 */
	//BRGUS00106770 - Bhuvane - to get employee id form User object
	//BRGUS00144815-upadhyayulag-Modified the method signature to throw TIERSValidationException
	//GANTAC, 2/17/2010, Passing Session Id for Online bacth EDBC
	//BRGUS00220923-upadhyayulag-Pass request as variable for Online Batch Process
	public void modifyDataForSTFS(Map request, long caseNum, Connection conn, User userinfo, String sessID)
			throws EDBCException,TIERSValidationException {
		try {
			EgDataHandler egDataHandler = new EgDataHandler();
			ArrayList edEligibilityList = new ArrayList();
			ArrayList edIndvEligibilityList = new ArrayList();
			ArrayList edIndvLtcPendReasonList = new ArrayList();
			ArrayList edIndvLtcPendReasonList1 = new ArrayList();
			EligDetail eligDetail = egDataHandler.getDBRecordsForSTFS(caseNum,
					conn);
			int iLength = 0;
			int jLength = 0;
			int indvLength = 0;
			long edgTraceId = 0;
			long ltcIndvId = 0;
			long indvId = 0;
			Timestamp eligBegDate = null;
			Timestamp eligEndDate = null;
			boolean insertFlag = false;
			boolean wfRecordExists = false;
			boolean pendCd1026Exists = false;
			boolean ltcUpdate = false;
			if (eligDetail.getEdEligibilityCargo() != null) {
				iLength = eligDetail.getEdEligibilityCargo().length;
			}
			if (eligDetail.getEdIndvLtcPendingReasonCargo() != null) {
				jLength = eligDetail.getEdIndvLtcPendingReasonCargo().length;
			}
			long edgTraceIdsFip[] = new long[iLength];

			for (int i = 0; i < iLength; i++) {
				if (eligDetail.getEdEligibilityCargo()[i]
						.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
						&& eligDetail.getEdEligibilityCargo()[i].getDeleteSw() == 'N') {
					edgTraceIdsFip[i] = eligDetail.getEdEligibilityCargo()[i]
							.getEdgTraceId();
				}
			}
			if (eligDetail.getEdIndvEligibilityCargo() != null) {
				indvLength = eligDetail.getEdIndvEligibilityCargo().length;
			}
			for (int k = 0; k < indvLength; k++) {
				if (eligDetail.getEdIndvEligibilityCargo()[k] != null) {
					indvId = eligDetail.getEdIndvEligibilityCargo()[k]
							.getIndvId();
					edgTraceId = eligDetail.getEdIndvEligibilityCargo()[k]
							.getEdgTraceId();
					if (eligDetail.getEdIndvEligibilityCargo()[k].getEtRegInd() == 'M'
							&& eligDetail.getEdIndvEligibilityCargo()[k]
									.getEtActTypeCd().equalsIgnoreCase("WF")
							&& checkEdgTraceIds(edgTraceIdsFip, edgTraceId) == true) {
						for (int l = 0; l < jLength; l++) {
							if (eligDetail.getEdIndvLtcPendingReasonCargo()[l] != null
									&& eligDetail
											.getEdIndvLtcPendingReasonCargo()[l]
											.getPendingReasonCd()
											.equalsIgnoreCase("1026")
									&& indvId == eligDetail
											.getEdIndvLtcPendingReasonCargo()[l]
											.getIndvId()
									&& eligDetail.getEdIndvEligibilityCargo()[k]
											.getEdgTraceId() == eligDetail
											.getEdIndvLtcPendingReasonCargo()[l]
											.getEdgTraceId()) {
								eligDetail.getEdIndvLtcPendingReasonCargo()[l]
										.setPendingReasonCd("1027");
								edIndvLtcPendReasonList.add(eligDetail
										.getEdIndvLtcPendingReasonCargo()[l]);
								wfRecordExists = true;
								pendCd1026Exists = true;
							}
						}
						if (pendCd1026Exists == false) {
							for (int i = 0; i < iLength; i++) {
								ltcUpdate = false;
								if (eligDetail.getEdEligibilityCargo()[i]
										.getTypeOfAssistanceCd()
										.equalsIgnoreCase("TP01")
										&& eligDetail.getEdEligibilityCargo()[i]
												.getEdgTraceId() == eligDetail
												.getEdIndvEligibilityCargo()[k]
												.getEdgTraceId()
										&& eligDetail.getEdEligibilityCargo()[i]
												.getDeleteSw() == 'N') {
									eligDetail.getEdEligibilityCargo()[i]
											.setStfsPotentialEligSw('N');
									eligDetail.getEdEligibilityCargo()[i]
											.setNfEligRsltCd("PE");
									eligDetail.getEdEligibilityCargo()[i]
											.setCgEligRsltCd("PE");
									eligDetail.getEdEligibilityCargo()[i]
											.setCgStatusCd("PE");
									eligDetail.getEdEligibilityCargo()[i]
											.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_PENDING);
									eligDetail.getEdEligibilityCargo()[i]
											.setStfsEligRsltCd("NA");
									eligDetail.getEdIndvEligibilityCargo()[k]
											.setNfEligRsltCd("PE");
									eligDetail.getEdIndvEligibilityCargo()[k]
											.setEligRsltCd("PE");
									edEligibilityList.add(eligDetail
											.getEdEligibilityCargo()[i]);
									wfRecordExists = true;
									edIndvEligibilityList.add(eligDetail
											.getEdIndvEligibilityCargo()[k]);
									//Pend with 1027
									for (int l = 0; l < jLength; l++) {
										if (eligDetail
												.getEdIndvLtcPendingReasonCargo()[l] != null) {
											if (indvId == eligDetail
													.getEdIndvLtcPendingReasonCargo()[l]
													.getIndvId()
													&& edgTraceId == eligDetail
															.getEdIndvLtcPendingReasonCargo()[l]
															.getEdgTraceId()) {
												ltcUpdate = true;
											}

										}
									}
									if (ltcUpdate == false
											&& insertFlag == false) {
										EdIndvLtcPendingReasonCargo edLtcPendRsns = new EdIndvLtcPendingReasonCargo();
										edLtcPendRsns.setCaseNum(eligDetail
												.getEdEligibilityCargo()[i]
												.getCaseNum());
										edLtcPendRsns.setEdgTraceId(eligDetail
												.getEdEligibilityCargo()[i]
												.getEdgTraceId());
										edLtcPendRsns.setIndvId(indvId);
										edLtcPendRsns
												.setDeleteSw(IEdEligCodes.NO);
										edLtcPendRsns.setCreateUserId("Driver");
										edLtcPendRsns
												.setCreateDt(DateComparisons
														.getLocalesDate());
										edIndvLtcPendReasonList1
												.add(edLtcPendRsns);
										edLtcPendRsns
												.setPendingReasonCd("1027");
										insertFlag = true;
										//
										//Sending trigger ELE60 to interface.
										InTriggerTableCargo inTriggerTableCargo = new InTriggerTableCargo();
										inTriggerTableCargo
												.setCaseNum(eligDetail
														.getEdEligibilityCargo()[i]
														.getCaseNum());
										inTriggerTableCargo
												.setEdgNum(eligDetail
														.getEdEligibilityCargo()[i]
														.getEdgNum());
										inTriggerTableCargo
												.setKeySeqNum(eligDetail
														.getEdEligibilityCargo()[i]
														.getEdgTraceId());
										inTriggerTableCargo.setProgTfSw('Y');
										inTriggerTableCargo
												.setCgStatusCd(eligDetail
														.getEdEligibilityCargo()[i]
														.getCgStatusCd());
										inTriggerTableCargo
												.setPaymentBegDt(eligDetail
														.getEdEligibilityCargo()[i]
														.getPaymentBegDt());
										inTriggerTableCargo
												.setTriggerCd("ELE60");
										try {
											INTriggerBO inTriggerBO = null;
											inTriggerBO = new INTriggerBO();
											inTriggerBO
													.createTrigger(inTriggerTableCargo);

										}

										catch (Exception e) {
											e.printStackTrace();
											throw new EDBCException(
													EDBCException.MAJOR,
													"EdUtil",
													"insertInterfaceTrigger:error while inserting new interface records to the database",
													e.getMessage());
										}
									}
								}
							}

						}

					} else {
						for (int m = 0; m < jLength; m++) {
							if (eligDetail.getEdIndvLtcPendingReasonCargo()[m] != null
									&& indvId == eligDetail
											.getEdIndvLtcPendingReasonCargo()[m]
											.getIndvId()
									&& checkEdgTraceIds(
											edgTraceIdsFip,
											eligDetail
													.getEdIndvLtcPendingReasonCargo()[m]
													.getEdgTraceId()) == true
									&& edgTraceId == eligDetail
											.getEdIndvLtcPendingReasonCargo()[m]
											.getEdgTraceId()
									&& eligDetail
											.getEdIndvLtcPendingReasonCargo()[m]
											.getPendingReasonCd()
											.equalsIgnoreCase("1026")) {
								eligDetail.getEdIndvLtcPendingReasonCargo()[m]
										.setDeleteSw('Y');
								edIndvLtcPendReasonList.add(eligDetail
										.getEdIndvLtcPendingReasonCargo()[m]);
							}
						}
					}
				}
			}
			if (wfRecordExists == false) {
				//Get EligibilityBeginDate
				for (int i = 0; i < iLength; i++) {
					if (eligDetail.getEdEligibilityCargo()[i]
							.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
							&& eligDetail.getEdEligibilityCargo()[i]
									.getDeleteSw() == 'N'
							&& eligDetail.getEdEligibilityCargo()[i]
									.getCgStatusCd() != null
							&& eligDetail.getEdEligibilityCargo()[i]
									.getCgStatusCd().equalsIgnoreCase(
											IEdEligCodes.STATUS_CD_PENDING)
							&& eligDetail.getEdEligibilityCargo()[i]
									.getVerificationStatusCd()
									.equalsIgnoreCase(
											IEdEligCodes.STATUS_CD_PENDING) == false
							&& eligDetail.getEdEligibilityCargo()[i]
									.getStfsPotentialEligSw() == 'Y')

					{
						eligBegDate = eligDetail.getEdEligibilityCargo()[i]
								.getPaymentBegDt();
						break;
					}
				}
				//Make it approval for Edg level
				for (int i = 0; i < iLength; i++) {
					if (eligDetail.getEdEligibilityCargo()[i]
							.getTypeOfAssistanceCd().equalsIgnoreCase("TP01")
							&& eligDetail.getEdEligibilityCargo()[i]
									.getDeleteSw() == 'N'
							&& eligDetail.getEdEligibilityCargo()[i]
									.getCgStatusCd() != null
							&& eligDetail.getEdEligibilityCargo()[i]
									.getCgStatusCd().equalsIgnoreCase(
											IEdEligCodes.STATUS_CD_PENDING)
							&& eligDetail.getEdEligibilityCargo()[i]
									.getVerificationStatusCd()
									.equalsIgnoreCase(
											IEdEligCodes.STATUS_CD_PENDING) == false) {
						//eligDetail.getEdEligibilityCargo()[i].setStfsPotentialEligSw('N');
						eligDetail.getEdEligibilityCargo()[i]
								.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
						eligDetail.getEdEligibilityCargo()[i]
								.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						eligDetail.getEdEligibilityCargo()[i]
								.setStfsEligRsltCd("NA");
						eligDetail.getEdEligibilityCargo()[i]
								.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
						if (eligBegDate != null) {
							eligDetail.getEdEligibilityCargo()[i]
									.setEligibilityBegDt(eligBegDate);
						}
						edEligibilityList.add(eligDetail
								.getEdEligibilityCargo()[i]);
					}
				}
				//Make it approval for Indiv level
				for (int k = 0; k < indvLength; k++) {
					if (eligDetail.getEdIndvEligibilityCargo()[k] != null) {
						indvId = eligDetail.getEdIndvEligibilityCargo()[k]
								.getIndvId();
						if (eligDetail.getEdIndvEligibilityCargo()[k]
								.getEtRegInd() == 'M'
								&& eligDetail.getEdIndvEligibilityCargo()[k]
										.getEtActTypeCd()
										.equalsIgnoreCase("WF")

								//	BRGUS00102911- Mulpuriv- Modified the code
								// for Invalid String comparision
								&& "PE".equalsIgnoreCase(eligDetail.getEdIndvEligibilityCargo()[k]
										.getNfEligRsltCd()))   // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
						// End - BRGUS00102911
						{
							eligDetail.getEdIndvEligibilityCargo()[k]
									.setNfEligRsltCd("PS");
							eligDetail.getEdIndvEligibilityCargo()[k]
									.setEligRsltCd("PS");
							edEligibilityList.add(eligDetail
									.getEdEligibilityCargo()[k]);
						}
					}
				}

				if (eligDetail.getEdIndvLtcPendingReasonCargo() != null) {
					jLength = eligDetail.getEdIndvLtcPendingReasonCargo().length;
				}
				//Set DeleteSw ='Y' for all ltc pending records.
				for (int j = 0; j < jLength; j++) {
					if (eligDetail.getEdIndvLtcPendingReasonCargo()[j] != null
							&& eligDetail.getEdIndvLtcPendingReasonCargo()[j]
									.getPendingReasonCd().equalsIgnoreCase(
											"1026")) {
						eligDetail.getEdIndvLtcPendingReasonCargo()[j]
								.setDeleteSw('Y');
						edIndvLtcPendReasonList.add(eligDetail
								.getEdIndvLtcPendingReasonCargo()[j]);
					}
				}

			}
			eligDetail
					.setEdEligibilityCargo((EdEligibilityCargo[]) edEligibilityList
							.toArray(new EdEligibilityCargo[edEligibilityList
									.size()]));
			eligDetail
					.setEdIndvEligibilityCargo((EdIndvEligibilityCargo[]) edIndvEligibilityList
							.toArray(new EdIndvEligibilityCargo[edIndvEligibilityList
									.size()]));
			eligDetail
					.setEdIndvLtcPendingReasonCargo((EdIndvLtcPendingReasonCargo[]) edIndvLtcPendReasonList
							.toArray(new EdIndvLtcPendingReasonCargo[edIndvLtcPendReasonList
									.size()]));
			egDataHandler.writeSTFSRecords(caseNum, eligDetail, conn,
					insertFlag);
			eligDetail
					.setEdIndvLtcPendingReasonCargo((EdIndvLtcPendingReasonCargo[]) edIndvLtcPendReasonList1
							.toArray(new EdIndvLtcPendingReasonCargo[edIndvLtcPendReasonList1
									.size()]));
			egDataHandler.insertSTFSRecords(caseNum, eligDetail, conn,
					insertFlag);
			//Begin modified BRGUS00048581
			//BEGIN-BRGUS00220923-upadhyayulag-Check if the request is not from STFS screen
			//Replace prgsToRun with request map
			//Map prgsToRun = new HashMap();
			request.put(CASE_NUM, new Long(caseNum));
			request.put(IEdEligCodes.REQUEST_CASE_RUN_MODE,
					IEdEligCodes.CASE_RUN_MODE_ONLINE);
			request.put(TIERSConstants.PAGE, "DCSFD");
			DateComparisons.setRunDate(DateComparisons.getLocalesDate());
			//BRGUS00106770 - Bhuvane - to get employee id form User object
			//User userinfo = new User();
			request.put(IEdEligCodes.EMP_ID, new Long(userinfo.getEmpId()));
			request.put(IEdEligCodes.USER_INFO, userinfo);
			//BEGIN-BRGUS00144361-upadhyayulag-Put the user id in the map
			request.put(IEdEligCodes.SESSION_USER_ID, userinfo.getUserId());
			//END-BRGUS00144361
			/**
			 * Begin BrgId:BRGUS00210098
			 * UserId: GANTAC
			 * Date: 01/04/2010
			 * Adding ONLINE BATCH EDBC changes to process the STFS Eligbility. 
			 */
			/**
			 * Begin:BRGUS00220923
			 * UserId: GANTAC
			 * Date: 02/17/2010
			 * Comenting Online bacth EDBC changes
			 */
			/*if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.ENABLE_ONLINE_BATCH)!=null){
				prgsToRun.put(DiAttributes.ENABLE_ONLINE_BATCH,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.ENABLE_ONLINE_BATCH));
			}
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.CUT_OFF_SCORE)!=null){
				prgsToRun.put(DiAttributes.CUT_OFF_SCORE,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.CUT_OFF_SCORE));
			}
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.NO_OF_STREAMS_EXE)!=null){
				prgsToRun.put(DiAttributes.NO_OF_STREAMS_EXE,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.NO_OF_STREAMS_EXE));
			}
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.NO_OF_CASES_ALLOWED_IN_QUEUE)!=null){
				prgsToRun.put(DiAttributes.NO_OF_CASES_ALLOWED_IN_QUEUE,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.NO_OF_CASES_ALLOWED_IN_QUEUE));
			}
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.WAIT_TIME_IN_MINUTES)!=null){
				prgsToRun.put(DiAttributes.WAIT_TIME_IN_MINUTES,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.WAIT_TIME_IN_MINUTES));
			}
			if(FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.STATUS_CHECK_INTERVAL)!=null){
				prgsToRun.put(DiAttributes.STATUS_CHECK_INTERVAL,FwProperty.getInstance().getProperty(TIERSConstants.PROPERTY_FILE_NAME,DiAttributes.STATUS_CHECK_INTERVAL));
			}*/			
			//prgsToRun.put(IEdEligCodes.SESSION_ID, sessID);
			request.put(IEdEligCodes.REQUEST_MODULE_SWITCH,
					IEdEligCodes.MODULE_SWITCH_EDG);
			performEDBCNRFV(request);
			/*if(prgsToRun.get("ONLINEBATCHREQ")!= null &&
					((String) prgsToRun.get("ONLINEBATCHREQ")).equalsIgnoreCase("Y") &&
					 prgsToRun.get(DiAttributes.ENABLE_ONLINE_BATCH)!= null &&
					((String) prgsToRun.get(DiAttributes.ENABLE_ONLINE_BATCH)).equalsIgnoreCase("Y")){
				try{
				  showOnlineBatchResults(prgsToRun,conn);
				} catch (EDBCException e) {
					EDBCLogger.writeExceptionStackTrace(
							DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);			
					throw new FrameworkException(e.getErrorProfile());
				} 
				
			}else{*///END BRGUS00210098
				request.put(IEdEligCodes.REQUEST_MODULE_SWITCH,
						IEdEligCodes.MODULE_SWITCH_EDBC);
				performEDBCNRFV(request);
			// end modified BRGUS00048581
			//BRGUS00107811 -bhuvane - to rebuild edg and edbc if edg-reprocess switch is yes
			boolean edgReprocessSw1=false;
			String begDateComplete = null;
	 		String endDateComplete = null;

			DiFindByBO diFindByBO=new DiFindByBO();
			DIUtil dIUtil=new DIUtil();
			EdCommonUtil edComUtil = new EdCommonUtil();
				EdEligibilityCargo[] minMaxDatesCargo=diFindByBO.getDatesForEligSummaryPage(String.valueOf(caseNum));
			Timestamp[] paymentMinMaxDates=dIUtil.getMinMaxDatesFromEdRecords(minMaxDatesCargo,DIConstants.MODULE_SWITCH_EDBC);

			begDateComplete=dIUtil.getStringDate(paymentMinMaxDates[0]);
			endDateComplete=dIUtil.getStringDate(paymentMinMaxDates[1]);

			EdEligibilityCargo[] edCargoBig = diFindByBO.getEdEligCargo("ALL", caseNum, begDateComplete, endDateComplete,null);
			edgReprocessSw1 = edComUtil.getEDGReprocessSW(edCargoBig);
			if (edgReprocessSw1){
					edComUtil.rebuildEDGandEDBC(request,caseNum);
				}
		    //BRGUS00107811 - bhuvane - to rebuild edg if reprocess switch is yes
        //BEGIN-BRGUS00144815-upadhyayulag-Catch the TIERSValidationException & throw it
		} catch (TIERSValidationException tve) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
			throw tve;
		//END-BRGUS00144815
		}catch (Exception e) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"Error while modifying STFS data", e.getMessage());
		}

	}

	/**
	 * Method adjustEDGStatus is used to adjust the group level record's
	 * status if one of the SER services is passed.
	 *
	 * @param finDataHandler FinDataHandler
	 * @param egDataHandler EgDataHandler
	 * @param eligDetail EligDetail
	 * @param list ArrayList
	 * @param eligAllDetail EligDetail
	 * @param alShortfall ArrayList
	 * @throws EDBCException
	 */
	public void adjustEDGStatus(FinDataHandler finDataHandler,
			EgDataHandler egDataHandler, EligDetail eligDetail, ArrayList list,
			EligDetail eligAllDetail, ArrayList alShortfall)
			throws EDBCException {
		try {

			boolean recordModified = false;
			SerDataHandler serDataHandler = new SerDataHandler();
			SERManager serManager = new SERManager();
			serDataHandler.setSerServiceInfo(serDataHandler.getSerDetail(
					eligDetail.getEdEligibilityCargo()[0].getCaseNum(), null));
			serManager.executeSerServices(eligDetail.getEdEligibilityCargo()[0]
					.getCaseNum(), serDataHandler, eligDetail, finDataHandler,
					egDataHandler, list, eligAllDetail,null,null,alShortfall,null);//BrgId:BRGUS00160516 UserId: GANTAC Date: 05/08/2009 SER bacth changes
			//End BRGUS00073750
			int serServiceLen = eligDetail.getEdEligSerServiceAuth().length;
			for (int i = 0; i < serServiceLen; i++) {
				if ((eligDetail.getEdEligSerServiceAuth()[i]
						.getServiceResultCd()
						.equals(IEdEligCodes.ELIG_RSLT_CD_PASS))
						&& (eligDetail.getEdEligibilityCargo()[0]
								.getCgStatusCd()
								.equals(IEdEligCodes.STATUS_CD_DENIED))) {
					recordModified = true;
					break;
				}
			}
			if (recordModified == true) {
				updateEligibilityStatusCode(eligDetail);
			}
			// eligDetail.setEdIndvEligibilityCargo(indvCargo);
			egDataHandler.writeSERRecords(eligDetail);
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"adjustEDGStatus", ex);
		}

	}

	/**
	 * @param eligDetail
	 */
	private void updateEligibilityStatusCode(EligDetail eligDetail) {
		Timestamp eligibilityBeginDate = eligDetail.getEdEligSerServiceAuth()[0]
				.getServiceBeginDt();
		Timestamp eligibilityEndDate = eligDetail.getEdEligSerServiceAuth()[0]
				.getServiceEndDt();
		int indvLen = 0;
		eligDetail.getEdEligibilityCargo()[0]
				.setCgEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
		eligDetail.getEdEligibilityCargo()[0]
				.setVerificationStatusCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
		eligDetail.getEdEligibilityCargo()[0]
				.setCgStatusCd(IEdEligCodes.STATUS_CD_APPROVED);
		eligDetail.getEdEligibilityCargo()[0]
				.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
		eligDetail.getEdEligibilityCargo()[0]
				.setEligibilityBegDt(eligibilityBeginDate);
		eligDetail.getEdEligibilityCargo()[0]
				.setEligibilityEndDt(eligibilityEndDate);
		eligDetail.getEdEligibilityCargo()[0]
				.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_CERTIFY);
		EdIndvEligibilityCargo[] indvCargo = eligDetail
				.getEdIndvEligibilityCargo();
		if (indvCargo != null) {
			indvLen = indvCargo.length;
		}
		for (int i = 0; i < indvLen; i++) {
			if (indvCargo[i].getPartStatusCd().equalsIgnoreCase("EA")
					|| indvCargo[i].getPartStatusCd().equalsIgnoreCase("EC")) {
				indvCargo[i].setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
				indvCargo[i].setEligibilityBegDt(eligibilityBeginDate);
				indvCargo[i].setEligibilityEndDt(eligibilityEndDate);
			}
		}

	}

	//if ed_elig.cg_elig_rslt_cd = 'PS' and ed_elig.fin_rslt_cd = 'FL'
	//loop on ed_indv for CDC
	//if indv group ind = 'C' and corresponding service has failed (for the
	// same pay period) and notice reason is income failure
	//set ed_indv.indv_rslt_cd = 'FL' and group ind = 'E' and indv_notice
	// reason = the service notice reason
	//decrease cgsize and countofcgchild by
	/**
	 * Method detIndvGroupInd is used to determine group indicator
	 * @param eligDetail EligDetail
	 * @param edIndvEligibility EdIndvEligibilityCargo
	 */
	private void detIndvGroupInd(EligDetail eligDetail,
			EdIndvEligibilityCargo edIndvEligibility) {
		if (eligDetail.getEdEligibilityCargo() != null
				&& eligDetail.getEdEligibilityCargo()[0].getCgEligRsltCd()
						.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PASS)
				&& eligDetail.getEdEligibilityCargo()[0].getFinEligRsltCd()
						.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_FAIL)) {
			if (edIndvEligibility != null) {
				if (edIndvEligibility.getGroupInd() == IEdEligCodes.GROUP_IND_C) {
					EdIndvCdcServiceAuthCargo[] edindvCdcServAuth = eligDetail
							.getEdIndvCdcServiceAuth();
					if (edindvCdcServAuth != null) {
						for (int j = 0; j < edindvCdcServAuth.length; j++) {
							if ((edindvCdcServAuth[j].getChildIndvId() == edIndvEligibility
									.getIndvId())
									&& (edindvCdcServAuth[j].getServiceRsltCd()
											.equalsIgnoreCase(IEdEligCodes.FAIL))
									&& (edindvCdcServAuth[j]
											.getServiceFailureRsn()
											.equalsIgnoreCase("EL3007"))) {
								edIndvEligibility
										.setGroupInd(IEdEligCodes.GROUP_IND_E);
								edIndvEligibility.setPartStatusCd("OC");
								edIndvEligibility
										.setEligRsltCd(IEdEligCodes.FAIL);
								eligDetail.getEdEligibilityCargo()[0]
										.setCountOfCgChild(eligDetail
												.getEdEligibilityCargo()[0]
												.getCountOfCgChild() - 1);
								eligDetail.getEdEligibilityCargo()[0]
										.setCgSize(eligDetail
												.getEdEligibilityCargo()[0]
												.getCgSize() - 1);

							}
						}
					}
				}
			}
		}
	}

	/**
	 * Method detCDeligibilityBegingDate is used to calculate the eligibility begin date for CDC
	 * @param aEgDataHandler EgDataHandler
	 * @return Timestamp
	 * @throws EDBCException
	 */
	private Timestamp detCDeligibilityBegingDate(EgDataHandler aEgDataHandler)
			throws EDBCException {

		EligDetail arrEligDetail = aEgDataHandler.getEligDetail()[0];
		Timestamp earlyEligBegDt = null;
		Timestamp eligBegDt = null;
		for (int i = 0; i < arrEligDetail.getEdEligibilityCargo().length; i++) {
			if (arrEligDetail.getEdEligibilityCargo()[i].getProgramCd()
					.equalsIgnoreCase("CD")) {
				eligBegDt = arrEligDetail.getEdEligibilityCargo()[i]
						.getPaymentBegDt();
				if (earlyEligBegDt == null) {
					earlyEligBegDt = eligBegDt;
					continue;
				}
				if (DateComparisons.dateLTEQDateInTimestamp(eligBegDt,
						earlyEligBegDt)) {
					earlyEligBegDt = eligBegDt;
				}
			}
		}

		return earlyEligBegDt;
	}

	//Start added By Kesavan For defect #BRGUS00074227
	/**
	 * Method getEligDetailCdcLastAuth is used to filter the CDC last authorized records
	 * from all the authrozied records given
	 * @param eligDetailCurrEDM EligDetail
	 * @param eligDetailAllLastAuth EligDetail
	 * @return EligDetail
	 * @throws EDBCException
	 */
	private EligDetail getEligDetailCdcLastAuth(EligDetail eligDetailCurrEDM,
			EligDetail eligDetailAllLastAuth) throws EDBCException {
		int iLength = 0;
		int jLength = 0;
		EligDetail eligDetailCdcLastAuth = null;
		EdEligibilityCargo[] edEligibilityCargoCdc = new EdEligibilityCargo[1];
		ArrayList cdcAuth = new ArrayList();
		if (eligDetailAllLastAuth != null
				&& eligDetailAllLastAuth.getEdEligibilityCargo() != null) {
			iLength = eligDetailAllLastAuth.getEdEligibilityCargo().length;
		}
		//BEGIN-BRGUS00217436-upadhyayulag-FindBugs
		if (eligDetailAllLastAuth != null 
				&& eligDetailAllLastAuth.getEdIndvCdcServiceAuth() != null) {
			jLength = eligDetailAllLastAuth.getEdIndvCdcServiceAuth().length;
		}
		//END-BRGUS00217436
		for (int i = 0; i < iLength; i++) {
			if (eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgNum() == eligDetailAllLastAuth
					.getEdEligibilityCargo()[i].getEdgNum()
					&& DateComparisons.dateGTEQDateInTimestamp(
							eligDetailCurrEDM.getEdEligibilityCargo()[0]
									.getPaymentBegDt(), eligDetailAllLastAuth
									.getEdEligibilityCargo()[i]
									.getPaymentBegDt())) {

				if (eligDetailAllLastAuth.getEdEligibilityCargo()[i]
						.getPaymentEndDt() == null
						|| (eligDetailCurrEDM.getEdEligibilityCargo()[0]
								.getPaymentEndDt() != null
								&& eligDetailAllLastAuth
										.getEdEligibilityCargo()[i]
										.getPaymentEndDt() != null && DateComparisons
								.dateLTEQDateInTimestamp(eligDetailCurrEDM
										.getEdEligibilityCargo()[0]
										.getPaymentEndDt(),
										eligDetailAllLastAuth
												.getEdEligibilityCargo()[i]
												.getPaymentEndDt()))) {
					edEligibilityCargoCdc[0] = eligDetailAllLastAuth
							.getEdEligibilityCargo()[i];
					eligDetailCdcLastAuth = new EligDetail();
					eligDetailCdcLastAuth
							.setEdEligibilityCargo(edEligibilityCargoCdc);
					break;
				}

			}
		}
		for (int j = 0; j < jLength; j++) {
			if (eligDetailCdcLastAuth != null
					&& (eligDetailCdcLastAuth.getEdEligibilityCargo()[0]
							.getEdgTraceId() == eligDetailAllLastAuth
							.getEdIndvCdcServiceAuth()[j].getEdgTraceId())) {
				cdcAuth.add(eligDetailAllLastAuth.getEdIndvCdcServiceAuth()[j]);
			}
		}
		if (eligDetailCdcLastAuth != null) {
			eligDetailCdcLastAuth
					.setEdIndvCdcServiceAuth((EdIndvCdcServiceAuthCargo[]) cdcAuth
							.toArray(new EdIndvCdcServiceAuthCargo[cdcAuth
									.size()]));
		}
		/*
		 * int cdcAuthList = cdcAuth.size(); int cdcUnAuthSize = 0;
		 * EdIndvCdcServiceAuthCargo[] edIndvCdcAuth = new
		 * EdIndvCdcServiceAuthCargo[1]; EdIndvCdcServiceAuthCargo tempCdcAuth =
		 * null; if(eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null) {
		 * cdcUnAuthSize = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length; }
		 * for(int k=0; k <cdcUnAuthSize; k++) { for(int m=0; m <cdcAuthList;
		 * m++) { tempCdcAuth = (EdIndvCdcServiceAuthCargo)cdcAuth.get(m);
		 * if(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[k].getChildIndvId()
		 * ==tempCdcAuth.getChildIndvId() &&
		 * eligDetailCurrEDM.getEdIndvCdcServiceAuth()[k].getPspId() ==
		 * tempCdcAuth.getPspId() &&
		 * eligDetailCurrEDM.getEdIndvCdcServiceAuth()[k].getNeedBlock() ==
		 * tempCdcAuth.getNeedBlock()) {
		 *
		 * if(DateComparisons.dateEqualsDateInTimestamp(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[0].getPayPeriodBegDt(),
		 * tempCdcAuth.getPayPeriodBegDt()) &&
		 * (((eligDetailCurrEDM.getEdIndvCdcServiceAuth()[0].getPayPeriodEndDt() ==
		 * null && tempCdcAuth.getPayPeriodEndDt() == null) ||
		 * (eligDetailCurrEDM.getEdIndvCdcServiceAuth()[0].getPayPeriodEndDt() !=
		 * null && tempCdcAuth.getPayPeriodEndDt() != null &&
		 * DateComparisons.dateEqualsDateInTimestamp(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[0].getPayPeriodEndDt(),tempCdcAuth.getPayPeriodEndDt()))))) {
		 * if(eligDetailCdcLastAuth != null) { edIndvCdcAuth[0] = new
		 * EdIndvCdcServiceAuthCargo();
		 * eligDetailCdcLastAuth.setEdIndvCdcServiceAuth(edIndvCdcAuth); }
		 * break; } } } }
		 */

		return eligDetailCdcLastAuth;
	}

	//	End - added By Kesavan For defect #BRGUS00074227

	/*
	 * private EdEligibilityCargo[]
	 * getSERSortedEdEligibilityCargo(EdEligibilityCargo[] arrEdElibilityCargo) {
	 *
	 * ArrayList serEdList = new ArrayList(); ArrayList otherEdList = new
	 * ArrayList(); ArrayList timeStampList = new ArrayList(); Timestamp[]
	 * timeStampArr = null; HashMap tempMap = new HashMap(); int eligLength = 0;
	 * int listLength = 0; if(arrEdElibilityCargo != null) { eligLength =
	 * arrEdElibilityCargo.length; }
	 *
	 * for(int i=0; i < eligLength; i++) {
	 * if(arrEdElibilityCargo[i].getProgramCd().equalsIgnoreCase("SE")) {
	 *
	 * timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
	 * tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),arrEdElibilityCargo[i]); }
	 * else { otherEdList.add(arrEdElibilityCargo[i]); } }
	 *
	 * timeStampArr = (Timestamp[])timeStampList.toArray(new
	 * Timestamp[timeStampList.size()]);
	 *
	 * if(timeStampArr !=null){
	 *
	 * java.util.Arrays.sort(timeStampArr); for(int j=0; j <
	 * timeStampArr.length; j++) { EdEligibilityCargo edEligibilityCargo =
	 * (EdEligibilityCargo)tempMap.get(timeStampArr[j]);
	 * serEdList.add(edEligibilityCargo); } timeStampList.clear();
	 * tempMap.clear();
	 *
	 * listLength = serEdList.size(); for(int j=0; j < listLength; j++) {
	 * otherEdList.add(serEdList.get(j)); } } return (EdEligibilityCargo[])
	 * otherEdList.toArray(new EdEligibilityCargo[otherEdList.size()]);
	 *  }
	 */

	/*
	 * private EdEligibilityCargo[]
	 * getCDCSortedEdEligibilityCargo(EdEligibilityCargo[] arrEdElibilityCargo)
	 * throws EDBCException{ ArrayList finalEdList = new ArrayList(); int
	 * eligLength = 0; ArrayList timeStampList = new ArrayList(); HashMap
	 * tempMap = new HashMap();
	 *
	 * if(arrEdElibilityCargo != null) { eligLength =
	 * arrEdElibilityCargo.length; }
	 *
	 * for(int i=0; i < eligLength; i++) {
	 * if(arrEdElibilityCargo[i].getProgramCd().equalsIgnoreCase("CD")) { if(i !=
	 * (eligLength-1) &&
	 * !arrEdElibilityCargo[i+1].getProgramCd().equalsIgnoreCase("CD")) {
	 * timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
	 * tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),arrEdElibilityCargo[i]);
	 * Timestamp[] timeStampArr = (Timestamp[])timeStampList.toArray(new
	 * Timestamp[timeStampList.size()]); java.util.Arrays.sort(timeStampArr);
	 * for(int j=0; j < timeStampArr.length; j++) { EdEligibilityCargo
	 * edEligibilityCargo = (EdEligibilityCargo)tempMap.get(timeStampArr[j]);
	 * finalEdList.add(edEligibilityCargo); } timeStampList.clear();
	 * tempMap.clear(); } else if((eligLength-1) == i) {
	 * timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
	 * tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),arrEdElibilityCargo[i]);
	 * Timestamp[] timeStampArr = (Timestamp[])timeStampList.toArray(new
	 * Timestamp[timeStampList.size()]); java.util.Arrays.sort(timeStampArr);
	 * for(int j=0; j < timeStampArr.length; j++) { EdEligibilityCargo
	 * edEligibilityCargo = (EdEligibilityCargo)tempMap.get(timeStampArr[j]);
	 * finalEdList.add(edEligibilityCargo); } timeStampList.clear();
	 * tempMap.clear(); }
	 *
	 * else { timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
	 * tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),arrEdElibilityCargo[i]);
	 *  }
	 *  } else {
	 *
	 * finalEdList.add(arrEdElibilityCargo[i]); } }
	 *
	 * return (EdEligibilityCargo[]) finalEdList.toArray(new
	 * EdEligibilityCargo[finalEdList.size()]);
	 *  }
	 */

	/*
	 * Defect ID : BRGUS00082095 Added By : kesavanr Date : 02/15/2007 Change :
	 * Sorting SER edgs both by edg number and payment begin date.
	 *
	 */
	/**
	 * Method getSERSortedEdEligibilityCargo is used to filter the SER eligibility records
	 * from all the eligibility records
	 * @param arrEdElibilityCargo EdEligibilityCargo[]
	 * @return EdEligibilityCargo[]
	 */
	private EdEligibilityCargo[] getSERSortedEdEligibilityCargo(
			EdEligibilityCargo[] arrEdElibilityCargo) {

		ArrayList serEdList = new ArrayList();
		ArrayList otherEdList = new ArrayList();
		ArrayList timeStampList = new ArrayList();
		Timestamp[] timeStampArr = null;
		HashMap tempMap = new HashMap();
		int eligLength = 0;
		int listLength = 0;
		if (arrEdElibilityCargo != null) {
			eligLength = arrEdElibilityCargo.length;
		}
		long edgNum = 0;
		for (int i = 0; i < eligLength; i++) {
			if (arrEdElibilityCargo[i].getProgramCd().equalsIgnoreCase("SE")) {
				if (edgNum == 0) {
					timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
					tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),
							arrEdElibilityCargo[i]);
					edgNum = arrEdElibilityCargo[i].getEdgNum();
					continue;
				} else if (edgNum == arrEdElibilityCargo[i].getEdgNum()) {
					timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
					tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),
							arrEdElibilityCargo[i]);
					edgNum = arrEdElibilityCargo[i].getEdgNum();
					continue;
				} else if (edgNum != arrEdElibilityCargo[i].getEdgNum()) {
					timeStampArr = (Timestamp[]) timeStampList
							.toArray(new Timestamp[timeStampList.size()]);
					if (timeStampArr != null) {
						java.util.Arrays.sort(timeStampArr);
						for (int j = 0; j < timeStampArr.length; j++) {
							EdEligibilityCargo edEligibilityCargo = (EdEligibilityCargo) tempMap
									.get(timeStampArr[j]);
							serEdList.add(edEligibilityCargo);
						}
						timeStampList.clear();
						tempMap.clear();
						timeStampList.add(arrEdElibilityCargo[i]
								.getPaymentBegDt());
						tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),
								arrEdElibilityCargo[i]);
						edgNum = arrEdElibilityCargo[i].getEdgNum();
						continue;
					}
				}
			} else {
				otherEdList.add(arrEdElibilityCargo[i]);
			}
		}
		timeStampArr = (Timestamp[]) timeStampList
				.toArray(new Timestamp[timeStampList.size()]);
		if (timeStampArr != null && timeStampArr.length > 0) {
			java.util.Arrays.sort(timeStampArr);
			for (int j = 0; j < timeStampArr.length; j++) {
				EdEligibilityCargo edEligibilityCargo = (EdEligibilityCargo) tempMap
						.get(timeStampArr[j]);
				serEdList.add(edEligibilityCargo);
			}
		}

		listLength = serEdList.size();
		for (int j = 0; j < listLength; j++) {
			otherEdList.add(serEdList.get(j));
		}
		/*
		 * for(int k=0;k <otherEdList.size();k++) { EdEligibilityCargo cargo =
		 * ((EdEligibilityCargo)otherEdList.get(k));
		 * System.out.println("ProgramCd: "+cargo.getProgramCd()+" EDG Num:
		 * "+cargo.getEdgNum()+" PaymentBeginDate: "+cargo.getPaymentBegDt()); }
		 */

		return (EdEligibilityCargo[]) otherEdList
				.toArray(new EdEligibilityCargo[otherEdList.size()]);

	}

	/**
	 * Method getCDCSortedEdEligibilityCargo is used to filter the CDC eligibility records
	 * from all the eligibility records
	 * @param arrEdElibilityCargo EdEligibilityCargo[]
	 * @return EdEligibilityCargo[]
	 */
	private EdEligibilityCargo[] getCDCSortedEdEligibilityCargo(
			EdEligibilityCargo[] arrEdElibilityCargo) {

		ArrayList cdcEdList = new ArrayList();
		ArrayList otherEdList = new ArrayList();
		ArrayList timeStampList = new ArrayList();
		Timestamp[] timeStampArr = null;
		HashMap tempMap = new HashMap();
		int eligLength = 0;
		int listLength = 0;
		if (arrEdElibilityCargo != null) {
			eligLength = arrEdElibilityCargo.length;
		}

		for (int i = 0; i < eligLength; i++) {
			if (arrEdElibilityCargo[i].getProgramCd().equalsIgnoreCase("CD")) {

				timeStampList.add(arrEdElibilityCargo[i].getPaymentBegDt());
				tempMap.put(arrEdElibilityCargo[i].getPaymentBegDt(),
						arrEdElibilityCargo[i]);
			} else {
				otherEdList.add(arrEdElibilityCargo[i]);
			}
		}

		timeStampArr = (Timestamp[]) timeStampList
				.toArray(new Timestamp[timeStampList.size()]);

		if (timeStampArr != null) {

			java.util.Arrays.sort(timeStampArr);
			for (int j = 0; j < timeStampArr.length; j++) {
				EdEligibilityCargo edEligibilityCargo = (EdEligibilityCargo) tempMap
						.get(timeStampArr[j]);
				cdcEdList.add(edEligibilityCargo);
			}
			timeStampList.clear();
			tempMap.clear();

			listLength = cdcEdList.size();
			for (int j = 0; j < listLength; j++) {
				otherEdList.add(cdcEdList.get(j));
			}
		}

		return (EdEligibilityCargo[]) otherEdList
				.toArray(new EdEligibilityCargo[otherEdList.size()]);

	}

	/**
	 * This method deletes alert in the case for the specified alert number and
	 * alert category
	 *
	 * @param edelig
	 *            EdEligibilityCargo
	 * @param alertNumber
	 *            long
	 * @param pageId
	 *            String
	 * @param caseMode
	 *            String
	 * @throws EDBCException
	 * @throws FrameworkException
	 * @throws ApplicationException
	 */
	private void deleteAlert(EdEligibilityCargo edelig, long alertId,
			String pageId, String caseMode, Connection conn, String sUserId, boolean isOnlineEdbcProcess)
			throws EDBCException, FrameworkException, ApplicationException {

		try {
			HashMap alertsParam = new HashMap();
		   // IAlerts alertObject = AlAlertManager.getInstance();
		    AlAlertManager alAlertManager = new AlAlertManager(conn);
		    
			
			alertsParam.put("CASE_NUM", new Long(edelig.getCaseNum()));
			alertsParam.put("CALLING_PROG_ID", pageId);
			alertsParam.put("UPDATE_USER", sUserId);
			alertsParam.put("UPDATE_DATE", edelig.getEdbcRunDt());
			alertsParam.put("PROCESSED_DATE", edelig.getEdbcRunDt());
			alertsParam.put("APP_NUM", "0");
			alertsParam.put("ALERT_ID", new Long(alertId));
			if(isOnlineEdbcProcess){
				//BEGIN-BRGUS00217436-upadhyayulag-FindBugs				
				alertsParam.put("ONLINEBATCHREQUIRED",Boolean.valueOf(isOnlineEdbcProcess));
				//END-BRGUS00217436			
			}
			if ((caseMode != null
					&& (caseMode.equalsIgnoreCase("BATCH") || caseMode
							.equalsIgnoreCase("CV"))) || isOnlineEdbcProcess) {
				alertsParam.put("CONNECTION", conn);
			}
			//alertObject.deleteAlert(alertsParam);
			alAlertManager.deleteAlert(alertsParam);
		} catch (Exception e) {
			throw new EDBCException(EDBCException.MAJOR, "EDUtil",
					"error in deleteAlerts while deleting all alert", e);
		}
	}

	/**
	 * Added by Sairama on 11/01/2007 for Defect #BRGUS00078806 This method
	 * determines checks for individual's MaCoverageCodes , if they have changed
	 * and returns individual benefit status.
	 *
	 * @param coverageCdConfirmed
	 * @param coverageCdUnConfirmed
	 * @param aEdEligibilityCargo
	 * @return
	 * @throws EDBCException
	 */
	private String getIndvBenefitStatus(char coverageCdConfirmed,
			char coverageCdUnConfirmed, EdEligibilityCargo aEdEligibilityCargo)
			throws EDBCException {

		char authCoverageCd = IEdEligCodes.CHAR_INIT_SPACE;
		char unAuthCoverageCd = IEdEligCodes.CHAR_INIT_SPACE;
		String indvCoverageStsCd = null;

		authCoverageCd = coverageCdConfirmed;
		unAuthCoverageCd = coverageCdUnConfirmed;

		if (authCoverageCd != IEdEligCodes.CHAR_INIT_SPACE
				&& unAuthCoverageCd != IEdEligCodes.CHAR_INIT_SPACE) {

			if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
					IEdEligCodes.PROGRAM_CD_FMA)
					|| aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_ME)) {
				// From F to T or D
				if (authCoverageCd == 'F') {
					if (authCoverageCd == 'F'
							&& (unAuthCoverageCd == 'T' || unAuthCoverageCd == 'D')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				//From T to F
				if (authCoverageCd == 'T') {
					if (authCoverageCd == 'T' && unAuthCoverageCd == 'F') {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From P to F
				if (authCoverageCd == 'P') {
					if (authCoverageCd == 'P' && unAuthCoverageCd == 'F') {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From D to F
				if (authCoverageCd == 'D') {
					if (authCoverageCd == 'D' && unAuthCoverageCd == 'F') {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From K to F or D
				if (authCoverageCd == 'K') {
					if (authCoverageCd == 'K'
							&& (unAuthCoverageCd == 'F' || unAuthCoverageCd == 'D')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From 0 to any code
				if (authCoverageCd == '0') {
					if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					}
				}

				// From E to F,T,P,D,K,G or V
				if (authCoverageCd == 'E') {
					if (authCoverageCd == 'E'
							&& (unAuthCoverageCd == 'F'
									|| unAuthCoverageCd == 'T'
									|| unAuthCoverageCd == 'P'
									|| unAuthCoverageCd == 'D'
									|| unAuthCoverageCd == 'K'
									|| unAuthCoverageCd == 'G' || unAuthCoverageCd == 'V')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From U to F,T,P,D,K,E,G OR V
				if (authCoverageCd == 'U') {
					if (authCoverageCd == 'U'
							&& (unAuthCoverageCd == 'F'
									|| unAuthCoverageCd == 'T'
									|| unAuthCoverageCd == 'P'
									|| unAuthCoverageCd == 'D'
									|| unAuthCoverageCd == 'K'
									|| unAuthCoverageCd == 'E'
									|| unAuthCoverageCd == 'G' || unAuthCoverageCd == 'V')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From G to F,T,P,D or K
				if (authCoverageCd == 'G') {
					if (authCoverageCd == 'G'
							&& (unAuthCoverageCd == 'F'
									|| unAuthCoverageCd == 'T'
									|| unAuthCoverageCd == 'P'
									|| unAuthCoverageCd == 'D' || unAuthCoverageCd == 'K')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From Y to F,T,P,D,K or G
				if (authCoverageCd == 'Y') {
					if (authCoverageCd == 'Y'
							&& (unAuthCoverageCd == 'F'
									|| unAuthCoverageCd == 'T'
									|| unAuthCoverageCd == 'P'
									|| unAuthCoverageCd == 'D'
									|| unAuthCoverageCd == 'K' || unAuthCoverageCd == 'G')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From V to F,T,P,D,K,E or G
				if (authCoverageCd == 'V') {
					if (authCoverageCd == 'V'
							&& (unAuthCoverageCd == 'F'
									|| unAuthCoverageCd == 'T'
									|| unAuthCoverageCd == 'P'
									|| unAuthCoverageCd == 'D'
									|| unAuthCoverageCd == 'K'
									|| unAuthCoverageCd == 'E' || unAuthCoverageCd == 'G')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
// BRGUS00242106 rampurkara when coverage moved from B,C,F to F or E then set benefit status to increase				
				if (authCoverageCd == 'B' || authCoverageCd == 'C' || authCoverageCd == 'H') 
				{
					if (unAuthCoverageCd == 'F' || unAuthCoverageCd == 'E') 
					{
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} 
					else if (authCoverageCd == unAuthCoverageCd) 
					{
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} 
					else 
					{
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
// end BRGUS00242106				
				
				else {
				}

			}

			else if (aEdEligibilityCargo.getProgramCd().equalsIgnoreCase(
					IEdEligCodes.PROGRAM_CD_MC)) {
				// From Q to B or C
				if (authCoverageCd == 'Q') {
					if (authCoverageCd == 'Q'
							&& (unAuthCoverageCd == 'B' || unAuthCoverageCd == 'C')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				// From H to B or C
				if (authCoverageCd == 'H') {
					if (authCoverageCd == 'H'
							&& (unAuthCoverageCd == 'B' || unAuthCoverageCd == 'C')) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}
				//From C to B
				if (authCoverageCd == 'C') {
					if (authCoverageCd == 'C' && unAuthCoverageCd == 'B') {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_INCREASE;
					} else if (authCoverageCd == unAuthCoverageCd) {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					} else {
						indvCoverageStsCd = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					}
				}

			}

		}
		return indvCoverageStsCd;
	}

	/**
	 * Added by Sairama on 11/01/2007 for Defect #BRGUS00078806 This method gets
	 * the CgStatusCd for authorized and unauthorized records.
	 *
	 * @param edgTraceId
	 * @param edEligibilityAuthCargo
	 * @return
	 * @throws EDBCException
	 */
	private boolean getCgStsCd(long edgTraceId,
			EdEligibilityCargo edEligibilityCargo) throws EDBCException {
		if (edEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
				EDGConstants.APPROVED)
				|| edEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
						EDGConstants.PEND)) {
			return true;
		}
		return false;
	}

	//	ADDED FOR DEFECT # BRGUS00065911
	//START
	/**
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 */
	private boolean isDisabilityPending(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) {
		String[] noticeReason = null;
		String procProgCd = aEdEligibilityCargo.getProgramCd();
		EligDetail eligDetailCurrEdm = aEgDataHandler
				.getEligDetailUnAuthCurrEDM();
		if (eligDetailCurrEdm != null) {
			EdIndvNoticeReasonsCargo[] edIndvNoticeReasons = eligDetailCurrEdm
					.getEdIndvNoticeReasonsCargo();
			if (edIndvNoticeReasons != null) {
				if (procProgCd.equalsIgnoreCase(EDGConstants.ME)
						&& aEdEligibilityCargo.getCgStatusCd().equals(
								EDGConstants.PEND)
						&& aEdEligibilityCargo.getNfEligRsltCd().equals(
								EDGConstants.PEND)) {
					noticeReason = getFailureReasonCd1(aEdEligibilityCargo
							.getEdgTraceId(), edIndvNoticeReasons);
					if (noticeReason != null && noticeReason.length > 0 ){
						for (int i=0; i < noticeReason.length; i++) {
							if(noticeReason[i] != null){
								if(noticeReason[i].equalsIgnoreCase("EL1319"))return true;
							}
						}
					}
				}
			}
		}
		return false;
	}

	/**
	 * Method getFailureReasonCd1 is used to return an array of failure reason codes
	 * for the given edg trace id
	 * @param traceId long
	 * @param arrEdNotice EdIndvNoticeReasonsCargo[]
	 * @return String[]
	 */
	private String[]getFailureReasonCd1(long traceId,
			EdIndvNoticeReasonsCargo[] arrEdNotice) {

		String[]failureReasonCd= null;
		//BEGIN-BRGUS00215440-upadhyayulag-Use ArrayList to 
		//dynamically find the String array length
		//int j=0;
		int arrEdNoticeLength = 0;
		if (arrEdNotice != null && arrEdNotice.length > 0 ) {
			arrEdNoticeLength = arrEdNotice.length;
			//failureReasonCd = new String[arrEdNoticeLength];
			ArrayList failureReasonCdList = new ArrayList();
			for (int i = 0; i < arrEdNoticeLength; i++) {
				if (arrEdNotice[i].getEdgTraceId() == traceId) {
					if (arrEdNotice[i].getFailureReasonCode() != null) {
						//failureReasonCd[j]= arrEdNotice[i].getFailureReasonCode();
						//j++;
						failureReasonCdList.add(arrEdNotice[i].getFailureReasonCode());
					}
				}
			}
			if(failureReasonCdList != null && failureReasonCdList.size() > 0){
				int failureReasonCdListSize = failureReasonCdList.size();
				failureReasonCd = new String[failureReasonCdListSize];
				for (int k = 0; k < failureReasonCdListSize; k++) {
					failureReasonCd[k]= (String)failureReasonCdList.get(k);
				}
			}
		}
		//END-BRGUS00215440

		return failureReasonCd;
	}

	//END


	/* Begin BRGUS00109150 – kesavanr
	 * Method to process scope and coverage during end process.
	 */
	/**
	 * Method processScopeAndCoverage is used to process scope and coverage
	 * @param eligDetail EligDetail
	 * @param egDataHandler EgDataHandler
	 * @param arrEligDetailOutput EligDetail[]
	 * @throws RulesException
	 * @throws TIERSValidationException
	 * @throws EDBCException
	 */
	private void processScopeAndCoverage(EligDetail eligDetail,
			EgDataHandler egDataHandler,EligDetail[] arrEligDetailOutput) throws RulesException,
			TIERSValidationException, EDBCException {

		if (eligDetail.getEdEligibilityCargo()[0].getProgramCd().equals(
				IEdEligCodes.PROGRAM_CD_ME)
				|| eligDetail.getEdEligibilityCargo()[0].getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_FMA)
				|| eligDetail.getEdEligibilityCargo()[0].getProgramCd().equals(
						IEdEligCodes.PROGRAM_CD_MC)) {
			EDScopeCoverageBO edScopeCoverageBo = new EDScopeCoverageBO();
			edScopeCoverageBo.processScopeCoverage(egDataHandler, eligDetail,arrEligDetailOutput);
		}
	}
	//End BRGUS00109150

	/**
	 * Method detIndvBenefitStatus is used to determine benefit status of the individual
	 * @param aEdEligibilityCargo EdEligibilityCargo
	 * @param aEdEligibilityAuthCargo EdEligibilityCargo
	 * @param aEgDataHandler EgDataHandler
	 * @return String
	 * @throws EDBCException
	 */
	public String detIndvBenefitStatus(EdEligibilityCargo aEdEligibilityCargo,
			EdEligibilityCargo aEdEligibilityAuthCargo,
			EgDataHandler aEgDataHandler) throws EDBCException {

		//char coverageCdConfirmed = IEdEligCodes.CHAR_BLANK_VALUE;
		//char coverageCdUnConfirmed = IEdEligCodes.CHAR_BLANK_VALUE;
		long authIndvEdgTraceId = 0;
		long unAuthIndvEdgTraceId = 0;
		String indvBenefitStatus = null;
		ArrayList indvBenefitStatusCd = new ArrayList();
		String partStatusCdUnAuth = null;
		String partStatusCdAuth = null;
		boolean indvFound = false;
		boolean edCgStsCodeCheckAuth = false;
		boolean edCgStsCodeCheckUnAuth = false;
		int unAuthlength = 0;
		char grpIndAuth = IEdEligCodes.CHAR_BLANK_VALUE;
		char grpIndUnAuth = IEdEligCodes.CHAR_BLANK_VALUE;
		unAuthlength = aEgDataHandler.getEligDetailUnAuthCurrEDM()
				.getEdIndvEligibilityCargo().length;
		int authlength = 0;
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			authlength = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo().length;
		}
		EdIndvEligibilityCargo[] authRecords = null;
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdIndvEligibilityCargo() != null) {
			authRecords = aEgDataHandler.getEligDetailLastAuth()
					.getEdIndvEligibilityCargo();
		}

		EdIndvEligibilityCargo[] unAuthRecords = aEgDataHandler
				.getEligDetailUnAuthCurrEDM().getEdIndvEligibilityCargo();

		try {

			if (unAuthlength < authlength) {
				for (int i = 0; i < authlength; i++) {
					indvFound = false;
					partStatusCdAuth = authRecords[i].getPartStatusCd();
					grpIndAuth = authRecords[i].getGroupInd();
					for (int j = 0; j < unAuthlength; j++) {
						partStatusCdUnAuth = unAuthRecords[j].getPartStatusCd();
						grpIndUnAuth = unAuthRecords[j].getGroupInd();
						if (authRecords[i].getIndvId() == unAuthRecords[j]
								.getIndvId()) {
							indvFound = true;
							authIndvEdgTraceId = authRecords[i].getEdgTraceId();
							unAuthIndvEdgTraceId = unAuthRecords[j]
									.getEdgTraceId();
							/*
							 * ? - In order to check an individual's eligibility ,
							 * we check his group level CgStatusCd. We do this
							 * for both authorized and unauthorized records.
							 */
							edCgStsCodeCheckAuth = getCgStsCd(
									authIndvEdgTraceId, aEdEligibilityAuthCargo);
							edCgStsCodeCheckUnAuth = getCgStsCd(
									unAuthIndvEdgTraceId, aEdEligibilityCargo);
							if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							} else if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							}

						}

					}

					if (!indvFound) {

						if (edCgStsCodeCheckAuth
								&& ((partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)) {
							indvBenefitStatusCd
									.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
						} else if (edCgStsCodeCheckAuth
								&& !((partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)) {
							indvBenefitStatusCd
									.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						}
					}

				}
			} else {
				for (int i = 0; i < unAuthlength; i++) {
					indvFound = false;
					partStatusCdUnAuth = unAuthRecords[i].getPartStatusCd();
					grpIndUnAuth = unAuthRecords[i].getGroupInd();
					for (int j = 0; j < authlength; j++) {

						partStatusCdAuth = authRecords[j].getPartStatusCd();
						grpIndAuth = authRecords[j].getGroupInd();
						if (unAuthRecords[i].getIndvId() == authRecords[j]
								.getIndvId()) {
							indvFound = true;
							authIndvEdgTraceId = authRecords[j].getEdgTraceId();
							unAuthIndvEdgTraceId = unAuthRecords[i]
									.getEdgTraceId();
							edCgStsCodeCheckAuth = getCgStsCd(
									authIndvEdgTraceId, aEdEligibilityAuthCargo);
							edCgStsCodeCheckUnAuth = getCgStsCd(
									unAuthIndvEdgTraceId, aEdEligibilityCargo);
							if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							} else if ((edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_DECREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
							} else if ((!(edCgStsCodeCheckAuth && ((partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdAuth
									.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndAuth == IEdEligCodes.GROUP_IND_C)))
									&& (!(edCgStsCodeCheckUnAuth && ((partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
											.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)))) {
								indvBenefitStatusCd
										.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
							}
						}

					}
					if (!indvFound) {
						if (edCgStsCodeCheckUnAuth
								&& ((partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)) {
							indvBenefitStatusCd
									.add(IEdEligCodes.BENEFIT_STATUS_INCREASE);
						} else if (edCgStsCodeCheckUnAuth
								&& !((partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_ADULT) || partStatusCdUnAuth
										.equalsIgnoreCase(EDGConstants.ELIGIBLE_CHILD)) && grpIndUnAuth == IEdEligCodes.GROUP_IND_C)) {
							indvBenefitStatusCd
									.add(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
						}
					}

				}

			}
			/*
			 * ? We take all the benefit status into an ArrayList and follow the
			 * below conditions. If any one is decrease, the group level benefit
			 * status is decrease. If any one is increase, the group level
			 * benefit status id increase. If all are sustain, the group level
			 * benefit status is sustain.
			 */
			boolean indvBenefitStatusFlag = false;
			String[] indvCoverageCdArr;
			indvCoverageCdArr = (String[]) indvBenefitStatusCd
					.toArray(new String[indvBenefitStatusCd.size()]);
			if (indvBenefitStatus == null) {
				for (int i = 0; i < indvCoverageCdArr.length; i++) {
					//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_DECREASE) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
					if (IEdEligCodes.BENEFIT_STATUS_DECREASE.equalsIgnoreCase(indvCoverageCdArr[i])) {	
						indvBenefitStatus = IEdEligCodes.BENEFIT_STATUS_DECREASE;
						indvBenefitStatusFlag = true;
						break;
					}
				}
				if (indvBenefitStatusFlag == false) {
					for (int i = 0; i < indvCoverageCdArr.length; i++) {
						//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_INCREASE) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
						  if (IEdEligCodes.BENEFIT_STATUS_INCREASE.equalsIgnoreCase(indvCoverageCdArr[i])) { 	
							indvBenefitStatus = IEdEligCodes.BENEFIT_STATUS_INCREASE;
							indvBenefitStatusFlag = true;
							break;
						}
					}
				}
				if (indvBenefitStatusFlag == false) {
					boolean isSustain = false;
					for (int i = 0; i < indvCoverageCdArr.length; i++) {
						//if (indvCoverageCdArr[i] == IEdEligCodes.BENEFIT_STATUS_SUSTAIN) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
						if (IEdEligCodes.BENEFIT_STATUS_SUSTAIN.equalsIgnoreCase(indvCoverageCdArr[i])) {
							isSustain = true;
						} else {
							isSustain = false;
							break;
						}
					}
					if (isSustain) {
						indvBenefitStatus = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
					}
				}

			}
		} catch (Exception ex) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, ex);
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"detIndvBenefitStatus", ex);
		}
		return indvBenefitStatus;
	}

	/**
	 * If the Edg is in EFIP,Typeof Assistance is tp01 and If the indv Status is
	 * changed from Deferred to Mandatory . This method Change the Indv Status
	 * from Mandatory to other member("OM"). *
	 *
	 * @param EligDetail
	 *            arrEligDetailOutputCurMonth
	 * @param EligDetail
	 *            arrEligDetailOutputPrevMonth
	 * @return EligDetail
	 * @throws EDBCException
	 */

	private EligDetail detOtherMember(EligDetail arrEligDetailOutputCurMonth,
			EligDetail arrEligDetailOutputPrevMonth,
			EgDataHandler aEgDataHandler) throws EDBCException {
		int indvCurrLength = 0;
		int indvPrevLength = 0;
		int indvVRecordLength = 0;
		int aEdEligLength = 0;
		long currIndvId = 0;
		long prevIndvId = 0;
		char curEtRegInd;
		char prevEtRegInd;
		String etActivityType = null;
		String prevEtActivityType = null;
		EdIndvEligibilityCargo[] edIndvEligibilityVCargo = null;
		EligDetail arrEligDetailVRecords = null;
		try {
			// beniwala - ASPEN00015918 - fix findbugs issue
			if ((arrEligDetailOutputCurMonth != null &&
					arrEligDetailOutputCurMonth.getEdEligibilityCargo()[0] != null
					&& arrEligDetailOutputCurMonth.getEdEligibilityCargo()[0]
					.getTypeOfAssistanceCd()
					.equalsIgnoreCase(IEdEligCodes.TP_01))
					&& (arrEligDetailOutputCurMonth.getEdEligibilityCargo()[0]
							.getEfipEligSw() != IEdEligCodes.CHAR_INIT_SPACE)
					&& (arrEligDetailOutputCurMonth.getEdEligibilityCargo()[0]
							.getEfipEligSw() == IEdEligCodes.YES)) {
				//BEGIN-BRGUS00166207-upadhyayulag-If an individual in the current EFIP run is 
				//Mandatory & Work First, change to "Other Member", if in the previous month record,
				//individual is not Mandatory or not Work First.
				if (arrEligDetailOutputCurMonth !=null
						&& arrEligDetailOutputCurMonth.getEdIndvEligibilityCargo() != null){
					indvCurrLength = arrEligDetailOutputCurMonth
							.getEdIndvEligibilityCargo().length;
				}
				if (arrEligDetailOutputPrevMonth !=null
						&& arrEligDetailOutputPrevMonth.getEdIndvEligibilityCargo() != null) {
					indvPrevLength = arrEligDetailOutputPrevMonth
							.getEdIndvEligibilityCargo().length;
				}

				arrEligDetailVRecords = aEgDataHandler.getEligDetailVRecords();
				if (arrEligDetailVRecords != null) {
					//BEGIN-BRGUS00166207-upadhyayulag-Retrieve only the current EDG & pay
					//begin month record's corresponding previous month 'V' record
					/*
					edIndvEligibilityVCargo = arrEligDetailVRecords
							.getEdIndvEligibilityCargo();
					if (edIndvEligibilityVCargo != null) {
						indvVRecordLength = arrEligDetailVRecords
								.getEdIndvEligibilityCargo().length;
					}
					*/
					EdEligibilityCargo edEligibilityCargoV = getPreviousVRecord(
							aEgDataHandler.getEdEligibilityCargoVrecords(),
							arrEligDetailOutputCurMonth.getEdEligibilityCargo()[0]);
					if(edEligibilityCargoV != null){
						edIndvEligibilityVCargo = getEdIndvEligibilityByTraceId(
								aEgDataHandler.getEdIndvEligibilityCargoVrecords(),	edEligibilityCargoV);
						if(edIndvEligibilityVCargo != null){
							indvVRecordLength = edIndvEligibilityVCargo.length;
						}
					}
					//END-BRGUS00166207
				}

				for (int k = 0; k < indvCurrLength; k++) {
					if (arrEligDetailOutputCurMonth.getEdIndvEligibilityCargo()[k] != null) {
						if (arrEligDetailOutputCurMonth
								.getEdIndvEligibilityCargo()[k].getEtRegInd() != IEdEligCodes.CHAR_INIT_SPACE
								&& arrEligDetailOutputCurMonth
										.getEdIndvEligibilityCargo()[k]
										.getEtActTypeCd() != null) {

							curEtRegInd = arrEligDetailOutputCurMonth
									.getEdIndvEligibilityCargo()[k]
									.getEtRegInd();
							etActivityType = arrEligDetailOutputCurMonth
									.getEdIndvEligibilityCargo()[k]
									.getEtActTypeCd();
							if ((etActivityType != null && etActivityType
									.equalsIgnoreCase("WF"))
									&& (curEtRegInd == 'M')) {
								currIndvId = arrEligDetailOutputCurMonth
										.getEdIndvEligibilityCargo()[k]
										.getIndvId();

							}
							for (int l = 0; l < indvPrevLength; l++) {
								/*if (arrEligDetailOutputCurMonth
										.getEdIndvEligibilityCargo()[l] != null) {*/
								/*
								 * Defect ID : BRGUS00108059
								 *  Added By  : alamm2
								 *  Date      : 04/23/2008
								 *  Change    : Application error, need to look arrEligDetailOutputPrevMonth
								 * 				insted of arrEligDetailOutputCurMonth
								 *
								 */
								if (arrEligDetailOutputPrevMonth
										.getEdIndvEligibilityCargo()[l] != null) {
									prevIndvId = arrEligDetailOutputPrevMonth
											.getEdIndvEligibilityCargo()[l]
											.getIndvId();
									prevEtRegInd = arrEligDetailOutputPrevMonth
											.getEdIndvEligibilityCargo()[l]
											.getEtRegInd();
									if (arrEligDetailOutputPrevMonth
											.getEdIndvEligibilityCargo()[l]
											.getEtActTypeCd() != null) {
										prevEtActivityType = arrEligDetailOutputPrevMonth
												.getEdIndvEligibilityCargo()[l]
												.getEtActTypeCd();
									}
									/*if ((currIndvId == prevIndvId && prevEtRegInd == 'D')
											|| (prevEtActivityType != null && prevEtActivityType
													.equalsIgnoreCase("OM"))) {
										arrEligDetailOutputCurMonth
												.getEdIndvEligibilityCargo()[k]
												.setEtActTypeCd("OM");

									}*/
									/*
									 * Defect ID : BRGUS00111826 Added By : alamm2 Date : 05/21/2008
									 * Change : added currIndvId == prevIndvId to make sure to look at 
									 * the correct individual
									 */
									/*
									if ((currIndvId == prevIndvId && prevEtRegInd == 'D')
											|| (prevEtActivityType != null && prevEtActivityType
													.equalsIgnoreCase("OM") && currIndvId == prevIndvId)) {
										arrEligDetailOutputCurMonth
												.getEdIndvEligibilityCargo()[k]
												.setEtActTypeCd("OM");
									}
									*/
									if(currIndvId == prevIndvId){
										if((prevEtRegInd != 'M') 
											|| (prevEtActivityType != null 
													&& !prevEtActivityType.equalsIgnoreCase("WF"))){
											arrEligDetailOutputCurMonth
											.getEdIndvEligibilityCargo()[k].setEtActTypeCd("OM");
										}
									}
								}
							}

							for (int m = 0; m < indvVRecordLength; m++) {
								if (edIndvEligibilityVCargo != null) {
									prevIndvId = edIndvEligibilityVCargo[m]
											.getIndvId();
									prevEtRegInd = edIndvEligibilityVCargo[m]
											.getEtRegInd();
									prevEtActivityType = edIndvEligibilityVCargo[m]
											.getEtActTypeCd();

									/*if (edIndvEligibilityVCargo[m]
											.getEtActTypeCd() != null) {
										prevEtActivityType = edIndvEligibilityVCargo[m]
												.getEtActTypeCd();
									}*/
									/*if (prevEtActivityType != null
											&& prevEtActivityType
													.equalsIgnoreCase("OM")) {
										arrEligDetailOutputCurMonth
												.getEdIndvEligibilityCargo()[k]
												.setEtActTypeCd("OM");

									}*/
									/*
									 * Defect ID : BRGUS00111826 Added By : alamm2 Date : 06/10/2008
									 * Change : added currIndvId == prevIndvId to make sure to look at 
									 * the correct individual
									 */
									/*
									if ((currIndvId == prevIndvId && prevEtRegInd == 'D')
											|| (prevEtActivityType != null && prevEtActivityType
													.equalsIgnoreCase("OM") && currIndvId == prevIndvId)) {
										arrEligDetailOutputCurMonth
												.getEdIndvEligibilityCargo()[k]
												.setEtActTypeCd("OM");

									}
									*/
									if(currIndvId == prevIndvId){
										if((prevEtRegInd != 'M') 
											|| (prevEtActivityType != null 
													&& !prevEtActivityType.equalsIgnoreCase("WF"))){
											arrEligDetailOutputCurMonth
											.getEdIndvEligibilityCargo()[k].setEtActTypeCd("OM");
										}
									}
								}
							}
							//END-BRGUS00166207
							currIndvId = 0;
							prevIndvId = 0;
						}

					}

				}

			}
		} catch (Exception e) {

			throw new EDBCException(
					EDBCException.MAJOR,
					"EDUtil",
					"Error in Determine the OtherMember,MethodName:detOtherMember",
					e);

		}
		return arrEligDetailOutputCurMonth;
	}

	/**
	 * If the Typeof Assistance is tp01 and If Nonfin, resource,fin and vcl is
	 * failing in Edg or Indv Level. this method will remove the other pendinng
	 * reason records.
	 *
	 * @param EligDetai[]
	 *            arrEligDetailOutput
	 * @return EligDetail[]
	 * @throws EDBCException
	 */

	private EligDetail[] removeOtherPendingRsn(EligDetail[] arrEligDetailOutput)
			throws EDBCException {
		int jLength = 0;
		int indvLength = 0;
		long edEligEdgTraceId = 0;
		long ltcPendEdgTraceId = 0;
		long ltcIndvId = 0;
		boolean edgLevelFail = false;
		String edgNfRsltCd = null;
		String edgRscRsltCd = null;
		String edgFinRsltCd = null;
		String ltcPendCd = null;
		int m = 0;
		try {
			if (arrEligDetailOutput != null) {
				jLength = arrEligDetailOutput.length;
			}
			long edgTraceIdsFip[] = new long[jLength];
			for (int i = 0; i < jLength; i++) {
				if (arrEligDetailOutput[i].getEdEligibilityCargo()[0] != null) {
					if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
							.getTypeOfAssistanceCd().equals(IEdEligCodes.TP_01)) {
						edEligEdgTraceId = arrEligDetailOutput[i]
								.getEdEligibilityCargo()[0].getEdgTraceId();
						if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getNfEligRsltCd() != null) {
							edgNfRsltCd = arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0]
									.getNfEligRsltCd();
						}
						if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getRscEligRsltCd() != null) {
							edgRscRsltCd = arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0]
									.getRscEligRsltCd();
						}
						if (arrEligDetailOutput[i].getEdEligibilityCargo()[0]
								.getFinEligRsltCd() != null) {
							edgFinRsltCd = arrEligDetailOutput[i]
									.getEdEligibilityCargo()[0]
									.getFinEligRsltCd();
						}
						if ((edgNfRsltCd != null && edgNfRsltCd
								.equalsIgnoreCase(IEdEligCodes.FAIL))
								|| (edgRscRsltCd != null && edgRscRsltCd
										.equalsIgnoreCase(IEdEligCodes.FAIL))
								|| (edgFinRsltCd != null && edgFinRsltCd
										.equals(IEdEligCodes.FAIL))) {
							edgLevelFail = true;
							edgTraceIdsFip[m] = edEligEdgTraceId;
							m = m + 1;
						}

						if (edgLevelFail == true) {
							for (int j = 0; j < jLength; j++) {
								if (arrEligDetailOutput[j]
										.getEdIndvLtcPendingReasonCargo() != null) {
									indvLength = arrEligDetailOutput[j]
											.getEdIndvLtcPendingReasonCargo().length;
									for (int k = 0; k < indvLength; k++) {
										if (arrEligDetailOutput[j]
												.getEdIndvLtcPendingReasonCargo()[k] != null) {
											ltcPendEdgTraceId = arrEligDetailOutput[j]
													.getEdIndvLtcPendingReasonCargo()[k]
													.getEdgTraceId();
											ltcPendCd = arrEligDetailOutput[j]
													.getEdIndvLtcPendingReasonCargo()[k]
													.getPendingReasonCd();
											if (checkEdgTraceIds(
													edgTraceIdsFip,
													ltcPendEdgTraceId) == true
													&& ltcPendCd.equals("1027")) {
												arrEligDetailOutput[j]
														.getEdIndvLtcPendingReasonCargo()[k]
														.setDeleteSw('Y');
											}
										}

									}
								}
							}
						}

					}

				}
			}

			/*
			 * Defect ID : BRGUS00098347 Added By : phadtarep Date : 03/10/2008
			 * Change : This method will set the Delete Switch for FAP in
			 * Ed_eligibility : While shortening benefit period, if Payment
			 * Begin Date for FAP is greater than Cert End Date then we set the
			 * Delete Switch for this EDG and for the EDG having PayBeg date ==
			 * Cer EndDate we set the PayEndDate and Rec End date to null
			 */

			/*
			 * Defect ID : BRGUS00098347 Added By : phadtarep Date : 03/19/2008
			 * Change : reverting back the changes as per Girish, EDG is taking
			 * care of this
			 */
			//EdDriverHelper.determineEDGtobeDeletedForFAP(arrEligDetailOutput);
		} catch (Exception e) {
			throw new EDBCException(
					EDBCException.MAJOR,
					"EDUtil",
					"Error in remove the Other PendingReason ,MethodName:removeOtherPendingRsn",
					e);
		}
		return arrEligDetailOutput;
	}

	/**
	 * @param edEligibilityCargo
	 * @return
	 */
	private boolean isNFRequired(EdEligibilityCargo edEligibilityCargo) {

		if (edEligibilityCargo.getProgramCd().equalsIgnoreCase("DS")) {
			return false;
		}
		return true;

	}

	/**
	 * @param edEligibilityCargo
	 * @return
	 */
	private boolean isFinRequired(EdEligibilityCargo edEligibilityCargo) {

		if (edEligibilityCargo.getProgramCd().equalsIgnoreCase("DS")) {
			return false;
		}
		return true;

	}

	/**
	 * @param edEligibilityCargo
	 * @return
	 */
	private boolean isResourceRequired(EdEligibilityCargo edEligibilityCargo) {

		if (edEligibilityCargo.getProgramCd().equalsIgnoreCase("DS")) {
			return false;
		}
		return true;

	}

	/*
	 * Defect ID : BRGUS00100127 Added By : kesavanr Date : 03/05/2008 Change :
	 * Determing group benefit status from services benefit statuses.
	 *
	 */
	/**
	 * Determing group benefit status from services benefit statuses.
	 *
	 * @param ArrayList
	 *            serviceBenefitStatusList
	 * @return String
	 * @throws EDBCException
	 */
	private String detCdcGroupBenefitStatus(ArrayList serviceBenefitStatusList)
			throws EDBCException {
		boolean groupBenefitStatusFlag = false;
		String groupBenefitStatus = null;
		String[] serviceBenefitStatusArr;
		try {
			serviceBenefitStatusArr = (String[]) serviceBenefitStatusList
					.toArray(new String[serviceBenefitStatusList.size()]);
			int serviceLength = 0;
			if (serviceBenefitStatusArr != null) {
				serviceLength = serviceBenefitStatusArr.length;
			}
			for (int i = 0; i < serviceLength; i++) {
				//if (serviceBenefitStatusArr[i] == IEdEligCodes.BENEFIT_STATUS_DECREASE) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
				if (IEdEligCodes.BENEFIT_STATUS_DECREASE.equalsIgnoreCase(serviceBenefitStatusArr[i])) {	
					groupBenefitStatus = IEdEligCodes.BENEFIT_STATUS_DECREASE;
					groupBenefitStatusFlag = true;
					break;
				}
			}
			if (groupBenefitStatusFlag == false) {
				for (int i = 0; i < serviceLength; i++) {
					//if (serviceBenefitStatusArr[i] == IEdEligCodes.BENEFIT_STATUS_INCREASE) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
					  if (IEdEligCodes.BENEFIT_STATUS_INCREASE.equalsIgnoreCase(serviceBenefitStatusArr[i])) {
						groupBenefitStatus = IEdEligCodes.BENEFIT_STATUS_INCREASE;
						groupBenefitStatusFlag = true;
						break;
					}
				}
			}
			if (groupBenefitStatusFlag == false) {
				boolean isSustain = false;
				for (int i = 0; i < serviceLength; i++) {
					//if (serviceBenefitStatusArr[i] == IEdEligCodes.BENEFIT_STATUS_SUSTAIN) { // Parma - ASPEN00043092 - JDK 6 does not support for string comparison with ==
					  if (IEdEligCodes.BENEFIT_STATUS_SUSTAIN.equalsIgnoreCase(serviceBenefitStatusArr[i])) {
						isSustain = true;
					} else {
						isSustain = false;
						break;
					}
				}
				if (isSustain) {
					groupBenefitStatus = IEdEligCodes.BENEFIT_STATUS_SUSTAIN;
				}
			}
		} catch (Exception e) {
			throw new EDBCException(EDBCException.MAJOR, "EDUtil",
					"Error in determining group benefit status", e);
		}
		return groupBenefitStatus;
	}

	/*
	 * Begin BRGUS00095464 – kesavanr BV should not be called from EDBC driver
	 * if eligibility is pending not due to STFS.
	 */
	/**
	 * BV should not be called from EDBC driver if eligibility is pending not
	 * due to STFS.
	 *
	 * @param edEligibilityCargo
	 *            EdEligibilityCargo
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean isBVEdCanBeProcessed(EdEligibilityCargo edEligibilityCargo)
			throws EDBCException {

		boolean isBVEdCanBeProcessed = true;
		try {
			// modified for BRGUS00048581
			if (edEligibilityCargo.getTypeOfAssistanceCd().equalsIgnoreCase(
					"TP01")
					&& edEligibilityCargo.getActivityType().equalsIgnoreCase(
							IEdEligCodes.ACTIVITY_TYPE_INTAKE)
					&& edEligibilityCargo.getVerificationStatusCd() != null
					&& !edEligibilityCargo
							.getVerificationStatusCd()
							.equalsIgnoreCase(IEdEligCodes.ELIG_RSLT_CD_PENDING)
					&& edEligibilityCargo.getNfEligRsltCd() != null
					&& !edEligibilityCargo.getNfEligRsltCd().equalsIgnoreCase(
							IEdEligCodes.ELIG_RSLT_CD_PENDING)
					&& edEligibilityCargo.getStfsEligRsltCd() != null
					&& edEligibilityCargo.getStfsEligRsltCd().equalsIgnoreCase(
							IEdEligCodes.ELIG_RSLT_CD_PENDING)) {
				isBVEdCanBeProcessed = true;
			} else if (edEligibilityCargo.getCgStatusCd().equalsIgnoreCase(
					IEdEligCodes.STATUS_CD_PENDING)) {
				isBVEdCanBeProcessed = false;
			}
		} catch (Exception e) {
			throw new EDBCException(
					EDBCException.MAJOR,
					"EDUtil",
					"Error in determining whether BV can be processed due to pending eligibility status",
					e);
		}
		return isBVEdCanBeProcessed;
	}
	//End BRGUS00095464

	/* Begin BRGUS00109150 – kesavanr
	 * Determining benefit status for Medicaid Program
	 */
	/**
	 * Determining benefit status for Medicaid Program
	 * @param aEdEligibilityCargo EdEligibilityCargo
	 * @param aEgDataHandler EgDataHandler
	 * @param deductibleConfirmed double
	 * @param ftwPremiumConfirmed double
	 * @param tmapPremiumConfirmed double
	 * @param patientPayConfirmed double
	 * @throws EDBCException
	 */
	private void detMedicaidBenefitStatus(EdEligibilityCargo aEdEligibilityCargo,EdEligibilityCargo lastAuthCargo, EgDataHandler aEgDataHandler,
			     double deductibleConfirmed,double ftwPremiumConfirmed,double tmapPremiumConfirmed,double patientPayConfirmed ) throws EDBCException{

		double deductibleUnConfirmed = 0;
		double ftwPremiumUnConfirmed = 0;
		double tmapPremiumUnConfirmed = 0;
		double patientPayUnConfirmed = 0;
		String coverageCdSts = null;
		EdEligibilityCargo edEligibilityAuthCargo = null;

		/* Begin BRGUS00099351 – kesavanr
		 * Check benefit amount instead of spenddown amount to determine
		 * benefit status for G2 TOAs
		 */
		//BEGIN-BRGUS00158978-upadhyayulag-For G2 TOAs, if the authorized/confirmed remaining deductible
		//amount is '0', then take the remaining deductible amount from the current run
		if (aEdEligibilityCargo.getTypeOfAssistanceCd()
				.startsWith("G2")) {
			//BEGIN-BRGUS00181506-upadhyayulag-Consider the remaining deductible amount from current run as well
			if(lastAuthCargo.getSpendDownAmt() <= 0 || aEdEligibilityCargo.getSpendDownAmt() <= 0){
				deductibleUnConfirmed = aEdEligibilityCargo.getSpendDownAmt();
			}else{
				deductibleUnConfirmed = aEdEligibilityCargo.getBenefitAmt();
			}
			//END-BRGUS00181506
		}else{
			deductibleUnConfirmed = aEdEligibilityCargo
					.getBenefitAmt();
		}
		//deductibleUnConfirmed = aEdEligibilityCargo.getBenefitAmt();
		//END-BRGUS00158978
		//End BRGUS00099351

		if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
				.getEdEligMeBudgetCargo() != null
				&& aEgDataHandler.getEligDetailUnAuthCurrEDM()
						.getEdEligMeBudgetCargo().length > 0) {
			ftwPremiumUnConfirmed = aEgDataHandler
					.getEligDetailUnAuthCurrEDM()
					.getEdEligMeBudgetCargo()[0]
					.getFtwMonthlyPremiumAmt();
		}
		if (aEgDataHandler.getEligDetailUnAuthCurrEDM()
				.getEdEligTanfBudgetCargo() != null
				&& aEgDataHandler.getEligDetailUnAuthCurrEDM()
						.getEdEligTanfBudgetCargo().length > 0) {
			tmapPremiumUnConfirmed = aEgDataHandler
					.getEligDetailUnAuthCurrEDM()
					.getEdEligTanfBudgetCargo()[0]
					.getPremiumAmt();
		}

		patientPayUnConfirmed = aEdEligibilityCargo
				.getCopayAmt();
		if (aEgDataHandler.getEligDetailLastAuth() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdEligibilityCargo() != null
				&& aEgDataHandler.getEligDetailLastAuth()
						.getEdEligibilityCargo().length > 0) {
			edEligibilityAuthCargo = aEgDataHandler
					.getEligDetailLastAuth()
					.getEdEligibilityCargo()[0];
		}
		
		//BEGIN-BRGUS00209869-upadhyayulag-Do not increase PPA retroactively 
		//if negative action cannot be taken
		boolean retainPreviousAuthCopay = false;
		boolean lastAuthNotPresent = false;
		if (lastAuthCargo != null){
			if(patientPayUnConfirmed > lastAuthCargo.getCopayAmt()){
				retainPreviousAuthCopay = true;
			}
		}else{
			lastAuthNotPresent = true;
		}
		if(DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),
				aEdEligibilityCargo.getEdbcRunDt())){
			//In PR mode, current month can also have adverse action switch set to 'Y'
			if(retainPreviousAuthCopay){
				patientPayUnConfirmed = lastAuthCargo.getCopayAmt();
			}else if(lastAuthNotPresent){
				patientPayUnConfirmed = 0;
			}
			aEdEligibilityCargo.setCopayAmt(patientPayUnConfirmed);
		}else{
			if(!(aEdEligibilityCargo.getAdverseActionAllowedSw() != 0 
							&& aEdEligibilityCargo.getAdverseActionAllowedSw() == 'Y') 
							|| (aEdEligibilityCargo.getAdequateNoticeReqSw() != 0 
									&& aEdEligibilityCargo.getAdequateNoticeReqSw() == 'Y')){
				if(retainPreviousAuthCopay){
					patientPayUnConfirmed = lastAuthCargo.getCopayAmt();
				}else if(lastAuthNotPresent){
					patientPayUnConfirmed = 0;
				}
				aEdEligibilityCargo.setCopayAmt(patientPayUnConfirmed);
			}
		}
		//END-BRGUS00209869
		
		/*
		 * if(aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligLtcCopayBudgetCargo() !=
		 * null &&
		 * aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEligLtcCopayBudgetCargo().length >
		 * 0) { patientPayUnConfirmed =
		 * aEgDataHandler.getEligDetailUnAuthCurrEDM()
		 * .getEdEligLtcCopayBudgetCargo()[0].getMthlyCopayAmt(); }
		 */
		// Defect 59767 Benefit Status
		coverageCdSts = setBeneStsForCoverageCd(
				aEdEligibilityCargo, edEligibilityAuthCargo,
				aEgDataHandler);

		if (deductibleUnConfirmed < deductibleConfirmed
				|| ftwPremiumUnConfirmed < ftwPremiumConfirmed
				|| tmapPremiumUnConfirmed < tmapPremiumConfirmed
				|| patientPayUnConfirmed < patientPayConfirmed
				|| (coverageCdSts != null && coverageCdSts
						.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_DECREASE))) {

			if (coverageCdSts != null
					&& coverageCdSts
							.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_DECREASE)) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);

			} else if (patientPayUnConfirmed < patientPayConfirmed) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
			} else if (!((aEdEligibilityCargo
					.getTypeOfAssistanceCd().equalsIgnoreCase(
							IEdEligCodes.TP_56)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2PM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.FTWM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.TMAP)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2SM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2UM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2CM) || aEdEligibilityCargo
					.getTypeOfAssistanceCd().equalsIgnoreCase(
							IEdEligCodes.TP_32)))) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
			} else {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
			}
		} else if (deductibleUnConfirmed > deductibleConfirmed
				|| ftwPremiumUnConfirmed > ftwPremiumConfirmed
				|| tmapPremiumUnConfirmed > tmapPremiumConfirmed
				|| patientPayUnConfirmed > patientPayConfirmed
				|| (coverageCdSts != null && coverageCdSts
						.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_INCREASE))) {
			if (coverageCdSts != null
					&& coverageCdSts
							.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_INCREASE)) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);

			} else if (patientPayUnConfirmed > patientPayConfirmed) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
			} else if (!((aEdEligibilityCargo
					.getTypeOfAssistanceCd().equalsIgnoreCase(
							IEdEligCodes.TP_56)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2PM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.FTWM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.TMAP)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2SM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2UM)
					|| aEdEligibilityCargo
							.getTypeOfAssistanceCd()
							.equalsIgnoreCase(IEdEligCodes.G2CM) || aEdEligibilityCargo
					.getTypeOfAssistanceCd().equalsIgnoreCase(
							IEdEligCodes.TP_32)))) {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_INCREASE);
			} else {
				aEdEligibilityCargo
						.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_DECREASE);
			}
		} else if (deductibleUnConfirmed == deductibleConfirmed
				|| ftwPremiumUnConfirmed == ftwPremiumConfirmed
				|| tmapPremiumUnConfirmed == tmapPremiumConfirmed
				|| patientPayUnConfirmed == patientPayConfirmed
				|| (coverageCdSts != null && coverageCdSts
						.equalsIgnoreCase(IEdEligCodes.BENEFIT_STATUS_SUSTAIN))) {
			aEdEligibilityCargo
					.setBenefitStatus(IEdEligCodes.BENEFIT_STATUS_SUSTAIN);
		}
	}
	//End BRGUS00109150

	/* Begin BRGUS00104696 – kesavanr
	 * Retrieving approved authorized eligdetail structure on or before the protested month.
	 */
	/**
	 * Retrieving approved authorized eligdetail structure on or before the protested month.
	 * @param eligDetailAllAuth EligDetail
	 * @param protestedMonth Timestamp
	 * @param aEgDataHandler EgDataHandler
	 * @throws EDBCException
	 */
	private EligDetail getEligDetailAuthAppProtestedmonth(EligDetail eligDetailAllAuth,
			HeRestoreBenefitsCargo heRestoreBenefitsCargo,EgDataHandler aEgDataHandler,EligDetail eligDetailAllAuthCancel) throws EDBCException{

		if(eligDetailAllAuth != null && eligDetailAllAuth.getEdEligibilityCargo() != null &&
		   eligDetailAllAuth.getEdEligibilityCargo().length >0 ) {
			int kLength = eligDetailAllAuth.getEdEligibilityCargo().length;
			EdEligibilityCargo[] edEligibilityCargoAuth = eligDetailAllAuth.getEdEligibilityCargo();
			int cLength = eligDetailAllAuthCancel.getEdEligibilityCargo().length;
			EdEligibilityCargo[] edEligibilityCargoAuthCancel = eligDetailAllAuthCancel.getEdEligibilityCargo();
			Timestamp protestedMonth = heRestoreBenefitsCargo.getProtestedMonthDt();
			Timestamp noticeDate = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
			if(heRestoreBenefitsCargo.getNoticeDt() != null){
				noticeDate = heRestoreBenefitsCargo.getNoticeDt();
			}
			Timestamp tsToBeUsed = null;
			Timestamp paymentBeginDt = null;
			String overriddenProgram = "";
			EligDetail eligDetailAuthAppProtestedMonth = null;
			for (int i = 0; i < edEligibilityCargoAuth.length; i++) {
				if(edEligibilityCargoAuth[i].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()){
					overriddenProgram = edEligibilityCargoAuth[i].getProgramCd();
					break;
				}
			}
			//BEGIN-BRGUS00191867-upadhyayulag-If client notice sent date is before conversion,
			//Take the conversion loaded ongoing record to restore benefits
			boolean isNoticeDtBeforeConversion = false;
			Timestamp conversionDate = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
			if(aEgDataHandler != null 
					&& aEgDataHandler.getDcCasesCargo() != null 
					&& aEgDataHandler.getDcCasesCargo()[0].getConversionDt() != null){
				conversionDate = aEgDataHandler.getDcCasesCargo()[0].getConversionDt();
			}
			if(DateComparisons.dateLTDateInTimestamp(noticeDate,conversionDate)){
				isNoticeDtBeforeConversion = true;
			}
			if(isNoticeDtBeforeConversion){
				for(int l=0;l<kLength;l++){
					if((edEligibilityCargoAuth[l].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()) 
							&& (edEligibilityCargoAuth[l].getPaymentEndDt() == null)
							&& (edEligibilityCargoAuth[l].getActivityType().equalsIgnoreCase
									(IEdEligCodes.ACTIVITY_TYPE_CONVERSION))
							&& (edEligibilityCargoAuth[l].getCgStatusCd().equalsIgnoreCase
									(IEdEligCodes.STATUS_CD_APPROVED))){
						   	    	eligDetailAuthAppProtestedMonth = 
						   	    		aEgDataHandler.detEligDetailFiltered(edEligibilityCargoAuth[l],
						   	    				eligDetailAllAuth, null, true, null);
				   	    	return eligDetailAuthAppProtestedMonth;
					}
				}
				if(eligDetailAuthAppProtestedMonth == null){
					for (int m = 0; m < cLength; m++) {
						if((edEligibilityCargoAuthCancel[m].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()) 
								&& (edEligibilityCargoAuthCancel[m].getPaymentEndDt() == null)
								&& (edEligibilityCargoAuthCancel[m].getActivityType().equalsIgnoreCase
										(IEdEligCodes.ACTIVITY_TYPE_CONVERSION))
								&& (edEligibilityCargoAuthCancel[m].getCgStatusCd().equalsIgnoreCase
										(IEdEligCodes.STATUS_CD_APPROVED))){
							   	    	eligDetailAuthAppProtestedMonth = 
							   	    		aEgDataHandler.detEligDetailFiltered(edEligibilityCargoAuthCancel[m],
							   	    				eligDetailAllAuthCancel, null, true, null);
					   	    	return eligDetailAuthAppProtestedMonth;
						}
					}
				}
			}else{
				if(!overriddenProgram.equalsIgnoreCase(IEdEligCodes.PROGRAM_CD_CDC)){
					for(int k=0;k<kLength; k++){
						if(protestedMonth != null){
							tsToBeUsed = DateComparisons.subMonths(protestedMonth,k+1);
						}
						for(int l=0;l<kLength;l++){
							if(edEligibilityCargoAuth[l].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()){
								paymentBeginDt = edEligibilityCargoAuth[l].getPaymentBegDt();
								String tsToBeUsedMMYYYY = "" + DateComparisons.getMM(tsToBeUsed) 
								+ DateComparisons.getYYYY(tsToBeUsed);
						   	    String paymentBeginDtMMYYYY = "" + DateComparisons.getMM(paymentBeginDt) 
								+ DateComparisons.getYYYY(paymentBeginDt);
								if(tsToBeUsedMMYYYY.equalsIgnoreCase(paymentBeginDtMMYYYY) 
										&& edEligibilityCargoAuth[l].getCgStatusCd().equalsIgnoreCase
										(IEdEligCodes.STATUS_CD_APPROVED)){
								   	    	eligDetailAuthAppProtestedMonth = 
								   	    		aEgDataHandler.detEligDetailFiltered(edEligibilityCargoAuth[l],
								   	    				eligDetailAllAuth, null, true, null);
						   	    	return eligDetailAuthAppProtestedMonth;
						   	    }
							}
						}
					}
				}else{
					//BEGIN-BRGUS00129499-upadhyayulag-Iterate through authorized records to retrieve 
					//the record to be used for protested month. If none of them are found, iterate 
					//through cancelled records.
					for (int a = 0; a < kLength; a++) {
						Timestamp tsToBeUsedCDC = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
						if(protestedMonth != null) {
							tsToBeUsedCDC = DateComparisons.subDays(protestedMonth,(a+1)*14);
						}
						Timestamp latestEdbcRunDt = null;
						for(int b=0; b < kLength; b++) {
							if(edEligibilityCargoAuth[b].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()
									&& (edEligibilityCargoAuth[b].getCurrentEligInd() == 
										IEdEligCodes.CURRENT_ELIG_INDICATOR_A)){
								Timestamp cdcPayPeriodBegDt = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
								Timestamp cdcPayPeriodEndDt = DateComparisons.getDate(IEdEligCodes.HIGH_DATE);
								if(edEligibilityCargoAuth[b].getPaymentBegDt() != null){
									cdcPayPeriodBegDt = edEligibilityCargoAuth[b].getPaymentBegDt();	
								}
								if(edEligibilityCargoAuth[b].getPaymentEndDt() != null){
									cdcPayPeriodEndDt = edEligibilityCargoAuth[b].getPaymentEndDt();	
								}
								boolean payPeriodFound = false;
								if(DateComparisons.dateGTEQDateInTimestamp(tsToBeUsedCDC, cdcPayPeriodBegDt) 
										&& DateComparisons.dateLTEQDateInTimestamp(tsToBeUsedCDC, cdcPayPeriodEndDt)){
									payPeriodFound = true;
								}
								if(payPeriodFound){
									if((DateComparisons.dateLTDateInTimestamp
											(edEligibilityCargoAuth[b].getEdbcRunDt(),noticeDate)) 
											&& ((latestEdbcRunDt == null) 
													|| (latestEdbcRunDt != null 
															&& DateComparisons.dateGTDateInTimestamp
															(edEligibilityCargoAuth[b].getEdbcRunDt(),
																	latestEdbcRunDt)))){
										latestEdbcRunDt = edEligibilityCargoAuth[b].getEdbcRunDt();
							   	    	eligDetailAuthAppProtestedMonth = 
							   	    		aEgDataHandler.detEligDetailFiltered(edEligibilityCargoAuth[b],
							   	    				eligDetailAllAuth, null, true, null);
									}
								}
							}
						}
					}
					if(eligDetailAuthAppProtestedMonth == null){
						for (int m = 0; m < cLength; m++) {
							Timestamp tsToBeUsedCDC = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
							if(protestedMonth != null) {
								tsToBeUsedCDC = DateComparisons.subDays(protestedMonth,(m+1)*14);
							}
							Timestamp latestEdbcRunDt = null;
							for(int n=0; n < cLength; n++) {
								if(edEligibilityCargoAuthCancel[n].getEdgNum() == heRestoreBenefitsCargo.getEdgNum()
										&& (edEligibilityCargoAuthCancel[n].getCurrentEligInd() == 
											IEdEligCodes.CURRENT_ELIG_INDICATOR_C)){
									Timestamp cdcPayPeriodBegDt = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
									Timestamp cdcPayPeriodEndDt = DateComparisons.getDate(IEdEligCodes.HIGH_DATE);
									if(edEligibilityCargoAuthCancel[n].getPaymentBegDt() != null){
										cdcPayPeriodBegDt = edEligibilityCargoAuthCancel[n].getPaymentBegDt();	
									}
									if(edEligibilityCargoAuthCancel[n].getPaymentEndDt() != null){
										cdcPayPeriodEndDt = edEligibilityCargoAuthCancel[n].getPaymentEndDt();	
									}
									boolean payPeriodFound = false;
									if(DateComparisons.dateGTEQDateInTimestamp(tsToBeUsedCDC, cdcPayPeriodBegDt) 
											&& DateComparisons.dateLTEQDateInTimestamp(tsToBeUsedCDC, cdcPayPeriodEndDt)){
										payPeriodFound = true;
									}
									if(payPeriodFound){
										if((DateComparisons.dateLTDateInTimestamp
												(edEligibilityCargoAuthCancel[n].getEdbcRunDt(),noticeDate)) 
												&& ((latestEdbcRunDt == null) 
														|| (latestEdbcRunDt != null 
																&& DateComparisons.dateGTDateInTimestamp
																(edEligibilityCargoAuthCancel[n].getEdbcRunDt(),
																		latestEdbcRunDt)))){
											latestEdbcRunDt = edEligibilityCargoAuthCancel[n].getEdbcRunDt();
								   	    	eligDetailAuthAppProtestedMonth = 
								   	    		aEgDataHandler.detEligDetailFiltered(edEligibilityCargoAuthCancel[n],
								   	    				eligDetailAllAuthCancel, null, true, null);
										}
									}
								}
							}
						}
					}
					//END-BRGUS00129499
					return eligDetailAuthAppProtestedMonth;
				}
			}
			//END-BRGUS00191867
		}
		return null;
	}
	//End BRGUS00104696

	/* Begin BRGUS00109539 – kesavanr
	 * Get the previous month 'V' EdIndvEligibility record for the month and individual passed.
	 */
	/**
	 * Get the previous month 'V' EdIndvEligibility record for the month and individual passed.
	 * @param edEligibilityCargoV EdEligibilityCargo
	 * @param EligDetailVRecords EligDetail
	 * @param indvId long
	 * @return boolean
	 * @throws EDBCException
	 */
	private EdIndvEligibilityCargo getPrevEdIndvEligibilityVRecord(EdEligibilityCargo edEligibilityCargoV,EligDetail EligDetailVRecords,long indvId){
		if(EligDetailVRecords != null && EligDetailVRecords.getEdIndvEligibilityCargo() != null &&
		   EligDetailVRecords.getEdIndvEligibilityCargo().length > 0) {
			int kLength = EligDetailVRecords.getEdIndvEligibilityCargo().length;
			EdIndvEligibilityCargo[] arrEdIndvEligibilityCargo = EligDetailVRecords.getEdIndvEligibilityCargo();
			for(int k=0; k<kLength; k++) {
				if(arrEdIndvEligibilityCargo[k].getEdgTraceId() == edEligibilityCargoV.getEdgTraceId() &&
				   arrEdIndvEligibilityCargo[k].getIndvId() == indvId) {
					return arrEdIndvEligibilityCargo[k];
				}
			}
		}
		return null;
	}
//	End BRGUS00109539
	/** Added Dc Disability validate check for CASH program run Edbc  Type of Assistance FIP and RAP.
	 * @param edEligCargo
	 * @param edIndvEligibilityCargo //Added this parameter under the defect BRGUS00110974
	 * @param dcIndvEmpServExemptionCargo
	 * @param dcDisabilityCargo
	 * @throws TIERSValidationException
	 * @throws EDBCException
	 * BrgId: BRGUS00106674
	 * UserId: Gantac
	 * Date: 05/08/2008
	 */
	private void validateCashProgram(EdEligibilityCargo[] edEligCargo,
			EdIndvEligibilityCargo[] edIndvEligibilityCargo,
			DcIndvEmpServExemptionCargo[] dcIndvEmpServExemptionCargo,
			DcDisabilityCargo[] dcDisabilityCargo)
			throws TIERSValidationException, EDBCException {
		boolean isDcIndvEmpRecFound = false;
		for (int i = 0; i < edEligCargo.length; i++) {
			if ((edEligCargo[i].getTypeOfAssistanceCd().equals(
					DIConstants.TOA_TP01) || edEligCargo[i]
					.getTypeOfAssistanceCd().equals(DIConstants.TOA_RAP))
					&& (edEligCargo[i].getCgStatusCd()
							.equals(DIConstants.CG_STATUS_CD_PE))) {
				for(int l=0; l<edIndvEligibilityCargo.length; l++){
					if(edEligCargo[i].getEdgTraceId() == edIndvEligibilityCargo[l].getEdgTraceId() &&
							edIndvEligibilityCargo[l].getPartStatusCd().equals(IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT)){
						/** Begin BrgID: BRGUS00110974
						 *  UserId: GANTAC
						 * 	Date: 05/28/2008
						 *  Adding indv id check if the indv id is Eligible Adult that time only we
						 *  are checking with the Dc Disabilty indv id. If any disability indvId match with
						 *  the Eligibility indv id that time we are looking in to DcIndvEmpServExemption						 *
						 */
						isDcIndvEmpRecFound = false;
				for (int j = 0; j < dcDisabilityCargo.length; j++) {
						if (dcDisabilityCargo[j].getIndvId() == edIndvEligibilityCargo[l].getIndvId()
								&&(dcDisabilityCargo[j].getEffEndDt() == null
							|| (dcDisabilityCargo[j].getBeginDt() != null && DateComparisons
									.getDaysBetween(dcDisabilityCargo[j]
											.getEffEndDt(),
											dcDisabilityCargo[j].getBeginDt()) > 90))) {
						if (dcIndvEmpServExemptionCargo == null
								|| dcIndvEmpServExemptionCargo.length == 0) {
							ArrayList alError = new ArrayList();
							ArrayList alPlaces = new ArrayList();
							StringBuffer sb = new StringBuffer("|"+"Indv Id:");
							sb.append(dcDisabilityCargo[j].getIndvId());
							alError.add(DIConstants.MSG_INVALID_INDV_DATA);
							alPlaces.add(sb.toString());
							throw new TIERSValidationException(alError,
									alPlaces);
						} else {

							for (int k = 0; k < dcIndvEmpServExemptionCargo.length; k++) {
								if (dcDisabilityCargo[j].getIndvId() == dcIndvEmpServExemptionCargo[k]
										.getIndvId()) {//End BRGUS00110974
									isDcIndvEmpRecFound = true;
									break;
								}
							}
								if(!isDcIndvEmpRecFound){
									ArrayList alError = new ArrayList();
									ArrayList alPlaces = new ArrayList();
									StringBuffer sb = new StringBuffer("|" +
											"Indv Id:");
									sb.append(dcDisabilityCargo[j].getIndvId());
									alError
											.add(DIConstants.MSG_INVALID_INDV_DATA);
									alPlaces.add(sb.toString());
									throw new TIERSValidationException(alError,
											alPlaces);
								}
							}
						}

					}
					}
				}
				}//End BRGUS00110974
			}

	}	//End BRGUS00106674

	/** Override individual data if group is overriden.
	 * @param arrEdIndvEligibilityCargo EdIndvEligibilityCargo[]
	 * @param edEligibilityUpdated EdEligibilityCargo
	 * BrgId: BRGUS00104696
	 * UserId: kesavanr
	 * Date: 05/08/2008
	 */
	private EdIndvEligibilityCargo[] getOverridenEdIndvEligibilityCargo(EdIndvEligibilityCargo[] arrEdIndvEligibilityCargo,EdEligibilityCargo edEligibilityUpdated) {
		if(arrEdIndvEligibilityCargo != null && arrEdIndvEligibilityCargo.length >0) {
			int kLength = arrEdIndvEligibilityCargo.length;
			ArrayList indvOverridenList = new ArrayList();
			for(int k=0; k<kLength; k++) {
				if(arrEdIndvEligibilityCargo[k].getEdgTraceId() == edEligibilityUpdated.getEdgTraceId() &&
				  (arrEdIndvEligibilityCargo[k].getEdgPartStatusCd().equalsIgnoreCase("EA") || arrEdIndvEligibilityCargo[k].getEdgPartStatusCd().equalsIgnoreCase("EC") ||
				   arrEdIndvEligibilityCargo[k].getEdgPartStatusCd().equalsIgnoreCase("OA") || arrEdIndvEligibilityCargo[k].getEdgPartStatusCd().equalsIgnoreCase("OC"))) {
						arrEdIndvEligibilityCargo[k].setEligRsltCd(IEdEligCodes.ELIG_RSLT_CD_PASS);
						arrEdIndvEligibilityCargo[k].setEligibilityBegDt(edEligibilityUpdated.getEligibilityBegDt());
						arrEdIndvEligibilityCargo[k].setEligibilityEndDt(null);
						indvOverridenList.add(arrEdIndvEligibilityCargo[k]);
				}
			}
			EdIndvEligibilityCargo[] arrIndvOverriden = (EdIndvEligibilityCargo[]) indvOverridenList
			.toArray(new EdIndvEligibilityCargo[indvOverridenList.size()]);
			return arrIndvOverriden;
		}
		return null;
	}

	/**
	 * Calls the FwTimer to set the sessionId and runtime SLa
	 * BrgId: BRGUS00115857
	 * UserId: GANTAC
	 * Date: 07/17/2008
	 * @param timer
	 * @param map
	 * @param sessID
	 */

	private void setTimer(FwTimer timer, Map map, String sessID){
		//if(timer == null) return;////BRGUS00217436-upadhyayulag-FindBugs
		if (timer == null) {
			return;
		}
		String sUserId = null;
		sUserId = (String)map.get(DIConstants.USER_ID);
		Date date = new Date(timer.getStartTime());
		String sessionID =  sdf.format(date) + ","+ sessID + "," +sUserId;
		FwTimer.setTraceID(sessionID);
		FwTimer.setRuntimeSLA(FwConstants.LOGGING_PERFORMANCE_DEFAULT_SLA);
		timer.setInfo(sessionID,map.toString());
	}

	/**
	 * Reports the time to FwTimer for performance reporting purpose
	 * BrgId: BRGUS00115857
	 * UserId: GANTAC
	 * Date: 07/17/2008
	 * @param tg
	 * @param pageIdOrErrMsg
	 * @param methodName
	 * @throws FrameworkException
	 */
	private void reportTime(
			FwTimer tg,
			String pageIdOrErrMsg,
			String methodName) throws FrameworkException{
			String sla = "1";
			if (pageIdOrErrMsg != null) {
				sla = getPageActionSLA(pageIdOrErrMsg, "Submit");
			}
			List tgList = null;
				tgList = new ArrayList();
				tgList.add(IEdEligCodes.BEFORE);
				tgList.add(pageIdOrErrMsg);
				tgList.add(methodName);
				tgList.add(sla);
				tgList.add(FwTimer.getRuntimeSLA());
				tg.report(IEdEligCodes.PRESENTATION_TIER, tgList);
				tgList.clear();
				tg = null;
		}

	/**
	 *getPageActionSLA from the database. This represents SLA category defined by the developer
	 * The runtime SLA will be updated based on actual execution flow
	  * BrgId: BRGUS00115857
	 * UserId: GANTAC
	 * Date: 07/17/2008
	 * @param pageid
	 * @param action
	 * @return String
	 * @throws FrameworkException
	 */
	private String getPageActionSLA(String pageid, String action) throws FrameworkException {
		return PageActionsParser.getTransactionType(pageid, action);
	}//End BRGUS00115857
//	Begin - BRGUS00123600- Mulpuriv

	/**This method is used to find out whether the Military Income Contributing individual is absent for the Current Eligibity run
	 * @param conn
	 * @param caseNum
	 * @param egDataHandler
	 * @return
	 * @throws ApplicationException
	 * @throws FrameworkException
	 * @throws SQLException
	 */
	private  boolean militaryCheck(Connection conn, long caseNum, EgDataHandler egDataHandler) throws ApplicationException, FrameworkException, SQLException {
		boolean militaryCheck = false;
		try{
		EligDetail[] arrEligDetailInput = null;
		//EgDataHandler egDataHandler = new EgDataHandler();
		//egDataHandler.loadEligDetail(caseNum, conn);
		arrEligDetailInput = egDataHandler.getEligDetail();
		Timestamp tsMaxEDM = detMaxEDM(arrEligDetailInput);
		Timestamp tsMinEDM = detMinEDM(arrEligDetailInput);
		DcIndvCargo[] dcIndvCargo =  getDcIndvCargo(caseNum,tsMaxEDM,tsMinEDM,conn);
		DcIndvHhStatusCargo[] dcIndvHhStatusCargo =  getDcIndvHhStatusCargo(caseNum,tsMaxEDM,tsMinEDM,conn);
		if (dcIndvCargo != null && dcIndvCargo.length > 0 ){
			for (int i=0; i<dcIndvCargo.length; i++){
				if (dcIndvCargo[i].getDeathDt() != null){
					militaryCheck= true;
					break;
				}
			}

		}
		if(militaryCheck == false && dcIndvHhStatusCargo != null && dcIndvHhStatusCargo.length > 0){
			for (int j=0; j<dcIndvHhStatusCargo.length; j++){
				if (dcIndvHhStatusCargo[j].getIntendsToReturnSw() == 'N' && dcIndvHhStatusCargo[j].getInHouseholdSw() == 'N'){
					militaryCheck= true;
					break;
				}
			}
		}



		}
		 catch (EDBCException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (DataException e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getErrorProfile());
		} catch (Exception e) {
			EDBCLogger.writeExceptionStackTrace(
					DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
			e.printStackTrace();
			throw new FrameworkException(e.getMessage());
		}
		return militaryCheck;

	}


	/**This method retrieves DcIndvCargo for the Current Eligibility run months
	 * @param casenum contains case number
	 * @param tsMaxEDM contains the max EDM month
	 * @param tsMinEDM contains the min EDM month
	 * @param conn contains the connection object
	 * @return contains array of DcIndvCargos 
	 * @throws DataException
	 */
	
	public DcIndvCargo[] getDcIndvCargo(long casenum,Timestamp tsMaxEDM,Timestamp tsMinEDM, Connection conn)
			throws DataException {
		DcIndvCargo[] result = null;
		DcIndvCollection dcIndvColl = null;
		Long lCaseNum = null;
		lCaseNum = new Long(casenum);
				Object[] list = new Object[3];

				try {
					list[0] = tsMaxEDM;
					list[1] = tsMinEDM;
					list[2] = lCaseNum;

					dcIndvColl =  new DcIndvCollection(conn);
					result = (DcIndvCargo[]) dcIndvColl.select("findByIndvForMilIncome",list);
							}
					catch(Exception e)
						{
						throw new DataException(DataException.MAJOR,
															"EdUtil",
															"getDcIndvCargo : Error reading DcIndvCargo",
															e);
						}
							return result;
			}

	/**This method retrieves DcIndvhhStatusCargo for the Current Eligibility run months
	 * 
	 * @param casenum contains the case number
	 * @param tsMaxEDM contains the max EDM month
	 * @param tsMinEDM contains the min EDM month
	 * @param conn contains the connection object
	 * @return contains the array of DcIndvHhStatusCargos 
	 * @throws DataException
	 */
	
	public DcIndvHhStatusCargo[] getDcIndvHhStatusCargo(long casenum,Timestamp tsMaxEDM,Timestamp tsMinEDM,Connection conn)
			throws DataException {
		DcIndvHhStatusCargo[] result = null;
		DcIndvHhStatusCollection dcIndvHhStatusColl = null;
		Long lCaseNum = null;
		lCaseNum = new Long(casenum);
				Object[] list = new Object[3];

				try {
					list[0] = tsMaxEDM;
					list[1] = tsMinEDM;
					list[2] = lCaseNum;

					dcIndvHhStatusColl =  new DcIndvHhStatusCollection(conn);
					result = (DcIndvHhStatusCargo[]) dcIndvHhStatusColl.select("findByIndvForMilIncome",list);
							}
					catch(Exception e)
						{
						throw new DataException(DataException.MAJOR,
															"EdUtil",
															"getDcIndvHhStatusCargo : Error reading DcIndvHhStatusCargo",
															e);
						}
							return result;
			}
	// End - BRGUS00123600

	//BEGIN-upadhyayulag-BRGUS00131829-New method added
	//BEGIN-BRGUS00145083-upadhyayulag-Modified the method to include connection in the parameter list
	/** Method to check if there is atleast one address for maxEDM and minEDM.
	 * @param aLCaseNum long
	 * @param tsMinEDM Timestamp
	 * @param tsMaxEDM Timestamp
	 * @throws TIERSValidationException
	 * @throws EDBCException
	 * Date: 10/24/2008
	 */
	private boolean isValidCaseAddressExists(long aLCaseNum,Timestamp tsMinEDM,Timestamp tsMaxEDM, Connection conn)
			throws TIERSValidationException, EDBCException {
		DcCaseAddressesCargo addrCargo = new DcCaseAddressesCargo();
		addrCargo.setCaseNum(aLCaseNum);
		addrCargo.setEffBeginDt(tsMinEDM);
		addrCargo.setEffEndDt(tsMaxEDM);
		//BEGIN-BRGUS00145083-upadhyayulag-Create the collection using connection object
		DcCaseAddressesCollection addrColl = null;
		if(conn != null){
			addrColl = new DcCaseAddressesCollection(conn);
		}else{
			addrColl = new DcCaseAddressesCollection();
		}
		//END-BRGUS00145083
		addrColl.setCargo(addrCargo);
		DcCaseAddressesCargo[] returnAddrArray = null;
		try {
			returnAddrArray = (DcCaseAddressesCargo[])addrColl.select("findByCaseDateRange");
		} catch (Exception e) {
			throw new DataException(DataException.MAJOR,
					"EdUtil",
					"validateCaseAddresses : Error reading DcIndvHhStatusCargo",
					e);
		}
		if(returnAddrArray != null && returnAddrArray.length > 0){
			int returnAddrArrayLen = returnAddrArray.length;
			Debug.println("returnAddrArrayLen from isValidCaseAddressExists is:"+returnAddrArrayLen+":");
			boolean earliestRecordExists = false;
			boolean latestRecordExists = false;
			//BEGIN-BRGUS00143679-upadhyayulag-Check the continuity of the dates of addresses
			boolean continuousRecordsExist = true;
			Timestamp previousEndDt = null;
			//BEGIN-BRGUS00152242-upadhyayulag-New logic to check the continuity of the dates of addresses
			Timestamp minDate = null;
			Timestamp maxDate = null;
			/**
			 * Begin - WR#BRGUS00255276
			 * Gantac - 01/11/2011
			 * Adding Physical and Mailing address 
			 * check to validate the case address
			 */ 
			boolean isFirstValidAddRecProcessed = false;
			for (int i = 0; i < returnAddrArrayLen; i++) {
				if (returnAddrArray[i].getAddrTypeCd().equals(IEdEligCodes.ADDR_TYPE_PA)||
						returnAddrArray[i].getAddrTypeCd().equals(
								IEdEligCodes.ADDR_TYPE_MA)) {//BRGUS00255276
					if (!isFirstValidAddRecProcessed) {
						minDate = returnAddrArray[i].getEffBeginDt();
						if (minDate.equals(tsMinEDM)
								|| minDate.before(tsMinEDM)) {
							earliestRecordExists = true;
							if (returnAddrArray[i].getEffEndDt() == null) {
								latestRecordExists = true;
								continuousRecordsExist = true;
								break;
							} else {
								maxDate = returnAddrArray[i].getEffEndDt();
								if (maxDate.equals(tsMaxEDM)
										|| maxDate.after(tsMaxEDM)) {
									latestRecordExists = true;
									continuousRecordsExist = true;
									break;
								}
							}
						} else {
							earliestRecordExists = false;
							break;
						}
						isFirstValidAddRecProcessed = true;
					} else {
						if (maxDate != null && returnAddrArray[i].getEffBeginDt().after(maxDate)) {
							if (DateComparisons.getDaysBetween(maxDate,
									returnAddrArray[i].getEffBeginDt()) > 1) {
								continuousRecordsExist = false;
								break;
							} else {//If the difference between previous
									// maxDate & present begin date is 1
								if (returnAddrArray[i].getEffEndDt() == null) {
									latestRecordExists = true;
									continuousRecordsExist = true;
									break;
								} else {
									if (returnAddrArray[i].getEffEndDt().after(
											maxDate)) {
										maxDate = returnAddrArray[i]
												.getEffEndDt();
									}
									if (maxDate.equals(tsMaxEDM)
											|| maxDate.after(tsMaxEDM)) {
										latestRecordExists = true;
										continuousRecordsExist = true;
										break;
									}
								}
							}
						} else {
							if (returnAddrArray[i].getEffEndDt() == null) {
								latestRecordExists = true;
								continuousRecordsExist = true;
								break;
							} else {
								if (returnAddrArray[i].getEffEndDt().after(
										maxDate)) {
									maxDate = returnAddrArray[i].getEffEndDt();
								}
								if (maxDate.equals(tsMaxEDM)
										|| maxDate.after(tsMaxEDM)) {
									latestRecordExists = true;
									continuousRecordsExist = true;
									break;
								}
							}
						}
					}
				}//End BRGUS00255276
			}
			/*
			for (int i = 0; i < returnAddrArrayLen; i++) {
				Timestamp tempBegDt = returnAddrArray[i].getEffBeginDt();
				Timestamp tempEndDt = returnAddrArray[i].getEffEndDt();;
				if(tempEndDt != null){
					if((tempBegDt.equals(tsMinEDM)) ||
							(tempBegDt.before(tsMinEDM) && tempEndDt.after(tsMinEDM)) ||
							(tempBegDt.before(tsMinEDM) && tempEndDt.equals(tsMinEDM))){
						if(!earliestRecordExists){
							earliestRecordExists = true;
						}
					}
					if((tempEndDt.equals(tsMaxEDM)) || (tempEndDt.after(tsMaxEDM))){
						if(!latestRecordExists){
							latestRecordExists = true;
						}
					}
					if(i > 0){
						if(previousEndDt != null){
							if(!DateComparisons.dateEqualsDateInTimestamp(DateComparisons.subDays(tempBegDt,1),previousEndDt)){
								continuousRecordsExist = false;
							}
						}
					}
					previousEndDt = (Timestamp)tempEndDt.clone();
				}else{
					if(!latestRecordExists){
						latestRecordExists = true;
					}
					tempBegDt = returnAddrArray[i].getEffBeginDt();
					if((tempBegDt.equals(tsMinEDM)) || (tempBegDt.before(tsMinEDM))){
						if(!earliestRecordExists){
							earliestRecordExists = true;
						}
					}
					if(i > 0){
						if(previousEndDt != null){
							if(!DateComparisons.dateEqualsDateInTimestamp(DateComparisons.subDays(tempBegDt,1),previousEndDt)){
								continuousRecordsExist = false;
							}
						}
						break;
					}
				}
			}
			*/
			//END-BRGUS00152242
			if(earliestRecordExists && latestRecordExists && continuousRecordsExist){
			//END-BRGUS00143679
				Debug.println("Return true from isValidCaseAddressExists since there " +
						"is an earliest & latest record from DC_CASE_ADDRESSES with open end date!!");
				return true;
			}else{
				Debug.println("Return false from isValidCaseAddressExists since either " +
				"earliest or latest record from DC_CASE_ADDRESSES is missing!!");
				return false;
			}
		}else{
			Debug.println("Return false from isValidCaseAddressExists " +
					"since there are no records from DC_CASE_ADDRESSES!!");
			return false;
		}
	}
	//END-BRGUS00145083
	//END-BRGUS00131829
	
	//BEGIN-BRGUS00217436-upadhyayulag-FindBugs	
	/**
	 * BrgId: BRGUS00144585
	 * UserId: Gantac
	 * Date: 01/29/2009
	 * @param edEligCargolist
	 * @return
	 * @throws TIERSValidationException
	 * @throws EDBCException
	 */
	/*
	private void countOfCurrentEdgNumAndMonths(ArrayList edEligCargolist)throws TIERSValidationException, EDBCException{
		EdEligibilityCargo[] edEligEdgCargo = new EdEligibilityCargo[edEligCargolist.size()];
		edEligCargolist.toArray(edEligEdgCargo);
		Timestamp minPayBegDt = null;
		Timestamp maxPayEnddt = null;
		Timestamp payBegDt = null;
		Timestamp payEnddt = null;
		long edgNumber = 0;
		int numberOfEdgs = 0;
		String countOfCurrentEdgNumAndMonths = null;
		ArrayList edgNumList = new ArrayList();
		if (edEligEdgCargo.length == 1) {
			numberOfMonths = 1;
			numberOfEdgs = 1;
		} else {
			for (int a = 0; a < edEligEdgCargo.length; a++) {
					edgNumber = edEligEdgCargo[a].getEdgNum();
					if (!edgNumList.contains(String.valueOf(edgNumber))) {
						edgNumList.add(String.valueOf(edgNumber));
					}
					if (a == 0) {
						payBegDt = edEligEdgCargo[a]
								.getPaymentBegDt();
						minPayBegDt = payBegDt;
						payEnddt = edEligEdgCargo[a]
								.getPaymentEndDt();
						if (payEnddt == null) {
							maxPayEnddt = payBegDt;
						} else {
							maxPayEnddt = payEnddt;
						}

					} else {
						payBegDt =edEligEdgCargo[a]
								.getPaymentBegDt();
						if (DateComparisons.dateLTDateInTimestamp(payBegDt,
								minPayBegDt)) {
							minPayBegDt = payBegDt;
						}
						payEnddt = edEligEdgCargo[a]
								.getPaymentEndDt();
						if (payEnddt != null
								&& DateComparisons.dateGTDateInTimestamp(
										payEnddt, maxPayEnddt)) {
							maxPayEnddt = payEnddt;
						} else if (payEnddt == null && DateComparisons.dateGTDateInTimestamp(
								payBegDt, maxPayEnddt)) {
							maxPayEnddt = payBegDt;
						}
					}
			}
		}
		if(numberOfMonths == 0){
			if(maxPayEnddt != null && minPayBegDt != null){
				numberOfMonths = DateComparisons.getMonthsBetween(minPayBegDt,maxPayEnddt);
			}
		}
		if(numberOfEdgs == 0){
			if(edgNumList != null && edgNumList.size() > 0){
				numberOfEdgs = edgNumList.size();
			}
		}
		countOfCurrentEdgNumAndMonths = String.valueOf(numberOfEdgs) 
		+ "," + String.valueOf(numberOfMonths);
	 }
	*/
	//END-BRGUS00217436
	
	//BEGIN-BRGUS00146278-upadhyayulag-New method added for CR23169
//	<BRGUS00215858><kucherlapatis><Reverting back the changes done for Afghan & Iraqi Refugees>
	/**
	 * If all the certified group members (GROUP_IND = 'C') are Afghan alien type(A4,A5), set estimated
	 * eligibility end date to 6 months (including the current month). If the alien type is Iraqi type(I4,I5),
	 * set estimated eligibilty end date to 8 months(including the current month).
	 * @param aEdEligibilityCargo
	 *            EdEligibilityCargo
	 * @param aArrEdIndvEligibilityCargo
	 *            EdIndvEligibilityCargo[]
	 * @param nfDataHandler
	 * 			NFDataHandler
	 * @param egDataHandler
	 * 			EgDataHandler
	 * @return boolean
	 * @throws EDBCException
	 */
	/*public Timestamp detEstEligEndDtCertifiedGroupAlienAfghanIraqi(EdEligibilityCargo aEdEligibilityCargo,
			EdIndvEligibilityCargo[] aArrEdIndvEligibilityCargo,
			NFDataHandler nfDataHandler,
			EgDataHandler egDataHandler)
			throws EDBCException {
			Timestamp estEligEndDtAlien = null;
			Timestamp estEligEndDtAlienA4A5 = null;
			Timestamp estEligEndDtAlienI4I5 = null;
			Timestamp tsHighestEntryDtA4A5 = null;
			Timestamp tsHighestEntryDtI4I5 = null;
			tsHighestEntryDtA4A5 = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
			tsHighestEntryDtI4I5 = DateComparisons.getDate(IEdEligCodes.LOW_DATE);
			boolean alienA4A5 = false;
			boolean alienI4I5 = false;
			String greatestAlienTypeCd = null;
			//Timestamp tsMaxEDM = detMaxEDM(egDataHandler.getEligDetail());//BRGUS00217436-upadhyayulag-FindBugs

			int iLength = 0;
			iLength = aArrEdIndvEligibilityCargo.length;

			HashMap hmDcIndividualAlien = null;
			for (int i = 0; i < iLength; i++) {
				if (aArrEdIndvEligibilityCargo[i].getGroupInd() != IEdEligCodes.CHAR_INIT_SPACE
						&& aArrEdIndvEligibilityCargo[i].getGroupInd() == IEdEligCodes.GROUP_IND_C) {

						hmDcIndividualAlien = NFUtil.detDcIndividualAlienInfoMonthlyHM(egDataHandler, nfDataHandler);

						if (hmDcIndividualAlien.containsKey(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))) {

							greatestAlienTypeCd = ""+((DcIndividualAlienCargo) hmDcIndividualAlien.get
									(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getAlienTypeCd();
							if(greatestAlienTypeCd.equalsIgnoreCase("A4") ||
									greatestAlienTypeCd.equalsIgnoreCase("A5")) {
								alienA4A5 =  true;
							}else if(greatestAlienTypeCd.equalsIgnoreCase("I4") ||
										greatestAlienTypeCd.equalsIgnoreCase("I5")){
								alienI4I5 = true;
							}else{
								//If any of the certified group memebers are not of Afghan/Iraqi alien
								//type, break out of the loop
								alienA4A5 = false;
								alienI4I5 = false;
								break;
							}
							if(alienA4A5){
								if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long
										(aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt() != null) {
									if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
													aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt()
													.after(tsHighestEntryDtA4A5)) {
										tsHighestEntryDtA4A5 = ((DcIndividualAlienCargo) hmDcIndividualAlien
												.get(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt();
									}
								} else {
									if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
												aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt() != null) {
										if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
												aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt()
												.after(tsHighestEntryDtA4A5)) {
											tsHighestEntryDtA4A5 = ((DcIndividualAlienCargo) hmDcIndividualAlien
													.get(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt();
										}
									}
								}
							}
							if(alienI4I5){
								if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long
										(aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt() != null) {
									if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
													aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt()
													.after(tsHighestEntryDtI4I5)) {
										tsHighestEntryDtI4I5 = ((DcIndividualAlienCargo) hmDcIndividualAlien
												.get(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getGrantDt();
									}
								} else {
									if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
												aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt() != null) {
										if (((DcIndividualAlienCargo) hmDcIndividualAlien.get(new Long(
												aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt()
												.after(tsHighestEntryDtI4I5)) {
											tsHighestEntryDtI4I5 = ((DcIndividualAlienCargo) hmDcIndividualAlien
													.get(new Long(aArrEdIndvEligibilityCargo[i].getIndvId()))).getUsEntryDt();
										}
									}
								}
							}
						}else{
							//If any of the certified group memebers do not have DC_INDIVIDUAL_ALIEN
							//record, reak out of the loop
							alienA4A5 = false;
							alienI4I5 = false;
							break;
						}
				}
			}
			//If there is an Afghani/Iraqi in the same group, give the latest
			if(alienA4A5){
				//Give 6 months including the month user entered US or granted entry. So, it would be
				//last day of the month after adding 5 months to this date
				estEligEndDtAlienA4A5 = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(tsHighestEntryDtA4A5,7));
				estEligEndDtAlien = estEligEndDtAlienA4A5;
			}
			if(alienI4I5){
				//Give 8 months including the month user entered US or granted entry. So, it would be
				//last day of the month after adding 7 months to this date
				estEligEndDtAlienI4I5 = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(tsHighestEntryDtI4I5,7));
				if(estEligEndDtAlien != null){
					if(estEligEndDtAlienI4I5.after(estEligEndDtAlien)){
						estEligEndDtAlien = estEligEndDtAlienI4I5;
					}
				}else{
					estEligEndDtAlien = estEligEndDtAlienI4I5;
				}
			}
			return estEligEndDtAlien;
		}
	//END-BRGUS00146278
*/
	//BEGIN-BRGUS00148880-upadhyayulag-New method added
	/** Method to check if hearing is pending for an EDG
	 * @param aEdEligibilityCargo EdEligibilityCargo
	 * @param aEgDataHandler EgDataHandler
	 * @throws EDBCException
	 * Date: 03/25/2009
	 */
	private boolean isHearingPending(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler)
			throws EDBCException {
		boolean hearingPending = false;
		HeRestoreBenefitsCargo[] heRestoreBenefitsCargo =
			aEgDataHandler.getPendingHearingOverrides();
		if(heRestoreBenefitsCargo != null && heRestoreBenefitsCargo.length > 0){
			int heRestoreBenefitsCargoLen = heRestoreBenefitsCargo.length;
			for (int i = 0; i < heRestoreBenefitsCargoLen; i++) {
				if((aEdEligibilityCargo.getCaseNum() == heRestoreBenefitsCargo[i].getCaseNum())
						&& (aEdEligibilityCargo.getEdgNum() == heRestoreBenefitsCargo[i].getEdgNum())){
					String paymentBeginDtMMYYYY = "" + DateComparisons.getMM(
							aEdEligibilityCargo.getPaymentBegDt()) +
							DateComparisons.getYYYY(aEdEligibilityCargo.getPaymentBegDt());
			   	    String protestedDtMMYYYY = "" + DateComparisons.getMM(
			   	    		heRestoreBenefitsCargo[i].getProtestedMonthDt()) +
							DateComparisons.getYYYY(heRestoreBenefitsCargo[i].getProtestedMonthDt());
					if(DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(),
												heRestoreBenefitsCargo[i].getProtestedMonthDt()) ||
					        paymentBeginDtMMYYYY.equalsIgnoreCase(protestedDtMMYYYY)) {
						hearingPending = true;
						break;
					}
				}
			}
		}
		return hearingPending;
	}
	//END-BRGUS00148880

	//BEGIN-BRGUS00168047-upadhyayulag-New methods added for MiChild Task/Reminder triggering
	/**
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 */
	private boolean isDeniedDueToExcessIncome(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) {
		String[] noticeReason = null;
		EligDetail eligDetailCurrEdm = aEgDataHandler
				.getEligDetailUnAuthCurrEDM();
		if (eligDetailCurrEdm != null) {
			EdEligNoticeReasonsCargo[] edEligNoticeReasons = eligDetailCurrEdm
					.getEdEligNoticeReasonsCargo();
			if (edEligNoticeReasons != null) {
					noticeReason = getFailureReasonCd(aEdEligibilityCargo
							.getEdgTraceId(), edEligNoticeReasons);
					if (noticeReason != null && noticeReason.length > 0 ){
						for (int i=0; i < noticeReason.length; i++) {
							if(noticeReason[i] != null){
								String currentNoticeReason = noticeReason[i].trim();
								if(currentNoticeReason.equalsIgnoreCase("EL3001") 
										|| currentNoticeReason.equalsIgnoreCase("EL3005")){
									return true;
								}
							}
						}
					}
			}
		}
		return false;
	}

	/**
	 * Method getFailureReasonCd is used to return an array of failure reason codes
	 * for the given edg trace id
	 * @param traceId long
	 * @param arrEdNotice EdEligNoticeReasonsCargo[]
	 * @return String[]
	 */
	private String[]getFailureReasonCd(long traceId,
			EdEligNoticeReasonsCargo[] arrEdNotice) {

		String[]failureReasonCd= null;
		//BEGIN-BRGUS00215440-upadhyayulag-Use ArrayList to 
		//dynamically find the String array length
		//int j=0;
		int arrEdNoticeLength = 0;
		if (arrEdNotice != null && arrEdNotice.length > 0){
			arrEdNoticeLength = arrEdNotice.length;
			//failureReasonCd = new String[arrEdNoticeLength];
			ArrayList failureReasonCdList = new ArrayList();
			for(int i = 0; i < arrEdNoticeLength; i++){
				if(arrEdNotice[i].getEdgTraceId() == traceId){
					if(arrEdNotice[i].getFailureReasonCode() != null){
						//failureReasonCd[j]= arrEdNotice[i].getFailureReasonCode();
						//j++;
						failureReasonCdList.add(arrEdNotice[i].getFailureReasonCode());
					}
				}
			}
			if(failureReasonCdList != null && failureReasonCdList.size() > 0){
				int failureReasonCdListSize = failureReasonCdList.size();
				failureReasonCd = new String[failureReasonCdListSize];
				for (int k = 0; k < failureReasonCdListSize; k++) {
					failureReasonCd[k]= (String)failureReasonCdList.get(k);
				}
			}
		}
		//END-BRGUS00215440
		
		return failureReasonCd;
	}
	
	/**This method is used to trigger Task/Reminder for healthy kids TOAs if 
	 * they are eligible for MiChild atleast once during the EDBC run (even 
	 * during cascading) 
	 * 
	 * @param aEdEligibilityCargo contains current EdEligibilityCargo
	 * @param aEgDataHandler contains the EgDataHandler
	 * @param userId contains logged in user id information
	 * @param conn contains the connection object
	 * @throws TIERSValidationException
	 * @throws Exception
	 */
	
	public void triggerMiChildTaskReminder(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler,String userId, Connection conn) 
	throws TIERSValidationException, Exception {
		//Instead of checking if denied due to excess income, just look if Finance failed
		if(aEdEligibilityCargo != null && 
				aEdEligibilityCargo.getFinEligRsltCd().equals(IEdEligCodes.ELIG_RSLT_CD_FAIL)){
			EligDetail eligDetailCurrEdm = aEgDataHandler.getEligDetailUnAuthCurrEDM();
			if(eligDetailCurrEdm != null && eligDetailCurrEdm.getEdIndvEligibilityCargo() != null 
					&& eligDetailCurrEdm.getEdIndvEligibilityCargo().length > 0){
				EdIndvEligibilityCargo[] arrEdIndvEligibilityCargoCurrEDM = 
					(EdIndvEligibilityCargo[])eligDetailCurrEdm.getEdIndvEligibilityCargo();
				int iLength = arrEdIndvEligibilityCargoCurrEDM.length;
				//Assumption is that all the Healthy Kids TOAs have only one individual
				for (int i = 0; i < iLength; i++) {
					//Trigger T/R for each & every certified individual in the group
					if(arrEdIndvEligibilityCargoCurrEDM[i].getGroupInd() == IEdEligCodes.GROUP_IND_C){
						//BEGIN-BRGUS00178898-upadhyayulag-Change the alert id
						long alertId = 2023;
						//END-BRGUS00178898
						long caseNum = aEdEligibilityCargo.getCaseNum();
						long indvId = arrEdIndvEligibilityCargoCurrEDM[i].getIndvId();
						String alertType = "ED";
						AlEmployeeAlertCargo alEmployeeAlertCargo = new AlEmployeeAlertCargo();
						alEmployeeAlertCargo.setCaseNum(aEdEligibilityCargo.getCaseNum());
						alEmployeeAlertCargo.setProcessedDt(aEdEligibilityCargo.getEdbcRunDt());
						//Set the alert type as 'ED'
						alEmployeeAlertCargo.setAlertType(alertType);
						alEmployeeAlertCargo.setAlertId(alertId);
						alEmployeeAlertCargo.setAlertText(String.valueOf(indvId));
						//Delete the pending alerts prior to the current EDBC run date
						AlEmployeeAlertCollection alEmployeeAlertCollectionSearch;
						if(conn != null){
							alEmployeeAlertCollectionSearch = new AlEmployeeAlertCollection(conn);
							
						}else{
							alEmployeeAlertCollectionSearch = new AlEmployeeAlertCollection();
						}
						alEmployeeAlertCollectionSearch.setCargo(alEmployeeAlertCargo);
						AlEmployeeAlertCargo[] alEmployeeAlertCargosDel = 
							(AlEmployeeAlertCargo[])alEmployeeAlertCollectionSearch.select("findByCaseAlertIdTypeProcessDt");
						if(alEmployeeAlertCargosDel != null && alEmployeeAlertCargosDel.length > 0){
							//Delete the T/Rs previously created by EDBC but not disposed
							AlEmployeeAlertCollection alEmployeeAlertCollectionDel;
							if(conn != null){
								alEmployeeAlertCollectionDel = new AlEmployeeAlertCollection(conn);
							}else{
								alEmployeeAlertCollectionDel = new AlEmployeeAlertCollection();
							}
							alEmployeeAlertCollectionDel.setResults(alEmployeeAlertCargosDel);
							alEmployeeAlertCollectionDel.delete();
						}
						//Search for T/Rs created today
						AlEmployeeAlertCollection alEmployeeAlertCollection;
						if(conn != null){
							alEmployeeAlertCollection = new AlEmployeeAlertCollection(conn);
						}else{
							alEmployeeAlertCollection = new AlEmployeeAlertCollection();
						}
						alEmployeeAlertCollection.setCargo(alEmployeeAlertCargo);
						AlEmployeeAlertCargo[] alEmployeeAlertCargos = 
							(AlEmployeeAlertCargo[])alEmployeeAlertCollection.select("findByCaseAlertIdTypeTextProcessDt");
						if(alEmployeeAlertCargos == null || alEmployeeAlertCargos.length <= 0){
							//Create the T/R if not created on the same EDBC run date
							//for the same case for the same individual
							generateAlert(aEdEligibilityCargo, String.valueOf(alertId), alertType,
									indvId, caseNum, userId, conn);
						}
					}
				}
			}
		}
	}
	
	/**
	 * @param aEdEligibilityCargo
	 * @param alertId
	 * @param alertType
	 * @param indvId
	 * @param caseNum
	 * @param userId
	 * @param aConn
	 * @throws Exception
	 */
	private void generateAlert(EdEligibilityCargo aEdEligibilityCargo, String alertId, String alertType, 
			long indvId, long caseNum, String userId, Connection aConn)
	throws Exception {
		IAlerts _alGen = AlAlertManager.getInstance();
		//ArrayList employeeList = new ArrayList();//BRGUS00217436-upadhyayulag-FindBugs
		HashMap paramsMap = new HashMap();
		Timestamp currDate = DateComparisons.getLocalesTimestamp();
		/**
        * While Bach job run should not create a new connection and used the existing one
        * Begin BrgId: BRGUS00186643
        * UserId: SINGHALR        
       */
		DIOverrideBO diOverrideBO;
		if(aConn!=null){
			diOverrideBO = new DIOverrideBO(aConn);
		}else{
			diOverrideBO = new DIOverrideBO();
		}
		// End BRGUS00186643
		long empId  = diOverrideBO.getCaseEmpId(caseNum,currDate);
		if(empId == 0){
			throw new Exception ("Employee not found for case - "+caseNum);
		}
		paramsMap.put("EMP_ID",new Long(empId));
		paramsMap.put(AlConstants.ALERT_ID, Long.valueOf(alertId));
		paramsMap.put(AlConstants.CREATE_DT, new Timestamp(System
				.currentTimeMillis()));
		paramsMap.put(AlConstants.CURRENT_DATE, new Timestamp(System
				.currentTimeMillis()));
		paramsMap.put(AlConstants.CREATE_USER, userId);

		paramsMap.put("ALERT_TYPE", alertType);
		
		paramsMap.put(AlConstants.ADDITIONAL_ALERT_TEXT,String.valueOf(indvId));
		
		paramsMap.put(AlConstants.CASE_NUM, new Long(caseNum));
                                
        paramsMap.put("PROCESSED_DATE",aEdEligibilityCargo.getEdbcRunDt());
		
		paramsMap.put(AlConstants.CONNECTION, aConn);
		_alGen.generateAlert(paramsMap);
	}
	//END-BRGUS00168047
		  
	//Start BRGUS00185295 -singhh
	/**
	 * This method sets the benefit amount to zero if the individuals Eligibility
	 * is terminated or denied for STFS records.
	 * 
	 * @param eligDetailEDG
	 * @return void
	 * @throws none
	 */
	private void adjustBenefitAmountForSTFS(EligDetail[] eligDetailEDG) {

		if (eligDetailEDG != null){
			int length = eligDetailEDG.length;
			EdEligibilityCargo eligCargo = null;
	
			for (int i = 0; i < length; i++) {
				if (eligDetailEDG[i] != null){
					eligCargo = eligDetailEDG[i].getEdEligibilityCargo()[0];
					if (eligCargo != null) {
						if (IEdEligCodes.TP_71.equalsIgnoreCase(eligCargo.getTypeOfAssistanceCd()) &&
								(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(eligCargo.getCgStatusCd()) ||
								 IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(eligCargo.getCgStatusCd())) &&
								 (IEdEligCodes.EDBC_ACTION_CD_DENIED.equalsIgnoreCase(eligCargo.getEdbcActionCd()) ||
								 IEdEligCodes.EDBC_ACTION_CD_TERMINATED.equalsIgnoreCase(eligCargo.getEdbcActionCd()))
						   )
						{
							eligCargo.setBenefitAmt(0);
						//Start : ASPEN00039332 - Updated by Deepak Kumar for "TANF Diversion NOCA incorrect"
							eligCargo.setNetBenefitAmt(0);
							eligCargo.setStfsPotentialBenefitAmt(0);
						//End : ASPEN00039332 - Updated by Deepak Kumar for "TANF Diversion NOCA incorrect"
						}
					}
				}
			}
		}
	}
	//end BRGUS00185295

	/**
	 * @param overrideFields
	 * @param edgOverrideDetailsCollection
	 * @return
	 */
	private HashMap populateOverrideFields(HashMap overrideFields, 
			EdEdgOverrideDetailsCollection edgOverrideDetailsCollection) throws Exception{
		if(edgOverrideDetailsCollection != null && edgOverrideDetailsCollection.getResultsSize() > 0){
			int size = edgOverrideDetailsCollection.getResultsSize();
			for(int i = 0; i < size; i++){
				EdEdgOverrideDetailsCargo fieldCargo = edgOverrideDetailsCollection.getResults(i);
				long caseNum = fieldCargo.getCaseNum();
				long edgNum = fieldCargo.getEdgNum();
				String overrideCd = fieldCargo.getOvrdCd();
				String programCd = fieldCargo.getProgramCd();
				long indvId = fieldCargo.getIndvId();
				String overrideFieldNewVal = fieldCargo.getOvrdFldNewVal();
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				if(overrideCd.equals("03")){//Benefit Amount
					overrideFields.put("Benefit Amount",overrideFieldNewVal);
				}else if(overrideCd.equals("05")){//EDG Status
					overrideFields.put("EDG Status",overrideFieldNewVal);
				}else if(overrideCd.equals("12")){//Remaining Deductible Amount
					overrideFields.put("Remaining Deductible Amount",overrideFieldNewVal);
				}else if(overrideCd.equals("13")){//Deductible Met Date
					java.util.Date date = sdf.parse(overrideFieldNewVal);
					overrideFields.put("Deductible Met Date",new java.sql.Timestamp(date.getTime()));
				}else if(overrideCd.equals("14")){//TMAP Premium Amount
					overrideFields.put("TMAP Premium Amount",overrideFieldNewVal);
				}else if(overrideCd.equals("15")){//FTW Premium Amount
					overrideFields.put("FTW Premium Amount",overrideFieldNewVal);
				}else if(overrideCd.equals("16")){//Patient Pay Amount
					overrideFields.put("Patient Pay Amount",overrideFieldNewVal);
				}else if(overrideCd.equals("29")){//Group Funding Source
					overrideFields.put("Group Funding Source",overrideFieldNewVal);
				}else if(overrideCd.equals("31")){//Type Of Assistance
					overrideFields.put("Type Of Assistance",overrideFieldNewVal);
				}else if(overrideCd.equals("37")){//Funding Source
					overrideFields.put("Funding Source",overrideFieldNewVal);
				}else if(overrideCd.equals("38")){//EFIP Indicator
					overrideFields.put("EFIP Indicator",overrideFieldNewVal);
				}
			}
		}
		return overrideFields;
	}
	
	/**
	 * @param field
	 * @param edgOverrideDetailsCollection
	 * @param eligDetailCurrEDM
	 * @return
	 * @throws Exception
	 */
	private void overrideField(String field, EdEdgOverrideDetailsCollection edgOverrideDetailsCollection, 
			EligDetail eligDetailCurrEDM, EgDataHandler egDataHandler) throws Exception{
		
		boolean fieldOverridden = false;
		if(edgOverrideDetailsCollection != null && edgOverrideDetailsCollection.getResultsSize() > 0){
			int size = edgOverrideDetailsCollection.getResultsSize();
			if(field != null){
				field = field.trim();
			}else{
				field = "";
			}
			if(!field.equals("")){
				for (int i = 0; i < size; i++) {
					EdEdgOverrideDetailsCargo fieldCargo = edgOverrideDetailsCollection.getResults(i);
					long caseNum = fieldCargo.getCaseNum();
					long edgNum = fieldCargo.getEdgNum();
					long overrideId = fieldCargo.getOvrdId();
					String overrideCd = fieldCargo.getOvrdCd();
					String programCd = fieldCargo.getProgramCd();
					long serviceReqNum = fieldCargo.getServiceReqNum();
					long serviceReqSeqNum = fieldCargo.getServiceReqSeqNum();
					String serviceCd = "";
					if(fieldCargo.getServiceCd() != null && !fieldCargo.getServiceCd().equals("")){
						serviceCd = fieldCargo.getServiceCd();
					}
					long pspId = fieldCargo.getPspId();
					long serviceId = fieldCargo.getServiceId();
					long indvId = fieldCargo.getIndvId();
					String overrideFieldNewVal = fieldCargo.getOvrdFldNewVal();
					if((caseNum == eligDetailCurrEDM.getEdEligibilityCargo()[0].getCaseNum()) 
							&& (edgNum == eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgNum())){
						if(overrideCd.equals("03") && field.equals("Benefit Amount")){//Benefit Amount
							// ASPEN00060947 - Parma - added check - LIHEAP should not be overridden for ongoing month
							/*if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
																	eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() != null)*/
							//ASPEN00068805 - kumard - Additional changes LIHEAP override by worker approving LIHEAP ongoing
							if(!(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
									eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null))
							{
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setBenefitAmt
								(Double.parseDouble(overrideFieldNewVal));
								//ASPEN00043818 - Update ne benefit amount at override process
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setNetBenefitAmt
								(Double.parseDouble(overrideFieldNewVal));
								//ASPEN00043818 - End
								if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().
										equals(IEdEligCodes.PROGRAM_CD_TANF)){
									if(eligDetailCurrEDM.getEdEligTanfBudgetCargo() != null 
											&& eligDetailCurrEDM.getEdEligTanfBudgetCargo().length > 0){
										eligDetailCurrEDM.getEdEligTanfBudgetCargo()[0].setGrantAmt
										(Double.parseDouble(overrideFieldNewVal));
									}
									if(eligDetailCurrEDM.getEdIndvTanfBudgetCargo() != null 
											&& eligDetailCurrEDM.getEdIndvTanfBudgetCargo().length > 0){
										int indvTanfBudgetLen = eligDetailCurrEDM.getEdIndvTanfBudgetCargo().length;
										if(egDataHandler != null && egDataHandler.getEdIndvInfo() != null
												&& egDataHandler.getEdIndvInfo().getDcHeadOfHouseholdCargo() != null){
											HashMap hohMap = egDataHandler.getEdDcUtil().
											getDcHeadOfHouseholdInfoMonthlyHMEOM();
	
											Set se = hohMap.keySet();
											Iterator it = se.iterator();
	
											Long hohIndv = null;
											while (it.hasNext()) {
												hohIndv = (Long) it.next();
											}
											
											if(hohIndv != null){
												for (int j = 0; j < indvTanfBudgetLen; j++) {
													if(eligDetailCurrEDM.getEdIndvTanfBudgetCargo()[j].getIndvId() 
															== hohIndv.longValue()){
														eligDetailCurrEDM.getEdIndvTanfBudgetCargo()[j].
														setCntblFsTanfGrantAmt(Double.parseDouble(overrideFieldNewVal));
														break;
													}
												}
											}
										}
									}
								}
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
								fieldOverridden = true;
								break;
					    	}
						}else if(overrideCd.equals("04") && field.equals("Benefit Status")){//Benefit Status
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setBenefitStatus(overrideFieldNewVal);
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
							fieldOverridden = true;
							break;
						}else if(overrideCd.equals("05") && field.equals("EDG Status")){//EDG Status
							// ASPEN00060947 - Parma - added check - LIHEAP should not be overridden for ongoing month
							   /*if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
																	eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() != null)*/
							//ASPEN00068805 - kumard - Additional changes LIHEAP override by worker approving LIHEAP ongoing
							if(!(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
									eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null))
							   {
									eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgStatusCd(overrideFieldNewVal);
									//BEGIN-BRGUS00191877-upadhyayulag-CG_ELIG_RSLT_CD should be overridden 
									//corresponding to CG_STATUS_CD
									if(overrideFieldNewVal.equalsIgnoreCase(IEdEligCodes.STATUS_CD_APPROVED)){
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
										(IEdEligCodes.ELIG_RSLT_CD_PASS);
									}else if((overrideFieldNewVal.equalsIgnoreCase(IEdEligCodes.STATUS_CD_DENIED)) 
											|| (overrideFieldNewVal.equalsIgnoreCase(IEdEligCodes.STATUS_CD_TERMINATED))){
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
										(IEdEligCodes.ELIG_RSLT_CD_FAIL);
										
									}else if(overrideFieldNewVal.equalsIgnoreCase(IEdEligCodes.STATUS_CD_PENDING)){
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgEligRsltCd
										(IEdEligCodes.ELIG_RSLT_CD_PENDING);
									}
									//END-BRGUS00191877
									eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
									fieldOverridden = true;
									break;
							   }
						}else if(overrideCd.equals("07") && field.equals("Participation Status")){
							//Participation Status
							// ASPEN00060947 - Parma - added check - LIHEAP should not be overridden for ongoing month
							/*if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
																	eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() != null)*/
							//ASPEN00068805 - kumard - Additional changes LIHEAP override by worker approving LIHEAP ongoing
							if(!(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
									eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null))
							{
							if(eligDetailCurrEDM.getEdIndvEligibilityCargo() != null){
								int edIndv_Coll_Size = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
								for(int j = 0; j < edIndv_Coll_Size; j++){
									if(eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getIndvId() == indvId){
										String oldPartStatusCd = 
											eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getPartStatusCd().trim();
										long oldCgSize = eligDetailCurrEDM.getEdEligibilityCargo()[0].getCgSize();
										if(oldPartStatusCd.equals("EA") || oldPartStatusCd.equals("EC")){
											if(overrideFieldNewVal.equals("EA") 
													|| overrideFieldNewVal.equals("EC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('C');
											}else if(overrideFieldNewVal.equals("XA") 
													|| overrideFieldNewVal.equals("XC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('X');
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_FAIL);
												//BEGIN-BRGUS00209965-upadhyayulag-Set NF_ELIG_RSLT_CD as well to Fail
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setNfEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_FAIL);
												//END-BRGUS00209965
												eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgSize(oldCgSize-1);
											}else{
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('E');
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_FAIL);
												eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgSize(oldCgSize-1);
											}
										}else if(oldPartStatusCd.equals("XA") || oldPartStatusCd.equals("XC")){
											if(overrideFieldNewVal.equals("EA") 
													|| overrideFieldNewVal.equals("EC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('C');
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_PASS);
												//BEGIN-BRGUS00209965-upadhyayulag-Set NF_ELIG_RSLT_CD as well to Pass
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setNfEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_PASS);
												//END-BRGUS00209965
												eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgSize(oldCgSize+1);
											}else if(overrideFieldNewVal.equals("XA") 
													|| overrideFieldNewVal.equals("XC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('X');
											}else{
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('E');
											}
										}else{
											if(overrideFieldNewVal.equals("EA") 
													|| overrideFieldNewVal.equals("EC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('C');
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_PASS);
												//BEGIN-BRGUS00209965-upadhyayulag-Set NF_ELIG_RSLT_CD as well to Pass
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setNfEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_PASS);
												//END-BRGUS00209965
												eligDetailCurrEDM.getEdEligibilityCargo()[0].setCgSize(oldCgSize+1);
											}else if(overrideFieldNewVal.equals("XA") 
													|| overrideFieldNewVal.equals("XC")){
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('X');
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_FAIL);
												//BEGIN-BRGUS00209965-upadhyayulag-Set NF_ELIG_RSLT_CD as well to Fail
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setNfEligRsltCd
												(IEdEligCodes.ELIG_RSLT_CD_FAIL);
												//END-BRGUS00209965
											}else{
												eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setGroupInd('E');
											}
										}
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setPartStatusCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
						}
							//break;
						}else if(overrideCd.equals("08") && field.equals("Scope")){//Scope
							if(eligDetailCurrEDM.getEdIndvEligibilityCargo() != null){
								int edIndv_Coll_Size = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
								for(int j = 0; j < edIndv_Coll_Size; j++){
									if(eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getIndvId() == indvId){
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setMaScopeCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("09") && field.equals("Coverage")){//Coverage
							if(eligDetailCurrEDM.getEdIndvEligibilityCargo() != null){
								int edIndv_Coll_Size = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
								for(int j = 0; j < edIndv_Coll_Size; j++){
									if(eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getIndvId() == indvId){
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setMaCoverageCd
										(overrideFieldNewVal.charAt(0));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("10") && field.equals("Work Participation Status")){
							//Work Participation Status
							if(eligDetailCurrEDM.getEdIndvEligibilityCargo() != null){
								int edIndv_Coll_Size = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
								for(int j = 0; j < edIndv_Coll_Size; j++){
									if(eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getIndvId() == indvId){
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEtRegInd
										(overrideFieldNewVal.charAt(0));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("11") && field.equals("Work Participation Reason")){
							//Work Participation Reason
							if(eligDetailCurrEDM.getEdIndvEligibilityCargo() != null){
								int edIndv_Coll_Size = eligDetailCurrEDM.getEdIndvEligibilityCargo().length;
								for(int j = 0; j < edIndv_Coll_Size; j++){
									if(eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].getIndvId() == indvId){
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEtExemptRsnCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdIndvEligibilityCargo()[j].setEtActTypeCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("12") && field.equals("Remaining Deductible Amount")){
							//Remaining Deductible Amount
							if(eligDetailCurrEDM.getEdEligMeBudgetCargo() != null){
								eligDetailCurrEDM.getEdEligMeBudgetCargo()[0].setRemDeductibleAmt
								(Double.parseDouble(overrideFieldNewVal));
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
								fieldOverridden = true;
							}
							break;
						}else if(overrideCd.equals("13") && field.equals("Deductible Met Date")){
							//Deductible Met Date
							SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
							java.util.Date date = formatter.parse(overrideFieldNewVal);
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setSpendDownMetDt
							(new java.sql.Timestamp(date.getTime()));
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
							fieldOverridden = true;
							break;
						}else if(overrideCd.equals("14") && field.equals("TMAP Premium Amount")){
							//TMAP Premium Amount
							if(eligDetailCurrEDM.getEdEligTanfBudgetCargo() != null){
								eligDetailCurrEDM.getEdEligTanfBudgetCargo()[0].setPremiumAmt
								(Double.parseDouble(overrideFieldNewVal));
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
								fieldOverridden = true;
							}
							break;
						}else if(overrideCd.equals("15") && field.equals("FTW Premium Amount")){
							//FTW Premium Amount
							if(eligDetailCurrEDM.getEdEligMeBudgetCargo() != null){
								eligDetailCurrEDM.getEdEligMeBudgetCargo()[0].setFtwMonthlyPremiumAmt
								(Double.parseDouble(overrideFieldNewVal));
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
								fieldOverridden = true;
							}
							break;
						}else if(overrideCd.equals("16") && field.equals("Patient Pay Amount")){
							//Patient Pay Amount
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setCopayAmt
							(Double.parseDouble(overrideFieldNewVal));
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
							fieldOverridden = true;
							break;
						}else if(overrideCd.equals("17") && field.equals("Eligibility/Need Reason")){
							//Eligibility/Need Reason
							if(eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null){
								int cdcCollectionSize = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length;
								for (int j = 0; j < cdcCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getServiceId() == serviceId 
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].
											getChildIndvId() == indvId
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getPspId() == pspId){
										eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setEligCategoryCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							break;
						}else if(overrideCd.equals("18") && field.equals("Authorized Hours")){//Authorized Hours
							if(eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null){
								int cdcCollectionSize = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length;
								for (int j = 0; j < cdcCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getServiceId() == serviceId 
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].
											getChildIndvId() == indvId
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getPspId() == pspId){
										eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setAuthHours
										(Long.parseLong(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							break;
						}else if(overrideCd.equals("19") && field.equals("Department Pay Percentage")){
							//Department Pay Percentage
							if(eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null){
								int cdcCollectionSize = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length;
								for (int j = 0; j < cdcCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getServiceId() == serviceId 
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].
											getChildIndvId() == indvId
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getPspId() == pspId){
										eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setDeptPayPercentage
										(Long.parseLong(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							break;
						}else if(overrideCd.equals("20") && field.equals("SER Service Eligibility Status")){
							//SER Service Eligibility Status
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setServiceResultCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("21") && field.equals("Request Amount")){//Request Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setNeedAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("22") && field.equals("Shortfall Amount")){//Shortfall Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setAllocatedShortfallAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("23") && field.equals("Co-payment Amount")){//Co-payment Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setAllocatedCopayAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("24") && field.equals("Client Contribution Amount")){
							//Client Contribution Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setActClntCtrbToUnmetNdAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}    
							}
							//break;
						}else if(overrideCd.equals("25") && field.equals("Prorated Amount")){//Prorated Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setProrateSerPayAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("26") && field.equals("Final Payment Amount")){
							//Final Payment Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setFinalSerPayAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("27") && field.equals("CDC Service Eligibility Status")){
							//CDC Service Eligibility Status
							if(eligDetailCurrEDM.getEdIndvCdcServiceAuth() != null){
								int cdcCollectionSize = eligDetailCurrEDM.getEdIndvCdcServiceAuth().length;
								for (int j = 0; j < cdcCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getServiceId() == serviceId 
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].
											getChildIndvId() == indvId
											&& eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].getPspId() == pspId){
										eligDetailCurrEDM.getEdIndvCdcServiceAuth()[j].setServiceRsltCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							break;
						}else if(overrideCd.equals("28") && field.equals("Specialist Approved Status")){
							//Specialist Approved Status
						}else if(overrideCd.equals("29") && field.equals("Group Funding Source")){
							//Group Funding Source
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setFundingSourceCd(overrideFieldNewVal);
							fieldOverridden = true;
							break;
						}else if(overrideCd.equals("30") && field.equals("Service Result")){//Service Result
							if(eligDetailCurrEDM.getEdIndvDssServiceAuthCargo() != null){
								int dssCollectionSize = eligDetailCurrEDM.getEdIndvDssServiceAuthCargo().length;
								for (int j = 0; j < dssCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j].
											getServiceReqNum() == serviceReqNum){
										eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j].setServiceResultCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("31") && field.equals("Type Of Assistance")){//Type Of Assistance
							String oldToa = eligDetailCurrEDM.getEdEligibilityCargo()[0].getTypeOfAssistanceCd();
							if(oldToa.equals(IEdEligCodes.TP_08) || oldToa.equals(IEdEligCodes.TP_RUMM) 
									|| oldToa.equals(IEdEligCodes.TA31) || oldToa.equals(IEdEligCodes.TMAP)
									|| oldToa.equals(IEdEligCodes.TP_07)){
								if(!overrideFieldNewVal.equals(IEdEligCodes.TP_08) 
										&& !overrideFieldNewVal.equals(IEdEligCodes.TP_RUMM)
										&& !overrideFieldNewVal.equals(IEdEligCodes.TA31)
										&& !overrideFieldNewVal.equals(IEdEligCodes.TMAP)
										&& !overrideFieldNewVal.equals(IEdEligCodes.TP_07)){
									eligDetailCurrEDM.setEdEligFmaBudgetCargo(null);
									eligDetailCurrEDM.setEdIndvFmaBudgetCargo(null);
								}
							}
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setTypeOfAssistanceCd(overrideFieldNewVal);
							//BEGIN-BRGUS00233262-upadhyayulag-Change the program code as per the new TOA
							String newProgramCode = ReferenceTableManager.getValueByColumn(true,"EDTOA",
									overrideFieldNewVal,"PROGRAMCD");
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setProgramCd(newProgramCode);
							//END-BRGUS00233262
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
							fieldOverridden = true;
							break;
						}else if(overrideCd.equals("32") && field.equals("Emergency Resolved")){//Emergency Resolved
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setResolveEmerSw
										(overrideFieldNewVal.charAt(0));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("34") && field.equals("Override Amount")){//Override Amount
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setOverrideAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("35") && field.equals("Override Service Code")){
							//Override Service Code
							if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
								int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
								for (int j = 0; j < serCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
											getServiceReqSeqNum() == serviceReqSeqNum){
										eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setOverrideServiceCd
										(overrideFieldNewVal);
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("36") && field.equals("Service Payment Amount")){
							//Service Payment Amount
							if(eligDetailCurrEDM.getEdIndvDssServiceAuthCargo() != null){
								int dssCollectionSize = eligDetailCurrEDM.getEdIndvDssServiceAuthCargo().length;
								for (int j = 0; j < dssCollectionSize; j++) {
									if(eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j].
											getServiceReqNum() == serviceReqNum){
										eligDetailCurrEDM.getEdIndvDssServiceAuthCargo()[j].setServicePaymentAmt
										(Double.parseDouble(overrideFieldNewVal));
										eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
										fieldOverridden = true;
									}
								}
							}
							//break;
						}else if(overrideCd.equals("37") && field.equals("Funding Source")){//Funding Source
							if(programCd.equals("SE")){
								if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
									int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
									for (int j = 0; j < serCollectionSize; j++) {
										if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].
												getServiceReqSeqNum() == serviceReqSeqNum){
											eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setFundingInd
											(overrideFieldNewVal.charAt(0));
											eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
											fieldOverridden = true;
										}
									}
								}
								//break;
							}else{
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setStateFundingInd
								(overrideFieldNewVal.charAt(0));
								eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
								fieldOverridden = true;
							}
							//break;
						}else if(overrideCd.equals("38") && field.equals("EFIP Indicator")){//EFIP Indicator
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEfipEligSw(overrideFieldNewVal.charAt(0));
							eligDetailCurrEDM.getEdEligibilityCargo()[0].setEdgOverrideSw('Y');
							fieldOverridden = true;
							break;
						}
					}
				}
			}
			//BEGIN-BRGUS00191877-upadhyayulag-Adverse action should be allowed when override is present
			if(fieldOverridden){
				// ASPEN00060947 - Parma - added check - LIHEAP should not be overridden for ongoing month
				/*if(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
														eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() != null)
				*/
				//ASPEN00068805 - kumard - Additional changes LIHEAP override by worker approving LIHEAP ongoing
				if(!(eligDetailCurrEDM.getEdEligibilityCargo()[0].getProgramCd().equalsIgnoreCase("SE") && 
						eligDetailCurrEDM.getEdEligibilityCargo()[0].getPaymentEndDt() == null))
				{
				eligDetailCurrEDM.getEdEligibilityCargo()[0].setAdverseActionAllowedSw('Y');
				}
			}
			//END-BRGUS00191877
		}
	}
	
	//BEGIN-BRGUS00224819-upadhyayulag
	/** Method checkFundingSource is used to check & modify if funding source is 
	 * present for SER service records when overridden
	 * @param eligDetailCurrEDM contains the current EligDetail structure
	 * @throws Exception
	 */
	private void checkFundingSource(EligDetail eligDetailCurrEDM) throws Exception{
		if(eligDetailCurrEDM != null 
				&& eligDetailCurrEDM.getEdEligibilityCargo() != null
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgOverrideSw() != 0
				&& eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgOverrideSw() == 'Y'){
			if(eligDetailCurrEDM.getEdEligSerServiceAuth() != null){
				int serCollectionSize = eligDetailCurrEDM.getEdEligSerServiceAuth().length;
				for (int j = 0; j < serCollectionSize; j++) {
					if(eligDetailCurrEDM.getEdEligSerServiceAuth()[j].getFundingInd() == '\u0000'){
						eligDetailCurrEDM.getEdEligSerServiceAuth()[j].setFundingInd('F');
					}
				}
			}
		}
	}
	//END-BRGUS00224819
	
	/**
	 * Begin:BRGUS00191175
	 * UserId: GANTAC
	 * Date:09/24/2009	 
	 * EDBC Performance Changes: MU Trigger From Online.
	 * @param aMapRequest
	 * @param conn
	 * @throws EDBCException
	 * @throws TIERSValidationException
	 */
	
	private void showOnlineBatchResults(Map aMapRequest, Connection conn)
			throws EDBCException, TIERSValidationException {
		EdOnlineTriggerCollection mctcoll = null;
		EdOnlineTriggerCargo[] mct = null;
		long onlineBatchStartTime = 0;
		boolean batchCompleted = false;
		Long onlineSeqNum = (Long) aMapRequest.get("ONLINEBATCHSEQNUM");
		Object[] objLst = new Object[2];
		objLst[0] = (Long) aMapRequest.get(DIConstants.CASE_NUM);
		objLst[1] = onlineSeqNum;
		
		String statusChkInterval = null;
		String waitTimeCheckCount = null;
		long sleepTime = 0;
		long waitTimeCheckLoop = 0;
		if (aMapRequest.get(DiAttributes.STATUS_CHECK_INTERVAL) != null) {
			statusChkInterval = (String) aMapRequest
					.get(DiAttributes.STATUS_CHECK_INTERVAL);
			sleepTime = Long.valueOf(statusChkInterval).longValue() * 1000;
		}
		if (aMapRequest.get(DiAttributes.WAIT_TIME_IN_MINUTES) != null) {
			waitTimeCheckCount = (String) aMapRequest
					.get(DiAttributes.WAIT_TIME_IN_MINUTES);
			waitTimeCheckLoop = Long.valueOf(waitTimeCheckCount).longValue();			
		}
		onlineBatchStartTime = System.currentTimeMillis();
		while (!batchCompleted && ((System.currentTimeMillis() - onlineBatchStartTime)/60000) < waitTimeCheckLoop) {
			try {
				mctcoll = new EdOnlineTriggerCollection(conn);
				mct = (EdOnlineTriggerCargo[]) mctcoll.select(
						"findByCaseCurSeqNumber", objLst);  
				if (mct.length > 0
						&& (mct[0].getStatusInd() != EDGConstants.blank && (mct[0]
								.getStatusInd() == 'E' || mct[0].getStatusInd() == 'S'))) {
					batchCompleted = true;
				}				
			} catch (Exception e) {
				logger.log("massupdate", ILog.FATAL, "MuDataHandler"
						+ "updateMUStatus" + e.getMessage());
				throw new DataException(DataException.MAJOR, "MuDataHandler",
						"updateMUStatus",
						"Some java.lang.Exception from coll.select(..)", e);
			}
			if (!batchCompleted) {
				try {
					Thread.sleep(sleepTime);
				} catch (InterruptedException e1) {
					logger.log("massupdate", ILog.FATAL, "MuDataHandler"
							+ "Error While Waiting Time" + e1.getMessage());
				}
			}
		}

		if (batchCompleted && mct[0].getStatusInd() == 'S') {
			;       
		} else {
			try {
				ArrayList alError = new ArrayList();
				ArrayList alPlaces = new ArrayList();
				StringBuffer sb = new StringBuffer();
				if (mct != null && mct[0].getStatusInd() == 'E' && 
						mct[0].getExceptionDetails() != null) {
					String msg = mct[0].getExceptionDetails().replaceAll("\"","");
					if(msg.indexOf("~")>0){
						String[] exceptionSplit = msg.split("~");
						if(exceptionSplit!=null && exceptionSplit.length>0){
							String exceptionNum = msg.substring(0,msg.indexOf(" "));
							String exceptionMsg = msg.substring(msg.indexOf("|"),msg.length());
							if(exceptionNum!=null && exceptionNum.length()>0)
								alError.add(exceptionNum);
							if(exceptionMsg!=null && exceptionMsg.length()>0){
								sb.append(exceptionMsg);
							}else{
								sb.append(mct[0].getExceptionDetails());
							}
						}
					}else{
						alError.add("4032");		
						/**
						 * Begin:BRGUS00191175
						 * UserId: GANTAC
						 * Date:10/28/2009
						 * Correct message to display on EDBC Eun Eligibility Screen	 
						 */
						sb.append(msg);
					}
				}else {					
					sb.append("In Manual Cascade mode");
					alError.add("7005");
				}				
				alPlaces.add(sb.toString());
				throw new TIERSValidationException(alError, alPlaces);
			} catch (TIERSValidationException tve) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, tve);
				throw tve;
			} 
		}

	}
	
	//BEGIN-BRGUS00243082-upadhyayulag-New method to perform Ex-Parte review
	/**
	 * The method performExParteReview is used to check if Ex-Parte review is required
	 * for individuals whose medicaid is closed
	 *
	 * @param aMapRequest Map
	 * @throws Exception
	 */
	public void performExParteReview(Map aMapRequest) throws Exception {
		//load the data using the datahandler
		String aSReqModSw = (String) aMapRequest.get(IEdEligCodes.REQUEST_MODULE_SWITCH);
		long aLCaseNum = ((Long) aMapRequest.get(IEdEligCodes.REQUEST_CASE_NUM)).longValue(); 
		String aSUserId = (String) aMapRequest.get(IEdEligCodes.SESSION_USER_ID);
		Connection conn = (Connection) aMapRequest.get(IEdEligCodes.REQUEST_CONNECTION);
		
		EgDataHandler egDataHandler = new EgDataHandler();
		egDataHandler.setModuleSw(aSReqModSw);
		egDataHandler.setFSOverrideSw((String) aMapRequest
				.get(IEdEligCodes.FS_OVERRIDES));
		egDataHandler.loadEligDetail(aLCaseNum, conn);
		try {
			String exParteSwFromProperties = FwPropertyLoader.getPropertyOf(
					IEdEligCodes.TIERS_PROPERTIES, IEdEligCodes.EX_PARTE_REVIEW_SW);
			if(exParteSwFromProperties.charAt(0) == IEdEligCodes.YES){
				EgDataHandler egDataHandlerExParte = new EgDataHandler();
				egDataHandlerExParte.loadEligDetailForExParteReview(aLCaseNum, conn);
				EdDriverHelper.processExParteReview(egDataHandler, egDataHandlerExParte);
				egDataHandlerExParte.writeEligDetailExParteReview(
						egDataHandlerExParte, aSUserId, conn);
			}
		} catch (Exception e) {
			// TODO: handle exception
		}
	}
	//END-BRGUS00243082
	
// BRGUS00251500 rampurkara merging from DEV-CR2	
	//BRGUS00229515 - kucherlapatis - 04/07/2010 - Added to reset chip referral sw for AD-Care
	/** 
	 *  Method resetChipReferralSw is used to reset chipReferralSw when the child 
	 *  goes to AD-Care after healthy kids is denied
	 * 
	 *  @param arrEligDetailoutput
	 *  @throws EDBCException
	 */
	private void resetChipReferralSw(EligDetail[] arrEligDetailoutput)
			throws EDBCException {

		int iLength = 0;
		int iEligLength = 0;
		int iIndvLength = 0;
		if (arrEligDetailoutput != null) {
			int ilength = arrEligDetailoutput.length;
			for (int k = 0; k < ilength; k++) {
				EligDetail eligDetail = arrEligDetailoutput[k];
				EdEligibilityCargo[] edEligibilityCargo = eligDetail
						.getEdEligibilityCargo();
				EdIndvEligibilityCargo[] edIndvEligibilityCargo = eligDetail
						.getEdIndvEligibilityCargo();

				if (edEligibilityCargo != null) {
					iEligLength = edEligibilityCargo.length;
				}
				if (edIndvEligibilityCargo != null) {
					iIndvLength = edIndvEligibilityCargo.length;
				}

				for (int i = 0; i < iEligLength; i++) {
					if (edEligibilityCargo[i].getProgramCd().equalsIgnoreCase(
							IEdEligCodes.PROGRAM_CD_ME)) {
						if (edEligibilityCargo[i].getTypeOfAssistanceCd()
								.equalsIgnoreCase(IEdEligCodes.ADMA)) {
							if (edEligibilityCargo[i].getCgStatusCd()
									.equalsIgnoreCase(
											IEdEligCodes.STATUS_CD_APPROVED)) {
								if (edEligibilityCargo[i].getChipReferralSw() == 'Y') {
									for (int j = 0; j < iIndvLength; j++) {
										if (edEligibilityCargo[i]
												.getEdgTraceId() == edIndvEligibilityCargo[j]
												.getEdgTraceId()) {
											if (edIndvEligibilityCargo[j]
													.getGroupInd() == 'C') {
												if (edIndvEligibilityCargo[j]
														.getPartStatusCd()
														.equalsIgnoreCase(
																IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT)
														|| edIndvEligibilityCargo[j]
																.getPartStatusCd()
																.equalsIgnoreCase(
																		IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD)) {
													if (edIndvEligibilityCargo[j]
															.getChipReferralSw() == 'Y') {
														edEligibilityCargo[i]
																.setChipReferralSw('N');
														edIndvEligibilityCargo[j]
																.setChipReferralSw('N');
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}// end BRGUS00251500	
	
	/** <BRGUS00259961><kucherlapatis><03/17/2011>
	 * <When a child is removed from the group retroactively and certified, eligibility is coming up with correct eligbility end dates.
	 * When the same case is run again for the retro months, eligbility is coming up with new eligbility end date. So, fix is made to
	 * check for auth hours when running for retro months for the failed individual> 
	 * 
	 * @param aEgDataHandler
	 * @param aEdIndvligbilityCargo
	 * @return boolean
	 * @throws EDBCException
	 */
	public boolean isCDCAuthHrsZero(EgDataHandler aEgDataHandler,
			EdIndvEligibilityCargo aEdIndvligbilityCargo) throws EDBCException {

		int iLength = 0;
		EdIndvCdcServiceAuthCargo[] authEdIndvCDCSerAuthCargo = null;
		if (aEgDataHandler != null
				&& aEgDataHandler.getEligDetailAllAuth()
						.getEdIndvCdcServiceAuth() != null) {
			authEdIndvCDCSerAuthCargo = aEgDataHandler.getEligDetailAllAuth()
					.getEdIndvCdcServiceAuth();
		}
		if (authEdIndvCDCSerAuthCargo != null
				&& authEdIndvCDCSerAuthCargo.length > 0) {
			iLength = authEdIndvCDCSerAuthCargo.length;
		}

		if (authEdIndvCDCSerAuthCargo != null && aEdIndvligbilityCargo != null) {
			for (int i = 0; i < iLength; i++) {
				if (aEdIndvligbilityCargo.getIndvId() == authEdIndvCDCSerAuthCargo[i]
						.getChildIndvId()) {
					if (aEdIndvligbilityCargo.getEdgTraceId() == authEdIndvCDCSerAuthCargo[i]
							.getEdgTraceId()) {
						if (authEdIndvCDCSerAuthCargo[i].getServiceRsltCd()
								.equalsIgnoreCase(IEdEligCodes.PASS)) {
							if (authEdIndvCDCSerAuthCargo[i].getAuthHours() == 0) {
								if (authEdIndvCDCSerAuthCargo[i]
										.getEdbcActionCd() != null
										&& authEdIndvCDCSerAuthCargo[i]
												.getEdbcActionCd()
												.equalsIgnoreCase(
														IEdEligCodes.EDBC_ACTION_CD_APPROVED)) {
									return true;
								}
							}
						}
					}
				}
			}
		}
		return false;
	}
	
	// beniwala - ASPEN00017459
	/**
	 * determine cert period for GA Disability.  
	 * a. for set Set Term, cert period is earlier of End Date and EDM+8 months
	 * b. For variable Term, cert period is earlier of Review Due Date and EDM+12 months
	 * @param aEdEligibilityCargo
	 * @throws EDBCException 
	 */
	// Begin - beniwala - ASPEN00032273
	private static void detGADCCertDate(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler egDataHandler, EdIndvEligibilityCargo[] 
			aEdIndvEligibilityCargos) throws EDBCException {	
		if(aEdIndvEligibilityCargos != null && aEdEligibilityCargo != null && egDataHandler != null) {
			/*String termType = aEdEligibilityCargo.getSplToaCd();
			if (termType != null && !"".equalsIgnoreCase(termType.trim())) {*/
				for(EdIndvEligibilityCargo edIndvEligibilityCargo:aEdIndvEligibilityCargos) {
					// GA-Disability EDG is formed for this individual
					if(edIndvEligibilityCargo != null && IEdEligCodes.PART_STATUS_CD_ELIGIBLE_ADULT.equalsIgnoreCase(
							edIndvEligibilityCargo.getPartStatusCd())) {
						// fetch dcDisabilityDetermination record for this individual and set cert period based on type (Set/Variable)
						DcDisableDeterminationCargo arrDcDisableDeterminationCargo[] = (DcDisableDeterminationCargo[]) egDataHandler.
								getEdDcUtil().getDcDisableDeterminationInfoMonthlyHM().get(new Long(edIndvEligibilityCargo.getIndvId()));
						if(arrDcDisableDeterminationCargo != null) {
							for(DcDisableDeterminationCargo dcDisableDetermCargo:arrDcDisableDeterminationCargo) {
								if(dcDisableDetermCargo != null) {
									try {
										char termType = dcDisableDetermCargo.getTermInd();
										if(termType != IEdEligCodes.CHAR_INIT_SPACE) {
											if(EDBCConstants.TERM_TYPE_SET == termType) {
												Timestamp endDate = dcDisableDetermCargo.getTermEndDt();
												Timestamp edm8Months = DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 7);
												setEarlierCertEndDate(aEdEligibilityCargo, endDate, edm8Months);
												return;
											}
											else if(EDBCConstants.TERM_TYPE_VARIABLE == termType) {
												Timestamp reviewEndDate = dcDisableDetermCargo.getDisabilityReviewDueDt();
												Timestamp edm12Months = DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 11);
												setEarlierCertEndDate(aEdEligibilityCargo, reviewEndDate, edm12Months);
												return;
											}
										} 									
									} catch(EDBCException e) {
										EDBCLogger.writeExceptionStackTrace(
												DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
										throw new EDBCException(EDBCException.MAJOR, "EdUtil",
												"detGADCCertDate", e);
									}
								}
							}
						}
						/*if (String.valueOf(EDBCConstants.TERM_TYPE_SET).equalsIgnoreCase(termType)) {
							aEdEligibilityCargo.setCertEndDt(DateComparisons.
									getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 7)));
						} else if (String.valueOf(EDBCConstants.TERM_TYPE_VARIABLE).equalsIgnoreCase(termType)) {
							aEdEligibilityCargo.setCertEndDt(DateComparisons.
									getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 11)));
						}*/
					}					
				}
			//}
		}		
	}
	
	
	// Begin - beniwala - ASPEN00017552
	/**
	 * determine EDBC Action Cd as No Issue Change if required
	 * @param aEdEligibilityCargo
	 * @param aEdEligNoticeReasonsCargo
	 * @param aEgDataHandler
	 * @throws EDBCException 
	 */
	// Begin - beniwala - ASPEN00034263 - check if NoIssuanceChange should be set or not
	/*private boolean detNoIssuanceChangeEDBCActionCd(EdEligibilityCargo aEdEligibilityCargo,EdEligNoticeReasonsCargo aEdEligNoticeReasonsCargo, EgDataHandler aEgDataHandler) throws EDBCException {*/
	private boolean detNoIssuanceChangeEDBCActionCd(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
		
		/*if(aEdEligibilityCargo != null && aEdEligNoticeReasonsCargo != null && aEgDataHandler != null) {*/
		if(aEdEligibilityCargo != null && aEgDataHandler != null) {
			try {
				// for Non-PR and O/P Referral TANF/FS edm, if estimatedEligEndDt > paymentBegDt
				if((IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
						|| IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()))
						&& !IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())
						/* beniwala - ASPEN00037492 - EDBC ActionCd has not been set yet, so, removing from IF condition
						 * && IEdEligCodes.EDBC_ACTION_CD_OP_REFERRAL.equalsIgnoreCase(aEdEligibilityCargo.getEdbcActionCd())*/
						&& IEdEligCodes.SR1.equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())
						&& aEdEligibilityCargo.getEstimatedEligEndDt() != null
						&& DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getEstimatedEligEndDt(), aEdEligibilityCargo.getPaymentBegDt())) {
					// if all individuals are deceased or applicant is nto valid or voluntary quit in written, then make no change
					EligDetail eligDetailCurrEdm = aEgDataHandler.getEligDetailUnAuthCurrEDM();
					if (eligDetailCurrEdm != null) {
						EdEligNoticeReasonsCargo[] aEdEligNoticeReasonsCargos = eligDetailCurrEdm.getEdEligNoticeReasonsCargo();
						if (aEdEligNoticeReasonsCargos != null
								&& aEdEligNoticeReasonsCargos.length > 0
								&& aEdEligNoticeReasonsCargos[0] != null
								&& aEdEligNoticeReasonsCargos[0].getFailureReasonCode() != null) {
							// beniwala - ASPEN00039661 - if client requests for closure verbally, recoup benefit 
							//ASPEN00053280 - sandrun - Case should be closed due to NO show to the postponed appointment
							//ASPEN00057450 - sandrun - No Issuance for the AdverseAction month for-Failure to comply with application process
							if (aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_VOLUNTARY_QUIT_WRITTEN) >= 0
									|| aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_VOLUNTARY_QUIT_VERBAL) >= 0
									|| aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_ALL_CASE_INDVS_DECEASED) >= 0
									|| aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_NO_VALID_APP) >= 0
									|| aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_MISSED_APPOINTMENT) >= 0
									|| aEdEligNoticeReasonsCargos[0].getFailureReasonCode().indexOf(EDGConstants.NR_AUTO_DENIAL_INFO) >= 0
									) {
								return false;

							}
						}
						/*
						 * if (aEdEligNoticeReasonsCargo.getFailureReasonCode()
						 * != null) { if
						 * (aEdEligNoticeReasonsCargo.getFailureReasonCode
						 * ().indexOf(EDGConstants.NR_VOLUNTARY_QUIT_WRITTEN) >=
						 * 0 ||
						 * aEdEligNoticeReasonsCargo.getFailureReasonCode().
						 * indexOf(EDGConstants.NR_ALL_CASE_INDVS_DECEASED) >= 0
						 * ||
						 * aEdEligNoticeReasonsCargo.getFailureReasonCode().indexOf
						 * (EDGConstants.NR_NO_VALID_APP) >= 0) { return false;
						 * 
						 * } }
						 */
						/*
						 * EligDetail eligDetailCurrEdm =
						 * aEgDataHandler.getEligDetailUnAuthCurrEDM();
						 */
						// if any individual is deceased , then do not make any
						// change
						/* beniwala - ASPEN00037627 - In New Mexico, benefit decrease is Approved only when head of household is deceased, not when any other household
						 * member is deceased
						 * if (eligDetailCurrEdm != null) {
							EdIndvNoticeReasonsCargo[] edIndvNoticeReasons = eligDetailCurrEdm.getEdIndvNoticeReasonsCargo();
							if (edIndvNoticeReasons != null) {
								String[] noticeReason = getFailureReasonCd1(aEdEligibilityCargo.getEdgTraceId(), edIndvNoticeReasons);
								if (noticeReason != null
										&& noticeReason.length > 0) {
									for (int i = 0; i < noticeReason.length; i++) {
										if (noticeReason[i] != null) {
											if (EDGConstants.NR_INDV_DECEASED.equalsIgnoreCase(noticeReason[i]))
												return false;
										}
									}
								}
							}
						}*/
					}
														
					// set Edbc Action Cd as No Issue Change
					/* beniwala - ASPEN00034263 - do nto set No Issuance Change here
					 * aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);*/
					return true;					
				}
			} catch (EDBCException e) {
				EDBCLogger.writeExceptionStackTrace(
						DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
				throw new EDBCException(EDBCException.MAJOR, "EdUtil",
						"detNoIssuanceChangeEDBCActionCd", e);
			}
		}	
		return false;
	}	
	// End - beniwala - ASPEN00017552
	
	// Begin - beniwala - ASPEN00021700
	/**
	 * create EDM tasks for the individuals identified by NonFin module
	 * @param edEligibilityCargo
	 * @param aHmParams
	 * @throws EDBCException
	 */
	// Start : ASPEN00045455 : Updated by Deepak Kumar to fix the null pointer issue for egDataHandler issue while creating EDMTasks
		//private void createEDMTasks(EligDetail[] eligDetail, Map aHmParams, Connection conn) throws EDBCException {
		private void createEDMTasks(EligDetail[] eligDetail, Map aHmParams, Connection conn, EgDataHandler egDataHandler) throws EDBCException {
	//End : ASPEN00045455 : Updated by Deepak Kumar to fix the null pointer issue for egDataHandler issue while creating EDMTasks	
		/*if(aHmParams != null && eligDetail != null && eligDetail.getEdEligibilityCargo() != null && eligDetail.getEdEligibilityCargo().length > 0) {
			EdEligibilityCargo edEligibilityCargo = eligDetail.getEdEligibilityCargo()[0];*/
			if(aHmParams != null && eligDetail != null && eligDetail.length > 0) {
			/*EdEligibilityCargo edEligibilityCargo = eligDetail.getEdEligibilityCargo()[0];*/
			NFDataHandler nfDataHandler = (NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER);
			User userInfo = (User) aHmParams.get(IEdEligCodes.USER_INFO);
			// beniwala - ASPEN00011772
			String userId = (String) aHmParams.get(IEdEligCodes.SESSION_USER_ID);
			Long empIdLong = (Long) aHmParams.get(IEdEligCodes.EMP_ID);
			
			//EgDataHandler egDataHandler = (EgDataHandler) aHmParams.get(IEdEligCodes.EG_DATA_HANDLER); //ASPEN00045455 : Updated by Deepak Kumar to fix the null pointer issue for egDataHandler issue while creating EDMTasks
			// beniwala - ASPEN00022170 - do not create EDM tasks for conversion batch job
			/*if(aHmParams.get("BATCH")!= null && ((String)aHmParams.get("BATCH")).startsWith("MU")) {*/
			if(aHmParams.get(MU_RUN_MODE)!= null && ("CV".equalsIgnoreCase((String)aHmParams.get(MU_RUN_MODE)))) {
				return;
			}
			/*if(edEligibilityCargo != null && nfDataHandler != null && nfDataHandler.getIndvsForTasksMap() != null && userInfo != null) {*/
			/* beniwala - ASPEN00011772 - userInfo is null for batch, hence, should nto be in if condition
			 * if(nfDataHandler != null && nfDataHandler.getIndvsForTasksMap() != null && userInfo != null) {*/
			if(nfDataHandler != null && nfDataHandler.getIndvsForTasksMap() != null) {
				// beniwala - ASPEN00022170 - TOA is also stored in the map
				/*Map<Long,List<Long>> indvsForTasksMap = nfDataHandler.getIndvsForTasksMap();*/
				//ASPEN00023320 - The statement below got deleted from previous version, Hence adding it back
				Map<Long,Map<String,List<Long>>> indvsForTasksMap = nfDataHandler.getIndvsForTasksMap();
				DMElectronicDocumentNotificationImpl dmWebServiceImpl = new DMElectronicDocumentNotificationImpl();
				List<Long> taskstoBeNotCreated = new ArrayList<Long>();	
				// Begin - beniwala - ASPEN00039444
				Set<Long> coTriggerCreatedForIndvSet = new HashSet<Long>();
				for(Long taskId:indvsForTasksMap.keySet()) {	
					Map<String,List<Long>> indvIdsForTOAMap = indvsForTasksMap.get(taskId);
					if(indvIdsForTOAMap != null) {
						for(String toa:indvIdsForTOAMap.keySet()) {
							List<Long> indvIds = indvIdsForTOAMap.get(toa);
							// Begin - beniwala - ASPEN00035660 - take unique IndvIds only
							Set<Long> indvIdsSet = null;
							if(indvIds != null) {
								indvIdsSet = new HashSet<Long>(indvIds);
							}
							Map<Long,Set<Long>> indvsForTasksCreatedMap = nfDataHandler.getIndvsForTasksCreatedMap();
							Set<Long> indvIdsForTasksCreated = null;
							if(indvsForTasksCreatedMap != null) {
								indvIdsForTasksCreated = indvsForTasksCreatedMap.get(taskId);
							}	
							else {
								indvsForTasksCreatedMap = new HashMap<Long, Set<Long>>();
								nfDataHandler.setIndvsForTasksCreatedMap(indvsForTasksCreatedMap);
							}
							/*if(indvIds != null) {*/
							if(indvIdsSet != null) {
								// check if task should be created or not based on CgStatusCd and eligRsltCds of all modules
								/*if(checkIfTaskToBeCreated(eligDetail, edEligibilityCargo, taskId)) {*/
								if(checkIfTaskToBeCreated(eligDetail, taskId, toa)) {
									/*for(Long indvId:indvIds) {*/
									for(Long indvId:indvIdsSet) {
									// End - beniwala - ASPEN00035660	
										/*
										 * Begin - beniwala - ASPEN00039444 - if NMW task is to be created for the individual
										 * and typeOfAssistanceCd is not SNAP, then create FXX434 trigger for CO 
										 */
										boolean createCoTriggerForIndv = false;
										if(taskId == DIConstants.DOC_ID_NMW && !IEdEligCodes.TP_09.equalsIgnoreCase(toa)) {
											createCoTriggerForIndv = true;
										}
										// End - beniwala - ASPEN00039444
										// if task has not been created for this indv in this EDBC run
										if(indvIdsForTasksCreated == null || (indvIdsForTasksCreated != null 
												&& !indvIdsForTasksCreated.contains(indvId))) {
											try {
												DMFactory dmFactory = new DMFactory();
												DMElectronicDocumentWSGroupVO[] dmDocumentWSGroupVOs = new DMElectronicDocumentWSGroupVO[0];
												String taskType = DIConstants.TASKID_TYPE_MAP.get(taskId);
												if(taskType == null) {
													taskType = "";
												}
												// beniwala - ASPEN00036192 - pass connection object
												// Begin - beniwala - ASPEN00011772  - null check for userInfo and fetch officeNum
												long officeNum = 0;
												// for online fetch from userInfo
												if(conn == null && userInfo != null) {
													officeNum = userInfo.getLoggedInOffice();
												}
												// else, fetch from DcCasesCargo
												else{													
													if(egDataHandler != null && egDataHandler.getDcCasesCargo() != null
															&& egDataHandler.getDcCasesCargo().length > 0 && egDataHandler.getDcCasesCargo()[0] != null) {
														officeNum = egDataHandler.getDcCasesCargo()[0].getOfficeNum();
													}
												}
												/*dmDocumentWSGroupVOs = dmFactory.createGroupForInternalTask(userInfo.getLoggedInOffice(), userInfo.getLoggedInOffice(), indvId, 0, taskId,taskType, userInfo.getUserId(), "I",conn);*/
												//Start : ASPEN00046060 - Update by Deepak Kumar for "EDM task error in batch jobs"
												String scannedUserId=null;
												if (aHmParams.get(DIConstants.CASE_RUN_MODE)!=null &&
														DIConstants.RUN_MODE_BATCH.equalsIgnoreCase((String) aHmParams.get(DIConstants.CASE_RUN_MODE))){
													scannedUserId= FwPropertyLoader.getPropertyOf(GenericConstants.TIERS_PROPERTIES_NAME, DIConstants.IMAGE_NOW_SCANNED_USER_ID);
													dmDocumentWSGroupVOs = dmFactory.createGroupForInternalTask(officeNum, officeNum, indvId, 0, taskId,taskType, scannedUserId, "I",conn);
												}
												else
												//End : ASPEN00046060 - Update by Deepak Kumar for "EDM task error in batch jobs"
												dmDocumentWSGroupVOs = dmFactory.createGroupForInternalTask(officeNum, officeNum, indvId, 0, taskId,taskType, userId, "I",conn);
												// End - beniwala - ASPEN00011772
												String resultMessage = null;
												resultMessage = dmWebServiceImpl.createElectronicDocumentNotifications(dmDocumentWSGroupVOs);																							
												if (DMConstants.FAILURE_DM_DISABLED.equalsIgnoreCase(resultMessage)) {
													logger.log(DIConstants.LOGGING_CATEGORY_EDBC, ILog.ERROR, "DM switch is not enabled.");
													throw new FrameworkException("Error while creating eletronic document notification as DM switch is not enabled");
												} else if (!"Success".equalsIgnoreCase(resultMessage)) {
													logger.log(DIConstants.LOGGING_CATEGORY_EDBC, ILog.ERROR, "Failure occurred in creating electronic document notifications : "
															+ resultMessage);
													throw new FrameworkException("Error while creating eletronic document notification : "
															+ resultMessage);
												}
											} catch(EDBCException e) {
												throw new EDBCException(EDBCException.MAJOR, "EdUtil", "createEDMTasks:error while creating electronic document" +
														" notification", e.getMessage());
											} catch (Exception e) {
												throw new EDBCException(EDBCException.MAJOR, "EdUtil", "createEDMTasks:error while creating electronic document " +
														"notification", e.getMessage());
											} 
											// add individual to the list of indvIds for whom task has been created
											if(indvIdsForTasksCreated == null) {
												indvIdsForTasksCreated = new HashSet<Long>();
												indvsForTasksCreatedMap.put(taskId, indvIdsForTasksCreated);
											}
											indvIdsForTasksCreated.add(indvId);
											/* beniwala - generate trigger outside of if block
											 * // beniwala - ASPEN00022170 - create trigger to correspondence for NMW tasks only
											if(DIConstants.DOC_ID_NMW == taskId) {
												EdEligibilityCargo[] edEligibilityCargos = eligDetail[0].getEdEligibilityCargo();
												if(edEligibilityCargos != null && edEligibilityCargos.length > 0 && edEligibilityCargos[0] != null)
												EdCommonUtil.triggerCorrespondence(
													    edEligibilityCargos[0].getCaseNum(), 0,
														indvId,
														DIConstants.CO_DOC_ID_NMW,
														userInfo.getUserId(), conn);
											}*/																		
										}
										// Begin - beniwala - ASPEN00039444 - create FXX434 trigger for CO for given indv
										if(createCoTriggerForIndv && !coTriggerCreatedForIndvSet.contains(indvId)) {
											EdEligibilityCargo[] edEligibilityCargos = eligDetail[0].getEdEligibilityCargo();
											if(edEligibilityCargos != null && edEligibilityCargos.length > 0 && edEligibilityCargos[0] != null) {
												/* Begin - beniwala - ASPEN00011772
												 * EdCommonUtil.triggerCorrespondence(
													    edEligibilityCargos[0].getCaseNum(), 0,
														indvId,
														DIConstants.CO_DOC_ID_NMW,
														userInfo.getUserId(), conn);*/
													long empId = 0;
													if(empIdLong != null) {
														empId = empIdLong;
													}
													if(empIdLong == null && userInfo != null) {
														empId = userInfo.getEmpId();
													}
													if(egDataHandler != null && egDataHandler.getDcCasesCargo() != null
													&& egDataHandler.getDcCasesCargo().length > 0 && egDataHandler.getDcCasesCargo()[0] != null) {
														EdCommonUtil.triggerCorrespondence(
															    edEligibilityCargos[0].getCaseNum(), 0,
																indvId,
																DIConstants.CO_DOC_ID_NMW,
																userId, conn, userInfo, egDataHandler.getDcCasesCargo(),empId);
													}
													else {
														EdCommonUtil.triggerCorrespondence(
															    edEligibilityCargos[0].getCaseNum(), 0,
																indvId,
																DIConstants.CO_DOC_ID_NMW,
																userId, conn, userInfo, null,empId);
													}
											}												
											// End - beniwala - ASPEN00011772
											coTriggerCreatedForIndvSet.add(indvId);
										}
										// End - beniwala - ASPEN00039444
									}
								}
								/*else {
									taskstoBeNotCreated.add(taskId);
								}*/
							}
						}
					}
					
				}
				/*
				 * remove the indvIds from map for the tasks that should not be created because the cgStatus is not Approved 
				 */
				/*for(Long taskId : taskstoBeNotCreated) {
					indvsForTasksMap.remove(taskId);
				}*/							
			}
		}	
		
	}
	
	/**
	 * check if EDM task is to be created for individual
	 * @param eligDetail
	 * @param edEligibilityCargo
	 * @param taskId
	 * @return
	 */
	private boolean checkIfTaskToBeCreated(EligDetail eligDetail, EdEligibilityCargo edEligibilityCargo, long taskId) {
		/* for TP01 / Transistional Bonus / Education Works, if cgStatus is Approved, then
		 * only create NMW task
		 */
		/*
		 * beniwala - ASPEN00022170- create NMW task only if edg is Approved
		 */
		/*if((IEdEligCodes.TP_01.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()) 
				|| IEdEligCodes.TP_TRBP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())
				 || IEdEligCodes.ENWP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()))
				 && IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())
			     && DIConstants.DOC_ID_NMW == taskId) {*/
		// beniwala - ASPEN00023107 - create NMW task for SNAP as well
		/*
		 * Begin - beniwala - ASPEN00033732 - create NMW task when cgStatusCd as pending/Approved
		 * also, remove TRBP and ENWP TOAs
		 */
		// beniwala - ASPEN00038014 - create NMW task for Support Services also
		if((IEdEligCodes.TP_01.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()) 
				/*|| IEdEligCodes.TP_TRBP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())
				 || IEdEligCodes.ENWP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())*/
				//|| IEdEligCodes.TP_09.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())//ASPEN00049383 - SNAP E&T Policy Changes - nsandru
				 || IEdEligCodes.TP_SSSA.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()))
				 /*&& !IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())
				 && !IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())*/
				 && (IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())
						 || IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd()))
			     && DIConstants.DOC_ID_NMW == taskId) {
			// End - beniwala - ASPEN00033732 
			/* beniwala - ASPEN00022170 - if not terminated and not denied, then create NMW task. Pending due to potential
			 * STFS eligibility is checked in the caller function because even if one edg is pending because of potential STFS
			 * eligibility then we do nto create EDM task
			 * if(!IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())) {
				return true;
			}
			else {
				EdIndvLtcPendingReasonCargo[] edIndvLtcPendingReasonsCargos = eligDetail.getEdIndvLtcPendingReasonCargo();
				if(edIndvLtcPendingReasonsCargos != null) {
					for(int i=0; i < edIndvLtcPendingReasonsCargos.length; i++) {
						if(EDBCConstants.LTC_PEND_REASON_STFS.equalsIgnoreCase(edIndvLtcPendingReasonsCargos[i].getPendingReasonCd())) {
							return false;
						}
					}
				}	
				return true;
			}*/
			return true;
		}
		/*
		 * for GA Disability, if cgStatus is Approved, then create IRU task
		 */
		if(IEdEligCodes.TP_SDA.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()) 
				&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())) {
			return true;
		}
		/*
		 * for GA Disability, if cgStatus is Pending and only NonFin is Pending due to pending Disability
		 * Determination and rest all modules are Pass, then only create IRU task
		 */
		if(IEdEligCodes.TP_SDA.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()) 
				&& IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())
				&& IEdEligCodes.ELIG_RSLT_CD_PENDING.equalsIgnoreCase(edEligibilityCargo.getNfEligRsltCd())
				&& IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(edEligibilityCargo.getFinEligRsltCd())
				&& IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(edEligibilityCargo.getRscEligRsltCd())
				&& IEdEligCodes.ELIG_RSLT_CD_PASS.equalsIgnoreCase(edEligibilityCargo.getVerificationStatusCd())) {
				EdIndvLtcPendingReasonCargo[] edIndvLtcPendingReasonsCargos = eligDetail.getEdIndvLtcPendingReasonCargo();
				if(edIndvLtcPendingReasonsCargos != null) {
					for(int i=0; i < edIndvLtcPendingReasonsCargos.length; i++) {
						if(!EDBCConstants.LTC_PEND_REASON_IRU.equalsIgnoreCase(edIndvLtcPendingReasonsCargos[i].getPendingReasonCd())) {
							return false;
						}
					}
				}
				else {
					return false;
				}
			//ASPEN00039873 - EDBC will not create IRU task it will be triggered thru driver flow, hence returning flase
			//return true;
			return false;
		}
		return false;
	}
	// End - beniwala - ASPEN00021700
	
	// Begin - beniwala - ASPEN00022170
	/**
	 * check if EDM task is to be created for given TOA 
	 * @param eligDetail
	 * @param taskId
	 * @param typeOfAssistanceCd
	 * @return
	 */
	private boolean checkIfTaskToBeCreated(EligDetail[] eligDetail, long taskId, String typeOfAssistanceCd) {
		if(eligDetail != null && eligDetail.length > 0) {
			/* Begin - beniwala - ASPEN00033732 - create task if EDG is pending ,so, commenting the below logic
			 * for(int i =0; i < eligDetail.length;i++) {
				// if there is atleast one EDG which is pending due to potential STFS eligibility, then we do not create
				// NMW task for Cash
				if(eligDetail[i] != null && eligDetail[i].getEdEligibilityCargo() != null && eligDetail[i].getEdEligibilityCargo().length > 0) {
					EdEligibilityCargo edEligibilityCargo = eligDetail[i].getEdEligibilityCargo()[0];
					if(typeOfAssistanceCd != null && typeOfAssistanceCd.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())) {
						if((IEdEligCodes.TP_01.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()) 
								|| IEdEligCodes.TP_TRBP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())
								 || IEdEligCodes.ENWP.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd()))
								 && IEdEligCodes.STATUS_CD_PENDING.equalsIgnoreCase(edEligibilityCargo.getCgStatusCd())
								 && DIConstants.DOC_ID_NMW == taskId) {
							EdIndvLtcPendingReasonCargo[] edIndvLtcPendingReasonsCargos = eligDetail[i].getEdIndvLtcPendingReasonCargo();
							if(edIndvLtcPendingReasonsCargos != null) {
								for(int j=0; j < edIndvLtcPendingReasonsCargos.length; i++) {
									if(EDBCConstants.LTC_PEND_REASON_STFS.equalsIgnoreCase(edIndvLtcPendingReasonsCargos[j].getPendingReasonCd())) {
										return false;
									}
								}
							}							
						}
					}					
				}				
			}
			// if there is no EDG pending because of potential STFS eligibility, then call existing function to check if task is to be created
			 */
			// End - beniwala - ASPEN00033732
			// call existing function to check if task is to be created
			/*
			 * Begin - beniwala - ASPEN00035660 check if there exists one month of the given TOA for which task should be created, then return true
			 */
			boolean isTaskToBeCreated = false;
			for(int i =0; i < eligDetail.length;i++) {
				if(eligDetail[i] != null && eligDetail[i].getEdEligibilityCargo() != null && eligDetail[i].getEdEligibilityCargo().length > 0) {
					EdEligibilityCargo edEligibilityCargo = eligDetail[i].getEdEligibilityCargo()[0];
					if(typeOfAssistanceCd != null && typeOfAssistanceCd.equalsIgnoreCase(edEligibilityCargo.getTypeOfAssistanceCd())) {
						isTaskToBeCreated = isTaskToBeCreated ||  checkIfTaskToBeCreated(eligDetail[i], edEligibilityCargo, taskId);
						/*return checkIfTaskToBeCreated(eligDetail[i], edEligibilityCargo, taskId);*/
						
					}					
				}
				
			}
			return isTaskToBeCreated;
			// End - beniwala - ASPEN00035660
		}
		return false;
	}
	// End - beniwala - ASPEN00022170
	
	// Begin - beniwala - ASPEN00028805
		/**
		 * create trigger to CO for conciliation form to be sent
		 * @param eligDetailCurrEDM
		 * @param aHmParams
		 * @param conn
		 * @throws EDBCException
		 */
		/*private void createCOTriggerForConciliation(EligDetail eligDetailCurrEDM,
				HashMap aHmParams, Connection conn) throws EDBCException {
			if(eligDetailCurrEDM != null && aHmParams != null) {
				if(eligDetailCurrEDM.getEdEligibilityCargo() != null && eligDetailCurrEDM.getEdEligibilityCargo().length > 0){
					try {
						long edgTraceId = eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgTraceId();
						long caseNum = eligDetailCurrEDM.getEdEligibilityCargo()[0].getCaseNum();
						long edgNum = eligDetailCurrEDM.getEdEligibilityCargo()[0].getEdgNum();
						User userInfo = (User) aHmParams.get(IEdEligCodes.USER_INFO);
						NFDataHandler nfDataHandler = (NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER);
						if(userInfo != null && nfDataHandler != null && nfDataHandler.getNonCoopsForConciliationTrigger() != null) {
						if(userInfo != null && nfDataHandler != null && StringUtils.isNotBlank(nfDataHandler.getMiscParamsForCOTrigger())) {
							boolean concilationToBeSent = false;
							 Miscellaneous paramerters are now set in the rules
							 * Set<Long> nonCoopsForConciliationTriggers = nfDataHandler.getNonCoopsForConciliationTrigger();	
							StringBuilder miscParameters = new StringBuilder();
							int i = 0;
							for(Long nonCoopSeqNum:nonCoopsForConciliationTriggers) {							
								if(nonCoopSeqNum != 0) {
									concilationToBeSent= true;
									if(i == 0) {
										miscParameters.append(nonCoopSeqNum);
									}
									else {
										miscParameters.append(DIConstants.CO_DELIMITER).append(nonCoopSeqNum);
									}
									i++;
								}
							}
							if(concilationToBeSent) {
								EdCommonUtil.triggerCorrespondence(caseNum, edgNum, miscParameters.toString(), 0, DIConstants.CO_DOC_ID_CONCILIATION,
										userInfo.getUserId(), conn);
							}	
							EdCommonUtil.triggerCorrespondence(caseNum, edgNum, nfDataHandler.getMiscParamsForCOTrigger(), 0, 
									DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, userInfo.getUserId(), conn);
						}
					} catch(EDBCException e) {
						EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
						throw new EDBCException(EDBCException.MAJOR, "EdUtil","createCOTriggerForConciliation", e);
					} catch(Exception e) {
						EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
						throw new EDBCException(EDBCException.MAJOR, "EdUtil","createCOTriggerForConciliation", e);
					}							
				}			
			}
		}*/
	/**
	 * create CO trigger for conciliation to be sent
	 * @param eligDetailEDM
	 * @param aHmParams
	 * @param conn
	 * @throws EDBCException
	 */
	private void createCOTriggerForSanctionsConciliation(EligDetail[] eligDetailEDM,
			Map aHmParams, Connection conn, EgDataHandler egDataHandler) throws EDBCException {
		if(eligDetailEDM != null && aHmParams != null && eligDetailEDM.length > 0 && egDataHandler != null) {
			Timestamp tsRunDt = DateComparisons.getRunDate();
			User userInfo = (User) aHmParams.get(IEdEligCodes.USER_INFO);
			// beniwala - ASPEN00011772
			String userId = (String) aHmParams.get(IEdEligCodes.SESSION_USER_ID);
			Long empIdLong = (Long)aHmParams.get(IEdEligCodes.EMP_ID);
			long empId = 0;
			if(empIdLong != null) {
				empId = empIdLong;
			}
			else if(userInfo != null) {
				empId = userInfo.getEmpId();
			}
			// Begin - beniwala - ASPEN00047095 - do not generate Notice of Non-Compliance for CV job
			if(aHmParams.get(MU_RUN_MODE)!= null && ("CV".equalsIgnoreCase((String)aHmParams.get(MU_RUN_MODE)))) {
				return;
			}
			// End - beniwala - ASPEN00047095
			NFDataHandler nfDataHandler = (NFDataHandler) aHmParams.get(IEdEligCodes.NF_DATA_HANDLER);
			// Begin - beniwala - ASPEN00032954
			/* FXX084 is only for conciliation, not for penalties
			 * Map<Long,String> miscParamsForSanctions = nfDataHandler.getMiscParamsCOTriggerForSanctions();*/
			Map<Long,String> miscParamsForConciliation = nfDataHandler.getMiscParamsCOTriggerForConciliation();
			/*if(userInfo != null && (miscParamsForSanctions != null || miscParamsForConciliation != null)) {
				Set<Long> edgNumsProcessed = new HashSet<Long>();
				for(int i =0 ; i < eligDetailEDM.length;i++) {
					if(eligDetailEDM[i] != null && eligDetailEDM[i].getEdEligibilityCargo() != null && eligDetailEDM[i].getEdEligibilityCargo().length > 0){
						long edgNum = eligDetailEDM[i].getEdEligibilityCargo()[0].getEdgNum();		
						if(!edgNumsProcessed.contains(edgNum)) {
							try {
								long edgTraceId = eligDetailEDM[i].getEdEligibilityCargo()[0].getEdgTraceId();
								long caseNum = eligDetailEDM[i].getEdEligibilityCargo()[0].getCaseNum();
								String miscSanctionParams = "";
								if(miscParamsForSanctions != null && miscParamsForSanctions.get(edgNum) != null) {
									miscSanctionParams = miscParamsForSanctions.get(edgNum);
									miscSanctionParams = miscSanctionParams.replace(DIConstants.CO_DELIMITER, DIConstants.CO_DELIM_SANC);
								}
								String miscConciliationParams = "";
								if(miscParamsForConciliation != null && miscParamsForConciliation.get(edgNum) != null) {
									miscConciliationParams = miscParamsForConciliation.get(edgNum);
									miscConciliationParams = miscConciliationParams.replace(DIConstants.CO_DELIMITER, DIConstants.CO_DELIM_CONCILIATION);
								}
								String miscParams = miscSanctionParams + miscConciliationParams;
								if(StringUtils.isNotEmpty(miscParams)) {									
									EdCommonUtil.triggerCorrespondence(caseNum, edgNum, miscParams, 0, 
											DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, userInfo.getUserId(), conn);
								}
							} catch(EDBCException e) {
								EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
								throw new EDBCException(EDBCException.MAJOR, "EdUtil","createCOTriggerForConciliation", e);
							} catch(Exception e) {
								EDBCLogger.writeExceptionStackTrace(DIConstants.LOGGING_CATEGORY_EDBC, ILog.DEBUG, e);
								throw new EDBCException(EDBCException.MAJOR, "EdUtil","createCOTriggerForConciliation", e);
							}
							edgNumsProcessed.add(edgNum);
						}
							
					}
				}
			}*/			
			// iterate over all the edgNums inserted in conciliation map and consolidate nonCoopSeqNums for all EDGs in miscellaneous params for CO
			// beniwala - ASPEN00011772 - userInfo is null for batch, so should nto be present in condition
			/*if(userInfo != null && miscParamsForConciliation != null && eligDetailEDM[0] != null && eligDetailEDM[0].getEdEligibilityCargo() != null 
						&& eligDetailEDM[0].getEdEligibilityCargo().length > 0) {*/
			if(miscParamsForConciliation != null && eligDetailEDM[0] != null && eligDetailEDM[0].getEdEligibilityCargo() != null 
						&& eligDetailEDM[0].getEdEligibilityCargo().length > 0) {
				long caseNum = eligDetailEDM[0].getEdEligibilityCargo()[0].getCaseNum();
				CoRequestHistoryCargo existingCoRequest = egDataHandler.readCoRequestHistory(caseNum, tsRunDt, 
						DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, conn);				
				// if there are some nonCoopSeqNums, create FXX084 trigger
				if(existingCoRequest == null) {
					// beniwala - ASPEN00011772 - userId is fetched from different key in map and not from userInfo
					createUpdateCOTrigger(conn, egDataHandler, tsRunDt, userInfo, caseNum, miscParamsForConciliation, null,null, userId, empId);
					/* beniwala - ASPEN00033310 - FXX576 trigger should only be created if we are creating FXX084 trigger
					 * So moving below logic to function createUpdateCOTrigger
					 * CoRequestHistoryCargo existingFXX576CoRequest = egDataHandler.readCoRequestHistory(caseNum, tsRunDt, 
							DIConstants.CO_DOC_ID_CONCILIATION, conn);	
					
					 * if there is no FXX576 trigger for today for caseNum, create it with blank mkiscParams so that NonCompliance notice
					 * with conciliation section can be sent out even if case is not certified today
					 
					if(existingFXX576CoRequest == null) {
						EdCommonUtil.triggerCorrespondence(caseNum, 0, 0, DIConstants.CO_DOC_ID_CONCILIATION, userInfo.getUserId(), conn);
					}*/
				}
				else {
					Set<String> edgNumsInCurrentRun = new HashSet<String>();
					for(int i =0 ; i < eligDetailEDM.length;i++) {
						if(eligDetailEDM[i] != null && eligDetailEDM[i].getEdEligibilityCargo() != null && eligDetailEDM[i].getEdEligibilityCargo().length > 0){
							edgNumsInCurrentRun.add(String.valueOf(eligDetailEDM[i].getEdEligibilityCargo()[0].getEdgNum()));
						}					
					}
					// beniwala - ASPEN00011772 - userId is fetched from different key in map and not from userInfo
					createUpdateCOTrigger(conn, egDataHandler, tsRunDt, userInfo, caseNum, miscParamsForConciliation,existingCoRequest,edgNumsInCurrentRun, userId, empId);
					/* beniwala - ASPEN00033310 - FXX576 trigger should only be created if we are creating FXX084 trigger. 
					 * So moving below logic to function createUpdateCOTrigger
					 * if there is no FXX576 trigger for today for caseNum, create it with blank mkiscParams so that NonCompliance notice
					 * with conciliation section  can be sent out even if case is not certified today
					 
					CoRequestHistoryCargo existingFXX576CoRequest = egDataHandler.readCoRequestHistory(caseNum, tsRunDt, 
							DIConstants.CO_DOC_ID_CONCILIATION, conn);	
					if(existingFXX576CoRequest == null) {
						EdCommonUtil.triggerCorrespondence(caseNum, 0, 0, DIConstants.CO_DOC_ID_CONCILIATION, userInfo.getUserId(), conn);
					}*/
				// End - beniwala - ASPEN00032954
				}
			}
		}	
	}

			// End - beniwala - ASPEN00028805
	
	/**ASPEN00021378
	 * This update program request due date for auto denial functionality
	 * 
	 * @param EligDetail
	 *            arrEligDetailOutput
	 * @param EgDataHandler
	 *            aEgDataHandler
	 * @throws EDBCException
	 */
	public static void detProgramRequestDueDate(
			EligDetail[] arrEligDetailOutput, EgDataHandler aEgDataHandler, Connection conn)
			throws EDBCException {

		int isize = 0;		
		int eligDetailLength = 0;
		boolean updateDcCaseProgram = false;				
		DcCaseProgramCargo[] arrDcCaseProgramCargo = aEgDataHandler
				.getDcCaseProgramCargo();
		if (arrDcCaseProgramCargo != null) {
			isize = arrDcCaseProgramCargo.length;
		}
		if (arrEligDetailOutput != null && arrEligDetailOutput.length > 0) {
			eligDetailLength = arrEligDetailOutput.length;
		}
		for (int k = 0; k < isize; k++) {
			// for (int i = 0; i < eligDetailLength; i++) {
			if (IEdEligCodes.PROGRAM_CD_TANF
					.equalsIgnoreCase(arrDcCaseProgramCargo[k].getProgCd())
					&& IEdEligCodes.STATUS_CD_PENDING
							.equalsIgnoreCase(arrDcCaseProgramCargo[k]
									.getProgStatusCd())) {
				for (int i = 0; i < eligDetailLength; i++) {
					if (arrDcCaseProgramCargo[k].getProgCd().equalsIgnoreCase(arrEligDetailOutput[i]
							.getEdEligibilityCargo()[0].getProgramCd())
							&& IEdEligCodes.TP_SDA
									.equalsIgnoreCase(arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getTypeOfAssistanceCd())
							&& !IEdEligCodes.STATUS_CD_DENIED
									.equalsIgnoreCase(arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getCgStatusCd())) {
						if (arrDcCaseProgramCargo[k].getRequestDt() != null
								&& arrDcCaseProgramCargo[k].getRequestDueDt() != null
								&& !DateComparisons.dateGTEQDateInTimestamp(
										arrDcCaseProgramCargo[k]
												.getRequestDueDt(),
										DateComparisons.addDays(
												arrDcCaseProgramCargo[k]
														.getRequestDt(), 90))) {
							// Set request date + 90 days as request due date
							// for GA-Disability
							arrDcCaseProgramCargo[k]
									.setRequestDueDt(DateComparisons.addDays(
											arrDcCaseProgramCargo[k]
													.getRequestDt(), 90));
							updateDcCaseProgram =true;
							break;
						}
					}
				}
			}
			if (IEdEligCodes.PROGRAM_CD_FMA
					.equalsIgnoreCase(arrDcCaseProgramCargo[k].getProgCd())
					&& IEdEligCodes.STATUS_CD_PENDING
							.equalsIgnoreCase(arrDcCaseProgramCargo[k]
									.getProgStatusCd())) {
				for (int i = 0; i < eligDetailLength; i++) {
					if (IEdEligCodes.ICBL
									.equalsIgnoreCase(arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getTypeOfAssistanceCd())
									|| IEdEligCodes.ECMA
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWMF
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWDD
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWBI
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWAI
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWDB
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWAG
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_MA_MWBL
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd())
									|| IEdEligCodes.TP_13
											.equalsIgnoreCase(arrEligDetailOutput[i]
													.getEdEligibilityCargo()[0]
													.getTypeOfAssistanceCd()) || IEdEligCodes.TA_22
										.equalsIgnoreCase(arrEligDetailOutput[i]
												.getEdEligibilityCargo()[0]
												.getTypeOfAssistanceCd())
							&& !IEdEligCodes.STATUS_CD_DENIED
									.equalsIgnoreCase(arrEligDetailOutput[i]
											.getEdEligibilityCargo()[0]
											.getCgStatusCd())) {
						if (arrDcCaseProgramCargo[k].getRequestDt() != null
								&& arrDcCaseProgramCargo[k].getRequestDueDt() != null
								&& !DateComparisons.dateGTEQDateInTimestamp(
										arrDcCaseProgramCargo[k]
												.getRequestDueDt(),
										DateComparisons.addDays(
												arrDcCaseProgramCargo[k]
														.getRequestDt(), 90))) {
							// Set request date + 90 days as request due date
							// for Medicaid
							arrDcCaseProgramCargo[k]
									.setRequestDueDt(DateComparisons.addDays(
											arrDcCaseProgramCargo[k]
													.getRequestDt(), 90));
							updateDcCaseProgram =true;
							break;
						}
					}
				}
			}
		}
		if(updateDcCaseProgram){
			EDDataWriter edWrite = new EDDataWriter(0, conn);
			edWrite.writeDcCaseProgramCargo(arrDcCaseProgramCargo);	
		}
	}
	//ASPEN00021378 - Update request due date for Auto denial

	// Begin - beniwala - ASPEN00031274
	/**
	 * set Edbc Cd for LIHEAP Edg
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 */
	private boolean detEdbcActionCdLiheap(EdEligibilityCargo aEdEligibilityCargo,
			EgDataHandler aEgDataHandler) {
		if(aEdEligibilityCargo != null && aEgDataHandler != null) {
			
		}
		/*
		 * Begin - beniwala - ASPEN00031274 - 
		 * a. if last authorized LIHEAP Edg is approved, then set Edbc Action Cd as No Issuance Change
		 * b. if last authorized LIHEAP Edg is Denied and current is also Denied, then set EdbcActionCd as Denied
		 * c. if last authorized LIHEAP Edg is Denied and current is Approved, then set EdbcActionCd as Approved
		 * d. For ongoing terminated LIHEAP EDG, set EdbcActionCd as Terminated
		 */
		
		//Start : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"
		if(IEdEligCodes.PROGRAM_CD_SER.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd()) 
				&& aEgDataHandler != null && aEgDataHandler.getEligDetailLastAuth() != null 
				&& aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo() != null
				&& aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo().length > 0){
			
			if(((aEgDataHandler.getArrBiSerIndvIssuanceLiheapCargo()!=null && aEgDataHandler.getArrBiSerIndvIssuanceLiheapCargo().length>0 ) ||
					(aEgDataHandler.getArrCvEdMciEdgIndividualLiheapCargo()!=null && aEgDataHandler.getArrCvEdMciEdgIndividualLiheapCargo().length>0)) &&
					aEdEligibilityCargo.getPaymentEndDt()!=null){
			BiSerIndvIssuanceCargo biSerIndvIssuanceLiheapCargo= aEgDataHandler.getArrBiSerIndvIssuanceLiheapCargo()[0]; 
			CvEdMciEdgIndividualCargo  cvEdMciEdgIndividualLiheapCargo =aEgDataHandler.getArrCvEdMciEdgIndividualLiheapCargo()[0];
			if(biSerIndvIssuanceLiheapCargo!=null && cvEdMciEdgIndividualLiheapCargo!=null){
				if(!IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
					aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
					return true;
				}
				else if(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())){
					aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
					return true;	
				}
			}
			}
			else{
				//End : ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"
				EdEligibilityCargo eligAuthcargo = aEgDataHandler.getEligDetailLastAuth().getEdEligibilityCargo()[0];
				if(eligAuthcargo != null) {
					if(IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(eligAuthcargo.getCgStatusCd())) {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						return true;
					}
					else if(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(eligAuthcargo.getCgStatusCd())
							&& IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_DENIED);
						return true;
					}
					else if(IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(eligAuthcargo.getCgStatusCd())
							&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(aEdEligibilityCargo.getCgStatusCd())) {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_APPROVED);
						return true;
					}
					else if(IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(eligAuthcargo.getCgStatusCd())
							&& aEdEligibilityCargo.getPaymentEndDt() == null) {
						aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_TERMINATED);
						return true;
					}
				}
			}//ASPEN00071039 - Updated by Deepak Kumar for "Duplicate LIHEAP Issuance"
			
		}
	
		return false;
	}
	// End - beniwala - ASPEN00031274
	
	// Begin - beniwala - ASPEN00032273
	/**
	 * set cert end date as earlier of the two input dates
	 * 
	 * @param aEdEligibilityCargo
	 * @param enteredDate
	 * @param calculatedDate
	 * @throws EDBCException
	 */
	private static void setEarlierCertEndDate(EdEligibilityCargo aEdEligibilityCargo, Timestamp enteredDate,
			Timestamp calculatedDate) throws EDBCException {
		if (aEdEligibilityCargo != null) {
			Timestamp certEndDate = null;
			if (enteredDate == null) {
				certEndDate = calculatedDate;
			} else if (calculatedDate != null
					&& DateComparisons.dateGTDateInTimestamp(enteredDate, calculatedDate)) {
				certEndDate = calculatedDate;
			} else {
				certEndDate = enteredDate;
			}
			aEdEligibilityCargo.setCertEndDt(DateComparisons.getLastDayOfDate(certEndDate));
		}
	}
	// End - beniwala - ASPEN00032273
	
	// Begin - beniwala - ASPEN00032954
	/**
	 * create or update FXX084 trigger
	 * @param conn
	 * @param egDataHandler
	 * @param tsRunDt
	 * @param userInfo
	 * @param caseNum
	 * @param miscParamsForConciliation
	 * @param existingCoRequest
	 * @param edgNumsInCurrentRun
	 * @throws EDBCException
	 */
	private void createUpdateCOTrigger(Connection conn,
			EgDataHandler egDataHandler, Timestamp tsRunDt, User userInfo,
			long caseNum, Map<Long, String> miscParamsForConciliation,
			CoRequestHistoryCargo existingCoRequest,
			Set<String> edgNumsInCurrentRun, String userId, long empId) throws EDBCException {
		Map<String, String> existingCoRequestMiscParamMap = new HashMap<String, String>();
		/*
		 * if there exists FXX084 record, create a map from miscellaneous params with key as edgNum
		 * and value as miscParams for that edgNum
		 */
		if (existingCoRequest != null) {
			String existingMiscParams = existingCoRequest.getMiscParms();
			if (!StringUtils.isEmpty(existingMiscParams)) {
				String[] existingMiscParamsForEdgs = existingMiscParams.split(DIConstants.CO_DELIM_EDGNUM_ESCAPE);
				for (String existingMiscParamforEdg : existingMiscParamsForEdgs) {
					if (existingMiscParamforEdg != null && existingMiscParamforEdg.indexOf(DIConstants.CO_DELIMITER) != -1) {
						String edgNum = existingMiscParamforEdg.substring(0,existingMiscParamforEdg.indexOf(DIConstants.CO_DELIMITER));
						existingCoRequestMiscParamMap.put(edgNum, DIConstants.CO_DELIM_EDGNUM+existingMiscParamforEdg);
					}
				}
			}
		}
		StringBuffer miscParams = new StringBuffer();
		/*
		 * if current EDBC run identified noncooperations for which conciliation is to be sent
		 * then those noncoopSeqNums are to be used in miscellaenous params of FXX084 trigger
		 */
		if (miscParamsForConciliation != null
				&& !miscParamsForConciliation.isEmpty()) {
			for (Long edgNum : miscParamsForConciliation.keySet()) {
				if (!StringUtils.isEmpty(miscParamsForConciliation.get(edgNum))) {
					String miscConciliationParams = miscParamsForConciliation.get(edgNum).replace(DIConstants.CO_DELIMITER, DIConstants.CO_DELIM_CONCILIATION);
					miscParams.append(DIConstants.CO_DELIM_EDGNUM).append(edgNum).append(miscConciliationParams);
				}
			}
		}
		/*
		 * if there exists some NonCoopseqNum that is present in misc params of existing CoRequestHistory record
		 * but we did not create that edgNum in current EDBC run, then retain the nonCoopSeqNums from the existing record.
		 */
		if (existingCoRequestMiscParamMap != null) {
			for (String edgNumStr : existingCoRequestMiscParamMap.keySet()) {
				if (edgNumsInCurrentRun == null
						|| (edgNumsInCurrentRun != null && !edgNumsInCurrentRun.contains(edgNumStr))) {
					String existingMiscParamForEdg = existingCoRequestMiscParamMap.get(edgNumStr);
					if (!StringUtils.isEmpty(existingMiscParamForEdg)) {
						miscParams.append(existingMiscParamForEdg);
					}
				}
			}
		}
		/* 
		 * if miscParams is not blank, this implies we  have some noncooperation for which conciliation needs to be sent out
		 * So, create/update FXX084 trigger. Else, cancel the existing FXX084 trigger
		 */
		if (!StringUtils.isEmpty(miscParams.toString())) {
			/* beniwala - ASPEN00011772 - add arguments for batch
			 * EdCommonUtil.triggerCorrespondence(caseNum, 0, miscParams.toString(), 0, DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, userInfo.getUserId(), conn);*/
			EdCommonUtil.triggerCorrespondence(caseNum, 0, miscParams.toString(), 0, DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, userId, conn, userInfo, egDataHandler.getDcCasesCargo(), empId);
			/*
			 * beniwala - ASPEN00033310 - if there is no FXX576 trigger for today for caseNum, create it with blank miscParams so that NonCompliance notice
			 * with conciliation section  can be sent out even if case is not certified today
			 */
			CoRequestHistoryCargo existingFXX576CoRequest = egDataHandler.readCoRequestHistory(caseNum, tsRunDt, 
					DIConstants.CO_DOC_ID_CONCILIATION, conn);	
			if(existingFXX576CoRequest == null) {
				/* beniwala - ASPEN00011772 - add arguments for batch
				 * EdCommonUtil.triggerCorrespondence(caseNum, 0, 0, DIConstants.CO_DOC_ID_CONCILIATION, userInfo.getUserId(), conn);*/
				EdCommonUtil.triggerCorrespondence(caseNum, 0, 0, DIConstants.CO_DOC_ID_CONCILIATION, userId, conn, userInfo, egDataHandler.getDcCasesCargo(), empId);
			}
		} else {
			// if there is no conciliation to be sent out - cancel FXX084
			// generated today for the caseNum
			if (egDataHandler != null) {
				egDataHandler.cancelCoRequestHistory(caseNum, tsRunDt, DIConstants.CO_DOC_ID_DUMMY_CONCILIATION_SANCTION, conn);
				/*
				 * beniwala -  ASPEN00033310 - if FXX576 trigger exists with blank miscParams => no new sanctions created. 
				 * So, since we are cancelling FXX084 trigger, we should cancel FXX576 trigger also
				 */
				CoRequestHistoryCargo existingFXX576CoRequest = egDataHandler.readCoRequestHistory(caseNum, tsRunDt, 
						DIConstants.CO_DOC_ID_CONCILIATION, conn);	
				if(existingFXX576CoRequest != null && StringUtils.isEmpty(existingFXX576CoRequest.getMiscParms())) {
					egDataHandler.cancelCoRequestHistory(caseNum, tsRunDt, DIConstants.CO_DOC_ID_CONCILIATION, conn);
				}
				//ASPEN00066051 - Parma - If sanction has been complied prior to certification, need to cancel pending co_req_history records
				else if (existingFXX576CoRequest != null) { 
					egDataHandler.cancelCoRequestHistory(caseNum, tsRunDt, DIConstants.CO_DOC_ID_CONCILIATION, conn); 
				}
				
			}
		}

	}
	// End - beniwala - ASPEN00032954
	
	// Begin - beniwala - ASPEN00034743
	/**
	 * 
	 * @param aEdEligibilityCargo
	 * @param aEdEligFsBudget
	 * @param nfDataHandler
	 * @param egDataHandler
	 * @param aEdIndvEligibilityCargo
	 * @param edEligibilityCargoPrevMonth
	 * @return
	 * @throws EDBCException 
	 */
	private static Timestamp det12MonthCertPeriod(EdEligibilityCargo aEdEligibilityCargo, EdEligFsBudgetCargo[] aEdEligFsBudget, NFDataHandler nfDataHandler,
			EgDataHandler egDataHandler, EdIndvEligibilityCargo[] aEdIndvEligibilityCargo,
			EdEligibilityCargo edEligibilityCargoPrevMonth, Timestamp tsEstimatedEligEndDt, EdCaseRecertDatesCargo[] aEdCaseRecertDatesCargo) throws EDBCException {
	
		if(aEdEligibilityCargo != null && aEdEligFsBudget != null && 
				!IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())
				&& !IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())) {
			String toaCd = aEdEligibilityCargo.getTypeOfAssistanceCd();
			if(IEdEligCodes.TP_09.equalsIgnoreCase(toaCd)
					&& "SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())) {
				if(aEdEligibilityCargo.getCertEndDt() != null && aEdEligibilityCargo.getCertBegDt() != null) {
					int certPeriod = DateComparisons.getMonthsIncludedBetween(aEdEligibilityCargo.getCertEndDt(), aEdEligibilityCargo.getCertBegDt());
					if(certPeriod == 24) {
						boolean agedAndDisabledIndvFlag = false;
						boolean isEarnedIncome = false;
						DiFsCertification diFsCertification = new DiFsCertification();
						agedAndDisabledIndvFlag = diFsCertification.verifyDisablityAndAge(
								aEdEligibilityCargo, aEdIndvEligibilityCargo, aEdEligFsBudget,
								nfDataHandler, egDataHandler, edEligibilityCargoPrevMonth);
						isEarnedIncome = diFsCertification.verifyEarnings(aEdEligibilityCargo,
								aEdIndvEligibilityCargo, aEdEligFsBudget, nfDataHandler,
								egDataHandler, edEligibilityCargoPrevMonth);
						/*
						 * if there is an earned income or there is an individual who is not aged/disabled,
						 * change cert period to 12 months and Interim Reporting to 6 months
						 */
						if(isEarnedIncome || !agedAndDisabledIndvFlag) {
							int prevMonthCertPeriod = 0;
							if(edEligibilityCargoPrevMonth != null && edEligibilityCargoPrevMonth.getCertBegDt() != null &&
									edEligibilityCargoPrevMonth.getCertEndDt() != null) {
								prevMonthCertPeriod = DateComparisons.getMonthsIncludedBetween(edEligibilityCargoPrevMonth.getCertEndDt(),
										edEligibilityCargoPrevMonth.getCertBegDt());
							}
							if(edEligibilityCargoPrevMonth == null || (edEligibilityCargoPrevMonth != null && (prevMonthCertPeriod == 0 || prevMonthCertPeriod == 24))) {
								if((aEdEligibilityCargo.getSemiAnnualReviewDt() == null || (aEdEligibilityCargo.getSemiAnnualReviewDt() != null 
										&& DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(), aEdEligibilityCargo.getSemiAnnualReviewDt()))) &&
										DateComparisons.dateGTDateInTimestamp(aEdEligibilityCargo.getCertEndDt(), aEdEligibilityCargo.getPaymentBegDt())) {
									Timestamp newEstimatedEligEndDt = DateComparisons.getLastDayOfDate(DateComparisons.addMonths(aEdEligibilityCargo.getPaymentBegDt(), 5));
									// beniwala - ASPEN00049529 - shorten certification period only if edm+5 months < certEndDt and recert packet has not gone out
									EdCaseRecertDatesCargo edCaseRecertDatesCargo = null;
									if(aEdCaseRecertDatesCargo != null) {
										for(EdCaseRecertDatesCargo edCaseDatesCargo: aEdCaseRecertDatesCargo) {
											if(edCaseDatesCargo != null && edCaseDatesCargo.getEdgNum() == aEdEligibilityCargo.getEdgNum()) {
												edCaseRecertDatesCargo = edCaseDatesCargo;
												break;
											}
										}
									}
									if(DateComparisons.dateLTDateInTimestamp(newEstimatedEligEndDt, aEdEligibilityCargo.getCertEndDt())
											&& (edCaseRecertDatesCargo == null || (edCaseRecertDatesCargo != null && edCaseRecertDatesCargo.getForm1830PrintDt() == null))) {
										aEdEligibilityCargo.setSemiAnnualReviewDt(newEstimatedEligEndDt);
										aEdEligibilityCargo.setMidCertEndDt(null);
										aEdEligibilityCargo.setMidCertificationShortenSw('Y');
										tsEstimatedEligEndDt = newEstimatedEligEndDt;
									}										
								}
							}
						}
					}
				}
			}
		}
		return tsEstimatedEligEndDt;		
	}
	// End - beniwala - ASPEN00034743
	
	// Begin - beniwala - ASPEN00042218
	/**
	 * check if all target individuals have disqualification or not
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 * @throws EDBCException
	 */
	private boolean areAllTargetIndivsDisqualified(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
		boolean areAllTargetIndivsDisqualified = false;
		if(aEdEligibilityCargo != null && aEgDataHandler != null && aEgDataHandler.getEligDetailUnAuthCurrEDM() != null) {
			EdIndvEligibilityCargo[] edIndvEligibilityCargos = aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdIndvEligibilityCargo();
			if(edIndvEligibilityCargos != null) {
				for(int i=0; i < edIndvEligibilityCargos.length; i++) {
					if(edIndvEligibilityCargos[i] != null) {
						// for SNAP, if there is IPV penalty, then should recoup, so return true
						if(IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
							HashMap dcIndvIPVSanctionHm = aEgDataHandler.getEdDcUtil()
									.getDcIndvIpvSanctionsInfoMonthlyHM();

							DcIndvIpvSanctionsCargo[] dcIndvIpvSanctionResults = null;
							if (dcIndvIPVSanctionHm != null) {

								dcIndvIpvSanctionResults = (DcIndvIpvSanctionsCargo[]) dcIndvIPVSanctionHm
										.get(Long.valueOf(edIndvEligibilityCargos[i].getIndvId()));
								if (dcIndvIpvSanctionResults != null) {
									//ASPEN00061942 - Parma - Application Error because of ArrayIndexOutOfException -- changed i to j in inner loop
									for (int j = 0; j < dcIndvIpvSanctionResults.length; j++) {
										if (dcIndvIpvSanctionResults[j].getProgramCd() != null && 
												dcIndvIpvSanctionResults[j].getProgramCd().equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
											if (validRecord(dcIndvIpvSanctionResults[j]
													.getSanctionBeginDt(),
													dcIndvIpvSanctionResults[j]
															.getSanctionEndDt(), aEdEligibilityCargo)) {
												areAllTargetIndivsDisqualified = true;
												return areAllTargetIndivsDisqualified;
											}
										}
									}
								}
							}
						}						
						// if for Cash/SNAP, all target individuals are disqualified then return true. Else return false
						if(IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
								|| IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
							if(edIndvEligibilityCargos[i].getTargetSw() != IEdEligCodes.CHAR_INIT_SPACE
									&& edIndvEligibilityCargos[i].getTargetSw() == 'Y') {
								if(IEdEligCodes.PART_STATUS_CD_DISQ_ADULT.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())
										|| IEdEligCodes.PART_STATUS_CD_DISQ_CHILD.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())
										|| IEdEligCodes.PART_STATUS_CD_DISQ_PRORATED_INDV.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())) {
									areAllTargetIndivsDisqualified = true;
								}
								else {
									areAllTargetIndivsDisqualified = false;
									return areAllTargetIndivsDisqualified;
								}
							}
						}						
					}
				}
			}
		}
		return areAllTargetIndivsDisqualified;
	}
	
	/**
	 * Method validRecord.check if the ed_eligibility record falls within the
	 * range of given begin_dt and end_dt.
	 *
	 * @param aBeginDt
	 *            Timestamp
	 * @param aEndDt
	 *            Timestamp
	 * @param edElig
	 *            EdEligibilityCargo
	 * @return boolean
	 * @throws EDBCException
	 */
	private boolean validRecord(Timestamp aBeginDt, Timestamp aEndDt,
			EdEligibilityCargo edElig) throws EDBCException {

		boolean retVal = false;
		if(edElig != null) {
			if ((aBeginDt != null)
					&& DateComparisons.dateLTEQDateInTimestamp(aBeginDt, edElig
							.getPaymentBegDt())) {
				if ((aEndDt == null)
						|| (DateComparisons.dateGTEQDateInTimestamp(aEndDt, edElig
								.getPaymentBegDt()))) {
					retVal = true;
				}
			}
		}
		

		return retVal;

	}
	// End - beniwala - ASPEN00042218
	
	// Begin - beniwala - ASPEN00042308
	/**
	 * This method should calculate the Adverse Action date from reference table
	 * @throws EDBCException 
	 */
	public Timestamp getAdverseActionDate(EdEligibilityCargo aEdEligibilityCargo) throws EDBCException{

		try {
			java.sql.Timestamp tsDate = null;
			Timestamp adverseActionDt = null;
			//get rundate - last day of run date month - 15 days
			tsDate = DateComparisons.getLastDayOfDate(aEdEligibilityCargo
					.getEdbcRunDt());
			//Defect BRGUS00029194 Adverse action is 12 days and not 13 days
			//?this.tsAdverseActionDate = DateComparisons.subDays(tsDate, 13);
			//Defect BRGUS00060864
			//this.tsAdverseActionDate = DateComparisons.subDays(tsDate, 12);
			//START
			int runMonth;
			int runYear;
			String refTableDate = null;
			String code = null;
			runMonth = DateComparisons.getMM(tsDate);
			//Added By Sairama For Defect #BRGUS00086836
			runYear = DateComparisons.getYYYY(tsDate);
			if(runMonth == 12) {
				runMonth = 1;
				runYear = runYear + 1;
			}
			else
				runMonth+=1;
			if(runMonth<10)
				code = Integer.toString(runYear)+"0"+Integer.toString(runMonth);
			else
				code = Integer.toString(runYear)+Integer.toString(runMonth);			
			refTableDate = ReferenceTableManager.getValueByColumn(true,
					"EDNEGACTIONDATE",code, "NEGACTIONDATE");
			adverseActionDt = DateComparisons.getTimeStampFromString(refTableDate);

			return adverseActionDt;
		} catch (Exception e) {
			throw new EDBCException(EDBCException.MAJOR, "EdUtil",
					"Error calling ReferenceTableManager."
							+ "No value recieved from table:" + "EDNEGACTIONDATE", "Missing Value");
		}
	}
	// End - beniwala - ASPEN00042308
	
	// Begin - beniwala - ASPEN00042620
	/**
	 * determine EDBC Action Cd as No Issuance Change or value passed in argument 
	 * If month is not in Interim reporting/PR mode and the cumulative effect of changes 
	 * leads to no change in issuance, set No Issuance Change.
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @param edbcActionCd
	 * @throws EDBCException
	 */
	private void detEDBCActionCdForRecoup(
			EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler, String edbcActionCd)
			throws EDBCException {
		if(aEdEligibilityCargo != null && edbcActionCd != null) {
			if ("SR1".equalsIgnoreCase(aEdEligibilityCargo.getSimplifiedReportingGrpCd())
					&& (IEdEligCodes.TP_09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) 
							|| (IEdEligCodes.TP_01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
									&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES)
							 || (IEdEligCodes.ENWP.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
											&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES)
							 || (IEdEligCodes.WASU.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())
											&& aEdEligibilityCargo.getEfipEligSw() != IEdEligCodes.YES))//ASPEN00062743 - ENWP/WASU closes before SR
					// beniwala - ASPEN00043823 - check if No Issuance Change can be set for Ongoing mode also
					&& (IEdEligCodes.ACTIVITY_TYPE_CHANGE_ACTION.equalsIgnoreCase(aEdEligibilityCargo.getActivityType())
							|| IEdEligCodes.ACTIVITY_TYPE_ONGOING.equalsIgnoreCase(aEdEligibilityCargo.getActivityType()))
					&& aEdEligibilityCargo.getEstimatedEligEndDt() != null && aEdEligibilityCargo.getPaymentBegDt() != null
					&& DateComparisons.dateLTEQDateInTimestamp(aEdEligibilityCargo.getPaymentBegDt(), aEdEligibilityCargo.getEstimatedEligEndDt())) {						
				/*
				 * set EDBCActionCd as passed in argument if individual is not valid applicant
				 *  OR HOH deceased or voluntarily withdrawn
				 */
				if (aEdEligibilityCargo.getRecoupmentAdviceSw() == IEdEligCodes.NO) {
					if(detNoIssuanceChangeEDBCActionCd(aEdEligibilityCargo, aEgDataHandler)) {
						// beniwala - ASPEN00042801 - if target individual(s) are disqualified or has third level sanction
						if(areAllTargetIndivsDisqualified(aEdEligibilityCargo, aEgDataHandler) || hasThirdLevelSanction(aEdEligibilityCargo, aEgDataHandler) 
								|| exceedsTfTimeLimit(aEdEligibilityCargo, aEgDataHandler)) { 		//ASPEN00044702 - close TF if exceeds time limit - Added by Sai Suresh
							aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
						}
						// if the cumulative effect is that recoupment should not be done, then only set NoIssuanceChange
						//Start ASPEN00053446 - Upated by Deepak Kumar for "Final fixes for Rebuild issue when closing SNAP and Building TFS"
						//Start : ASPEN00052188 - Updated by Deepak Kumar for "Revert back the java changes for the "rebuild issue - Fixes".
						/*else if(aEgDataHandler != null && aEgDataHandler.isHasNonHistoricaMonthChangeForRecoup() == false
								&& isEdWorksOrWSApproved(aEdEligibilityCargo, aEgDataHandler) == false) { // ASPEN00043554 - Education Works Fix - Added by Sai Suresh
								aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
						}*/
						//Start : ASPEN00051445- update by Deepak for "When building TRFS and making  "No Issuance Change" for FS".
						
						else if(aEgDataHandler != null && aEgDataHandler.isHasNonHistoricaMonthChangeForRecoup() == false){
							if ((EDGConstants.TP01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())&&
								 isEdWorksOrWSApproved(aEdEligibilityCargo, aEgDataHandler) == false) 
								|| (EDGConstants.TP09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd()) && 
										isTFSApproved(aEdEligibilityCargo, aEgDataHandler) == false)
										|| (!(EDGConstants.TP01.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())) &&
												!(EDGConstants.TP09.equalsIgnoreCase(aEdEligibilityCargo.getTypeOfAssistanceCd())))){
						//else if(aEgDataHandler != null && aEgDataHandler.isHasNonHistoricaMonthChangeForRecoup() == false
							//	&& isEdWorksOrWSApproved(aEdEligibilityCargo, aEgDataHandler) == false) { // ASPEN00043554 - Education Works Fix - Added by Sai Suresh
							//End : ASPEN00051445- update by Deepak for "When building TRFS and making  "No Issuance Change" for FS".
							aEdEligibilityCargo.setEdbcActionCd(IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL);
							}
							else {
								aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
							}
						}
						//End ASPEN00053446 - Upated by Deepak Kumar for "Final fixes for Rebuild issue when closing SNAP and Building TFS"
						//End : ASPEN00052188 - Updated by Deepak Kumar for "Revert back the java changes for the "rebuild issue - Fixes".
						else {
							aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
						}
					}
					else {
						aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
					}
				} else {
					aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
				}
			} else {
				aEdEligibilityCargo.setEdbcActionCd(edbcActionCd);
			}
		}
		
	}
	// End - beniwala - ASPEN00042620
	
	
	/**
	 * The method checks if 60 month time limit is exceeded
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 */
	private boolean exceedsTfTimeLimit(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler){
		
		//ASPEN00044702 - The method checks if 60 month time limit is exceeded - Added by Sai Suresh
		
		boolean exceedsTfTimeLimit = false;
		
		if(aEdEligibilityCargo != null && aEgDataHandler != null && aEgDataHandler.getEligDetailUnAuthCurrEDM() != null
				&& IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
			EligDetail eligDetailCurrEdm = aEgDataHandler.getEligDetailUnAuthCurrEDM();
			
			if (eligDetailCurrEdm != null) {
				EdIndvNoticeReasonsCargo[] edIndvNoticeReasons = eligDetailCurrEdm.getEdIndvNoticeReasonsCargo();
				EdIndvNoticeReasonsCargo indvNoticeCargo = null;
				if(null != edIndvNoticeReasons){
					for(int i=0;i<edIndvNoticeReasons.length;i++){
						indvNoticeCargo = edIndvNoticeReasons[i];
						if (indvNoticeCargo != null &&indvNoticeCargo.getEdgTraceId() == aEdEligibilityCargo.getEdgTraceId()) {
							if(null != indvNoticeCargo.getFailureReasonCode() && indvNoticeCargo.getFailureReasonCode().indexOf(EDGConstants.NR_EXCEEDS_TF_TIMELIMIT)!= -1){
								exceedsTfTimeLimit = true;
								break;
							}
						}				
					}
				}
			}	
		}
		
		return exceedsTfTimeLimit;
	}
	
	// Begin - beniwala - ASPEN00042705
	/**
	 * Check if Cash program has third level penalty in current EDM
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 * @throws EDBCException
	 */
	private boolean hasThirdLevelSanction(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
		boolean hasThirdLevelSanction = false;
		if(aEdEligibilityCargo != null && aEgDataHandler != null && aEgDataHandler.getEligDetailUnAuthCurrEDM() != null
				&& IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
			EdEdgPenaltyDetailsCargo[] edgPenaltyDetailsCargos = aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdEdgPenaltyDetailsCargo();
			if(edgPenaltyDetailsCargos != null) {
				for(int i=0; i < edgPenaltyDetailsCargos.length; i++) {
					if(edgPenaltyDetailsCargos[i] != null && edgPenaltyDetailsCargos[i].getGroupPenaltyLevel() == 3
							&& aEdEligibilityCargo.getPaymentBegDt() != null && edgPenaltyDetailsCargos[i].getPenDisBeginDt() != null
							&& DateComparisons.dateLTEQDateInTimestamp(DateComparisons.getFirstDayOfDate(edgPenaltyDetailsCargos[i].getPenDisBeginDt()), 
									DateComparisons.getFirstDayOfDate(aEdEligibilityCargo.getPaymentBegDt()))) {	
						if(edgPenaltyDetailsCargos[i].getPenDisMinPrdEndDt() == null) {
							return true;
						}
						else if(DateComparisons.dateGTEQDateInTimestamp(edgPenaltyDetailsCargos[i].getPenDisMinPrdEndDt(), aEdEligibilityCargo.getPaymentBegDt())) {
							return true;
						}
					}
				}
			}
		}
		return hasThirdLevelSanction;
	}
	// End - beniwala - ASPEN00042705
	
	/**
	 * The method determines if an education works or wage subsidy group was approved for the same period
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 * @throws EDBCException
	 */
	private boolean isEdWorksOrWSApproved(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException{
		// ASPEN00043554 - Education Works Fix - Added by Sai Suresh
		
		boolean bEdWorksOrWSApproved = false;
		
		EligDetail[] arrEligDetail = aEgDataHandler.getEligDetailUAProcTfCurrEDMEdges();
		if(null != arrEligDetail){
			for(int i=0;i<arrEligDetail.length;i++){
				EligDetail unAuthEligDetail = arrEligDetail[i];
				if(null != unAuthEligDetail){
					EdEligibilityCargo[] edEligArr = unAuthEligDetail.getEdEligibilityCargo();
					if(null != edEligArr){
						for(int j=0;j<edEligArr.length;j++){
							EdEligibilityCargo edElig = edEligArr[j];
							if(null != edElig){
								if((edElig.getTypeOfAssistanceCd().equalsIgnoreCase(EDGConstants.EDUCATIONAL_WORK_TPCODE) ||
										edElig.getTypeOfAssistanceCd().equalsIgnoreCase(EDGConstants.WASU)) && edElig.getCgStatusCd().equalsIgnoreCase("AP")){
									bEdWorksOrWSApproved = true;
								}
							}
						}
					}
				}
			}
		}
		
		return bEdWorksOrWSApproved;
	}
	
	// Start : ASPEN00052188 - Updated by Deepak Kumar for "Revert back the java changes for the "rebuild issue - Fixes".
	//Start : ASPEN00051445- update by Deepak for "When building TRFS and making  "No Issuance Change" for FS".
	/**
	 * The method determines if an education TFS group was approved for the same period
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 * @throws EDBCException
	 */
	private boolean isTFSApproved(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException{
		//Start ASPEN00053446 - Upated by Deepak Kumar for "Final fixes for Rebuild issue when closing SNAP and Building TFS"
			boolean bTFSApproved = false;
			/*
			EligDetail[] arrEligDetail = aEgDataHandler.getEligDetailUAProcFSCurrEDMEdges();
			if(null != arrEligDetail){
				for(int i=0;i<arrEligDetail.length;i++){
					EligDetail unAuthEligDetail = arrEligDetail[i];
					if(null != unAuthEligDetail){
						EdEligibilityCargo[] edEligArr = unAuthEligDetail.getEdEligibilityCargo();
						if(null != edEligArr){
							for(int j=0;j<edEligArr.length;j++){
								EdEligibilityCargo edElig = edEligArr[j];
								if(null != edElig){
									if((EDGConstants.TRANSITIONAL_FOOD_STAMP_TPCODE.equalsIgnoreCase(edElig.getTypeOfAssistanceCd())) 
											&& edElig.getCgStatusCd().equalsIgnoreCase(EDGConstants.APPROVED)){
										bTFSApproved = true;
									}
								}
							}
						}
					}
				}
			}
			return bTFSApproved;*/

		EdEligibilityCargo[] edEligibilityCargoCurrentEdgProced = aEgDataHandler.getEdEligibilityCargoCurrentEdgProced();
		int iLength=0;
		if (edEligibilityCargoCurrentEdgProced != null) {
			iLength = edEligibilityCargoCurrentEdgProced.length;
		}
		if(null != edEligibilityCargoCurrentEdgProced){
			for(int i=0;i<iLength;i++){	
					//if(null != arrEligDetail[0].getEdEligibilityCargo()){						
							EdEligibilityCargo edElig =edEligibilityCargoCurrentEdgProced[i];
							if(null != edElig){
								if((EDGConstants.TRANSITIONAL_FOOD_STAMP_TPCODE.equalsIgnoreCase(edElig.getTypeOfAssistanceCd())) 
										&& ( edElig.getCgStatusCd().equalsIgnoreCase(EDGConstants.APPROVED)||
												 edElig.getCgStatusCd().equalsIgnoreCase(EDGConstants.PEND))){
									bTFSApproved = true;
								}
							}
						
					//}
				
			}
		}
	
		return bTFSApproved;
		//End ASPEN00053446 - Upated by Deepak Kumar for "Final fixes for Rebuild issue when closing SNAP and Building TFS"	
		}

		//End : ASPEN00051445- update by Deepak for "When building TRFS and making  "No Issuance Change" for FS".
	//End : ASPEN00052188 - Updated by Deepak Kumar for "Revert back the java changes for the "rebuild issue - Fixes".
	
	/**
	 * The method checks for valid failure reasons for TFS to enable rebuild
	 * @param edEligCargo
	 * @param aEgDataHandler
	 * @return
	 */
	private boolean isRebuildClosureReason(EdEligibilityCargo edEligCargo, EgDataHandler aEgDataHandler){
		
		//ASPEN00044702 - valid closure reasons for TF to enable rebuild - Added by Sai Suresh
		
		boolean allowRebuild = false;
		
		EdEligNoticeReasonsCargo[] edEligNoticeCargoArr = null;
		EdEligNoticeReasonsCargo edEligNoticReasonCargo = null;
		
		if(edEligCargo != null && aEgDataHandler != null && aEgDataHandler.getEligDetailUnAuthCurrEDM() != null
				&& IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(edEligCargo.getProgramCd())) {
			EligDetail eligDetailCurrEdm = aEgDataHandler.getEligDetailUnAuthCurrEDM();
			
			if (eligDetailCurrEdm != null) {
				
				edEligNoticeCargoArr = eligDetailCurrEdm.getEdEligNoticeReasonsCargo();
				if(null != edEligNoticeCargoArr){
					for(int i=0;i<edEligNoticeCargoArr.length;i++){
						edEligNoticReasonCargo = edEligNoticeCargoArr[i];
						if (edEligNoticReasonCargo != null && edEligNoticReasonCargo.getEdgTraceId() == edEligCargo.getEdgTraceId()) {
							if(null != edEligNoticReasonCargo.getFailureReasonCode() && (edEligNoticReasonCargo.getFailureReasonCode().indexOf(EDGConstants.NR_VOLUNTARY_QUIT_WRITTEN) != -1 
									|| edEligNoticReasonCargo.getFailureReasonCode().indexOf(EDGConstants.NR_NO_ELIG_CHILD)!= -1
									|| edEligNoticReasonCargo.getFailureReasonCode().indexOf(EDGConstants.NR_CERT_PERIOD_ENDED)!= -1 
										|| edEligNoticReasonCargo.getFailureReasonCode().indexOf(EDGConstants.NR_FAILURE_RETURN_ISD120)!=-1)){
								allowRebuild = true;
								break;
							}
						}				
					}
				}
			}
		}	
		
		return allowRebuild;
	}
	
	//Begin - beniwala - ASPEN00044903
	/**
	 * check if any individual has disqualification or not
	 * @param aEdEligibilityCargo
	 * @param aEgDataHandler
	 * @return
	 * @throws EDBCException
	 */
	private boolean isIndivDisqualified(EdEligibilityCargo aEdEligibilityCargo, EgDataHandler aEgDataHandler) throws EDBCException {
		boolean isIndivDisqualified = false;
		if(aEdEligibilityCargo != null && aEgDataHandler != null && aEgDataHandler.getEligDetailUnAuthCurrEDM() != null) {
			EdIndvEligibilityCargo[] edIndvEligibilityCargos = aEgDataHandler.getEligDetailUnAuthCurrEDM().getEdIndvEligibilityCargo();
			if(edIndvEligibilityCargos != null) {
				for(int i=0; i < edIndvEligibilityCargos.length; i++) {
					if(edIndvEligibilityCargos[i] != null) {
						// for SNAP, if there is IPV penalty, then should recoup, so return true
						if(IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
							HashMap dcIndvIPVSanctionHm = aEgDataHandler.getEdDcUtil()
									.getDcIndvIpvSanctionsInfoMonthlyHM();

							DcIndvIpvSanctionsCargo[] dcIndvIpvSanctionResults = null;
							if (dcIndvIPVSanctionHm != null) {

								dcIndvIpvSanctionResults = (DcIndvIpvSanctionsCargo[]) dcIndvIPVSanctionHm
										.get(Long.valueOf(edIndvEligibilityCargos[i].getIndvId()));
								if (dcIndvIpvSanctionResults != null) {
									//Start : ASPEN00055653 : Updated by Deepak Kumar for "Infinite looping issue for Indv Ipv SanctionResults"
									//Updated for loop with new j value. It was using same int i value as it already used in upper for loop and it is making
									//infinite looping issue.
									/*
									for (i = 0; i < dcIndvIpvSanctionResults.length; i++) {
										if (dcIndvIpvSanctionResults[i].getProgramCd() != null && 
												dcIndvIpvSanctionResults[i].getProgramCd().equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
											if (validRecord(dcIndvIpvSanctionResults[i]
													.getSanctionBeginDt(),
													dcIndvIpvSanctionResults[i]
															.getSanctionEndDt(), aEdEligibilityCargo)) {
												isIndivDisqualified = true;
												return isIndivDisqualified;
											}
										}
									}*/
									for (int j = 0; j < dcIndvIpvSanctionResults.length; j++) {
										if (dcIndvIpvSanctionResults[j].getProgramCd() != null && 
												dcIndvIpvSanctionResults[j].getProgramCd().equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
											if (validRecord(dcIndvIpvSanctionResults[j]
													.getSanctionBeginDt(),
													dcIndvIpvSanctionResults[j]
															.getSanctionEndDt(), aEdEligibilityCargo)) {
												isIndivDisqualified = true;
												return isIndivDisqualified;
											}
										}
									}
									//End : ASPEN00055653 : Updated by Deepak Kumar for "Infinite looping issue for Indv Ipv SanctionResults"
								}
							}
						}						
						// if for Cash/SNAP, if any individual is disqualified then return true. Else return false
						if(IEdEligCodes.PROGRAM_CD_TANF.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())
								|| IEdEligCodes.PROGRAM_CD_FS.equalsIgnoreCase(aEdEligibilityCargo.getProgramCd())) {
								if(IEdEligCodes.PART_STATUS_CD_DISQ_ADULT.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())
										|| IEdEligCodes.PART_STATUS_CD_DISQ_CHILD.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())
										|| IEdEligCodes.PART_STATUS_CD_DISQ_PRORATED_INDV.equalsIgnoreCase(edIndvEligibilityCargos[i].getPartStatusCd())) {
									isIndivDisqualified = true;
									return isIndivDisqualified;
								}								
						}						
					}
				}
			}
		}
		return isIndivDisqualified;
	}
	// End - beniwala - ASPEN00044903
	
	// Begin - beniwala - ASPEN00049529
	/**
	 * align TANF simplified reporting cert period and interim review period with SNAP simplified reporting
	 * @param arrEligDetailOutput
	 * @param conn
	 * @param egDataHandler
	 * @throws EDBCException
	 */
	private void alignTANFCertPeriod(EligDetail[] arrEligDetailOutput, 
			Connection conn, EgDataHandler egDataHandler) throws EDBCException {
		if(arrEligDetailOutput != null && egDataHandler != null) {
			EdEligibilityCargo tanfOngoingEligibilityCargo = null;
			EdEligibilityCargo snapOngoingEligibilityCargo = null;
			EligDetail snapOngoingEligDetail =  null;
			EligDetail tanfOngoingEligDetail = null;
			EdCaseRecertDatesCargo snapEdCaseRecertDatesCargo = null;
			EdCaseRecertDatesCargo tanfEdCaseRecertDatesCargo = null;
			try {
				// fetch ongoing SNAP Simplified reporting EDG from current run	
				snapOngoingEligDetail = fetchOngoingSimplifiedReportingEligDetail(arrEligDetailOutput, egDataHandler, IEdEligCodes.TP_09, false, false);
				if(snapOngoingEligDetail != null && snapOngoingEligDetail.getEdEligibilityCargo() != null && snapOngoingEligDetail.getEdEligibilityCargo().length > 0
						&& snapOngoingEligDetail.getEdEligibilityCargo()[0] != null) {
					if(snapOngoingEligDetail.getEdEligibilityCargo()[0].getCertEndDt() != null && 
							snapOngoingEligDetail.getEdEligibilityCargo()[0].getCertBegDt() != null) {
						int certPeriod = DateComparisons.getMonthsIncludedBetween(snapOngoingEligDetail.getEdEligibilityCargo()[0].getCertEndDt(),
								snapOngoingEligDetail.getEdEligibilityCargo()[0].getCertBegDt());
						// if cert period is 24 months OR if it NMCAP, do not do alignment
						if(certPeriod != 24 && (snapOngoingEligDetail.getEdEligibilityCargo()[0].getMicapFapSw() == IEdEligCodes.CHAR_INIT_SPACE
								|| (snapOngoingEligDetail.getEdEligibilityCargo()[0].getMicapFapSw() != IEdEligCodes.CHAR_INIT_SPACE
								&& snapOngoingEligDetail.getEdEligibilityCargo()[0].getMicapFapSw() != 'Y'))) {
							snapOngoingEligibilityCargo = snapOngoingEligDetail.getEdEligibilityCargo()[0];		
						}						
					}							
				}					
				// if unable to find SNAP ongoing EDG from current run, fetch from V records
				if(snapOngoingEligibilityCargo == null) {
					snapOngoingEligibilityCargo = fetchOngoingSimplifiedReportingVEDG(arrEligDetailOutput, egDataHandler, IEdEligCodes.TP_09, false, false);
					if(snapOngoingEligibilityCargo != null && snapOngoingEligibilityCargo.getCertEndDt() != null && 
							snapOngoingEligibilityCargo.getCertBegDt() != null) {
						int certPeriod = DateComparisons.getMonthsIncludedBetween(snapOngoingEligibilityCargo.getCertEndDt(),
								snapOngoingEligibilityCargo.getCertBegDt());
						// if cert period is 24 months OR if it NMCAP, do not do alignment
						if(certPeriod == 24 || snapOngoingEligibilityCargo.getMicapFapSw() == 'Y') {
							snapOngoingEligibilityCargo = null;
						}
					}
				}
				// fetch edCaseRecertDates for SNAP EDG
				snapEdCaseRecertDatesCargo = getEdCaseRecertDates(snapOngoingEligDetail, conn, egDataHandler, snapOngoingEligibilityCargo);

				// fetch TANF ongoing Simplified Reporting edg from current run
				tanfOngoingEligDetail = fetchOngoingSimplifiedReportingEligDetail(arrEligDetailOutput, egDataHandler, IEdEligCodes.TP_01, false, true);
				if(tanfOngoingEligDetail != null && tanfOngoingEligDetail.getEdEligibilityCargo() != null && tanfOngoingEligDetail.getEdEligibilityCargo().length > 0
						&& tanfOngoingEligDetail.getEdEligibilityCargo()[0] != null) {
					// if it is Transitional Bonus or Hardship, do not do alignment
					if(tanfOngoingEligDetail.getEdEligibilityCargo()[0].getEfipEligSw() != 'Y'
							&& (tanfOngoingEligDetail.getEdEligibilityCargo()[0].getSplToaCd() == null
							|| (tanfOngoingEligDetail.getEdEligibilityCargo()[0].getSplToaCd() != null
							&& "".equalsIgnoreCase(tanfOngoingEligDetail.getEdEligibilityCargo()[0].getSplToaCd().trim())))) {
						tanfOngoingEligibilityCargo = tanfOngoingEligDetail.getEdEligibilityCargo()[0];
					}
									
				}				
				// if unable to find TANF ongoing EDG from current run, fetch from V records
				if(tanfOngoingEligibilityCargo == null) {
					tanfOngoingEligibilityCargo = fetchOngoingSimplifiedReportingVEDG(arrEligDetailOutput, egDataHandler, IEdEligCodes.TP_01, false, true);
					// if it is Transitional Bonus or Hardship, do not do alignment
					if(tanfOngoingEligibilityCargo != null && (tanfOngoingEligibilityCargo.getEfipEligSw() == 'Y'
							|| (tanfOngoingEligibilityCargo.getSplToaCd() != null
							&& !"".equals(tanfOngoingEligibilityCargo.getSplToaCd().trim())))) {
						tanfOngoingEligibilityCargo = null;
					}
				}
				tanfEdCaseRecertDatesCargo = getEdCaseRecertDates(tanfOngoingEligDetail, conn, egDataHandler, tanfOngoingEligibilityCargo);
				if(snapOngoingEligibilityCargo != null && tanfOngoingEligibilityCargo != null) {
					List<EdEligibilityCargo> tanfEligibilityCargos = fetchEDGs(arrEligDetailOutput, egDataHandler, tanfOngoingEligibilityCargo.getEdgNum(), false);
					List<EdEligibilityCargo> snapEligibilityCargos = fetchEDGs(arrEligDetailOutput, egDataHandler, snapOngoingEligibilityCargo.getEdgNum(), true);
					if(tanfEligibilityCargos != null) {
						// when Approved SNAP is in Intake or recert mode and TANF is in Intake  mode
						if((IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())
								|| IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType()))
								&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd())
								&& IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())) {		
							setTANFCertPeriodFrmIntakeRecertSNAP(snapOngoingEligibilityCargo, tanfEligibilityCargos,
									 snapEligibilityCargos);
						}
						/*
						 * if Tanf is in Intake mode and SNAP ongoing month is not denied/terminated and is not in Intake/Recert
						 * SNAP ongoing month will always be less than SNAP's cert End Date
						 */
						// beniwala - ASPEN00050963 - if SNAP ongoing is No issuance Change, do not check for cgStatusCd
						else if(IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())
								&& ((!IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd())
								&& !IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd()))
								|| IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL.equalsIgnoreCase(snapOngoingEligibilityCargo.getEdbcActionCd()))
								&& !IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())
								&& !IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())) {
							// we are building tanf max month <= snap max month
							//ASPEN00052135 - sandrun - Null pointer check for SemiAnnualReviewDt
							if(tanfOngoingEligibilityCargo.getPaymentBegDt() != null && snapOngoingEligibilityCargo.getPaymentBegDt() != null
									&& DateComparisons.dateLTEQDateInTimestamp(DateComparisons.getFirstDayOfDate(tanfOngoingEligibilityCargo.getPaymentBegDt()), 
											DateComparisons.getFirstDayOfDate(snapOngoingEligibilityCargo.getPaymentBegDt()))) {								
								/*
								 * we are building SNAP beyond semi Annual Review Dt and SNAP Recert packet has not yet gone out
								 * OR we are building SNAP for months less than semiAnnual Review Dt and SNAP interim review packet has not gone out
								 */
								//ASPEN00052135 - sandrun - Null pointer check for SemiAnnualReviewDt
								if(snapEdCaseRecertDatesCargo != null &&  
											((snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null && DateComparisons.dateGTDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()) && dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1830PrintDt()))
										|| (snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null && DateComparisons.dateLTEQDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()) && dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1046PrintDt()))
										||(snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() == null && dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1830PrintDt())))) {
									// if TANF edg is approved, align cert period and interim review period with SNAP ongoing EDG
									setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
											snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());								
								}
								else if(snapEdCaseRecertDatesCargo != null && ((snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateGTDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()))
										|| (snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() == null)) && !dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1830PrintDt())) {
									/*
									 * recert packet for SNAP has already gone out, so we cannot align IR/PR dates of TANF with SNAP right now
									 * Do nothing, keep TANF IR and PR periods as it is and they will be aligned with SNAP IR/PR dates on recert of SNAP
									 */ 
								}
								//we are building SNAP for months less than semiAnnual Review Dt and SNAP interim review packet has  gone out
								else if(snapEdCaseRecertDatesCargo != null && snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateLTEQDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()) && !dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1046PrintDt())) {
									// if TANF edg is approved, align cert period  with SNAP ongoing EDG and no interim will happen for TANF
									setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
											snapOngoingEligibilityCargo.getCertEndDt(), null);
								}
							}
							// we are building TANF beyond SNAP ongoing month
							//ASPEN00052135 - sandrun - Null pointer check for SemiAnnualReviewDt
							else if(tanfOngoingEligibilityCargo.getPaymentBegDt() != null && snapOngoingEligibilityCargo.getPaymentBegDt() != null
									&& DateComparisons.dateGTDateInTimestamp(DateComparisons.getFirstDayOfDate(tanfOngoingEligibilityCargo.getPaymentBegDt()), 
											DateComparisons.getFirstDayOfDate(snapOngoingEligibilityCargo.getPaymentBegDt()))) {
								/*
								 * we are building SNAP beyond semi Annual Review Dt and SNAP Recert packet has not  gone out yet
								 */
								if(snapEdCaseRecertDatesCargo != null && ((snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateGTDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt())) 
										|| (snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() == null)) && dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1830PrintDt())) {
									// if tanf ongoing edm is less than cert end Date (review due date) of SNAP, then align IR/PR dates
									if(snapEdCaseRecertDatesCargo.getRecertReviewDueDt() != null && DateComparisons.dateLTEQDateInTimestamp(
											tanfOngoingEligibilityCargo.getPaymentBegDt(),snapEdCaseRecertDatesCargo.getRecertReviewDueDt())) {
										// if TANF edg is approved, align cert period and interim review period with SNAP ongoing EDG
										setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
												snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());	
									}	
									else {
										/*
										 * As we are building TANF beyond SNAP cert end date , we cannot align TANF IR/PR dates with SNAP right now
										 * do nothing, keep TANF IR and PR periods as it is and they will be aligned with SNAP IR/PR dates on recert of SNAP
										 */										
									}
								}
								else if(snapEdCaseRecertDatesCargo != null && ((snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateGTDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt())) || (snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() == null))
										&& !dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1830PrintDt())) {
									/*
									 * recert packet for SNAP has already gone out, so we cannot align IR/PR dates of TANF with SNAP right now
									 * Do nothing, keep TANF IR and PR periods as it is and they will be aligned with SNAP IR/PR dates on recert of SNAP
									 */ 
								}
								/*
								 *  we are building SNAP for months less than semiAnnual Review Dt and SNAP interim review packet has not gone out
								 */
								else if(snapEdCaseRecertDatesCargo != null && snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateLTEQDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()) && dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1046PrintDt())) {
									// if tanf ongoing edm is less than semi Annual review dueDate of SNAP, then align IR/PR dates
									if(snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null && DateComparisons.dateLTEQDateInTimestamp(
											tanfOngoingEligibilityCargo.getPaymentBegDt(),snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt())) {
										// if TANF edg is approved, align cert period and interim review period with SNAP ongoing EDG
										setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
												snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());		
									}
									/*
									 * Tanf ongoing edm is beyond Semi Annual Review Dt of SNAP, then we will align just PR dates
									 * as no interim review will be possible for TANF
									 */
									else {
										// if TANF edg is approved, align cert period  with SNAP ongoing EDG and no interim will happen for TANF
										setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
												snapOngoingEligibilityCargo.getCertEndDt(), null);											
									}
								}
								//we are building SNAP for months less than semiAnnual Review Dt and SNAP interim review packet has  gone out
								else if(snapEdCaseRecertDatesCargo != null && snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										DateComparisons.dateLTEQDateInTimestamp(snapOngoingEligibilityCargo.getPaymentBegDt(),
										snapEdCaseRecertDatesCargo.getSemiAnnualReviewDt()) && !dateIsEmpty(snapEdCaseRecertDatesCargo.getForm1046PrintDt())) {	
									// if TANF edg is approved, align cert period  with SNAP ongoing EDG and no interim will happen for TANF
									setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
											snapOngoingEligibilityCargo.getCertEndDt(), null);	
								}
							}
						}
						/*
						 * At recertification of SNAP, align TANF cert period
						 */
						else if(IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())
								&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd())
								&& !IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())) {							
							setTANFCertPeriodOnSNAPRecert(egDataHandler, tanfOngoingEligibilityCargo, snapOngoingEligibilityCargo, tanfEligibilityCargos);
						}
						/*
						 * At recertification of TANF, if SNAP application is being added, align TANF cert period
						 */
						else if(IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())
										&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd())
										&& IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())) {							
							setTANFCertPeriodOnTFRecertSnapIntake(egDataHandler, tanfOngoingEligibilityCargo, snapOngoingEligibilityCargo, tanfEligibilityCargos);
						}
						/*
						 * when adding SNAP to an ongoing TANF case
						 */
						// beniwala - ASPEN00050963 - align ongoing TANF on adding SNAP, if TANF is NoissuanceChange also
						else if(IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(snapOngoingEligibilityCargo.getActivityType())
								&& IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(snapOngoingEligibilityCargo.getCgStatusCd())
								&& !IEdEligCodes.ACTIVITY_TYPE_INTAKE.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())
								&& !IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(tanfOngoingEligibilityCargo.getActivityType())
								&& ((!IEdEligCodes.STATUS_CD_DENIED.equalsIgnoreCase(tanfOngoingEligibilityCargo.getCgStatusCd())
								&& !IEdEligCodes.STATUS_CD_TERMINATED.equalsIgnoreCase(tanfOngoingEligibilityCargo.getCgStatusCd()))
								|| IEdEligCodes.EDBC_ACTION_CD_NO_OP_REFERRAL.equalsIgnoreCase(tanfOngoingEligibilityCargo.getEdbcActionCd()))) {
							Timestamp maxAuthTFPaymentBegDt = fetchMaxAuthEDM(egDataHandler, tanfOngoingEligibilityCargo.getEdgNum());
							if(maxAuthTFPaymentBegDt == null || (maxAuthTFPaymentBegDt != null && DateComparisons.dateLTEQDateInTimestamp(
									maxAuthTFPaymentBegDt, snapOngoingEligibilityCargo.getEstimatedEligEndDt()))) {
								/*
								 * if we are building TANF beyond semiAnnual Review Dt of TANF and irrespective of whether TANF recert packet has gone out or not,
								 * align TANF IR/PR dates with SNAP
								 */
								//ASPEN00052135 - sandrun - Null pointer check for SemiAnnualReviewDt
								if(tanfEdCaseRecertDatesCargo != null && tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null && 
										(DateComparisons.dateGTDateInTimestamp(tanfOngoingEligibilityCargo.getPaymentBegDt(),
										tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt()))) {
									for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {
										if(tanfEdgCargo != null) {
											if(tanfEdgCargo.getPaymentBegDt() != null && tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
													snapOngoingEligibilityCargo.getCertBegDt() != null
													&& DateComparisons.dateGTDateInTimestamp(DateComparisons.getFirstDayOfDate(tanfEdgCargo.getPaymentBegDt()),
															DateComparisons.getFirstDayOfDate(tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt()))) {
												tanfEdgCargo.setCertEndDt(snapOngoingEligibilityCargo.getCertEndDt());
												tanfEdgCargo.setSemiAnnualReviewDt(snapOngoingEligibilityCargo.getSemiAnnualReviewDt());
												tanfEdgCargo.setEstimatedEligEndDt(snapOngoingEligibilityCargo.getEstimatedEligEndDt());
											}
										}
									}
								}								
								/*
								 * if we are building TANF less than semi Annual Review Dt of TANF and irrespective of whether TANF interim packet has gone out
								 * or not, align TANF IR/PR dates with SNAP
								 */
								//ASPEN00052135 - sandrun - Null pointer check for SemiAnnualReviewDt
								else if(tanfEdCaseRecertDatesCargo != null && tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt() != null &&
										(DateComparisons.dateLTEQDateInTimestamp(tanfOngoingEligibilityCargo.getPaymentBegDt(),
										tanfEdCaseRecertDatesCargo.getSemiAnnualReviewDt()))) {
									for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {
										if(tanfEdgCargo != null) {											
												tanfEdgCargo.setCertEndDt(snapOngoingEligibilityCargo.getCertEndDt());
												tanfEdgCargo.setSemiAnnualReviewDt(snapOngoingEligibilityCargo.getSemiAnnualReviewDt());
												tanfEdgCargo.setEstimatedEligEndDt(snapOngoingEligibilityCargo.getEstimatedEligEndDt());											
										}
									}
								}								
							}
						}
					
					}
				}
			} catch(Exception e) {
				throw new EDBCException(EDBCException.MAJOR, "EdUtil",
						"Error calling alignTANFCertPeriod."
								+ e.getMessage(), e);
			}
			
		}
	}


	/**
	 * get ed_case_recert_dates record for given edgNum
	 * @param eligDetail
	 * @param conn
	 * @param egDataHandler
	 * @param eligibilityCargo
	 * @return
	 * @throws EDBCException
	 */
	private EdCaseRecertDatesCargo getEdCaseRecertDates(EligDetail eligDetail,Connection conn,
			EgDataHandler egDataHandler,
			EdEligibilityCargo eligibilityCargo)
			throws EDBCException {
		EdCaseRecertDatesCargo edRecertDatesCargo = null;
		if(eligDetail != null && eligibilityCargo != null && eligDetail.getEdCaseRecertDatesCargo() != null) {
			for(EdCaseRecertDatesCargo edCaseRecertDatesCargo:eligDetail.getEdCaseRecertDatesCargo()) {
				if(edCaseRecertDatesCargo != null && edCaseRecertDatesCargo.getEdgNum() == eligibilityCargo.getEdgNum()) {
					edRecertDatesCargo = edCaseRecertDatesCargo;
				}
			}						
		}
		if(eligibilityCargo != null && egDataHandler != null && edRecertDatesCargo == null) {
			EdCaseRecertDatesCargo[] aEdRecertDates = egDataHandler.fetchEdRecertDates(eligibilityCargo, conn);
			if(aEdRecertDates != null) {
				for(EdCaseRecertDatesCargo edCaseRecertDatesCargo:aEdRecertDates) {
					if(edCaseRecertDatesCargo != null && edCaseRecertDatesCargo.getEdgNum() == eligibilityCargo.getEdgNum()) {
						edRecertDatesCargo = edCaseRecertDatesCargo;
					}								
				}
			}
		}
		return edRecertDatesCargo;
	}

	/**
	 * align TANF cert period on recertification of SNAP
	 * @param egDataHandler
	 * @param tanfOngoingEligibilityCargo
	 * @param snapOngoingEligibilityCargo
	 * @param tanfEligibilityCargos
	 * @throws EDBCException
	 */
	private void setTANFCertPeriodOnSNAPRecert(EgDataHandler egDataHandler,
			EdEligibilityCargo tanfOngoingEligibilityCargo,
			EdEligibilityCargo snapOngoingEligibilityCargo,
			List<EdEligibilityCargo> tanfEligibilityCargos)
			throws EDBCException {
		if(egDataHandler != null && tanfOngoingEligibilityCargo != null && snapOngoingEligibilityCargo != null) {
			EligDetail[] eligDetails = egDataHandler.getEligDetail();
			Timestamp maxAuthPaymentBegDt = null;
			// find max last authorized payment Beg Dt for TANF
			if(eligDetails != null && eligDetails.length > 1 && eligDetails[1] != null) {
				maxAuthPaymentBegDt = fetchAuthEligRecords(eligDetails[1], tanfOngoingEligibilityCargo.getEdgNum());
			}							
			if(maxAuthPaymentBegDt == null) {
				EligDetail eliglastAuthMinus6Mths = egDataHandler.getEligDetailAuthMinus6Mths();
				maxAuthPaymentBegDt = fetchAuthEligRecords(eliglastAuthMinus6Mths, tanfOngoingEligibilityCargo.getEdgNum());
			}
			// if we are building TANF only for months less than estimated elig end date of SNAP
			if(tanfOngoingEligibilityCargo.getPaymentBegDt() != null && snapOngoingEligibilityCargo.getEstimatedEligEndDt() != null
					&& DateComparisons.dateLTDateInTimestamp(tanfOngoingEligibilityCargo.getPaymentBegDt(),
							snapOngoingEligibilityCargo.getEstimatedEligEndDt())) {
				/*
				 * if last authorized TANF edm is less than estimated elig end date of SNAP, align cert period and interim review
				 * of TANF with ongoing SNAP edg
				 */
				if(maxAuthPaymentBegDt == null || (maxAuthPaymentBegDt != null && DateComparisons.dateLTEQDateInTimestamp(
						maxAuthPaymentBegDt, snapOngoingEligibilityCargo.getEstimatedEligEndDt()))) {									
					/* beniwala - ASPEN00050963
					 * setNewTANFPeriod(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
							snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());	*/
					setNewTANFPeriodAlways(tanfEligibilityCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
							snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());	
				}			
			}
		}		
	}
	
	/**
	 * align TANF cert period when SNAP application is being added on recert of TANF
	 * @param egDataHandler
	 * @param tanfOngoingEligibilityCargo
	 * @param snapOngoingEligibilityCargo
	 * @param tanfEligibilityCargos
	 * @throws EDBCException
	 */
	private void setTANFCertPeriodOnTFRecertSnapIntake(EgDataHandler egDataHandler,
			EdEligibilityCargo tanfOngoingEligibilityCargo,
			EdEligibilityCargo snapOngoingEligibilityCargo,
			List<EdEligibilityCargo> tanfEligibilityCargos)
			throws EDBCException {
		if(egDataHandler != null && tanfOngoingEligibilityCargo != null && snapOngoingEligibilityCargo != null) {
			EligDetail[] eligDetails = egDataHandler.getEligDetail();
			Timestamp maxAuthPaymentBegDt = null;
			// find max last authorized payment Beg Dt for TANF
			if(eligDetails != null && eligDetails.length > 1 && eligDetails[1] != null) {
				maxAuthPaymentBegDt = fetchAuthEligRecords(eligDetails[1], tanfOngoingEligibilityCargo.getEdgNum());
			}							
			if(maxAuthPaymentBegDt == null) {
				EligDetail eliglastAuthMinus6Mths = egDataHandler.getEligDetailAuthMinus6Mths();
				maxAuthPaymentBegDt = fetchAuthEligRecords(eliglastAuthMinus6Mths, tanfOngoingEligibilityCargo.getEdgNum());
			}
			// if we are building TANF only for months less than estimated elig end date of SNAP
			if(tanfOngoingEligibilityCargo.getPaymentBegDt() != null && snapOngoingEligibilityCargo.getEstimatedEligEndDt() != null
					&& DateComparisons.dateLTDateInTimestamp(tanfOngoingEligibilityCargo.getPaymentBegDt(),
							snapOngoingEligibilityCargo.getEstimatedEligEndDt())) {
				/*
				 * if last authorized TANF edm is less than estimated elig end date of SNAP, align cert period and interim review
				 * of PR TANF with ongoing SNAP edg
				 */
				if(maxAuthPaymentBegDt == null || (maxAuthPaymentBegDt != null && DateComparisons.dateLTEQDateInTimestamp(
						maxAuthPaymentBegDt, snapOngoingEligibilityCargo.getEstimatedEligEndDt()))) {
					List<EdEligibilityCargo> tanfPREdgCargos = new ArrayList<EdEligibilityCargo>();
					if(tanfEligibilityCargos != null) {
						for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {
							if(tanfEdgCargo != null && IEdEligCodes.ACTIVITY_TYPE_COMPLETE_REVIEW.equalsIgnoreCase(tanfEdgCargo.getActivityType())) {
								tanfPREdgCargos.add(tanfEdgCargo);
							}
						}
					}
					setNewTANFPeriod(tanfPREdgCargos,snapOngoingEligibilityCargo.getCertEndDt(), 
							snapOngoingEligibilityCargo.getEstimatedEligEndDt(), snapOngoingEligibilityCargo.getSemiAnnualReviewDt());	
				}			
			}
		}		
	}

	/**
	 * fetch maximum authorized EDM for given edgNum
	 * @param eligDetail
	 * @param edgNum
	 * @return
	 * @throws EDBCException
	 */
	private Timestamp fetchAuthEligRecords(EligDetail eligDetail, long edgNum) throws EDBCException {
		Timestamp maxAuthPaymentBegDt = null;
		if(eligDetail != null && eligDetail.getEdEligibilityCargo() != null
				&& eligDetail.getEdEligibilityCargo().length > 0) {
			for(EdEligibilityCargo edEligAuthCargo:eligDetail.getEdEligibilityCargo()) {									
				if(edEligAuthCargo != null && edEligAuthCargo.getPaymentBegDt() != null && edEligAuthCargo.getEdgNum() == edgNum) {
					if(maxAuthPaymentBegDt == null) {
						maxAuthPaymentBegDt = edEligAuthCargo.getPaymentBegDt();
					}
					if(DateComparisons.dateGTDateInTimestamp(edEligAuthCargo.getPaymentBegDt(), maxAuthPaymentBegDt)) {
						maxAuthPaymentBegDt = edEligAuthCargo.getPaymentBegDt();
					}
				}
			}
		}
		return maxAuthPaymentBegDt;
	}

	/**
	 * align TANF certification period when TANF application is added along with SNAP application 
	 * or at recertification of SNAP
	 * @param snapOngoingEligibilityCargo
	 * @param tanfEligibilityCargos
	 * @param snapEligibilityCargos
	 * @throws EDBCException
	 */
	private void setTANFCertPeriodFrmIntakeRecertSNAP(
			EdEligibilityCargo snapOngoingEligibilityCargo,
			List<EdEligibilityCargo> tanfEligibilityCargos,
			List<EdEligibilityCargo> snapEligibilityCargos)
			throws EDBCException {
		if(tanfEligibilityCargos != null && snapOngoingEligibilityCargo != null) {
			for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {
				int i = 0;
				/*
				 * align cert period and interim review period with SNAP ongoing EDG for first TANF approved EDG
				 * For rest of TANF EDGs, align cert period and interim review period
				 */
				if(tanfEdgCargo != null) {
					if((i == 0  && IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(tanfEdgCargo.getCgStatusCd())) 
							|| i > 0) {
						if(tanfEdgCargo.getPaymentBegDt() != null && snapOngoingEligibilityCargo.getPaymentBegDt() != null
								&& DateComparisons.dateLTEQDateInTimestamp(DateComparisons.getFirstDayOfDate(tanfEdgCargo.getPaymentBegDt()), 
										DateComparisons.getFirstDayOfDate(snapOngoingEligibilityCargo.getPaymentBegDt()))) {
							tanfEdgCargo.setCertEndDt(snapOngoingEligibilityCargo.getCertEndDt());
							Timestamp semiAnnualReviewDt = findSemiAnnualReviewDt(snapEligibilityCargos);;						
							if(semiAnnualReviewDt != null && DateComparisons.dateLTDateInTimestamp(tanfEdgCargo.getPaymentBegDt(), semiAnnualReviewDt)) {
								tanfEdgCargo.setSemiAnnualReviewDt(semiAnnualReviewDt);
								tanfEdgCargo.setEstimatedEligEndDt(semiAnnualReviewDt);
							}
							else {
								tanfEdgCargo.setEstimatedEligEndDt(snapOngoingEligibilityCargo.getEstimatedEligEndDt());
								tanfEdgCargo.setSemiAnnualReviewDt(snapOngoingEligibilityCargo.getSemiAnnualReviewDt());
							}
							i++;
						}
					}
					
				}
			}
		}		
	}

	/**
	 * set new certification period and interim review period 
	 * @param tanfEligibilityCargos
	 * @param certEndDt
	 * @param estimatedEligEndDt
	 * @param semiAnnualReviewDt
	 */
	private void setNewTANFPeriod(List<EdEligibilityCargo> tanfEligibilityCargos, Timestamp certEndDt, Timestamp estimatedEligEndDt, 
			Timestamp semiAnnualReviewDt) {
		if(tanfEligibilityCargos != null) {
			int i = 0;
			for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {										
				if(tanfEdgCargo != null) {
					/*
					 * align cert period and interim review period with dates provided for first TANF approved EDG
					 * For rest of TANF EDGs, align cert period and interim review period
					 */					
					 if((i == 0 &&  IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(tanfEdgCargo.getCgStatusCd()))
							|| i > 0) {
						tanfEdgCargo.setCertEndDt(certEndDt);
						tanfEdgCargo.setEstimatedEligEndDt(estimatedEligEndDt);
						tanfEdgCargo.setSemiAnnualReviewDt(semiAnnualReviewDt);
						i++;
					}					
				}
			}
		}		
	}
	
	/**
	 * find semiAnnualReviewDt from the given list of eligibility cargos
	 * @param eligibilityCargos
	 * @return
	 * @throws EDBCException
	 */
	private Timestamp findSemiAnnualReviewDt(
			List<EdEligibilityCargo> eligibilityCargos) throws EDBCException {
		Timestamp semiAnnualReviewDt = null;
		if(eligibilityCargos != null) {
			for(EdEligibilityCargo edgCargo:eligibilityCargos) {
				if(edgCargo != null && edgCargo.getSemiAnnualReviewDt() != null) {
					if(semiAnnualReviewDt == null) {
						semiAnnualReviewDt = edgCargo.getSemiAnnualReviewDt();
					}
					else if(DateComparisons.dateGTDateInTimestamp(edgCargo.getSemiAnnualReviewDt(), semiAnnualReviewDt)) {
						semiAnnualReviewDt = edgCargo.getSemiAnnualReviewDt();
					}
				}
			}
		}
		return semiAnnualReviewDt;
	}
	
	/**
	 * find ongoing Simplified reporting eligibility cargo for given type of assistance
	 * @param arrEligDetailOutput
	 * @param egDataHandler
	 * @param typeOfAssistanceCd
	 * @param checkApprovedStatus
	 * @param checkEligibleChild
	 * @return
	 */
	private EligDetail fetchOngoingSimplifiedReportingEligDetail(
			EligDetail[] arrEligDetailOutput, EgDataHandler egDataHandler,
			String typeOfAssistanceCd, boolean checkApprovedStatus, boolean checkEligibleChild) {
		EligDetail eligDetail = null;
		if(arrEligDetailOutput != null && egDataHandler != null && typeOfAssistanceCd != null) {			
			// fetch ongoing  simplified reporting ed_eligibility cargo
			for(int i=0;i<arrEligDetailOutput.length;i++) {
				if(arrEligDetailOutput[i] != null && arrEligDetailOutput[i].getEdEligibilityCargo() != null
						&& arrEligDetailOutput[i].getEdEligibilityCargo().length > 0 && arrEligDetailOutput[i].getEdEligibilityCargo()[0] != null) {
					if("SR1".equalsIgnoreCase(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getSimplifiedReportingGrpCd()) 
							&& arrEligDetailOutput[i].getEdEligibilityCargo()[0].getPaymentEndDt() == null) {
						if(typeOfAssistanceCd.equalsIgnoreCase(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getTypeOfAssistanceCd())) {
							if(checkApprovedStatus && IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(arrEligDetailOutput[i].
									getEdEligibilityCargo()[0].getCgStatusCd())) {
								eligDetail = arrEligDetailOutput[i];
								break;
							}
							else if(!checkApprovedStatus) {
								eligDetail = arrEligDetailOutput[i];
								break;
							}
						}					
					}
				}
			}
			if(eligDetail != null && checkEligibleChild) {
				EdIndvEligibilityCargo[] edIndvEligCargos = eligDetail.getEdIndvEligibilityCargo();
				boolean hasEligibleChild = false;
				if(edIndvEligCargos != null) {					
					for(EdIndvEligibilityCargo edIndvEligCargo:edIndvEligCargos) {
						if(edIndvEligCargo != null && edIndvEligCargo.getEdgTraceId() == eligDetail.getEdEligibilityCargo()[0].getEdgTraceId()) {
							if(IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD.equalsIgnoreCase(edIndvEligCargo.getPartStatusCd())
									|| IEdEligCodes.PART_STATUS_CD_EXCLUDED_CHILD.equalsIgnoreCase(edIndvEligCargo.getPartStatusCd())
									|| IEdEligCodes.PART_STATUS_CD_OTHER_CHILD.equalsIgnoreCase(edIndvEligCargo.getPartStatusCd())) {
								hasEligibleChild = true;
							}
						}
					}
				}
				if(hasEligibleChild == true) {
					return eligDetail;
				}
				else {
					return null;
				}
			}
		}		
		return eligDetail;
	}

	/**
	 * fetch ongoing simplified reporting eligibility cargo from V records for given type of assistance
	 * @param arrEligDetailOutput
	 * @param egDataHandler
	 * @param typeOfAssistanceCd
	 * @param checkApprovedStatus
	 * @param checkEligibleChild
	 * @return
	 */
	private EdEligibilityCargo fetchOngoingSimplifiedReportingVEDG(
			EligDetail[] arrEligDetailOutput, EgDataHandler egDataHandler,
			String typeOfAssistanceCd, boolean checkApprovedStatus, boolean checkEligibleChild) {
		EdEligibilityCargo eligCargo = null;
		if(arrEligDetailOutput != null && egDataHandler != null && typeOfAssistanceCd != null) {			
			/*
			 *  fetch ongoing SNAP and TANF simplified reporting ed_eligibility cargo from V records - this
			 *  scenario might occur on rebuild
			 */
			if(eligCargo == null) {
				EdEligibilityCargo[] eligVRecords = egDataHandler.getEdEligibilityCargoVrecords();
				if(eligVRecords != null) {
					for(int i =0; i < eligVRecords.length; i++) {
						if(eligVRecords[i] != null) {
							if("SR1".equalsIgnoreCase(eligVRecords[i].getSimplifiedReportingGrpCd()) 
									&& eligVRecords[i].getPaymentEndDt() == null) {
								if(typeOfAssistanceCd.equalsIgnoreCase(eligVRecords[i].getTypeOfAssistanceCd())) {
									if(checkApprovedStatus && IEdEligCodes.STATUS_CD_APPROVED.equalsIgnoreCase(eligVRecords[i].getCgStatusCd())) {
										eligCargo = eligVRecords[i];
									}
									else if(!checkApprovedStatus) {
										eligCargo = eligVRecords[i];
									}									
								}							
							}
						}
					}
					if(eligCargo != null && checkEligibleChild) {
						EdIndvEligibilityCargo[] edIndvVRecords = egDataHandler.getEdIndvEligibilityCargoVrecords();
						boolean hasEligibleChild = false;
						if(edIndvVRecords != null) {
							for(EdIndvEligibilityCargo edIndvVRecord:edIndvVRecords) {
								if(edIndvVRecord != null && eligCargo.getEdgTraceId() == edIndvVRecord.getEdgTraceId()
										&& (IEdEligCodes.PART_STATUS_CD_ELIGIBLE_CHILD.equalsIgnoreCase(edIndvVRecord.getPartStatusCd())
												|| IEdEligCodes.PART_STATUS_CD_EXCLUDED_CHILD.equalsIgnoreCase(edIndvVRecord.getPartStatusCd())
												|| IEdEligCodes.PART_STATUS_CD_OTHER_CHILD.equalsIgnoreCase(edIndvVRecord.getPartStatusCd()))) {
									hasEligibleChild = true;
								}
							}
						}
						if(hasEligibleChild) {
							return eligCargo;
						}
						else {
							return null;
						}
					}
				}
			}
		}
		return eligCargo;
	}
	
	/**
	 * fetch all the EDGs for given edgNum
	 * @param arrEligDetailOutput
	 * @param egDataHandler
	 * @param edgNum
	 * @param fetchVRecordsAlso
	 * @return
	 */
	private List<EdEligibilityCargo> fetchEDGs(
			EligDetail[] arrEligDetailOutput, EgDataHandler egDataHandler,
			long edgNum, boolean fetchVRecordsAlso) {
		List<EdEligibilityCargo> eligCargos = new ArrayList<EdEligibilityCargo>();
		if(arrEligDetailOutput != null && egDataHandler != null) {			
			// fetch  ed_eligibility cargos for given edgNum
			for(int i=0;i<arrEligDetailOutput.length;i++) {
				if(arrEligDetailOutput[i] != null && arrEligDetailOutput[i].getEdEligibilityCargo() != null
						&& arrEligDetailOutput[i].getEdEligibilityCargo().length > 0 && arrEligDetailOutput[i].getEdEligibilityCargo()[0] != null) {
					if(arrEligDetailOutput[i].getEdEligibilityCargo()[0].getEdgNum() == edgNum) {						
						eligCargos.add(arrEligDetailOutput[i].getEdEligibilityCargo()[0]);											
					}
				}
			}
			if(fetchVRecordsAlso) {
				EdEligibilityCargo[] eligVRecords = egDataHandler.getEdEligibilityCargoVrecords();
				if(eligVRecords != null) {
					for(int i =0; i < eligVRecords.length; i++) {
						if(eligVRecords[i] != null) {
							if(eligVRecords[i].getEdgNum() == edgNum) {
								/*eligCargos.add(arrEligDetailOutput[i].getEdEligibilityCargo()[0]);*/
								eligCargos.add(eligVRecords[i]);   // ASPEN00052550 - Parma - Added for NulPointer Exception
							}
						}
					}
				}
			}
		}
		return eligCargos;
	}
	
	/**
	 * fetch max authorized EDM
	 * @param egDataHandler
	 * @param edgNum
	 * @return
	 * @throws EDBCException
	 */
	private Timestamp fetchMaxAuthEDM(EgDataHandler egDataHandler, long edgNum) throws EDBCException {
		Timestamp maxAuthPaymentBegDt = null;
		if(egDataHandler != null) {
			EligDetail[] eligDetails = egDataHandler.getEligDetail();
			// find max last authorized payment Beg Dt for given edgNum
			if(eligDetails != null && eligDetails.length > 1 && eligDetails[1] != null) {
				maxAuthPaymentBegDt = fetchAuthEligRecords(eligDetails[1], edgNum);
			}							
			if(maxAuthPaymentBegDt == null) {
				EligDetail eliglastAuthMinus6Mths = egDataHandler.getEligDetailAuthMinus6Mths();
				maxAuthPaymentBegDt = fetchAuthEligRecords(eliglastAuthMinus6Mths, edgNum);
			}
		}
		
		return maxAuthPaymentBegDt;
	}
	
	/**
	 * check if date is blank or highDate
	 * @param ts
	 * @return
	 * @throws EDBCException
	 */
	private boolean dateIsEmpty(Timestamp ts) throws EDBCException {
		if(ts==null) {
			return true;
		}
		if(DateComparisons.dateEqualsDateInTimestamp(ts, DateComparisons.getTimestamp(EDGConstants.HIGH_DATE))) {
			return true;
		}
		return false;
	}
	// End - beniwala - ASPEN00049529
	
	// Begin - beniwala - ASPEN00050963
	/**
	 * set new certification period and interim review period 
	 * @param tanfEligibilityCargos
	 * @param certEndDt
	 * @param estimatedEligEndDt
	 * @param semiAnnualReviewDt
	 */
	private void setNewTANFPeriodAlways(List<EdEligibilityCargo> tanfEligibilityCargos, Timestamp certEndDt, Timestamp estimatedEligEndDt, 
			Timestamp semiAnnualReviewDt) {
		if(tanfEligibilityCargos != null) {
			for(EdEligibilityCargo tanfEdgCargo:tanfEligibilityCargos) {										
				if(tanfEdgCargo != null) {
					/*
					 * align cert period and interim review period with dates provided for first TANF approved EDG
					 * For rest of TANF EDGs, align cert period and interim review period
					 */
						tanfEdgCargo.setCertEndDt(certEndDt);
						tanfEdgCargo.setEstimatedEligEndDt(estimatedEligEndDt);
						tanfEdgCargo.setSemiAnnualReviewDt(semiAnnualReviewDt);				
				}
			}
		}		
	}
	// End - beniwala
}
